<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python Geographic Data Visualization Tool GeoPandas - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="GeoPandas Introduction GeoPandas is an open source project that aims to make it easier to work with geospatial data under Python. GeoPandas extends the pandas data type to allow spatial operations on geometric types. Geometric operations are performed by shapely. GeoPandas further relies on fiona for file access and descartes, matplotlib for plotting. GeoPandas follows the data types of pandas, so there are also two data types in GeoPandas. GeoSeries" /><meta name="keywords" content="Geopandas, Python" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-11/geopandas/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python Geographic Data Visualization Tool GeoPandas" />
<meta property="og:description" content="GeoPandas Introduction GeoPandas is an open source project that aims to make it easier to work with geospatial data under Python. GeoPandas extends the pandas data type to allow spatial operations on geometric types. Geometric operations are performed by shapely. GeoPandas further relies on fiona for file access and descartes, matplotlib for plotting. GeoPandas follows the data types of pandas, so there are also two data types in GeoPandas. GeoSeries" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-11/geopandas/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-15T19:35:48+08:00" />
<meta property="article:modified_time" content="2021-11-15T19:35:48+08:00" />

<meta itemprop="name" content="Python Geographic Data Visualization Tool GeoPandas">
<meta itemprop="description" content="GeoPandas Introduction GeoPandas is an open source project that aims to make it easier to work with geospatial data under Python. GeoPandas extends the pandas data type to allow spatial operations on geometric types. Geometric operations are performed by shapely. GeoPandas further relies on fiona for file access and descartes, matplotlib for plotting. GeoPandas follows the data types of pandas, so there are also two data types in GeoPandas. GeoSeries"><meta itemprop="datePublished" content="2021-11-15T19:35:48+08:00" />
<meta itemprop="dateModified" content="2021-11-15T19:35:48+08:00" />
<meta itemprop="wordCount" content="1371">
<meta itemprop="keywords" content="python," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python Geographic Data Visualization Tool GeoPandas"/>
<meta name="twitter:description" content="GeoPandas Introduction GeoPandas is an open source project that aims to make it easier to work with geospatial data under Python. GeoPandas extends the pandas data type to allow spatial operations on geometric types. Geometric operations are performed by shapely. GeoPandas further relies on fiona for file access and descartes, matplotlib for plotting. GeoPandas follows the data types of pandas, so there are also two data types in GeoPandas. GeoSeries"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python Geographic Data Visualization Tool GeoPandas</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-11-15 19:35:48 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1371 words </span>
          <span class="more-meta"> 3 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#geopandas-introduction">GeoPandas Introduction</a>
      <ul>
        <li>
          <ul>
            <li><a href="#geoseries">GeoSeries</a></li>
            <li><a href="#geodataframe">GeoDataFrame</a></li>
          </ul>
        </li>
        <li><a href="#geopandas-installation">GeoPandas installation</a></li>
        <li><a href="#use-of-geopandas">Use of GeoPandas</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="geopandas-introduction">GeoPandas Introduction</h1>
<p>GeoPandas is an open source project that aims to make it easier to work with geospatial data under Python. GeoPandas extends the pandas data type to allow spatial operations on geometric types. Geometric operations are performed by <a href="http://toblerity.github.io/shapely">shapely</a>. GeoPandas further relies on <a href="http://toblerity.github.io/fiona">fiona</a> for file access and <a href="https://pypi.python.org/pypi/descartes">descartes</a>, <a href="http://matplotlib.org/">matplotlib</a> for plotting.</p>
<p>GeoPandas follows the data types of pandas, so there are also two data types in GeoPandas.</p>
<ul>
<li>GeoSeries</li>
<li>GeoDataFrame</li>
</ul>
<p>They are subclasses of Series and DataFrame in Pandas, respectively, and inherit most of the methods of the Pandas data structure.</p>
<h3 id="geoseries">GeoSeries</h3>
<p>GeoSeries are sequences containing collections of shapes, each element can be a single shape or multiple shapes. geopandas have three basic types of geometric objects.</p>
<ul>
<li>Points: Points/Multi-Points</li>
<li>Lines: Lines/Multi-Lines</li>
<li>Facets: Polygons/Multi-Polygons</li>
</ul>
<p>All entries in a GeoSeries do not have to have the same geometry type; some operations may fail if they are of different types.</p>
<p>The Geoseries class implements almost all the properties and methods of the Shapely object. When using GeoSeries, it will be applied to each element of all geometries in the sequence. A binary operation can be performed between two GeoSeries objects, in which case the binary operation will be applied to each element. The two sequences will be operated on by matching indexes. The binary operation can also be applied to a single geometry, in which case the binary operation will be performed on each element of the geometry sequence. In both cases, the operation will return a Series or GeoSeries object.</p>
<p><strong>Attributes Attributes</strong></p>
<ul>
<li>area: Returns a Series that contains the area of each geometry in the GeoSeries.</li>
<li>bounds: Returns a DataFrame containing the bounds of each geometry, represented by the column values minx, miny, maxx, maxy.</li>
<li>total_bounds: Returns a tuple containing the minx,miny,maxx,maxy values for the entire series bounds. Bounds of the geometry contained in the series.</li>
<li>geom_type: Returns a string for the series, the string specifies the geometry type of each object.</li>
<li>is_valid: Returns a Series of boolean type, which is True if the geometry is valid.</li>
</ul>
<p><strong>Basic Methods basic methods</strong></p>
<ul>
<li>distance(): Returns a Series that contains the minimum distance to other GeoSeries objects (per element) or geometric objects.</li>
<li>centroid: Returns a GeoSeries that represents the geometry&rsquo;s center of gravity point.</li>
<li>representative_point(): Returns one GeoSeries of all points (calculated on the fly) that must be guaranteed to be in the interior of each geometry. This point is not equal to the center of gravity.</li>
<li>to_crs(): Converts the geometry in the GeoSeries to a different coordinate reference system. The crs attribute of the current GeoSeries must be set. crs attribute needs to be specified for output, either in dictionary form or in EPSG encoding.</li>
<li>plot(): Plots the geometry of the GeoSeries.</li>
</ul>
<p><strong>Relationship Tests relationship tests</strong></p>
<ul>
<li>geom_almost_equals(): Returns a boolean Series object, which is True if all points of each object are approximately equal to each other at the specified fractional precision.</li>
<li>contains(): Returns a Boolean Series object that is True if the interior of each object contains the interiors and bounds of the other objects and their bounds are not contiguous.</li>
<li>intersects(): Returns a Boolean Series that is True if the boundaries and interiors of each object intersect other objects in any other form.</li>
</ul>
<h3 id="geodataframe">GeoDataFrame</h3>
<p>A GeoDataFrame is a list data structure that contains a column called containing geometry, which contains a GeoSeries.</p>
<h2 id="geopandas-installation">GeoPandas installation</h2>
<p>GeoPandas is relatively easy to install under Linux, just execute: pip install geopandas</p>
<p>However, installation under Windows usually results in the following error.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="o">(</span>venv<span class="o">)</span> D:<span class="se">\C</span>odeHub<span class="se">\B</span>aidu-Area&gt;pip install geopandas
Looking in indexes: http://mirrors.aliyun.com/pypi/simple/
Collecting geopandas
  Downloading http://mirrors.aliyun.com/pypi/packages/83/c5/3cf9cdc39a6f2552922f79915f36b45a95b71fd343cfc51170a5b6ddb6e8/geopandas-0.7.0-py2.py3-none-any.whl <span class="o">(</span>928k
B<span class="o">)</span>
    100% <span class="p">|</span>████████████████████████████████<span class="p">|</span> 931kB 870kB/s
Collecting pyproj&gt;<span class="o">=</span>2.2.0 <span class="o">(</span>from geopandas<span class="o">)</span>
  Downloading http://mirrors.aliyun.com/pypi/packages/56/57/462b634a5ab562201f4f208b3cd077b80e8e04359509ec294e22f7dd006c/pyproj-2.6.0-cp37-cp37m-win_amd64.whl <span class="o">(</span>24.
1MB<span class="o">)</span>
    100% <span class="p">|</span>████████████████████████████████<span class="p">|</span> 24.1MB 479kB/s
Collecting shapely <span class="o">(</span>from geopandas<span class="o">)</span>
  Downloading http://mirrors.aliyun.com/pypi/packages/ea/55/61a5d274a210585b5d0c3dac81a82952a4baa7903e3642228d7a465fc340/Shapely-1.7.0-cp37-cp37m-win_amd64.whl <span class="o">(</span>1.
0MB<span class="o">)</span>
    100% <span class="p">|</span>████████████████████████████████<span class="p">|</span> 1.0MB 3.0MB/s
Collecting fiona <span class="o">(</span>from geopandas<span class="o">)</span>
  Downloading http://mirrors.aliyun.com/pypi/packages/6d/42/f4a7cac53b28fa70e9a93d0e89a24d33e14826dad6644b699362ad84dde0/Fiona-1.8.13.post1.tar.gz <span class="o">(</span>1.2MB<span class="o">)</span>
    100% <span class="p">|</span>████████████████████████████████<span class="p">|</span> 1.2MB 2.3MB/s
    Complete output from <span class="nb">command</span> python setup.py egg_info:
    A GDAL API version must be specified. Provide a path to gdal-config using a GDAL_CONFIG environment variable or use a GDAL_VERSION environment variable.

    ----------------------------------------
Command <span class="s2">&#34;python setup.py egg_info&#34;</span> failed with error code <span class="m">1</span> in C:<span class="se">\U</span>sers<span class="se">\Q</span>WD312~1.TCE<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\T</span>emp<span class="se">\p</span>ip-install-tls06urt<span class="se">\f</span>iona<span class="se">\
</span></code></pre></td></tr></table>
</div>
</div><p>Main content install GDAL and fiona times error by installing dependency libraries.</p>
<p>Solution 1: If you are using anaconda, you can install geopandas by conda</p>
<p>Solution 2: Download the compiled GDAL and fiona package to install, download address: <a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">https://www.lfd.uci.edu/~gohlke/pythonlibs/</a></p>
<h2 id="use-of-geopandas">Use of GeoPandas</h2>
<p>To display the world map.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">world</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
<span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/15/c3c08302e9c443feaab6658eb63be2ad.png" alt=""></p>
<p>GeoPandas' read_file method can read almost any vector-based spatial data format, including ESRI shapefiles, GeoJSON files, etc. geopandas.datasets.get_path(&lsquo;naturalearth_lowres &lsquo;) gets the shapefile file of the world map from GeoPandas&rsquo; own dataset. The data style is as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/15/0aadf3e331b843648058c13138a4e498.png" alt=""></p>
<p>In this data column, there are not only geometry columns, but also other attribute columns such as: pop_est (population), continent (continent), name (region name), iso_a3 (country/region three character code), gdp_md_est(), etc.</p>
<p>It is also possible to export GeoDataFrame as ESRI shapefile, GeoJson, GeoPackage and other geospatial file types:.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">world</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&#34;countries.shp&#34;</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&#34;countries.geojson&#34;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;GeoJSON&#39;</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s2">&#34;package.gpkg&#34;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s1">&#39;countries&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&#34;GPKG&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Show the center point of each country.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">world</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
<span class="n">world</span><span class="p">[</span><span class="s1">&#39;centroid_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">centroid</span>
<span class="c1"># 将新增列设置为几何列</span>
<span class="n">world</span> <span class="o">=</span> <span class="n">world</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s1">&#39;centroid_column&#39;</span><span class="p">)</span> 
<span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/15/9967015d2c3246b3a62252ad18f80806.png" alt=""></p>
<p>world.centroid returns a GeoSeries containing the spatial data of the centroids of each region. The .set_geometry function then sets the new columns to geometry columns, so that the map will be displayed according to the new geometry columns.</p>
<p>Display colors with different depths by population.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">world</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span> <span class="s1">&#39;pop_est&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/15/58dc61268c474a11b788ee34d744db80.png" alt=""></p>
<p>column sets the column to be displayed differently. legend=True sets whether to display the color scale. You can also set the color scheme of the displayed colors: <a href="https://matplotlib.org/tutorials/colors/colormaps.html">https://matplotlib.org/tutorials/colors/colormaps.html</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">world</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span> <span class="s1">&#39;pop_est&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGn&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/15/36d62a8e78224713a0ac15bdd5a04c27.png" alt=""></p>
<p><strong>Adding text labels to GeoPandas regions</strong></p>
<p>When plotting region data with GeoPandas, it is sometimes expected to add text labels to each day&rsquo;s region. The main problem is that it is not possible to determine where the text labels should be added. Fortunately GeoPandas provides <a href="https://geopandas.org/data_structures.html#basic-methods">2 methods</a> that can help us to locate the text labels.</p>
<ul>
<li>Centroid: returns the center point of each polygon</li>
<li>representative point(): returns a point inside the polygon, which is guaranteed to be inside the polygon&rsquo;s boundary, but not necessarily in the center</li>
</ul>
<p>Sample code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">adjustText</span> <span class="k">as</span> <span class="nn">aT</span>  <span class="c1"># https://github.com/Phlya/adjustText</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.sans-serif&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KaiTi&#39;</span><span class="p">]</span>  <span class="c1"># 用来正常显示中文标签</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.unicode_minus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># 用来正常显示负号</span>

<span class="n">china</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&#34;100000_full.json&#34;</span><span class="p">)</span>
<span class="n">china</span><span class="p">[</span><span class="s2">&#34;center&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">china</span><span class="p">[</span><span class="s2">&#34;geometry&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">centroid</span>
<span class="c1"># china[&#34;rep&#34;] = china[&#34;geometry&#34;].representative_point()</span>
<span class="n">china_points</span> <span class="o">=</span> <span class="n">china</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">china_points</span><span class="o">.</span><span class="n">set_geometry</span><span class="p">(</span><span class="s2">&#34;center&#34;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># china_points.set_geometry(&#34;rep&#34;, inplace = True)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">china</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&#34;whitesmoke&#34;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&#34;lightgrey&#34;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">china_points</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">china_points</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">china_points</span><span class="p">[</span><span class="s2">&#34;name&#34;</span><span class="p">]):</span>
    <span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>

<span class="n">aT</span><span class="o">.</span><span class="n">adjust_text</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">force_points</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">force_text</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">expand_points</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">expand_text</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
               <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&#34;-&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/15/ce1543a0ffa94a859e73237308d6d2e1.png" alt=""></p>
<p>Reference link.</p>
<ul>
<li><a href="https://geopandas.org/">https://geopandas.org/</a></li>
<li><a href="https://towardsdatascience.com/lets-make-a-map-using-geopandas-pandas-and-matplotlib-to-make-a-chloropleth-map-dddc31c1983d">Let’s make a map! Using Geopandas, Pandas and Matplotlib to make a Choropleth map</a></li>
<li><a href="https://towardsdatascience.com/creating-beautiful-maps-with-python-beyond-the-defaults-c92593ccf2cc">Creating Beautiful Maps with Python Beyond the defaults</a></li>
<li><a href="https://towardsdatascience.com/a-beginners-guide-to-create-a-cloropleth-map-in-python-using-geopandas-and-matplotlib-9cc4175ab630">A Beginners Guide to Create a Cloropleth Map in Python using GeoPandas and Matplotlib</a></li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-11/python-re/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Regular Expressions and Python Re Modules</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-11/mapboxgl-jupyter/">
            <span class="next-text nav-default">Python geographic data visualization tool mapboxgl jupyter</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
