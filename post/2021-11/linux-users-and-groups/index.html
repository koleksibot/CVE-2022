<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Linux user and user group management - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="There are only two levels of Linux users: root and non-root, and some users in Linux, such as apache, mysql, nobody, ftp, etc., are also non-root users, i.e. normal users. And these illusions are caused by another concept: user groups A user must belong to at least one user group A user can belong to more than one user group The reason for the existence of user groups is still" /><meta name="keywords" content="linux, Users, Groups" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-11/linux-users-and-groups/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Linux user and user group management" />
<meta property="og:description" content="There are only two levels of Linux users: root and non-root, and some users in Linux, such as apache, mysql, nobody, ftp, etc., are also non-root users, i.e. normal users. And these illusions are caused by another concept: user groups A user must belong to at least one user group A user can belong to more than one user group The reason for the existence of user groups is still" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-11/linux-users-and-groups/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-07T12:56:12+08:00" />
<meta property="article:modified_time" content="2021-11-07T12:56:12+08:00" />

<meta itemprop="name" content="Linux user and user group management">
<meta itemprop="description" content="There are only two levels of Linux users: root and non-root, and some users in Linux, such as apache, mysql, nobody, ftp, etc., are also non-root users, i.e. normal users. And these illusions are caused by another concept: user groups A user must belong to at least one user group A user can belong to more than one user group The reason for the existence of user groups is still"><meta itemprop="datePublished" content="2021-11-07T12:56:12+08:00" />
<meta itemprop="dateModified" content="2021-11-07T12:56:12+08:00" />
<meta itemprop="wordCount" content="3567">
<meta itemprop="keywords" content="linux," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Linux user and user group management"/>
<meta name="twitter:description" content="There are only two levels of Linux users: root and non-root, and some users in Linux, such as apache, mysql, nobody, ftp, etc., are also non-root users, i.e. normal users. And these illusions are caused by another concept: user groups A user must belong to at least one user group A user can belong to more than one user group The reason for the existence of user groups is still"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Linux user and user group management</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-11-07 12:56:12 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 3567 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#linux-user-and-group-data">Linux user and group data</a></li>
        <li><a href="#sudo-privileges">sudo privileges</a></li>
        <li><a href="#user-and-group-common-operations">User and group common operations</a>
          <ul>
            <li><a href="#adding-users">Adding users</a></li>
            <li><a href="#modify-user-password">Modify user password</a></li>
            <li><a href="#modify-user-information">Modify user information</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>There are only two levels of Linux users: root and non-root, and some users in Linux, such as apache, mysql, nobody, ftp, etc., are also non-root users, i.e. normal users. And these illusions are caused by another concept: user groups</p>
<ul>
<li>A user must belong to at least one user group</li>
<li>A user can belong to more than one user group</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/07/3a644476783446779bc6bd40334d2d02.png" alt=""></p>
<p>The reason for the existence of user groups is still mainly to facilitate the assignment of permissions. While the difference between users themselves and permissions is not very big, the main differences between individual users are.</p>
<ul>
<li>whether they have a password or not</li>
<li>home directory (ordinary users can have a home directory named after their user name, which is stored in /home/username, while the root user&rsquo;s home directory is: /root)</li>
<li>shell</li>
</ul>
<p>Users like nobody, who are used to execute Nginx worker processes, are generally not assigned a password or a shell, and do not even have a home directory. Why don&rsquo;t you assign a password? If a password is set, the program cannot be used automatically. Since no one will use this user to log in to the system, there is no need to assign a shell. (Note: Actually, technically there is a shell assigned, but the shell assigned is the special shell /sbin/nologin, which does not have any other function, the main function is to prevent you from logging in.)</p>
<h2 id="linux-user-and-group-data">Linux user and group data</h2>
<p>The main repositories of user and group information are the four files in /etc.</p>
<ul>
<li>/etc/passwd is a password file that contains basic information about the user.</li>
<li>/etc/shadow is a shadow password file that contains encrypted passwords.</li>
<li>/etc/group is a group file that contains basic information about groups and which users belong to them.</li>
<li>/etc/gshadow is a shadow group file that contains encrypted group passwords.</li>
</ul>
<p>The password (/etc/passwd) and group (/etc/group) files are shadowed for security reasons. passwd and group files themselves must be readable by all users, but encrypted passwords should not be readable by all users. Therefore, the shadow files contain encrypted passwords, and these files can only be read by root. suid program provides the necessary authentication access, and this program has root privileges but can be run by any user.</p>
<p>All users can be viewed by looking at /etc/passwd. The following is the user information on my system.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">root❌0:0:root:/root:/bin/bash
bin❌1:1:bin:/bin:/sbin/nologin
daemon❌2:2:daemon:/sbin:/sbin/nologin
adm❌3:4:adm:/var/adm:/sbin/nologin
lp❌4:7:lp:/var/spool/lpd:/sbin/nologin
sync❌5:0:sync:/sbin:/bin/sync
shutdown❌6:0:shutdown:/sbin:/sbin/shutdown
halt❌7:0:halt:/sbin:/sbin/halt
mail❌8:12:mail:/var/spool/mail:/sbin/nologin
operator❌11:0:operator:/root:/sbin/nologin
games❌12💯games:/usr/games:/sbin/nologin
ftp❌14:50:FTP User:/var/ftp:/sbin/nologin
nobody❌99:99:Nobody:/:/sbin/nologin
avahi-autoipd❌170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologin
systemd-bus-proxy❌999:997:systemd Bus Proxy:/:/sbin/nologin
systemd-network❌998:996:systemd Network Management:/:/sbin/nologin
dbus❌81:81:System message bus:/:/sbin/nologin
polkitd❌997:995:User for polkitd:/:/sbin/nologin
tss❌59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin
postfix❌89:89::/var/spool/postfix:/sbin/nologin
sshd❌74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
qw❌1000:1000:qw:/home/qw:/bin/bash
</code></pre></td></tr></table>
</div>
</div><p>Each line of the file represents a user, and each line is divided by a colon &ldquo;:&rdquo; into seven fields, which are structured as follows.</p>
<p><em>username: password: UID: GID: user full name: home directory: shell</em></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/07/8247432d11c548fe87cbf9cc939b17dc.png" alt=""></p>
<p>UID.</p>
<ul>
<li>UID 0 root user</li>
<li>UID 1 ~ 999 is accounted for pit users, that is, a write can not log in the user (previously the system is 1 ~ 499, just recently changed)</li>
<li>UID 1000 above is the normal logable user</li>
</ul>
<p>GID: previously said a user can belong to more than one user group, but here only one, said the dedicated user group, that is, a user has only one dedicated user group, its affiliation belonging to other user groups is stored in the /etc/group file.</p>
<p>One of the more special is the password field, unified by x instead, see /etc/passwd will know that at the beginning Linux is the password in this file, because of the consideration of /etc/passwd can be viewed by all, so will be stored in the /etc/shadow file (only root privileges can access), the specific data is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">root:$6$yp9k7rTFRX76aFP/$RpQ0Q7SIFpKn5jA3vEmpzsMdMDqDjmKQY3qCcVyuVNa1dTOOwJqC0SWCxqsNrZgYiBf5Og94cDR97hGCfd0OX1::0:99999:7:::
bin:*:16659:0:99999:7:::
daemon:*:16659:0:99999:7:::
adm:*:16659:0:99999:7:::
lp:*:16659:0:99999:7:::
sync:*:16659:0:99999:7:::
shutdown:*:16659:0:99999:7:::
halt:*:16659:0:99999:7:::
mail:*:16659:0:99999:7:::
operator:*:16659:0:99999:7:::
games:*:16659:0:99999:7:::
ftp:*:16659:0:99999:7:::
nobody:*:16659:0:99999:7:::
avahi-autoipd:!!:17031::::::
systemd-bus-proxy:!!:17031::::::
systemd-network:!!:17031::::::
dbus:!!:17031::::::
polkitd:!!:17031::::::
tss:!!:17031::::::
postfix:!!:17031::::::
sshd:!!:17031::::::
qw:$6$W1QYF2/.vMB7BPm/$n7GV1D07lcVDhsyGS0xUe66loRTfmFj2vT4TkELQgQGfqDxNn2fGzBYUYj4CgZMhaiNSvvmhW4gubpQxBhr3H0::0:99999:7:::
</code></pre></td></tr></table>
</div>
</div><p>The structure is as follows.</p>
<ul>
<li>login name: encrypted password <em>(means this user cannot be used to login): password last changed date (linux timestamp): minimum number of password days (0 means it can be changed at any time): maximum number of password days: remind the user a few days before expiration: password unavailable period: account expiration date: reserved bit</em></li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/07/ef342159bfbb486a9a616ccbf2e29477.png" alt=""></p>
<p>Again, take a look at the /etc/group file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">root❌0:
bin❌1:
daemon❌2:
sys❌3:
adm❌4:
tty❌5:
disk❌6:
lp❌7:
mem❌8:
kmem❌9:
wheel❌10:
cdrom❌11:
mail❌12:postfix
man❌15:
dialout❌18:
floppy❌19:
games❌20:
tape❌30:
video❌39:
ftp❌50:
lock❌54:
audio❌63:
nobody❌99:
users❌100:
utmp❌22:
utempter❌35:
ssh_keys❌999:
avahi-autoipd❌170:
input❌998:
systemd-journal❌190:
systemd-bus-proxy❌997:
systemd-network❌996:
dbus❌81:
polkitd❌995:
dip❌40:
tss❌59:
postdrop❌90:
postfix❌89:
sshd❌74:
qw❌1000:qw
</code></pre></td></tr></table>
</div>
</div><p>The structure is as follows.</p>
<p><em>Group name: User group password: GID: User name within the user group</em></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/07/be9cfbc08a254c0da4648ceb5be1e979.png" alt=""></p>
<p>User group passwords are rarely used in normal use and are stored in /etc/gshadow.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/07/b1b41591f84b438282acc1ca5b89ba6c.png" alt=""></p>
<p>The user group file is special for &ldquo;user names in user group&rdquo;, which is actually a list of users under this group, each user is separated by a comma &ldquo;,&quot;; this field can be empty; if the field is empty, it means that the user group is the user name of GID.</p>
<h2 id="sudo-privileges">sudo privileges</h2>
<p>Ordinary users have very low privileges, even to install software on the system. Many times you can temporarily give privileges to ordinary users, which is sudo (add sudo before the command). For example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo cat /etc/shadow
</code></pre></td></tr></table>
</div>
</div><p>This is different from Ubuntu and Fedora, which are mainly desktop versions. If you want to give users root privileges, you need to change the /etc/sudoers file and modify its contents.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1">## Sudoers allows particular users to run various commands as</span>
<span class="c1">## the root user, without needing the root password.</span>
<span class="c1">##</span>
<span class="c1">## Examples are provided at the bottom of the file for collections</span>
<span class="c1">## of related commands, which can then be delegated out to particular</span>
<span class="c1">## users or groups.</span>
<span class="c1">## </span>
<span class="c1">## This file must be edited with the &#39;visudo&#39; command.</span>

<span class="c1">## Host Aliases</span>
<span class="c1">## Groups of machines. You may prefer to use hostnames (perhaps using </span>
<span class="c1">## wildcards for entire domains) or IP addresses instead.</span>
<span class="c1"># Host_Alias     FILESERVERS = fs1, fs2</span>
<span class="c1"># Host_Alias     MAILSERVERS = smtp, smtp2</span>

<span class="c1">## User Aliases</span>
<span class="c1">## These aren&#39;t often necessary, as you can use regular groups</span>
<span class="c1">## (ie, from files, LDAP, NIS, etc) in this file - just use %groupname </span>
<span class="c1">## rather than USERALIAS</span>
<span class="c1"># User_Alias ADMINS = jsmith, mikem</span>


<span class="c1">## Command Aliases</span>
<span class="c1">## These are groups of related commands...</span>

<span class="c1">## Networking</span>
<span class="c1"># Cmnd_Alias NETWORKING = /sbin/route, /sbin/ifconfig, /bin/ping, /sbin/dhclient, /usr/bin/net, /sbin/iptables, /usr/bin/rfcomm, /usr/bin/wvdial, /sbin/iwconfig, /sbin/mii-tool</span>

<span class="c1">## Installation and management of software</span>
<span class="c1"># Cmnd_Alias SOFTWARE = /bin/rpm, /usr/bin/up2date, /usr/bin/yum</span>

<span class="c1">## Services</span>
<span class="c1"># Cmnd_Alias SERVICES = /sbin/service, /sbin/chkconfig, /usr/bin/systemctl start, /usr/bin/systemctl stop, /usr/bin/systemctl reload, /usr/bin/systemctl restart, /usr/bin/systemctl status, /usr/bin/systemctl enable, /usr/bin/systemctl disable</span>

<span class="c1">## Updating the locate database</span>
<span class="c1"># Cmnd_Alias LOCATE = /usr/bin/updatedb</span>

<span class="c1">## Storage</span>
<span class="c1"># Cmnd_Alias STORAGE = /sbin/fdisk, /sbin/sfdisk, /sbin/parted, /sbin/partprobe, /bin/mount, /bin/umount</span>

<span class="c1">## Delegating permissions</span>
<span class="c1"># Cmnd_Alias DELEGATING = /usr/sbin/visudo, /bin/chown, /bin/chmod, /bin/chgrp </span>

<span class="c1">## Processes</span>
<span class="c1"># Cmnd_Alias PROCESSES = /bin/nice, /bin/kill, /usr/bin/kill, /usr/bin/killall</span>

<span class="c1">## Drivers</span>
<span class="c1"># Cmnd_Alias DRIVERS = /sbin/modprobe</span>

<span class="c1"># Defaults specification</span>

<span class="c1">#</span>
<span class="c1"># Disable &#34;ssh hostname sudo &lt;cmd&gt;&#34;, because it will show the password in clear. </span>
<span class="c1">#         You have to run &#34;ssh -t hostname sudo &lt;cmd&gt;&#34;.</span>
<span class="c1">#</span>
Defaults    requiretty

<span class="c1">#</span>
<span class="c1"># Refuse to run if unable to disable echo on the tty. This setting should also be</span>
<span class="c1"># changed in order to be able to use sudo without a tty. See requiretty above.</span>
<span class="c1">#</span>
Defaults   !visiblepw

<span class="c1">#</span>
<span class="c1"># Preserving HOME has security implications since many programs</span>
<span class="c1"># use it when searching for configuration files. Note that HOME</span>
<span class="c1"># is already set when the the env_reset option is enabled, so</span>
<span class="c1"># this option is only effective for configurations where either</span>
<span class="c1"># env_reset is disabled or HOME is present in the env_keep list.</span>
<span class="c1">#</span>
Defaults    always_set_home

Defaults    env_reset
Defaults    <span class="nv">env_keep</span> <span class="o">=</span>  <span class="s2">&#34;COLORS DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&#34;</span>
Defaults    <span class="nv">env_keep</span> <span class="o">+=</span> <span class="s2">&#34;MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&#34;</span>
Defaults    <span class="nv">env_keep</span> <span class="o">+=</span> <span class="s2">&#34;LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&#34;</span>
Defaults    <span class="nv">env_keep</span> <span class="o">+=</span> <span class="s2">&#34;LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&#34;</span>
Defaults    <span class="nv">env_keep</span> <span class="o">+=</span> <span class="s2">&#34;LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&#34;</span>

<span class="c1">#</span>
<span class="c1"># Adding HOME to env_keep may enable a user to run unrestricted</span>
<span class="c1"># commands via sudo.</span>
<span class="c1">#</span>
<span class="c1"># Defaults   env_keep += &#34;HOME&#34;</span>

Defaults    <span class="nv">secure_path</span> <span class="o">=</span> /sbin:/bin:/usr/sbin:/usr/bin

<span class="c1">## Next comes the main part: which users can run what software on </span>
<span class="c1">## which machines (the sudoers file can be shared between multiple</span>
<span class="c1">## systems).</span>
<span class="c1">## Syntax:</span>
<span class="c1">##</span>
<span class="c1">##     user    MACHINE=COMMANDS</span>
<span class="c1">##</span>
<span class="c1">## The COMMANDS section may have other options added to it.</span>
<span class="c1">##</span>
<span class="c1">## Allow root to run any commands anywhere </span>
root    <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>     ALL

<span class="c1">## Allows members of the &#39;sys&#39; group to run networking, software, </span>
<span class="c1">## service management apps and more.</span>
<span class="c1"># %sys ALL = NETWORKING, SOFTWARE, SERVICES, STORAGE, DELEGATING, PROCESSES, LOCATE, DRIVERS</span>

<span class="c1">## Allows people in group wheel to run all commands</span>
%wheel    <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>    ALL

<span class="c1">## Same thing without a password</span>
<span class="c1"># %wheel    ALL=(ALL)    NOPASSWD: ALL</span>

<span class="c1">## Allows members of the users group to mount and unmount the </span>
<span class="c1">## cdrom as root</span>
<span class="c1"># %users  ALL=/sbin/mount /mnt/cdrom, /sbin/umount /mnt/cdrom</span>

<span class="c1">## Allows members of the users group to shutdown this system</span>
<span class="c1"># %users  localhost=/sbin/shutdown -h now</span>

<span class="c1">## Read drop-in files from /etc/sudoers.d (the # here does not mean a comment)</span>
<span class="c1">#includedir /etc/sudoers.d</span>
</code></pre></td></tr></table>
</div>
</div><p>To add sudo privileges to no users, simply refer to.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1">## Allow root to run any commands anywhere </span>
root    <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>     ALL
</code></pre></td></tr></table>
</div>
</div><p>Add the following.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1">## Allow root to run any commands anywhere </span>
root    <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>     ALL
qw    <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>     ALL
</code></pre></td></tr></table>
</div>
</div><p>If you want to add sudo privileges to a user group then: (with an extra % unlike for users)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1">## Allows people in group wheel to run all commands</span>
%wheel <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span> ALL
</code></pre></td></tr></table>
</div>
</div><p>Another way is to add users who do not need to enter the root password, i.e. have root privileges, by adding the following.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">qw    <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span>     NOPASSWD:ALL
</code></pre></td></tr></table>
</div>
</div><p>It is also possible to set exactly which execution privileges are available, with the following rules.</p>
<p><em>authorized users host=[(which users or user groups to switch to)] [whether password authentication is required] command1, [(which users or user groups to switch to)] [whether password authentication is required] [command2], [(which users or user groups to switch to)] [whether password authentication is required] [command3] &hellip;&hellip;</em></p>
<p>By default the first time you use sudo, you need to enter the root password, if you execute sudo again within 5 minutes you don&rsquo;t need to enter the password again, after 5 minutes you need to enter it again. This time is also configurable by adding the following to sudoers.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">Defaults:用户名 <span class="nv">timestamp_timeout</span><span class="o">=</span><span class="m">20</span>
</code></pre></td></tr></table>
</div>
</div><p>where the unit is minutes, and if it is set to 0, it means that the password has to be entered every time.</p>
<h2 id="user-and-group-common-operations">User and group common operations</h2>
<h3 id="adding-users">Adding users</h3>
<p>The <strong>useradd</strong> command is used to create a new system user in Linux. useradd can be used to create a user account. After the account is created, passwd is used to set the password for the account. The account can be deleted with userdel. The account created with the useradd command is actually saved in the /etc/passwd text file.</p>
<p>Syntax : <em>useradd(option)(parameter)</em></p>
<p>Options.</p>
<ul>
<li><code>-c&lt;comment&gt;</code>: Add the comment text. The comment text will be saved in the comment field of passwd</li>
<li><code>-d&lt;login directory&gt;</code>: Specify the directory where the user will start when logging in.</li>
<li>-D: change the preset value</li>
<li><code>-e&lt;expiration date&gt;</code>: Specify the expiration date of the account.</li>
<li><code>-f&lt;buffer days&gt;</code>: Specifies how many days after the password expires the account will be closed</li>
<li><code>-g&lt;group&gt;</code>: Specify the group to which the user belongs</li>
<li><code>-G&lt;groups&gt;</code>: Specify additional groups the user belongs to</li>
<li>-m: Automatically create the user&rsquo;s login directory</li>
<li>-M: Do not automatically create the user&rsquo;s login directory</li>
<li>-n: cancel the creation of groups with the user&rsquo;s name</li>
<li>-r: create system account</li>
<li>-s: specify the shell that the user will use after logging in</li>
<li>-u: specify the user id</li>
</ul>
<p>Example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo useradd username -m -s /sbin/nologin -d /home/username -g groupname
</code></pre></td></tr></table>
</div>
</div><p>Where.</p>
<ul>
<li>-s /sbin/nologin set no login</li>
<li>-d Set user home directory</li>
<li>-g user group</li>
<li>-m Create user directory</li>
</ul>
<h3 id="modify-user-password">Modify user password</h3>
<p>The <strong>passwd</strong> command is used to set user authentication information, including user password, password expiration time, etc. It can be used by system administrators to manage the passwords of system users. Only the administrator can specify the user name, general users can only change their own passwords.</p>
<p>Syntax: <em>passwd(option)(parameter)</em></p>
<p>Options</p>
<ul>
<li>-d: removes the password, available only to the system administrator.</li>
<li>-f: enforce.</li>
<li>-k: set the password to be updated only after it has expired.</li>
<li>-l: lock the password.</li>
<li>-s: lists information about the password, available only to the system administrator; * -u: unlocks the password.</li>
<li>-u: unlock the locked account.</li>
</ul>
<p>Ordinary users who want to change their passwords can just run passwd directly. If you create a new user and then want to create a password for the new user, use the passwd username, taking care to create it with the privileges of the root user.</p>
<h3 id="modify-user-information">Modify user information</h3>
<p>The <strong>usermod</strong> command is used to modify basic user information. usermod does not allow you to change the name of a user account that is online. When the usermod command is used to change the user id, you must make sure that the user is not running any programs on the computer. You will need to manually change the user&rsquo;s crontab file. You also need to manually change the user&rsquo;s at work file. To use NIS server, you need to change the NIS settings on the server.</p>
<p>Syntax: <em>usermod(option)(parameter)</em></p>
<p>Options</p>
<ul>
<li><code>-c&lt;comment&gt;</code>: Modify the comment text of the user account.</li>
<li><code>-d&lt;login directory&gt;</code>: Modifies the directory where the user logs in.</li>
<li><code>-e&lt;expiration date&gt;</code>: modifies the expiration date of the account.</li>
<li><code>-f&lt;buffer days&gt;</code>: modifies how many days after the password expires the account will be closed.</li>
<li><code>-g&lt;groups&gt;</code>: modifies the groups to which the user belongs.</li>
<li><code>-G&lt;groups&gt;</code>; modifies the additional groups to which the user belongs.</li>
<li><code>-l&lt;account name&gt;</code>: modify the name of the user&rsquo;s account.</li>
<li><code>-L</code>: lock the user&rsquo;s password to make it invalid.</li>
<li><code>-s&lt;shell&gt;</code>: modify the shell that the user uses when logged in.</li>
<li><code>-u&lt;uid&gt;</code>: modify the user ID.</li>
<li><code>-U</code>:unlock password.</li>
</ul>
<p>Example, adding newuser2 to the group staff.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">usermod -G staff newuser2
</code></pre></td></tr></table>
</div>
</div><p>Reference.</p>
<ul>
<li><a href="https://wiki.archlinux.org/index.php/Users_and_groups_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Users and groups</a></li>
<li><a href="https://www.linode.com/docs/guides/linux-users-and-groups/">Linux Users and Groups</a></li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/linux/">linux</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-11/linux-package-management/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Linux Package Management System</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-11/python-multi-thread-and-multi-process/">
            <span class="next-text nav-default">Python Multithreading and Multiprocessing</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
