<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Docker installation of multi-user version of JupyterHub - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="The host server is using Ubuntu 18.04. Note that Docker does not currently support Ubuntu 19.10. To use Docker in 19.10, you need to set the Ubuntu 18.04 version identifier: bionic in the Docker source configuration. 1 deb[arch=amd64]https://download.docker.com/linux/ubuntubionicstable Docker installation The installation process of Docker is very simple, just execute the following command. 1 2 3 4 5 6 7 8 9 sudo apt remove docker docker-engine docker.io sudo apt" /><meta name="keywords" content="docker, Jupyterhub" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-11/docker-jupyterhub/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Docker installation of multi-user version of JupyterHub" />
<meta property="og:description" content="The host server is using Ubuntu 18.04. Note that Docker does not currently support Ubuntu 19.10. To use Docker in 19.10, you need to set the Ubuntu 18.04 version identifier: bionic in the Docker source configuration. 1 deb[arch=amd64]https://download.docker.com/linux/ubuntubionicstable Docker installation The installation process of Docker is very simple, just execute the following command. 1 2 3 4 5 6 7 8 9 sudo apt remove docker docker-engine docker.io sudo apt" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-11/docker-jupyterhub/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-20T16:10:50+08:00" />
<meta property="article:modified_time" content="2021-11-20T16:10:50+08:00" />

<meta itemprop="name" content="Docker installation of multi-user version of JupyterHub">
<meta itemprop="description" content="The host server is using Ubuntu 18.04. Note that Docker does not currently support Ubuntu 19.10. To use Docker in 19.10, you need to set the Ubuntu 18.04 version identifier: bionic in the Docker source configuration. 1 deb[arch=amd64]https://download.docker.com/linux/ubuntubionicstable Docker installation The installation process of Docker is very simple, just execute the following command. 1 2 3 4 5 6 7 8 9 sudo apt remove docker docker-engine docker.io sudo apt"><meta itemprop="datePublished" content="2021-11-20T16:10:50+08:00" />
<meta itemprop="dateModified" content="2021-11-20T16:10:50+08:00" />
<meta itemprop="wordCount" content="2472">
<meta itemprop="keywords" content="docker," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker installation of multi-user version of JupyterHub"/>
<meta name="twitter:description" content="The host server is using Ubuntu 18.04. Note that Docker does not currently support Ubuntu 19.10. To use Docker in 19.10, you need to set the Ubuntu 18.04 version identifier: bionic in the Docker source configuration. 1 deb[arch=amd64]https://download.docker.com/linux/ubuntubionicstable Docker installation The installation process of Docker is very simple, just execute the following command. 1 2 3 4 5 6 7 8 9 sudo apt remove docker docker-engine docker.io sudo apt"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Docker installation of multi-user version of JupyterHub</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-11-20 16:10:50 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 2472 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#docker-installation">Docker installation</a></li>
        <li><a href="#multi-user-jupyterhub-installation">Multi-user jupyterhub installation</a></li>
        <li><a href="#gpu-support-for-multi-user-version-of-jupyterhub-inside-docker-containers">GPU support for multi-user version of JupyterHub inside Docker containers</a>
          <ul>
            <li><a href="#nvidia-docker">nvidia-docker</a></li>
            <li><a href="#jupyterhubsingleuser">jupyterhub/singleuser</a></li>
          </ul>
        </li>
        <li><a href="#docker调试相关命令">Docker调试相关命令</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>The host server is using Ubuntu 18.04. Note that Docker does not currently support Ubuntu 19.10. To use Docker in 19.10, you need to set the Ubuntu 18.04 version identifier: bionic in the Docker source configuration.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">deb</span><span class="w"> </span><span class="p">[</span><span class="n">arch</span><span class="o">=</span><span class="n">amd64</span><span class="p">]</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">download</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">ubuntu</span><span class="w"> </span><span class="n">bionic</span><span class="w"> </span><span class="k">stable</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h2 id="docker-installation">Docker installation</h2>
<p>The installation process of Docker is very simple, just execute the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo apt remove docker docker-engine docker.io
sudo apt install apt-transport-https ca-certificates curl software-properties-common
curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span class="p">|</span> sudo apt-key add –
sudo add-apt-repository <span class="s2">&#34;deb [arch=amd64] https://download.docker.com/linux/ubuntu </span><span class="k">$(</span>lsb_release -cs<span class="k">)</span><span class="s2"> stable&#34;</span>
sudo apt update
sudo apt install docker-ce
sudo usermod -aG docker <span class="nv">$USER</span>  <span class="c1">#将当前用户加入到Docker组</span>
sudo <span class="nb">echo</span> <span class="s2">&#34;DOCKER_OPTS=\&#34;--registry-mirror=https://registry.docker-cn.com\&#34;&#34;</span> &gt;&gt; /etc/default/docker  <span class="c1">#更改为国内源</span>
sudo service docker restartCEnt
</code></pre></td></tr></table>
</div>
</div><p>Installation under CentOS 7.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1"># 卸载旧版本Docker</span>
sudo yum remove docker docker-common docker-selinux docker-engine
<span class="c1"># 安装依赖包</span>
sudo yum install -y yum-utils device-mapper-persistent-data lvm2

<span class="c1"># 添加国内 yum 软件源：</span>
sudo yum-config-manager --add-repo https://mirrors.ustc.edu.cn/docker-ce/linux/centos/docker-ce.repo

<span class="c1"># 安装Docker CE</span>
sudo yum makecache fast
sudo yum install docker-ce

<span class="c1"># 启动 Docker CE</span>
sudo systemctl <span class="nb">enable</span> docker
sudo systemctl start docker

<span class="c1"># 将当前用户加入 docker 组</span>
sudo usermod -aG docker <span class="nv">$USER</span>

<span class="c1"># 镜像加速</span>
<span class="c1"># sudo echo &#34;DOCKER_OPTS=\&#34;--registry-mirror=https://registry.docker-cn.com\&#34;&#34; &gt;&gt; /etc/default/docker  #更改为国内源</span>
sudo nano /etc/docker/daemon.json
<span class="o">{</span>
  <span class="s2">&#34;registry-mirrors&#34;</span>: <span class="o">[</span><span class="s2">&#34;http://hub-mirror.c.163.com&#34;</span><span class="o">]</span>
<span class="o">}</span>

<span class="c1"># 重新启动服务</span>
sudo systemctl daemon-reload
sudo systemctl restart docker

<span class="c1"># 测试 Docker 是否安装正确</span>
sudo docker run hello-world

<span class="c1"># 安装 Docker-Compose</span>
<span class="c1"># 通过访问 https://github.com/docker/compose/releases/latest 得到最新的 docker-compose 版本</span>
sudo curl -L https://github.com/docker/compose/releases/download/1.25.5/docker-compose-<span class="sb">`</span>uname -s<span class="sb">`</span>-<span class="sb">`</span>uname -m<span class="sb">`</span> -o /usr/bin/docker-compose
sudo chmod +x /usr/bin/docker-compose
</code></pre></td></tr></table>
</div>
</div><p>Reference link.</p>
<ul>
<li><a href="https://www.linode.com/docs/applications/containers/install-docker-ce-ubuntu-1804/">How to Install Docker CE on Ubuntu 18.04</a></li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-18-04">How To Install and Use Docker on Ubuntu 18.04</a></li>
</ul>
<h2 id="multi-user-jupyterhub-installation">Multi-user jupyterhub installation</h2>
<p><strong>1. Pull the relevant image:</strong></p>
<p>No need to pull the latest version, the latest version has bugs and does not run properly after installation. Don&rsquo;t ask me how to know, blood and tears ~</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">docker pull jupyterhub/jupyterhub:1.0.0
docker pull jupyterhub/singleuser:1.0.0
</code></pre></td></tr></table>
</div>
</div><p><strong>2. Create jupyterhub_network</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">docker network create --driver bridge jupyterhub_network
</code></pre></td></tr></table>
</div>
</div><p><strong>3. Create jupyterhub&rsquo;s volume</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo mkdir -pv /data/jupyterhub
sudo chown -R root /data/jupyterhub
sudo chmod -R <span class="m">777</span> /data/jupyterhub
</code></pre></td></tr></table>
</div>
</div><p><strong>4. Create the jupyterhub_config.py file and copy it to the volume</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">cp</span><span class="w"> </span><span class="n">jupyterhub_config</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">/</span><span class="k">data</span><span class="o">/</span><span class="n">jupyterhub</span><span class="o">/</span><span class="n">jupyterhub_config</span><span class="p">.</span><span class="n">py</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Document content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># Configuration file for Jupyter Hub</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>

<span class="c1"># spawn with Docker</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">spawner_class</span> <span class="o">=</span> <span class="s1">&#39;dockerspawner.DockerSpawner&#39;</span>

<span class="c1"># Spawn containers from this image</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="s1">&#39;qw/jupyter_lab_singleuser:latest&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">extra_create_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="s1">&#39;root&#39;</span><span class="p">}</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;GRANT_SUDO&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
  <span class="s1">&#39;UID&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="c1"># workaround https://github.com/jupyter/docker-stacks/pull/420</span>
<span class="p">}</span>
<span class="c1"># c.JupyterHub.base_url=&#39;/jupyterhub&#39;</span>
<span class="c1"># JupyterHub requires a single-user instance of the Notebook server, so we</span>
<span class="c1"># default to using the `start-singleuser.sh` script included in the</span>
<span class="c1"># jupyter/docker-stacks *-notebook images as the Docker run command when</span>
<span class="c1"># spawning containers.  Optionally, you can override the Docker run command</span>
<span class="c1"># using the DOCKER_SPAWN_CMD environment variable.</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">extra_create_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="s2">&#34;start-singleuser.sh --SingleUserNotebookApp.default_url=/lab&#34;</span> <span class="p">})</span>

<span class="c1"># Connect containers to this Docker network</span>
<span class="n">network_name</span> <span class="o">=</span> <span class="s1">&#39;jupyterhub_network&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">use_internal_ip</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">network_name</span> <span class="o">=</span> <span class="n">network_name</span>
<span class="c1"># Pass the network name as argument to spawned containers</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">extra_host_config</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;network_mode&#39;</span><span class="p">:</span> <span class="n">network_name</span> <span class="p">}</span>

<span class="c1"># Explicitly set notebook directory because we&#39;ll be mounting a host volume to</span>
<span class="c1"># it.  Most jupyter/docker-stacks *-notebook images run the Notebook server as</span>
<span class="c1"># user `jovyan`, and set the notebook directory to `/home/jovyan/work`.</span>
<span class="c1"># We follow the same convention.</span>
<span class="n">notebook_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/jovyan&#39;</span>
<span class="c1"># notebook_dir = &#39;/home/jovyan/work&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">notebook_dir</span> <span class="o">=</span> <span class="n">notebook_dir</span>
<span class="c1"># Mount the real user&#39;s Docker volume on the host to the notebook user&#39;s</span>
<span class="c1"># notebook directory in the container</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">volumes</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;jupyterhub-user-</span><span class="si">{username}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">notebook_dir</span><span class="p">,</span><span class="s1">&#39;jupyterhub-shared&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;bind&#34;</span><span class="p">:</span> <span class="s1">&#39;/home/jovyan/shared&#39;</span><span class="p">,</span> <span class="s2">&#34;mode&#34;</span><span class="p">:</span> <span class="s2">&#34;rw&#34;</span><span class="p">}}</span>
<span class="c1"># volume_driver is no longer a keyword argument to create_container()</span>
<span class="c1"># c.DockerSpawner.extra_create_kwargs.update({ &#39;volume_driver&#39;: &#39;local&#39; })</span>
<span class="c1"># Remove containers once they are stopped</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">remove_containers</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># For debugging arguments passed to spawned containers</span>
<span class="n">c</span><span class="o">.</span><span class="n">DockerSpawner</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># The docker instances need access to the Hub, so the default loopback port doesn&#39;t work:</span>
<span class="c1"># from jupyter_client.localinterfaces import public_ips</span>
<span class="c1"># c.JupyterHub.hub_ip = public_ips()[0]</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">hub_ip</span> <span class="o">=</span> <span class="s1">&#39;jupyterhub&#39;</span>

<span class="c1"># IP Configurations</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">8000</span>

<span class="c1"># OAuth with GitLab</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">c</span><span class="o">.</span><span class="n">JupyterHub</span><span class="o">.</span><span class="n">authenticator_class</span> <span class="o">=</span> <span class="s1">&#39;oauthenticator.gitlab.GitLabOAuthenticator&#39;</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OAUTH_CALLBACK_URL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;http://10.101.14.13:8000/hub/oauth_callback&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;GITLAB_CLIENT_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;d89d76ef002100f217f4a7c1fc73011ca4d9eee7bb5ff8ce3e9532ba7721e29e&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;GITLAB_CLIENT_SECRET&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;05075caea4f3cb63a0cebc5d65e446df4dfc9598932cf3ddc751deb8eee5baf3&#39;</span>

<span class="n">c</span><span class="o">.</span><span class="n">GitLabOAuthenticator</span><span class="o">.</span><span class="n">oauth_callback_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;OAUTH_CALLBACK_URL&#39;</span><span class="p">]</span>
<span class="n">c</span><span class="o">.</span><span class="n">GitlabOAuthenticator</span><span class="o">.</span><span class="n">client_id</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;GITLAB_CLIENT_ID&#39;</span><span class="p">]</span>
<span class="n">c</span><span class="o">.</span><span class="n">GitlabOAuthenticator</span><span class="o">.</span><span class="n">client_secret</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;GITLAB_CLIENT_SECRET&#39;</span><span class="p">]</span>


<span class="n">c</span><span class="o">.</span><span class="n">Authenticator</span><span class="o">.</span><span class="n">whitelist</span> <span class="o">=</span> <span class="n">whitelist</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">Authenticator</span><span class="o">.</span><span class="n">admin_users</span> <span class="o">=</span> <span class="n">admin</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="n">here</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;userlist&#39;</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">whitelist</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;admin&#39;</span><span class="p">:</span>
            <span class="n">admin</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>5. Create the userlist file and copy it to volume</strong></p>
<p>Document content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">qw admin
</code></pre></td></tr></table>
</div>
</div><p>Only one admin account needs to be added here, as all other accounts can be added directly in the interface later.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">cp</span> <span class="n">userlist</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">jupyterhub</span><span class="o">/</span><span class="n">userlist</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>6、build jupyterhub image</strong></p>
<p>Since pip is used in Docker, it is recommended to modify the pip source. Create a new pip.conf file. The contents are</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">[global]
trusted-host=mirrors.aliyun.com
index-url=http://mirrors.aliyun.com/pypi/simple/
</code></pre></td></tr></table>
</div>
</div><p>Create a Dockerfile with the following file content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="k">ARG</span> <span class="nv">BASE_IMAGE</span><span class="o">=</span>jupyterhub/jupyterhub:1.0.0<span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> ${BASE_IMAGE}</span><span class="err">
</span><span class="err"></span><span class="k">ADD</span> pip.conf /etc/pip.conf<span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install --no-cache --upgrade jupyter<span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install --no-cache dockerspawner<span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install --no-cache oauthenticator<span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">GITLAB_HOST</span><span class="o">=</span>http://git.domain.com<span class="err">
</span><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8000</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>When complete, execute.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">docker build -t qw/jupyterhub .
</code></pre></td></tr></table>
</div>
</div><p><strong>7. build singleuser image (multi-user support)</strong></p>
<p>Create a Dockerfile with the following content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="k">ARG</span> <span class="nv">BASE_IMAGE</span><span class="o">=</span>jupyterhub/singleuser:1.0.0<span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> ${BASE_IMAGE}</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># 加速</span><span class="err">
</span><span class="err"></span><span class="k">ADD</span> pip.conf /etc/pip.conf<span class="err">
</span><span class="err"></span><span class="k">RUN</span> conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/<span class="err">
</span><span class="err"></span><span class="k">RUN</span> conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/<span class="err">
</span><span class="err"></span><span class="k">RUN</span> conda config --set show_channel_urls yes<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Install jupyterlab</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> conda install -c conda-forge jupyterlab<span class="err">
</span><span class="err"></span><span class="c"># RUN pip install jupyterlab</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> jupyter serverextension <span class="nb">enable</span> --py jupyterlab --sys-prefix<span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">GITLAB_HOST</span><span class="o">=</span>http://git.domain.com<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">USER</span><span class="s"> jovyan</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>When complete, execute.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">docker build -t qw/jupyter_lab_singleuser .
</code></pre></td></tr></table>
</div>
</div><p><strong>8. Open container</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">docker run -d --name jupyterhub -p8000:8000 --network jupyterhub_network -v /var/run/docker.sock:/var/run/docker.sock -v /data/jupyterhub:/srv/jupyterhub qw/jupyterhub:1.0.0
</code></pre></td></tr></table>
</div>
</div><p>If the following error is reported.</p>
<blockquote>
<p>Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get <a href="http://%2Fvar%2Frun%2Fdocker.sock/v1.40/images/json?all=1">http://%2Fvar%2Frun%2Fdocker.sock/v1.40/images/json?all=1</a>: dial unix /var/run/docker.sock: connect: permission denied</p>
</blockquote>
<p>then execute.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo chmod <span class="m">666</span> /var/run/docker.sock
</code></pre></td></tr></table>
</div>
</div><p><strong>9. Other related</strong></p>
<p>Jupyterhub&rsquo;s configuration file sets the shared directory, but it will report no permission problem when it is actually used. Solution.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo chmod -R <span class="m">777</span> /var/lib/docker/volumes/jupyterhub-shared
</code></pre></td></tr></table>
</div>
</div><h2 id="gpu-support-for-multi-user-version-of-jupyterhub-inside-docker-containers">GPU support for multi-user version of JupyterHub inside Docker containers</h2>
<p>After following the above process and installing it, you will encounter a problem: GPUs are not available within Docker, which is fatal for JupyterHub. Let&rsquo;s sort out how to solve this problem together today.</p>
<h3 id="nvidia-docker">nvidia-docker</h3>
<p>I thought that <a href="https://github.com/NVIDIA/nvidia-docker">nvidia docker</a> was the best solution, and after installing nvidia-docker I added the -gpu all directive when running Docker to make the container support GPUs, but that implementation solution only makes Jupyterhub easy to support GPUs, for the multi-user version of JupyterHub, a separate container is generated for each user. The single-user containers are generated by DockerSpawner from the API create_container. create_container does not support the -gpus parameter: <a href="https://github.com/docker/docker-py/issues/2395">https://github.com/docker/docker-py/issues/2395</a></p>
<p>Solution.</p>
<p><strong>1. Uninstall Docker 19.03 and downgrade to install Docker version 18.09:</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">services stop docker
rm -rf /var/lib/docker
yum remove docker*
yum -y install docker-ce-18.09.0 docker-ce-cli-18.09.0 containerd.io
</code></pre></td></tr></table>
</div>
</div><p><strong>2. Install the old version of nvidia-docker, i.e. nvidia-docker2</strong></p>
<p>If nvidia-docker version 1.0 was previously installed, you need to remove it first:.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">docker volume ls -q -f <span class="nv">driver</span><span class="o">=</span>nvidia-docker <span class="p">|</span> xargs -r -I<span class="o">{}</span> -n1 docker ps -q -a -f <span class="nv">volume</span><span class="o">={}</span> <span class="p">|</span> xargs -r docker rm -f
yum remove nvidia-docker
</code></pre></td></tr></table>
</div>
</div><p>Add related libraries and install them</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">distribution</span><span class="o">=</span><span class="k">$(</span>. /etc/os-release<span class="p">;</span><span class="nb">echo</span> <span class="nv">$ID$VERSION_ID</span><span class="k">)</span>
curl -s -L https://nvidia.github.io/nvidia-docker/<span class="nv">$distribution</span>/nvidia-docker.repo <span class="p">|</span> tee /etc/yum.repos.d/nvidia-docker.repo
yum install -y nvidia-docker2
</code></pre></td></tr></table>
</div>
</div><p>Configure nvidia-docker2 and set the default Runtime to nvidia.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;runtimes&#34;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&#34;nvidia&#34;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&#34;path&#34;</span><span class="p">:</span> <span class="s2">&#34;nvidia-container-runtime&#34;</span><span class="p">,</span>
            <span class="nt">&#34;runtimeArgs&#34;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&#34;default-runtime&#34;</span><span class="p">:</span> <span class="s2">&#34;nvidia&#34;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Add the above to the /etc/docker/daemon.json file, and restart dockerd.</p>
<h3 id="jupyterhubsingleuser">jupyterhub/singleuser</h3>
<p>jupyterhub/singleuser itself does not have any graphics drivers installed, the solution is to do a fresh Build.</p>
<p>From <a href="https://hub.docker.com/r/jupyterhub/singleuser/dockerfile">jupyterhub/singleuser&rsquo;s Dockerfile</a> we can see that it has a BASE_IMAGE of jupyter/base- notebook.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="c"># Build as jupyterhub/singleuser</span><span class="err">
</span><span class="err"></span><span class="c"># Run with the DockerSpawner in JupyterHub</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">BASE_IMAGE</span><span class="o">=</span>jupyter/base-notebook<span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> $BASE_IMAGE</span><span class="err">
</span><span class="err"></span><span class="k">MAINTAINER</span><span class="s"> Project Jupyter &lt;jupyter@googlegroups.com&gt;</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">ADD</span> install_jupyterhub /tmp/install_jupyterhub<span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">JUPYTERHUB_VERSION</span><span class="o">=</span>master
<span class="c"># install pinned jupyterhub and ensure notebook is installed</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> python3 /tmp/install_jupyterhub <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    python3 -m pip install notebook<span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>Look again at <a href="https://hub.docker.com/r/jupyter/base-notebook/dockerfile">the Dockerfile for jupyter/base-notebook</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="c"># Copyright (c) Jupyter Development Team.</span><span class="err">
</span><span class="err"></span><span class="c"># Distributed under the terms of the Modified BSD License.</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Ubuntu 18.04 (bionic) from 2019-10-29</span><span class="err">
</span><span class="err"></span><span class="c"># https://github.com/tianon/docker-brew-ubuntu-core/commit/d4313e13366d24a97bd178db4450f63e221803f1</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">BASE_CONTAINER</span><span class="o">=</span>ubuntu:bionic-20191029@sha256:6e9f67fa63b0323e9a1e587fd71c561ba48a034504fb804fd26fd8800039835d<span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> $BASE_CONTAINER</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">LABEL</span> <span class="nv">maintainer</span><span class="o">=</span><span class="s2">&#34;Jupyter Project &lt;jupyter@googlegroups.com&gt;&#34;</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">NB_USER</span><span class="o">=</span><span class="s2">&#34;jovyan&#34;</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">NB_UID</span><span class="o">=</span><span class="s2">&#34;1000&#34;</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">NB_GID</span><span class="o">=</span><span class="s2">&#34;100&#34;</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">USER</span><span class="s"> root</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Install all OS dependencies for notebook server that starts but lacks all</span><span class="err">
</span><span class="err"></span><span class="c"># features (e.g., download as all possible file formats)</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> DEBIAN_FRONTEND noninteractive<span class="err">
</span><span class="err"></span><span class="k">RUN</span> apt-get update <span class="se">\
</span><span class="se"></span> <span class="o">&amp;&amp;</span> apt-get install -yq --no-install-recommends <span class="se">\
</span><span class="se"></span>    wget <span class="se">\
</span><span class="se"></span>    bzip2 <span class="se">\
</span><span class="se"></span>    ca-certificates <span class="se">\
</span><span class="se"></span>    sudo <span class="se">\
</span><span class="se"></span>    locales <span class="se">\
</span><span class="se"></span>    fonts-liberation <span class="se">\
</span><span class="se"></span>    run-one <span class="se">\
</span><span class="se"></span> <span class="o">&amp;&amp;</span> apt-get clean <span class="o">&amp;&amp;</span> rm -rf /var/lib/apt/lists/*<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;en_US.UTF-8 UTF-8&#34;</span> &gt; /etc/locale.gen <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    locale-gen<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Configure environment</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">CONDA_DIR</span><span class="o">=</span>/opt/conda <span class="se">\
</span><span class="se"></span>    <span class="nv">SHELL</span><span class="o">=</span>/bin/bash <span class="se">\
</span><span class="se"></span>    <span class="nv">NB_USER</span><span class="o">=</span><span class="nv">$NB_USER</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">NB_UID</span><span class="o">=</span><span class="nv">$NB_UID</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">NB_GID</span><span class="o">=</span><span class="nv">$NB_GID</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">LC_ALL</span><span class="o">=</span>en_US.UTF-8 <span class="se">\
</span><span class="se"></span>    <span class="nv">LANG</span><span class="o">=</span>en_US.UTF-8 <span class="se">\
</span><span class="se"></span>    <span class="nv">LANGUAGE</span><span class="o">=</span>en_US.UTF-8<span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$CONDA_DIR</span>/bin:<span class="nv">$PATH</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">HOME</span><span class="o">=</span>/home/<span class="nv">$NB_USER</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Add a script that we will use to correct permissions after running certain commands</span><span class="err">
</span><span class="err"></span><span class="k">ADD</span> fix-permissions /usr/local/bin/fix-permissions<span class="err">
</span><span class="err"></span><span class="k">RUN</span> chmod a+rx /usr/local/bin/fix-permissions<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Enable prompt color in the skeleton .bashrc before creating the default NB_USER</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> sed -i <span class="s1">&#39;s/^#force_color_prompt=yes/force_color_prompt=yes/&#39;</span> /etc/skel/.bashrc<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Create NB_USER wtih name jovyan user with UID=1000 and in the &#39;users&#39; group</span><span class="err">
</span><span class="err"></span><span class="c"># and make sure these dirs are writable by the `users` group.</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&#34;auth requisite pam_deny.so&#34;</span> &gt;&gt; /etc/pam.d/su <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    sed -i.bak -e <span class="s1">&#39;s/^%admin/#%admin/&#39;</span> /etc/sudoers <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    sed -i.bak -e <span class="s1">&#39;s/^%sudo/#%sudo/&#39;</span> /etc/sudoers <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    useradd -m -s /bin/bash -N -u <span class="nv">$NB_UID</span> <span class="nv">$NB_USER</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    mkdir -p <span class="nv">$CONDA_DIR</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    chown <span class="nv">$NB_USER</span>:<span class="nv">$NB_GID</span> <span class="nv">$CONDA_DIR</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    chmod g+w /etc/passwd <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions <span class="nv">$HOME</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions <span class="s2">&#34;</span><span class="k">$(</span>dirname <span class="nv">$CONDA_DIR</span><span class="k">)</span><span class="s2">&#34;</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">USER</span><span class="s"> $NB_UID</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> $HOME</span><span class="err">
</span><span class="err"></span><span class="k">ARG</span> <span class="nv">PYTHON_VERSION</span><span class="o">=</span>default

<span class="c"># Setup work directory for backward-compatibility</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> mkdir /home/<span class="nv">$NB_USER</span>/work <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions /home/<span class="nv">$NB_USER</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Install conda as jovyan and check the md5 sum provided on the download site</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">MINICONDA_VERSION</span><span class="o">=</span><span class="m">4</span>.7.10 <span class="se">\
</span><span class="se"></span>    <span class="nv">MINICONDA_MD5</span><span class="o">=</span>1c945f2b3335c7b2b15130b1b2dc5cf4 <span class="se">\
</span><span class="se"></span>    <span class="nv">CONDA_VERSION</span><span class="o">=</span>4.7.12<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> <span class="nb">cd</span> /tmp <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    wget --quiet https://repo.continuum.io/miniconda/Miniconda3-<span class="si">${</span><span class="nv">MINICONDA_VERSION</span><span class="si">}</span>-Linux-x86_64.sh <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">MINICONDA_MD5</span><span class="si">}</span><span class="s2"> *Miniconda3-</span><span class="si">${</span><span class="nv">MINICONDA_VERSION</span><span class="si">}</span><span class="s2">-Linux-x86_64.sh&#34;</span> <span class="p">|</span> md5sum -c - <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    /bin/bash Miniconda3-<span class="si">${</span><span class="nv">MINICONDA_VERSION</span><span class="si">}</span>-Linux-x86_64.sh -f -b -p <span class="nv">$CONDA_DIR</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    rm Miniconda3-<span class="si">${</span><span class="nv">MINICONDA_VERSION</span><span class="si">}</span>-Linux-x86_64.sh <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nb">echo</span> <span class="s2">&#34;conda </span><span class="si">${</span><span class="nv">CONDA_VERSION</span><span class="si">}</span><span class="s2">&#34;</span> &gt;&gt; <span class="nv">$CONDA_DIR</span>/conda-meta/pinned <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">$CONDA_DIR</span>/bin/conda config --system --prepend channels conda-forge <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">$CONDA_DIR</span>/bin/conda config --system --set auto_update_conda <span class="nb">false</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">$CONDA_DIR</span>/bin/conda config --system --set show_channel_urls <span class="nb">true</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="k">if</span> <span class="o">[</span> ! <span class="nv">$PYTHON_VERSION</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> conda install --yes <span class="nv">python</span><span class="o">=</span><span class="nv">$PYTHON_VERSION</span><span class="p">;</span> <span class="k">fi</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    conda list python <span class="p">|</span> grep <span class="s1">&#39;^python &#39;</span> <span class="p">|</span> tr -s <span class="s1">&#39; &#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39;.&#39;</span> -f 1,2 <span class="p">|</span> sed <span class="s1">&#39;s/$/.*/&#39;</span> &gt;&gt; <span class="nv">$CONDA_DIR</span>/conda-meta/pinned <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">$CONDA_DIR</span>/bin/conda install --quiet --yes conda <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    <span class="nv">$CONDA_DIR</span>/bin/conda update --all --quiet --yes <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    conda clean --all -f -y <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    rm -rf /home/<span class="nv">$NB_USER</span>/.cache/yarn <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions <span class="nv">$CONDA_DIR</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions /home/<span class="nv">$NB_USER</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Install Tini</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> conda install --quiet --yes <span class="s1">&#39;tini=0.18.0&#39;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    conda list tini <span class="p">|</span> grep tini <span class="p">|</span> tr -s <span class="s1">&#39; &#39;</span> <span class="p">|</span> cut -d <span class="s1">&#39; &#39;</span> -f 1,2 &gt;&gt; <span class="nv">$CONDA_DIR</span>/conda-meta/pinned <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    conda clean --all -f -y <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions <span class="nv">$CONDA_DIR</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions /home/<span class="nv">$NB_USER</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Install Jupyter Notebook, Lab, and Hub</span><span class="err">
</span><span class="err"></span><span class="c"># Generate a notebook server config</span><span class="err">
</span><span class="err"></span><span class="c"># Cleanup temporary files</span><span class="err">
</span><span class="err"></span><span class="c"># Correct permissions</span><span class="err">
</span><span class="err"></span><span class="c"># Do all this in a single RUN command to avoid duplicating all of the</span><span class="err">
</span><span class="err"></span><span class="c"># files across image layers when the permissions change</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> conda install --quiet --yes <span class="se">\
</span><span class="se"></span>    <span class="s1">&#39;notebook=6.0.0&#39;</span> <span class="se">\
</span><span class="se"></span>    <span class="s1">&#39;jupyterhub=1.0.0&#39;</span> <span class="se">\
</span><span class="se"></span>    <span class="s1">&#39;jupyterlab=1.2.1&#39;</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    conda clean --all -f -y <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    npm cache clean --force <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    jupyter notebook --generate-config <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    rm -rf <span class="nv">$CONDA_DIR</span>/share/jupyter/lab/staging <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    rm -rf /home/<span class="nv">$NB_USER</span>/.cache/yarn <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions <span class="nv">$CONDA_DIR</span> <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    fix-permissions /home/<span class="nv">$NB_USER</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8888</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Configure container startup</span><span class="err">
</span><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;tini&#34;</span><span class="p">,</span> <span class="s2">&#34;-g&#34;</span><span class="p">,</span> <span class="s2">&#34;--&#34;</span><span class="p">]</span><span class="err">
</span><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;start-notebook.sh&#34;</span><span class="p">]</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Add local files as late as possible to avoid cache busting</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> start.sh /usr/local/bin/<span class="err">
</span><span class="err"></span><span class="k">COPY</span> start-notebook.sh /usr/local/bin/<span class="err">
</span><span class="err"></span><span class="k">COPY</span> start-singleuser.sh /usr/local/bin/<span class="err">
</span><span class="err"></span><span class="k">COPY</span> jupyter_notebook_config.py /etc/jupyter/<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Fix permissions on /etc/jupyter as root</span><span class="err">
</span><span class="err"></span><span class="k">USER</span><span class="s"> root</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> fix-permissions /etc/jupyter/<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># Switch back to jovyan to avoid accidental container runs as root</span><span class="err">
</span><span class="err"></span><span class="k">USER</span><span class="s"> $NB_UID</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div><p>Solution: Modify the BASE IMAGE of jupyter/base-notebook to: <a href="https://hub.docker.com/r/nvidia/cuda/">nvidia/cuda:10.1-cudnn7-devel-ubuntu18.04</a></p>
<p>The relevant files involved in the Dockerfile can be obtained from <a href="https://github.com/jupyter/docker-stacks/tree/master/base-notebook">https://github.com/jupyter/docker-stacks/tree/master/base-notebook</a>.</p>
<h2 id="docker调试相关命令">Docker调试相关命令</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sudo service docker stop <span class="c1">#关闭Docker服务</span>
sudo rm -rf /var/lib/docker/ <span class="c1">#删除所有Docker镜像</span>
sudo service docker start <span class="c1">#启动Docker服务</span>

docker images -a <span class="c1">#显示所有Docker镜像</span>
docker rmi qw/jupyterhub <span class="c1">#删除指定Docker镜像</span>

docker container ls -a <span class="c1">#显示所有docker容器</span>
docker container stop jupyterhub <span class="c1">#停止指定Docker容器</span>
docker container start jupyterhub <span class="c1">#开启指定Docker容器</span>
docker container rm jupyterhub <span class="c1">#删除指定Docker容器</span>
docker logs --details jupyterhub <span class="c1">#显示指定容器日志</span>
docker <span class="nb">exec</span> -it jupyterhub bash <span class="c1"># 进入指定容器（按Ctrl+D退出）</span>
docker container prune -f <span class="c1"># 删除所有停止的容器</span>
docker stop <span class="k">$(</span>docker ps -aq<span class="k">)</span> <span class="c1"># 停止所有容器</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/docker/">docker</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-11/use-cdk8s-define-k8s-apps/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Describing Kubernetes Applications Using Programming Languages - cdk8s</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-11/database-schema/">
            <span class="next-text nav-default">How to understand Schema schema of database</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
