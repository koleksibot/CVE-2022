<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python reads and writes Excel tables - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="When you use Python to process data, you often need to handle data in Excel. Nowadays, you basically use Pandas to read data from Excel, but there are some Python packages other than Pandas that can satisfy the need to read Excel data. Before we begin, learn the concepts involved in Excel. workbook : In various libraries, a workbook is actually an excel file, which can be regarded as a" /><meta name="keywords" content="Python, Excel" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-11/python-excel/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python reads and writes Excel tables" />
<meta property="og:description" content="When you use Python to process data, you often need to handle data in Excel. Nowadays, you basically use Pandas to read data from Excel, but there are some Python packages other than Pandas that can satisfy the need to read Excel data. Before we begin, learn the concepts involved in Excel. workbook : In various libraries, a workbook is actually an excel file, which can be regarded as a" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-11/python-excel/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-01T18:55:53+08:00" />
<meta property="article:modified_time" content="2021-11-01T18:55:53+08:00" />

<meta itemprop="name" content="Python reads and writes Excel tables">
<meta itemprop="description" content="When you use Python to process data, you often need to handle data in Excel. Nowadays, you basically use Pandas to read data from Excel, but there are some Python packages other than Pandas that can satisfy the need to read Excel data. Before we begin, learn the concepts involved in Excel. workbook : In various libraries, a workbook is actually an excel file, which can be regarded as a"><meta itemprop="datePublished" content="2021-11-01T18:55:53+08:00" />
<meta itemprop="dateModified" content="2021-11-01T18:55:53+08:00" />
<meta itemprop="wordCount" content="15341">
<meta itemprop="keywords" content="python,excel," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python reads and writes Excel tables"/>
<meta name="twitter:description" content="When you use Python to process data, you often need to handle data in Excel. Nowadays, you basically use Pandas to read data from Excel, but there are some Python packages other than Pandas that can satisfy the need to read Excel data. Before we begin, learn the concepts involved in Excel. workbook : In various libraries, a workbook is actually an excel file, which can be regarded as a"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python reads and writes Excel tables</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-11-01 18:55:53 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 15341 words </span>
          <span class="more-meta"> 31 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#python-excel-readwrite-package-of-xlrd-xlwt">Python Excel read/write package of xlrd, xlwt</a>
          <ul>
            <li><a href="#xlrd">xlrd</a></li>
            <li><a href="#xlwt">xlwt</a></li>
            <li><a href="#xlutils">xlutils</a></li>
            <li><a href="#xfstyle-format">XFStyle format</a></li>
          </ul>
        </li>
        <li><a href="#python-excel-writing-tool-for-xlsxwriter">Python Excel writing tool for xlsxwriter</a>
          <ul>
            <li><a href="#xlsxwriter-easy-to-use">xlsxwriter easy to use</a></li>
            <li><a href="#common-functions-of-xlsxwriter-module">Common functions of xlsxwriter module</a></li>
            <li><a href="#types-supported-by-xlsxwriter">Types supported by XlsxWriter</a></li>
          </ul>
        </li>
        <li><a href="#python-excel-reading-and-writing-with-openpyxl">Python Excel Reading and Writing with OpenPyXL</a>
          <ul>
            <li><a href="#createread-excel-files">Create/read excel files</a></li>
            <li><a href="#sheet-form-operations">sheet form operations</a></li>
            <li><a href="#cell-object">Cell object</a></li>
            <li><a href="#format-style-setting">Format style setting</a></li>
            <li><a href="#other">Other</a></li>
          </ul>
        </li>
        <li><a href="#python-excel-manipulation-of-xlwings">Python Excel manipulation of xlwings</a>
          <ul>
            <li><a href="#app-common-syntax">App common syntax</a></li>
            <li><a href="#book-common-syntax">Book common syntax</a></li>
            <li><a href="#sheet-common-syntax">Sheet common syntax</a></li>
            <li><a href="#range-common-syntax">Range common syntax</a></li>
            <li><a href="#transformer">Transformer</a></li>
          </ul>
        </li>
        <li><a href="#python-excel-quick-write-tool-pyexcelerate">Python Excel Quick Write Tool PyExcelerate</a></li>
        <li><a href="#python-read-and-write-excel-tool-pyexcel">Python read and write Excel tool pyexcel</a>
          <ul>
            <li><a href="#read-the-file">Read the file</a></li>
            <li><a href="#data-access">Data Access</a></li>
            <li><a href="#rewrite-the-file">Rewrite the file</a></li>
            <li><a href="#summary">Summary</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>When you use Python to process data, you often need to handle data in Excel. Nowadays, you basically use Pandas to read data from Excel, but there are some Python packages other than Pandas that can satisfy the need to read Excel data.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/01/3ca1e595dda34b44b00a82d33c973bf1.png" alt=""></p>
<p>Before we begin, learn the concepts involved in Excel.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/01/152df9fbf8804047bf14e0020d7e50e9.png" alt=""></p>
<ul>
<li><strong>workbook</strong> : In various libraries, a workbook is actually an excel file, which can be regarded as a database.</li>
<li><strong>sheet</strong> : In an excel file, there may be more than one sheet, a sheet can be regarded as a table in a database</li>
<li><strong>row</strong> : row is actually a row in a table, normally represented by the numbers 1, 2, 3, 4</li>
<li><strong>column</strong> : column is a column in a table, normally represented by the letters A, B, C, D</li>
<li><strong>cell</strong> : cell is a cell in a table, you can use the combination of row + column to represent, for example: A3</li>
</ul>
<p>Differences between the file formats commonly used in Excel.</p>
<ul>
<li><strong>XLS</strong> : The file format used before Excel version 2003, the binary way of saving files. xls files support a maximum of 65536 rows. xlsx supports a maximum of 1048576 rows. xls supports a maximum of 256 columns, xlsx is 16384 columns, this is the limit of the number of rows and columns is not from Excel version but the version of the file type.</li>
<li><strong>XLSX</strong>: XLSX is actually a ZIP file, that is, if you change the file name of XLSX to zip, and then you can use the unzip software to open the zip file directly, you open it to see the words, you will be able to see a lot of xml files inside.</li>
</ul>
<h2 id="python-excel-readwrite-package-of-xlrd-xlwt">Python Excel read/write package of xlrd, xlwt</h2>
<p>xlrd, xlwt, xlutils is developed by Simplistix, the original website content is basically emptied, the project migrated to <a href="http://www.python-excel.org">http://www.python-excel.org</a> and open source in GitHub, see <a href="https://github.com/python-excel">https://github.com/python-excel</a>. On the website is also currently Very much not recommended for the above tools, the official currently also do not recommend the continued use of the main reasons.</p>
<ul>
<li>xlrd module: can read .xls, .xlsx tables</li>
<li>xlwt module: can write .xls tables (can not write .xlsx files!!!)</li>
<li>xlutils is not required, but additionally provides some tool functions to simplify the operation.</li>
</ul>
<h3 id="xlrd">xlrd</h3>
<p>Read file functionality is provided by the xlrd package. xlrd implements the xlrd.book.Book (hereafter referred to as Book), xlrd.sheet.Sheet (hereafter referred to as Sheet) and xlrd.sheet.Cell (hereafter referred to as Cell) types, which correspond to the workbook, sheet and cell concepts in Excel, where the cell is the minimum operational granularity.</p>
<p>xlrd load form files on a function open_workbook, commonly used parameters on two.</p>
<ul>
<li>filename, specify the path to open the Excel file</li>
<li>on_demand, if it is True, then load the workbook on-demand form, if it is False, then directly load all forms, the default is False, in order to save resources is generally set to True, which is more obvious when the performance of large files.</li>
</ul>
<p>After reading the Excel file to get the Workbook, the next step is to locate the Sheet. the Book class object has several important properties and methods for indexing Sheets.</p>
<ul>
<li>nsheets property, which indicates the number of Sheet objects contained</li>
<li>sheet_names method, which returns the names of all sheets</li>
<li>sheet_by_index, sheet_by_name methods, which index the sheets using the serial number and name, respectively</li>
<li>sheets method, which returns a list of all Sheet objects</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">wb</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xls&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">wb</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">nsheets</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheet_names</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheet_by_name</span><span class="p">(</span><span class="s1">&#39;第一个 sheet&#39;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">sh</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>After getting the Sheet object, the next step is to index the rows/columns/cells and get the data of the rows/columns/cells. the Sheet class object has several important properties and methods to support the subsequent operations.</p>
<ul>
<li>the name property, which is the name of the form.</li>
<li>nrows, ncols properties, indicating the maximum number of rows and columns read into the form. Since cells only support row number indexing, these two properties are necessary to check for out-of-bounds content.</li>
<li>cell method, accepts 2 parameters, i.e. row and column serial numbers, returns Cell object, note that xlrd only supports indexing cells by row serial number, row serial number starts from 0.</li>
<li>cell_value method, similar to the cell method, except that the value returned is the value in the cell, not the Cell object.</li>
<li>cell_type method, returns the type of cell</li>
<li>row, col method, returns a list of Cell objects composed of 1 whole row (column).</li>
<li>row_types, col_types, return the type of cells in a number of columns (rows) within the specified row (column).</li>
<li>row_values, col_values, returns the value of the cell in the specified row (column) of a number of columns (rows).</li>
<li>row_slice, col_slice, return to the specified row (column) within a number of columns (rows) of cells, is a combination of types and values.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">wb</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xls&#39;</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="n">sh</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">row_values</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">col_values</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">cell_type</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">col_types</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># 第2列，第1行起始</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">row_slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="c1"># 第1行，第0列起始)</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that xlrd reads excel workbooks with row and column indexes starting from 0.</p>
<ul>
<li>row = ws.row_values(i, ca, cb) # read the contents of the [ca, cb) column in row i, return list. note that the cb column is not included</li>
<li>col = ws.col_values(i, ra, rb) # read the contents of the [ra, rb) row in column i, return to list. note that the rb row is not included</li>
<li>cell= ws.cell_value(r, c) # read the contents of the cell in column j of row i</li>
</ul>
<p>For predefined constants of data types</p>
<table>
<thead>
<tr>
<th>predefined constants</th>
<th>numeric</th>
<th>strings</th>
</tr>
</thead>
<tbody>
<tr>
<td>XL_CELL_EMPTY</td>
<td>0</td>
<td>empty</td>
</tr>
<tr>
<td>XL_CELL_TEXT</td>
<td>1</td>
<td>text</td>
</tr>
<tr>
<td>XL_CELL_NUMBER</td>
<td>2</td>
<td>number</td>
</tr>
<tr>
<td>XL_CELL_DATE</td>
<td>3</td>
<td>xldate</td>
</tr>
<tr>
<td>XL_CELL_BOOLEAN</td>
<td>4</td>
<td>boolean</td>
</tr>
<tr>
<td>XL_CELL_ERROR</td>
<td>5</td>
<td>error</td>
</tr>
<tr>
<td>XL_CELL_BLANK</td>
<td>6</td>
<td>blank</td>
</tr>
</tbody>
</table>
<p>The date data type is read as a floating point number and needs to be manually converted to time format, such as a cell date of 2020-2-5, xlrd module reads the value: 43866.0, there are two ways to convert a floating point number to the correct time format.</p>
<ul>
<li>xldate_as_tuple(xdate,datemode): returns a meta ancestor consisting of (year,month,day,hours,minutes,seconds), datemode parameter has 2 values, 0 means 1900 as the base timestamp (common), 1 means 1904 as the base timestamp. Dates before 1900-3-1 cannot be converted to tuples.</li>
<li>xldate_as_datetime(xdate,datemode) (need to introduce datetime module first), return a datetime object directly, xlrd.xldate_as_datetime(xdate,datemode).strftime( &lsquo;%Y-%m-%d %H:%M:%S&rsquo;)</li>
</ul>
<p>For indexing purposes, the cellname, cellnameabs, and colname functions of the xlrd package convert the row and column serial numbers to Excel-style cell addresses; the rowcol_to_cell and rowcol_pair_to_cellrange functions of the xlwt.Utils module can also convert the row and column serial numbers to Excel-style cell address; and col_by_name, cell_to_rowcol, cell_to_rowcol2, cellrange_to_rowcol_pair functions, the Excel-style cell address converted to row number.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="nb">print</span><span class="p">(</span><span class="n">xlrd</span><span class="o">.</span><span class="n">cellname</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xlrd</span><span class="o">.</span><span class="n">cellnameabs</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>  <span class="c1"># 结果为绝对引用地址</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xlwt</span><span class="o">.</span><span class="n">Utils</span><span class="o">.</span><span class="n">col_by_name</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>  <span class="c1"># 注意列名称必须大写</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xlwt</span><span class="o">.</span><span class="n">Utils</span><span class="o">.</span><span class="n">cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;K3&#39;</span><span class="p">))</span>  <span class="c1"># 行列均无绝对引用</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xlwt</span><span class="o">.</span><span class="n">Utils</span><span class="o">.</span><span class="n">cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;K$3&#39;</span><span class="p">))</span>  <span class="c1"># 行绝对引用</span>
<span class="nb">print</span><span class="p">(</span><span class="n">xlwt</span><span class="o">.</span><span class="n">Utils</span><span class="o">.</span><span class="n">cell_to_rowcol2</span><span class="p">(</span><span class="s1">&#39;K$3&#39;</span><span class="p">))</span>  <span class="c1"># 与上一个函数的区别是忽略绝对引用符号</span>
</code></pre></td></tr></table>
</div>
</div><p>The row number and cell address conversions are summarized in the following figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/01/5b55a1505c284ac3a9df180724aa4b2d.png" alt=""></p>
<p>To iterate through all the cells in a sheet, usually by row and column order to get the cell by cell, and then read out the cell value to save for subsequent processing. You can also directly get a whole row (column), the whole row (column) to deal with the data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">wb</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xls&#39;</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 1、逐单元格处理</span>
<span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">cx</span><span class="p">)</span>
        <span class="c1"># 对单元格的进一步处理</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">ctype</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># 2、整行处理</span>
<span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">nrows</span><span class="p">):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
    <span class="c1"># 对行的进一步处理</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>

<span class="c1"># 3、整列处理</span>
<span class="k">for</span> <span class="n">cx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">ncols</span><span class="p">):</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">cx</span><span class="p">)</span>
    <span class="c1"># 对列的进一步处理</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="xlwt">xlwt</h3>
<p>xlrd package can only read out the data in the form, can not do anything to rewrite the data, rewrite the data and save it to a file, by xlwt package. xlwt implements a set of xlwt.Workbook. Worksheet (hereinafter referred to as Worksheet) types, but unfortunately there is no inheritance relationship with the xlrd package, which results in the Book and Sheet objects read out of the xlrd package can not be used directly to create Workbook and Worksheet objects, but only to store the data temporarily for subsequent writing back, making the process very cumbersome.</p>
<p>The types, methods, functions and parameters exposed to the public by the xlwt package are also very concise and fit closely with the process of rewriting data and saving it to a file.</p>
<ul>
<li>Call the Workbook function of the Workbook module to create a Workbook object, the first parameter is encoding</li>
<li>call the Workbook object&rsquo;s add_sheet method to add Worksheet objects to Workbook, the first parameter sheetname specifies the name of the form, the second parameter cell_overwrite_ok determines whether to allow cell overwriting, it is recommended to set to True, to avoid the program may write data to the cell multiple times and throw an error.</li>
<li>call the Worksheet object write method, to the Worksheet row / column / cell write data, the data used here in most cases from the xlrd package from the Excel file to read the results, the first two parameters for the row number, the third parameter is the value to be written, the fourth parameter is the cell style, such as no special needs default can be; * call the Workbook object write method, to write data to the Worksheet row / column / cell.</li>
<li>Call the save method of the Workbook object to save the Workbook object to a file, with the parameters of the file name or file stream object.</li>
</ul>
<p>Other properties, methods, functions are generally used less.</p>
<p>xlwt mainly involves three classes: Workbook corresponds to the workbook file, Worksheet corresponds to the worksheet, XFStyle object used to control the cell format (XF record).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># 创建Workbook对象</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Workbook</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">style_compression</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># style_compression表示是否对格式进行压缩 默认为0不压缩 =1表示压缩字体信息 =2表示压缩字体和XF record</span>
<span class="c1"># 对于名为workbook的Workbook对象 可以有以下操作</span>
<span class="c1"># 添加工作表 并返回添加的工作表</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="n">sheet_name</span><span class="p">,</span> <span class="n">cell_overwrite_ok</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># 获取指定名称的工作表</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="n">Sheet_name</span><span class="p">)</span>
<span class="c1"># 保存xls文件</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
<span class="c1"># 对于名为worksheet的Worksheet对象 有以下操作</span>
<span class="c1"># 写入内容指定单元格的内容与格式</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rowx</span><span class="p">,</span> <span class="n">colx</span><span class="p">,</span> <span class="n">cell_value</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="n">rowx</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">colx</span><span class="p">,</span> <span class="n">cell_value</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="n">colx</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cell_value</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
<span class="c1"># 将完成编辑的行flush，flush之后的行不可再编辑</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">flush_row_data</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">rwb</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xls&#39;</span><span class="p">)</span>
<span class="n">rsh</span> <span class="o">=</span> <span class="n">rwb</span><span class="o">.</span><span class="n">sheet_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">wbk</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Workbook</span><span class="p">()</span>
<span class="n">wsh</span> <span class="o">=</span> <span class="n">wbk</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="s2">&#34;Sheet1&#34;</span><span class="p">,</span> <span class="n">cell_overwrite_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">for</span> <span class="n">rx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rsh</span><span class="o">.</span><span class="n">nrows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rsh</span><span class="o">.</span><span class="n">ncols</span><span class="p">):</span>
        <span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">cx</span><span class="p">,</span> <span class="n">rsh</span><span class="o">.</span><span class="n">cell_value</span><span class="p">(</span><span class="n">rx</span><span class="p">,</span> <span class="n">cx</span><span class="p">))</span>

<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;新数据A1&#39;</span><span class="p">)</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">3.14159</span><span class="p">)</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Utils</span><span class="o">.</span><span class="n">col_by_name</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="s1">&#39;列D&#39;</span><span class="p">)</span>

<span class="n">wbk</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;data2.xls&#39;</span><span class="p">)</span>
<span class="n">wbk</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;data-second.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 可以多次保存, 本质还是xls格式，与后缀无关。需要改成xls后才能使用Excel正常打开</span>
</code></pre></td></tr></table>
</div>
</div><p>There are two things to remember about saving.</p>
<ul>
<li>All Python libraries involving Excel operations do not support &ldquo;edit and save in place&rdquo;, and xlwt is no exception. &ldquo;Save&rdquo; is actually &ldquo;Save As&rdquo;, except that if you specify to save to the original file, the original file is overwritten.</li>
<li>Even if you specify the extension .xlsx, the file format itself is still xls format.</li>
</ul>
<p>Note that the date read from data.xls is essentially a numeric value, copied and written or numeric, you need to set the cell to date format in Excel to display as a date form.</p>
<p>xlwt also supports writing formulas, but more limited.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Formula</span><span class="p">(</span><span class="s1">&#39;sum(A3:D3)&#39;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>In addition, xlwr supports writing the contents of merged cells across rows or columns (rowx and colx starting from 0):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">write_merge</span><span class="p">(</span><span class="n">start_rowx</span><span class="p">,</span> <span class="n">end_rowx</span><span class="p">,</span> <span class="n">start_colx</span><span class="p">,</span> <span class="n">end_colx</span><span class="p">,</span><span class="n">content</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sytle</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Setting excel cell styles</strong></p>
<p>Set cell data formatting.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">mf</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">XFStyle</span><span class="p">()</span> <span class="c1">#返回用于设定单元格格式的实例</span>
<span class="n">mf</span><span class="o">.</span><span class="n">num_format_str</span> <span class="o">=</span> <span class="s1">&#39;yyyy/mm/dd&#39;</span> <span class="c1">#将数字转换为日期格式</span>
<span class="n">mf</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="s1">&#39;宋体&#39;</span> <span class="c1">#设置字体</span>
</code></pre></td></tr></table>
</div>
</div><p>The style instance needs to be specified in ws.write() to take effect.</p>
<p>Example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1">## 初始化样式</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">XFStyle</span><span class="p">()</span>  <span class="c1"># 样式类实例</span>

<span class="c1">## 创建字体</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Font</span><span class="p">()</span> <span class="c1"># 字体类实例</span>
<span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Times New Roman&#39;</span> <span class="c1"># 字体名称</span>
<span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># 加粗</span>
<span class="n">font</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span><span class="kc">True</span> <span class="c1"># 倾斜</span>
<span class="n">font</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">300</span> <span class="c1"># 字号 200 为 10 points</span>
<span class="n">font</span><span class="o">.</span><span class="n">colour_index</span><span class="o">=</span><span class="mi">3</span> <span class="c1"># 颜色编码</span>

<span class="c1">## 创建边框</span>
<span class="n">borders</span><span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Borders</span><span class="p">()</span> <span class="c1"># 边框类实例</span>
<span class="n">borders</span><span class="o">.</span><span class="n">left</span><span class="o">=</span> <span class="mi">6</span>
<span class="n">borders</span><span class="o">.</span><span class="n">right</span><span class="o">=</span> <span class="mi">6</span>
<span class="n">borders</span><span class="o">.</span><span class="n">top</span><span class="o">=</span> <span class="mi">6</span>
<span class="n">borders</span><span class="o">.</span><span class="n">bottom</span><span class="o">=</span> <span class="mi">6</span>

<span class="c1">## 创建对齐</span>
<span class="n">alignment</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Alignment</span><span class="p">()</span> <span class="c1"># 对齐类实例</span>
<span class="c1">#alignment.horz = xlwt.Alignment.HORZ_LEFT    # 水平左对齐</span>
<span class="c1">#alignment.horz = xlwt.Alignment.HORZ_RIGHT     # 水平右对齐</span>
<span class="n">alignment</span><span class="o">.</span><span class="n">horz</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Alignment</span><span class="o">.</span><span class="n">HORZ_CENTER</span>      <span class="c1"># 水平居中</span>
<span class="c1">#alignment.vert = xlwt.Alignment.VERT_TOP  # 垂直靠上</span>
<span class="c1">#alignment.vert = xlwt.Alignment.VERT_BOTTOM  # 垂直靠下</span>
<span class="n">alignment</span><span class="o">.</span><span class="n">vert</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Alignment</span><span class="o">.</span><span class="n">VERT_CENTER</span>      <span class="c1"># 垂直居中</span>
<span class="n">alignment</span><span class="o">.</span><span class="n">wrap</span> <span class="o">=</span> <span class="mi">1</span>      <span class="c1"># 自动换行</span>

<span class="c1">## 创建模式</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Pattern</span><span class="p">()</span> <span class="c1"># 模式类实例</span>
<span class="n">pattern</span><span class="o">.</span><span class="n">pattern</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Pattern</span><span class="o">.</span><span class="n">SOLID_PATTERN</span> <span class="c1"># 固定的样式</span>
<span class="n">pattern</span><span class="o">.</span><span class="n">pattern_fore_colour</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Style</span><span class="o">.</span><span class="n">colour_map</span><span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">]</span> <span class="c1"># 背景颜色</span>

<span class="c1">## 应用样式</span>
<span class="n">style</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>
<span class="n">style</span><span class="o">.</span><span class="n">borders</span> <span class="o">=</span> <span class="n">borders</span>
<span class="n">style</span><span class="o">.</span><span class="n">num_format_str</span> <span class="o">=</span> <span class="s1">&#39;#,##0.0000&#39;</span> <span class="c1"># 内容格式</span>
<span class="n">style</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">alignment</span>
<span class="n">style</span><span class="o">.</span><span class="n">pattern</span><span class="o">=</span><span class="n">pattern</span>

<span class="c1">## 合并单元格(A,B,C,D) 表示合并左上角[A,C]和右下角[B,D]单元格坐标(均在合并单元格内部)</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write_merge</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; Merge &#39;</span><span class="p">,</span><span class="n">style</span><span class="p">)</span> <span class="c1"># &#39; Merge &#39; 为写入内容，应用 style 样式</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1234567.890123</span><span class="p">,</span><span class="n">style</span><span class="p">)</span> <span class="c1"># 向[0,0]坐标单元格写入数据，应用style样式</span>

<span class="n">style</span><span class="o">.</span><span class="n">num_format_str</span> <span class="o">=</span> <span class="s1">&#39;#,##0.000%&#39;</span> <span class="c1"># 内容格式</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">67.8123456</span><span class="p">,</span><span class="n">style</span><span class="p">)</span> <span class="c1"># 整数部分用逗号分隔，小数部分保留3位小数并以百分数表示</span>

<span class="n">style</span><span class="o">.</span><span class="n">num_format_str</span> <span class="o">=</span> <span class="s1">&#39;###%&#39;</span> <span class="c1"># 内容格式</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.128</span><span class="p">,</span><span class="n">style</span><span class="p">)</span>

<span class="n">style</span><span class="o">.</span><span class="n">num_format_str</span> <span class="o">=</span> <span class="s1">&#39;###.##%&#39;</span> <span class="c1"># 内容格式</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.128</span><span class="p">,</span><span class="n">style</span><span class="p">)</span>

<span class="n">style</span><span class="o">.</span><span class="n">num_format_str</span> <span class="o">=</span> <span class="s1">&#39;000.00%&#39;</span> <span class="c1"># 内容格式</span>
<span class="n">wsh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.128</span><span class="p">,</span><span class="n">style</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Or.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">def</span> <span class="nf">set_style</span><span class="p">(</span><span class="n">font_name</span><span class="p">,</span> <span class="n">font_color</span><span class="p">,</span> <span class="n">font_height</span><span class="p">,</span> <span class="n">font_bold</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">XFStyle</span><span class="p">()</span>
    <span class="n">font</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">Font</span><span class="p">()</span>
    <span class="n">font</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">font_name</span>
    <span class="n">font</span><span class="o">.</span><span class="n">colour_index</span> <span class="o">=</span> <span class="n">font_color</span>
    <span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="n">font_bold</span>
    <span class="n">font</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">font_height</span>
    <span class="n">style</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>
    <span class="k">return</span> <span class="n">style</span>

<span class="n">ws</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">sheet</span><span class="o">.</span><span class="n">cell_value</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;黑体&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>XFStyle is used to specify the cell content format, use the easyxf function to get an XFStyle object.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">xlwt</span><span class="o">.</span><span class="n">Style</span><span class="o">.</span><span class="n">easyxf</span><span class="p">(</span><span class="n">strg_to_parse</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">num_format_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">field_sep</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">line_sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">intro_sep</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">esc_char</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>strg_to_parse is a string that defines the format, and can control the formatting properties including font (font), alignment (align), border form (border), color style (pattern) and cell protection (protection), etc. The specific formatting properties are listed in detail at the end of the article.</p>
<p>String strg_to_parse syntax format is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="p">(</span><span class="o">&lt;</span><span class="n">element</span><span class="o">&gt;</span><span class="p">:(</span><span class="o">&lt;</span><span class="n">attribute</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span><span class="p">,)</span><span class="o">+</span><span class="p">;)</span><span class="o">+</span>
</code></pre></td></tr></table>
</div>
</div><p>For example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="s1">&#39;font: bold on; align: wrap on, vert centre, horiz center&#39;</span>  <span class="c1"># 字体加粗 对齐方式 允许换行 垂直居中 水平居中</span>
</code></pre></td></tr></table>
</div>
</div><p>The parameter string num_format_str is used to specify the format of the number, e.g.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="s2">&#34;#,##0.00&#34;</span>
<span class="s2">&#34;dd/mm/yyyy&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>The following are some use cases for xlwt.Style.easyxf.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">style1</span> <span class="o">=</span> <span class="n">easyxf</span><span class="p">(</span><span class="s1">&#39;font: name Times New Roman&#39;</span><span class="p">)</span>
<span class="n">style2</span> <span class="o">=</span> <span class="n">easyxf</span><span class="p">(</span><span class="s1">&#39;font: underline single&#39;</span><span class="p">)</span>
<span class="n">style3</span> <span class="o">=</span> <span class="n">easyxf</span><span class="p">(</span><span class="s1">&#39;border: left thick, top thick&#39;</span><span class="p">)</span>
<span class="n">style4</span> <span class="o">=</span> <span class="n">easyxf</span><span class="p">(</span><span class="s1">&#39;pattern: pattern solid, fore_colour red;&#39;</span><span class="p">)</span>
<span class="n">style5</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">easyxf</span><span class="p">(</span><span class="n">num_format_str</span><span class="o">=</span><span class="s1">&#39;yyyy-mm-dd hh:mm:ss&#39;</span><span class="p">)</span>
<span class="n">style6</span> <span class="o">=</span> <span class="n">xlwt</span><span class="o">.</span><span class="n">easyxf</span><span class="p">(</span><span class="s1">&#39;font: name Times New Roman, color-index red, bold on&#39;</span><span class="p">,</span> <span class="n">num_format_str</span><span class="o">=</span><span class="s1">&#39;#,##0.00&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="xlutils">xlutils</h3>
<p>xlutils depends on xlrd and xlwt and contains the following modules.</p>
<ul>
<li>copy: copy xlrd.Book object to xlwt.Workbook object</li>
<li>display: to display information about xlrd related objects in a more friendly and secure way</li>
<li>filter: a small framework for splitting and filtering existing Excel files to new Excel files</li>
<li>margins: get how much useful information is contained in the Excel file</li>
<li>Book object into an Excel file</li>
<li>styles: a tool for formatting information in Excel files</li>
<li>view: use the view information of the worksheet in workbook</li>
</ul>
<p>Here we mainly introduce the use of two functions, the first xlutils.copy.copy(wb). From the above steps, if you are only generating a brand new Excel file, you can use the xlwt package. If you are &ldquo;editing&rdquo; some data in the Excel file, you must use xlrd to load the original file and make a copy of the original table, and then use xlwt to handle the cells that need to be edited, which is a cumbersome process. xlutils package copy is created to simplify this process, and can convert xlrd&rsquo;s Book object to xlwt&rsquo;s Workbook object.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlutils.copy</span>  <span class="c1"># 导入模块</span>

<span class="n">rbk</span> <span class="o">=</span> <span class="n">xlrd</span><span class="o">.</span><span class="n">open_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xls&#39;</span><span class="p">)</span>
<span class="n">wbk</span> <span class="o">=</span> <span class="n">xlutils</span><span class="o">.</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">rbk</span><span class="p">)</span>
<span class="n">sh</span> <span class="o">=</span> <span class="n">wbk</span><span class="o">.</span><span class="n">get_sheet</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 索引到Sheet1</span>
<span class="n">sh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;COPIED&#39;</span><span class="p">)</span>
<span class="n">wbk</span><span class="o">.</span><span class="n">add_sheet</span><span class="p">(</span><span class="s1">&#39;表单2&#39;</span><span class="p">)</span>  <span class="c1"># 新增表单</span>
<span class="n">wbk</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;data-copy.xls&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The other is the function xlutils.filter.process(reader, *chain) in xlutils.filter.</p>
<p>The module xlutils.filter contains some built-in modules reader, writer and filter, and the function process() for stringing them together, with the main function of filtering and splitting Excel files.</p>
<ul>
<li>The reader is used to fetch data from the data source and convert it into a series of Book objects, which will then call the first filter-related method. There are some basic reader classes provided within the module.</li>
<li>filterThe user gets the results needed for a specific task. Some specific methods have to be defined in the filter. The implementation of these methods can be filled with any functionality as needed, but will usually end with a call to the corresponding method of the next filter.</li>
<li>writer handles the specific method in the last filter in the parameter chain. writer is usually used to copy information from the data source and write it to the output file. Since there is a lot of work involved in the writer and usually only writing binary data to the target location is slightly different, some basic writer classes are provided within the module.</li>
<li>process(reader, *chain) can execute built-in or custom readers, writers and filters in tandem.</li>
</ul>
<h3 id="xfstyle-format">XFStyle format</h3>
<h4 id="format-attributes">format attributes</h4>
<ul>
<li>font
<ul>
<li>bold: boolean value, default is False</li>
<li>charset: see next section for optional values, default is sys_default</li>
<li>color (or color_index, color_index, color): see the next section for optional values, default is automatic</li>
<li>escapement: optional value is none, superscript or subscript, default value is none</li>
<li>family: a string containing the font family of the font, the default value is none</li>
<li>height: the height value obtained by multiplying point size by 20, the default is 200, corresponding to 10pt</li>
<li>italic: boolean value, default is False</li>
<li>name: a string containing the name of the font, default is Arial</li>
<li>outline: Boolean value, default is False</li>
<li>shadow: Boolean value, default is False</li>
<li>struck_out: Boolean value, default is False</li>
<li>underline: boolean value or one of none, single, single_acc, double, double_acc. The default value is none</li>
</ul>
</li>
<li>alignment (or align)
<ul>
<li>direction (or dire): one of the general, lr, rl, default general</li>
<li>horizontal (or horiz, horz): one of the following: general, left, center|centre, right, filled, justified, center|centre_across_selection, distributed one of the following, the default value is general</li>
<li>indent (or inde): indent value 0 to 15, default value 0</li>
<li>rotation (or rota): integer value between -90 and +90 or stacked, one of none, default is none</li>
<li>shrink_to_fit (or shri, shrink): boolean value, default is False</li>
<li>vertical (or vert): one of top, center|centre, bottom, justified, distributed, default is bottom</li>
<li>wrap: Boolean value, default is False</li>
</ul>
</li>
<li>borders (or borders)
<ul>
<li>left: border style, see the next section for details</li>
<li>right: border style, see next section</li>
<li>top: border style, see next section</li>
<li>bottom: border style, see next section</li>
<li>diag: the border style, see the next section</li>
<li>left_colour (or left_color): color value, see next section, default is automatic</li>
<li>right_colour (or right_color): color value, see next section, default is automatic</li>
<li>top_colour (or top_color): color value, see next section, default is automatic</li>
<li>bottom_colour (or bottom_color): color value, see next section, default is automatic</li>
<li>diag_colour (or diag_color): color value, see next section, default is automatic</li>
<li>need_diag_1: Boolean value, default is False</li>
<li>need_diag_2: Boolean value, default is False</li>
</ul>
</li>
<li>pattern
<ul>
<li>back_colour (or back_color, pattern_back_colour, pattern_back_color): color value, see the next section, default is automatic</li>
<li>fore_colour (or fore_color, pattern_fore_colour, pattern_fore_color): color value, see next section for details, default is automatic</li>
<li>pattern: no_fill, none, solid, solid_fill, solid_pattern, fine_dots, alt_bars, sparse_dots, thick_horz_bands, thick_vert_bands, thick_ backward_diag, thick_forward_diag, big_spots, bricks, thin_horz_bands, thin_vert_bands, thin_backward_diag, thin_forward_diag, squares, and diamonds one of them, default is none</li>
</ul>
</li>
<li>protection
<ul>
<li>cell_locked: Boolean value, default is True</li>
<li>formula_hidden: Boolean value, default is False</li>
</ul>
</li>
</ul>
<h4 id="description-of-the-values-taken">Description of the values taken</h4>
<p><strong>Boolean</strong></p>
<ul>
<li>True can be represented as 1, yes, true, or on.</li>
<li>False can be 0, no, false, or off.</li>
</ul>
<p><strong>charset</strong></p>
<p>The optional values for the character set are as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">ansi_latin</span><span class="p">,</span> <span class="n">sys_default</span><span class="p">,</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">apple_roman</span><span class="p">,</span> <span class="n">ansi_jap_shift_jis</span><span class="p">,</span> <span class="n">ansi_kor_hangul</span><span class="p">,</span> <span class="n">ansi_kor_johab</span><span class="p">,</span> <span class="n">ansi_chinese_gbk</span><span class="p">,</span> <span class="n">ansi_chinese_big5</span><span class="p">,</span> <span class="n">ansi_greek</span><span class="p">,</span> <span class="n">ansi_turkish</span><span class="p">,</span> <span class="n">ansi_vietnamese</span><span class="p">,</span> <span class="n">ansi_hebrew</span><span class="p">,</span> <span class="n">ansi_arabic</span><span class="p">,</span> <span class="n">ansi_baltic</span><span class="p">,</span> <span class="n">ansi_cyrillic</span><span class="p">,</span> <span class="n">ansi_thai</span><span class="p">,</span> <span class="n">ansi_latin_ii</span><span class="p">,</span> <span class="n">oem_latin_i</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>color</strong></p>
<p>The available values for color are as follows.</p>
<table>
<thead>
<tr>
<th>aqua</th>
<th>dark_red_ega</th>
<th>light_blue</th>
<th>plum</th>
</tr>
</thead>
<tbody>
<tr>
<td>black</td>
<td>dark_teal</td>
<td>light_green</td>
<td>purple_ega</td>
</tr>
<tr>
<td>blue</td>
<td>dark_yellow</td>
<td>light_orange</td>
<td>red</td>
</tr>
<tr>
<td>blue_gray</td>
<td>gold</td>
<td>light_turquoise</td>
<td>rose</td>
</tr>
<tr>
<td>bright_green</td>
<td>gray_ega</td>
<td>light_yellow</td>
<td>sea_green</td>
</tr>
<tr>
<td>brown</td>
<td>gray25</td>
<td>lime</td>
<td>silver_ega</td>
</tr>
<tr>
<td>coral</td>
<td>gray40</td>
<td>magenta_ega</td>
<td>sky_blue</td>
</tr>
<tr>
<td>cyan_ega</td>
<td>gray50</td>
<td>ocean_blue</td>
<td>tan</td>
</tr>
<tr>
<td>dark_blue</td>
<td>gray80</td>
<td>olive_ega</td>
<td>teal</td>
</tr>
<tr>
<td>dark_blue_ega</td>
<td>green</td>
<td>olive_green</td>
<td>teal_ega</td>
</tr>
<tr>
<td>dark_green</td>
<td>ice_blue</td>
<td>orange</td>
<td>turquoise</td>
</tr>
<tr>
<td>dark_green_ega</td>
<td>indigo</td>
<td>pale_blue</td>
<td>violet</td>
</tr>
<tr>
<td>dark_purple</td>
<td>ivory</td>
<td>periwinkle</td>
<td>white</td>
</tr>
<tr>
<td>dark_red</td>
<td>lavender</td>
<td>pink</td>
<td>yellow</td>
</tr>
</tbody>
</table>
<p><strong>borderline</strong></p>
<p>Can be an integer value from 0 to 13, or one of the following values.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">no_line</span><span class="p">,</span> <span class="n">thin</span><span class="p">,</span> <span class="n">medium</span><span class="p">,</span> <span class="n">dashed</span><span class="p">,</span> <span class="n">dotted</span><span class="p">,</span> <span class="n">thick</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span> <span class="n">hair</span><span class="p">,</span> <span class="n">medium_dashed</span><span class="p">,</span> <span class="n">thin_dash_dotted</span><span class="p">,</span> <span class="n">medium_dash_dotted</span><span class="p">,</span> <span class="n">thin_dash_dot_dotted</span><span class="p">,</span> <span class="n">medium_dash_dot_dotted</span><span class="p">,</span> <span class="n">slanted_medium_dash_dotted</span>
</code></pre></td></tr></table>
</div>
</div><p>Reference link.</p>
<ul>
<li><a href="https://github.com/python-excel">https://github.com/python-excel</a></li>
<li><a href="http://xlrd.readthedocs.io/en/latest/">http://xlrd.readthedocs.io/en/latest/</a></li>
<li><a href="http://xlwt.readthedocs.io/en/latest/api.html">http://xlwt.readthedocs.io/en/latest/api.html</a></li>
<li><a href="http://xlutils.readthedocs.io/en/latest/">http://xlutils.readthedocs.io/en/latest/</a></li>
</ul>
<h2 id="python-excel-writing-tool-for-xlsxwriter">Python Excel writing tool for xlsxwriter</h2>
<p>XlsxWriter is a Python module for writing documents in Excel 2007+ XLSX file format.</p>
<p>xlsxwriter can be used to write text, numbers, formulas and hyperlinks to multiple worksheets, supports formatting and more, and includes.</p>
<ul>
<li>100% compatible with Excel XLSX files.</li>
<li>Full formatting.</li>
<li>Merge cells.</li>
<li>Defined names.</li>
<li>Charting.</li>
<li>Automatic filtering.</li>
<li>Data validation and drop-down lists.</li>
<li>Conditional formatting.</li>
<li>Worksheet png/jpeg/bmp/wmf/emf images.</li>
<li>Rich multi-format strings.</li>
<li>Cell annotation.</li>
<li>Integration with Pandas.</li>
<li>Text boxes.</li>
<li>Support for adding macros.</li>
<li>Memory-optimized mode for writing large files.</li>
</ul>
<p>Pros.</p>
<ul>
<li>More powerful: Relatively speaking, this is the most powerful tool other than Excel itself. Font settings, foreground color background color, border settings, view zoom (zoom), cell merge, autofilter, freeze panes, formulas, data validation, cell comments, row height and column width settings, etc.</li>
<li>Support for large file writes: If the amount of data is very large, you can enable constant memory mode, which is a sequential write mode that writes a row of data as soon as you get it, without keeping all the data in memory.</li>
</ul>
<p>Disadvantages.</p>
<ul>
<li>No read and modify support: The author did not intend to make an XlsxReader to provide read operations. If you can&rsquo;t read, you can&rsquo;t modify. It can only be used to create new files. When you write data in a cell, there is still no way to read the information that has been written unless you have saved the relevant content yourself.</li>
<li>XLS files are not supported: XLS is the format used in Office 2013 or earlier and is a binary format file. XLSX is a compressed package made up of a series of XML files (the final X stands for XML). If you have to create a lower version of XLS file, please go to xlwt.</li>
<li>Pivot Table is not supported at this time.</li>
</ul>
<h3 id="xlsxwriter-easy-to-use">xlsxwriter easy to use</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;年度&#39;</span><span class="p">,</span> <span class="s1">&#39;数量&#39;</span><span class="p">,</span> <span class="s1">&#39;剩余数量&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">,</span> <span class="s1">&#39;150&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;170&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;190&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">],</span>
<span class="p">]</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 创建一个新的excel表格</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;sheet1&#39;</span><span class="p">)</span>  <span class="c1"># 创建一个新的sheet</span>
<span class="c1"># 将data数组的数据插入到excel表格中</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>We can also set the style to the excel table, set the style to the table using the add_format method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;年度&#39;</span><span class="p">,</span> <span class="s1">&#39;数量&#39;</span><span class="p">,</span> <span class="s1">&#39;剩余数量&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;30&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2017&#39;</span><span class="p">,</span> <span class="s1">&#39;150&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;170&#39;</span><span class="p">,</span> <span class="s1">&#39;40&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;190&#39;</span><span class="p">,</span> <span class="s1">&#39;15&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">,</span> <span class="s1">&#39;200&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 创建一个新的excel表格</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;sheet1&#39;</span><span class="p">)</span>  <span class="c1"># 创建一个新的sheet</span>
<span class="c1"># 将data数组的数据插入到excel表格中</span>

<span class="c1"># 增加样式配置</span>
<span class="n">style</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 字体加粗</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># 单元格边框宽度</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span>  <span class="c1"># 水平对齐方式</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>  <span class="c1"># 垂直对齐方式</span>
    <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>  <span class="c1"># 单元格背景颜色</span>
    <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 是否自动换行</span>
    <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>  <span class="c1"># 文字颜色</span>
<span class="p">})</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">style</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>The xlsxwriter package allows us to insert data by row and column, using the following methods.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;年份&#39;</span><span class="p">,</span> <span class="s1">&#39;数量&#39;</span><span class="p">,</span> <span class="s1">&#39;剩余数量&#39;</span><span class="p">]</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">]</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;sheet1&#39;</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data1</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;sheet2&#39;</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data1</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">xlsxwriter包中我们可以给excel插入图表</span><span class="err">，</span><span class="n">简单梳理如下</span><span class="err">：</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 创建新的excel</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;sheet1&#39;</span><span class="p">)</span>  <span class="c1"># 创建新的sheet</span>
<span class="c1"># 向excel文件中插入数据</span>
<span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;年份&#39;</span><span class="p">,</span> <span class="s1">&#39;2013&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span> <span class="s1">&#39;2015&#39;</span><span class="p">,</span> <span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">,</span> <span class="s1">&#39;2018&#39;</span><span class="p">,</span> <span class="s1">&#39;2019&#39;</span><span class="p">,</span> <span class="s1">&#39;2020&#39;</span><span class="p">]</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data1</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;数量&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="c1"># 设置图表类型 ,type常见参数有:area：面积图,bar：条形图,column：直方图,doughnut：环状图,line：折线图,pie：饼状图,scatter：散点图,radar：雷达图,stock:箱线图</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>
<span class="c1"># 给图表设置信息</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;发展趋势&#39;</span><span class="p">,</span>  <span class="c1"># 设置折线名称</span>
        <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=sheet1!$A$2:$A$9&#39;</span><span class="p">,</span>  <span class="c1"># 设置x轴信息</span>
        <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=sheet1!$B$2:$B$9&#39;</span><span class="p">,</span>  <span class="c1"># 设置y轴信息</span>
        <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>  <span class="c1"># 给折线设置样式</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;测试&#39;</span><span class="p">})</span>  <span class="c1"># 设置表头标题</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s2">&#34;x轴&#34;</span><span class="p">})</span>  <span class="c1"># 设置x轴名称</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;y轴&#39;</span><span class="p">})</span>  <span class="c1"># 设置y轴名称</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>  <span class="c1"># 放置图表位置</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/01/ffb67a8afd7f4d479271fdfd631e2795.png" alt=""></p>
<h3 id="common-functions-of-xlsxwriter-module">Common functions of xlsxwriter module</h3>
<h4 id="set-cell-formatting">Set cell formatting</h4>
<p>Set the formatting directly by means of a dictionary.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">workfomat</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 字体加粗</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># 单元格边框宽度</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>  <span class="c1"># 对齐方式</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>  <span class="c1"># 字体对齐方式</span>
    <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#F4B084&#39;</span><span class="p">,</span>  <span class="c1"># 单元格背景颜色</span>
    <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># 是否自动换行</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>Set the cell format by means of the format object.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">workfomat</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">workfomat</span><span class="o">.</span><span class="n">set_bold</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># 设置边框宽度</span>
<span class="n">workfomat</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;0.00&#39;</span><span class="p">)</span>  <span class="c1"># 格式化数据格式为小数点后两位</span>
<span class="n">workfomat</span><span class="o">.</span><span class="n">set_align</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>  <span class="c1"># 设置对齐方式</span>
<span class="n">workfomat</span><span class="o">.</span><span class="n">set_fg_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>  <span class="c1"># 设置单元格背景颜色</span>
<span class="n">workfomat</span><span class="o">.</span><span class="n">set_bg_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># 设置单元格背景颜色 (经测试和上边的功能一样)</span>
</code></pre></td></tr></table>
</div>
</div><p>There are many more operations like this for some cell tables, so you can study them according to your needs.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;D1:D7&#39;</span><span class="p">,</span> <span class="s1">&#39;合并单元格&#39;</span><span class="p">)</span>  <span class="c1"># 合并单元格</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>  <span class="c1"># 设置sheet标签颜色</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:D&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>  <span class="c1"># 设置A到D列的列宽为25</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;=B2/C2&#39;</span><span class="p">)</span>  <span class="c1"># 设置表格中的计算，‘E2’是计算结果，&#39;=B2/C2&#39;是计算公式</span>

<span class="c1"># 写入单个单元格数据</span>
<span class="c1"># row:行， col：列， data:要写入的数据, bold:单元格的样式</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># 写入一整行， A1:从A1单元格开始插入数据，按行插入， data:要写入的数据（格式为一个列表), bold:单元格的样式</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="err">“</span><span class="n">A1</span><span class="err">”</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># 写入一整列 ， A1:从A1单元格开始插入数据，按列插入， data:要写入的数据（格式为一个列表), bold:单元格的样式</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="err">“</span><span class="n">A1</span><span class="err">”</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># 插入图片， 第一个参数是插入的起始单元格，第二个参数是图片你文件的绝对路径</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;f:\.jpg&#39;</span><span class="p">)</span>

<span class="c1"># 写入超链接</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s2">&#34;internal:</span><span class="si">%s</span><span class="s2">!A1&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&#34;要关联的工作表表名&#34;</span><span class="p">),</span> <span class="n">string</span><span class="o">=</span><span class="s2">&#34;超链接显示的名字&#34;</span><span class="p">)</span>

<span class="c1"># 插入图表 </span>
<span class="s2">&#34;&#34;&#34; 参数中的type指的是图表类型，图表类型示例如下：[area：面积图,bar：条形图,column：直方图,
</span><span class="s2">doughnut：环状图,line：折线图,pie：饼状图,scatter：散点图,radar：雷达图,stock:箱线图] &#34;&#34;&#34;</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">add_chartsheet</span><span class="p">(</span><span class="nb">type</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">)</span>

<span class="c1"># 获得当前excel文件的所有工作表</span>
<span class="s2">&#34;&#34;&#34;
</span><span class="s2">workbook.worksheets() 用于获得当前工作簿中的所有工作表，
</span><span class="s2">这个函数的存在便利了对于工作表的循环操作，
</span><span class="s2">如果你想在当前工作簿的所有工作表的A1单元格中输入一个字符创‘Hello xlsxwriter’，
</span><span class="s2">那么这个命令就派上用场了。
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">worksheets</span><span class="p">()</span>

<span class="c1"># 关闭excel文件</span>
<span class="s2">&#34;&#34;&#34;
</span><span class="s2">这个命令是使用xlsxwriter操作Excel的最后一条命令，一定要记得关闭文件。
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Common chart types.</p>
<ul>
<li>area: Creates an Area (solid line) style sheet.</li>
<li>bar: Creates a bar style (transposed histogram) chart.</li>
<li>column: Creates a column style (histogram) chart.</li>
<li>line: Creates a line chart.</li>
<li>pie: Creates a pie-style chart.</li>
<li>doughnut: Creates a doughnut style chart.</li>
<li>scatter: Creates a scatter chart style chart.</li>
<li>stock: Creates a stock style chart.</li>
<li>radar: Creates a radar style sheet.</li>
</ul>
<h4 id="sample-code-explanation">Sample Code Explanation</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_data_table.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 可以生成.xls文件但是会报错</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>  <span class="c1"># 工作页</span>

<span class="c1"># 准备测试数据</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># 插入数据</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>  <span class="c1"># 行插入操作  注意这里的&#39;A1&#39;</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># 列插入操作 注意这里的&#39;A2&#39;</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># 插入直方图1</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>  <span class="c1"># 选择 直方图 &#39;column&#39;</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>  <span class="c1"># X轴值（实在不知道怎么叫，就用XY轴表示）</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>  <span class="c1"># Y轴值</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>  <span class="c1"># 显示数字，就是直方图上面的数字，默认不显示</span>
<span class="p">})</span>

<span class="c1"># 注意上面写法 &#39;=Sheet1!$B$2:$B$7&#39;  Sheet1是指定工作页， $A$2:$A$7是从A2到A7数据，熟悉excel朋友应该一眼就能认得出来</span>

<span class="c1"># 插入直方图2</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="p">})</span>

<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Data Table&#39;</span><span class="p">})</span>  <span class="c1"># 直方图标题</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>  <span class="c1"># X轴描述</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>  <span class="c1"># Y轴描述</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_table</span><span class="p">()</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># 直方图类型</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>  <span class="c1"># 直方图插入到 D2位置 </span>
<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="types-supported-by-xlsxwriter">Types supported by XlsxWriter</h3>
<p>Excel often treats different types of input data, such as strings and numbers, differently, though usually transparently to the user. the XlsxWriter view emulates this with the worksheet.write() method, by mapping Python data types to the types supported by Excel.</p>
<p>The write() method serves as a generic alias for several more specific methods.</p>
<ul>
<li>write_string()</li>
<li>write_number()</li>
<li>write_blank()</li>
<li>write_formula()</li>
<li>write_datetime()</li>
<li>write_boolean()</li>
<li>write_url()</li>
</ul>
<p>In the code here, we use some of these methods to handle different types of data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span>  <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>     <span class="n">item</span>              <span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span> <span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span>  <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">money_format</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>This is mainly to show that if you need more control over the data you write to the worksheet, you can use the appropriate methods. In this simple example, the write() method actually works out well.</p>
<p>Date handling is also new to the program.</p>
<p>Dates and times in Excel are floating-point numbers applied in a numeric format to make it easier to display them in the correct format. If the date and time are Python datetime objects, then XlsxWriter will automatically do the required numeric conversion. However, we also need to add numeric formatting to ensure that Excel displays them as dates.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;mmmm d yyyy&#39;</span><span class="p">})</span>
<span class="o">...</span>

<span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">date_str</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expenses</span><span class="p">):</span>
    <span class="c1"># Convert the date string into a datetime object.</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_str</span><span class="p">,</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span> <span class="p">)</span>
    <span class="o">...</span>
</code></pre></td></tr></table>
</div>
</div><p>Finally, set_column() is needed to adjust the width of column B so that the date can be displayed clearly.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># Adjust the column width.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Reference links.</p>
<ul>
<li><a href="https://xlsxwriter.readthedocs.io/">https://xlsxwriter.readthedocs.io/</a></li>
</ul>
<h2 id="python-excel-reading-and-writing-with-openpyxl">Python Excel Reading and Writing with OpenPyXL</h2>
<p>And you can make detailed settings for the cells in the Excel file, including cell styles and other content, and even support the insertion of charts, print settings and other content. openpyxl can read and write xltm, xltx, xlsm, xlsx and other types of files.</p>
<p>The general process of using openpyxl is: create/read excel file -&gt; select sheet object -&gt; operate on form/cell -&gt; save excel</p>
<h3 id="createread-excel-files">Create/read excel files</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>  <span class="c1"># 新建空白工作簿</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;1.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 读取excel</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;filename.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 保存excel</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="sheet-form-operations">sheet form operations</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 读取excel</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span>  <span class="c1"># 以list方式返回excel文件所有sheet名称（-&gt;list[str,str..]）</span>
<span class="c1"># 选定需要操作的sheet</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;第一个 sheet&#39;</span><span class="p">]</span>  <span class="c1"># 根据sheet名称选取</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># 选择当前活动的sheet，默认为第一个</span>
<span class="c1"># 创建新的sheet</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&#34;newsheet_end&#34;</span><span class="p">)</span>  <span class="c1"># 默认插入到最后</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="s2">&#34;newsheet_first&#34;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 插入到最开始的位置(从0开始计算)</span>

<span class="c1"># 复制一个sheet对象</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">copy_worksheet</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

<span class="c1"># 移动工作表</span>
<span class="n">wb</span><span class="o">.</span><span class="n">move_sheet</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># sheet常见属性</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;第一个 sheet&#39;</span><span class="p">]</span>  <span class="c1"># 根据sheet名称选取</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>  <span class="c1"># sheet名称</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">max_row</span><span class="p">)</span>  <span class="c1"># 最大行</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">max_column</span><span class="p">)</span>  <span class="c1"># 最大列</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span>  <span class="c1"># 行生成器, 里面是每一行的cell对象，由一个tuple包裹。</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># 列生成器, 里面是每一列的cell对象，由一个tuple包裹。</span>

<span class="c1"># 可以使用list(sheet.rows)[0].value 类似方法来获取数据，或</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># 删除sheet</span>
<span class="k">del</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;第三个 sheet&#39;</span><span class="p">]</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;output.xlsx&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="cell-object">Cell object</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.utils</span> <span class="kn">import</span> <span class="n">get_column_letter</span><span class="p">,</span> <span class="n">column_index_from_string</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 读取excel</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># 选择当前活动的sheet，默认为第一个</span>

<span class="c1"># 根据名称访问</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">])</span>  <span class="c1"># A列1行的单元对象 A1</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">])</span>  <span class="c1"># 也可以小写 A1</span>

<span class="c1"># cell方法访问</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># B2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># B3</span>

<span class="c1"># 从cell列表中返回</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">)[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># B3</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">columns</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># B3</span>

<span class="c1"># 选择多个单元格</span>
<span class="n">a2_b3</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">:</span><span class="s1">&#39;b3&#39;</span><span class="p">]</span>  <span class="c1"># 切片访问,以行组成tuple返回tuple</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a2_b3</span><span class="p">)</span>

<span class="c1"># 单独字母与数字返回列与行的所有数据</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>  <span class="c1"># 返回b列的所有cell对象</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">row1</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span>  <span class="c1"># 返回第1行的所有cell</span>
<span class="n">row1</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 加引号和不加引号效果一样</span>
<span class="nb">print</span><span class="p">(</span><span class="n">row1</span><span class="p">)</span>
<span class="c1"># 当然也能范围选择</span>
<span class="n">a_e</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;a:e&#39;</span><span class="p">]</span>  <span class="c1"># a-e列的cell对象</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a_e</span><span class="p">)</span>

<span class="c1"># 单元格属性</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">column</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">row</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># 注意: 如果单元格是使用的公式，则值是公式而不是计算后的值</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">number_format</span><span class="p">)</span>  <span class="c1"># 返回单元格格式属性,# 默认为General格式</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">font</span><span class="p">)</span>  <span class="c1"># 单元格样式</span>

<span class="c1"># 更改单元格值</span>
<span class="c1"># 直接赋值</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">222</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;aaa&#39;</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;b2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;=SUM(A1:A17)&#39;</span>  <span class="c1"># 使用公式</span>
<span class="c1"># value属性赋值</span>
<span class="n">cell</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">222</span>
<span class="c1"># 或</span>
<span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">222</span><span class="p">)</span>

<span class="c1"># 移动单元格</span>
<span class="n">ws</span><span class="o">.</span><span class="n">move_range</span><span class="p">(</span><span class="s2">&#34;D4:F10&#34;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># 表示单元格D4: F10向上移动一行，右移两列。单元格将覆盖任何现有单元格。</span>
<span class="n">ws</span><span class="o">.</span><span class="n">move_range</span><span class="p">(</span><span class="s2">&#34;G4:H10&#34;</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># 移动中包含公式的自动转换</span>

<span class="c1"># 合并与拆分单元格</span>
<span class="n">ws</span><span class="o">.</span><span class="n">merge_cells</span><span class="p">(</span><span class="s1">&#39;A2:D2&#39;</span><span class="p">)</span>  <span class="c1"># 合并单元格,以最左上角写入数据或读取数据</span>
<span class="n">ws</span><span class="o">.</span><span class="n">unmerge_cells</span><span class="p">(</span><span class="s1">&#39;A2:D2&#39;</span><span class="p">)</span>  <span class="c1"># 拆分单元格</span>

<span class="c1"># 列字母和坐标数字相互转换</span>
<span class="nb">print</span><span class="p">(</span><span class="n">get_column_letter</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>  <span class="c1"># C # 根据列的数字返回字母</span>
<span class="nb">print</span><span class="p">(</span><span class="n">column_index_from_string</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>  <span class="c1"># 4 # 根据字母返回列的数字</span>

<span class="c1"># 遍历单元格</span>
<span class="c1"># 注意</span>
<span class="c1"># openpyxl 读取 Excel 的索引是从 1 开始的</span>
<span class="c1"># 因为 range 函数是左闭右开，再加上索引是从 1 开始的，所以最大值都要 +1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">max_row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ws</span><span class="o">.</span><span class="n">max_column</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">cols</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_cols</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>

<span class="n">cell_range</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">:</span><span class="s1">&#39;C2&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cell_range</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">cols</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># 多个单元格的操作</span>
<span class="c1"># 同一行中，多个单元格同时输入</span>
<span class="n">datas</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;A5追加&#34;</span><span class="p">,</span> <span class="s2">&#34;B5追加&#34;</span><span class="p">,</span> <span class="s2">&#34;C5追加&#34;</span><span class="p">]</span>
<span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">datas</span><span class="p">)</span>

<span class="c1"># 复数行中，多个单元格同时输入</span>
<span class="n">datas</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&#34;A6追加&#34;</span><span class="p">,</span> <span class="s2">&#34;B6追加&#34;</span><span class="p">,</span> <span class="s2">&#34;C6追加&#34;</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&#34;A7追加&#34;</span><span class="p">,</span> <span class="s2">&#34;B7追加&#34;</span><span class="p">,</span> <span class="s2">&#34;C7追加&#34;</span><span class="p">],</span>
<span class="p">]</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="n">datas</span><span class="p">:</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="format-style-setting">Format style setting</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">Alignment</span><span class="p">,</span> <span class="n">PatternFill</span><span class="p">,</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span><span class="p">,</span> <span class="n">NamedStyle</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 读取excel</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># 选择当前活动的sheet，默认为第一个</span>
<span class="c1"># 字体</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">vertAlign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">underline</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
            <span class="n">strike</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">)</span>

<span class="c1"># 示例：设定字体为等线24号，加粗斜体，字体颜色红色。将字体赋值给A1</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;等线&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="o">.</span><span class="n">RED</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 对齐方式</span>
<span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;general&#39;</span><span class="p">,</span>
                      <span class="n">vertical</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                      <span class="n">text_rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">wrap_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">shrink_to_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 示例：设置B1中的数据垂直居中和水平居中</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="c1"># horizontal 的可用样式为：{&#39;left&#39;:&#39;左对齐&#39;, &#39;center&#39;:&#39;居中对齐&#39;, &#39;right&#39;:&#39;右对齐&#39;, &#39;distributed&#39;:&#39;分散对齐&#39;, &#39;centerContinuous&#39;:&#39;跨列居中&#39;, &#39;justify&#39;:&#39;两端对齐&#39;, &#39;fill&#39;:&#39;填充&#39;, &#39;general&#39;:&#39;常规&#39;}</span>
<span class="c1"># vertical 的可用样式为：{&#39;top&#39;:&#39;顶端对齐&#39;, &#39;center&#39;:&#39;居中对齐&#39;, &#39;bottom&#39;:&#39;底端对齐&#39;, &#39;distributed&#39;:&#39;分散对齐&#39;, &#39;justify&#39;:&#39;两端对齐&#39;}</span>
<span class="c1"># wrap_text 为自动换行。</span>

<span class="c1"># 填充单元格颜色</span>
<span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">fill_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">start_color</span><span class="o">=</span><span class="s1">&#39;FFFFFFFF&#39;</span><span class="p">,</span>
                   <span class="n">end_color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">)</span>

<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">fill</span>
<span class="c1"># 可选择的填充样式为：[&#39;none&#39;, &#39;solid&#39;, &#39;darkDown&#39;, &#39;darkGray&#39;, &#39;darkGrid&#39;, &#39;darkHorizontal&#39;, &#39;darkTrellis&#39;, &#39;darkUp&#39;, &#39;darkVertical&#39;, &#39;gray0625&#39;, &#39;gray125&#39;, &#39;lightDown&#39;, &#39;lightGray&#39;, &#39;lightGrid&#39;, &#39;lightHorizontal&#39;, &#39;lightTrellis&#39;, &#39;lightUp&#39;, &#39;lightVertical&#39;, &#39;mediumGray&#39;]</span>

<span class="c1"># 设置行高和列宽</span>
<span class="n">ws</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># 设置边框</span>
<span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">right</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">top</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">bottom</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">diagonal</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">diagonal_direction</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">outline</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">vertical</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
                <span class="n">horizontal</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">)</span>
                <span class="p">)</span>

<span class="c1"># 可选择的边框样式为：[&#39;dashDot&#39;, &#39;dashDotDot&#39;, &#39;dashed&#39;, &#39;dotted&#39;, &#39;double&#39;, &#39;hair&#39;, &#39;medium&#39;, &#39;mediumDashDot&#39;, &#39;mediumDashDotDot&#39;, &#39;mediumDashed&#39;, &#39;slantDashDot&#39;, &#39;thick&#39;, &#39;thin&#39;]</span>

<span class="c1"># 设置工作表标签底色</span>
<span class="n">ws</span><span class="o">.</span><span class="n">sheet_properties</span><span class="o">.</span><span class="n">tabColor</span> <span class="o">=</span> <span class="s2">&#34;1072BA&#34;</span>

<span class="c1"># 创建一个样式预设</span>
<span class="n">highlight</span> <span class="o">=</span> <span class="n">NamedStyle</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;highlight&#39;</span><span class="p">)</span>
<span class="n">highlight</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">bd</span> <span class="o">=</span> <span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thick&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;000000&#39;</span><span class="p">)</span>
<span class="n">highlight</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bd</span><span class="p">)</span>
<span class="c1"># Once a named style has been created, it can be registered with the workbook:</span>
<span class="n">wb</span><span class="o">.</span><span class="n">add_named_style</span><span class="p">(</span><span class="n">highlight</span><span class="p">)</span>
<span class="c1"># Named styles will also be registered automatically the first time they are assigned to a cell:</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">highlight</span>
<span class="c1"># Once registered, assign the style using just the name:</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D5&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;highlight&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="other">Other</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">load_workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.drawing.image</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">openpyxl.comments</span> <span class="kn">import</span> <span class="n">Comment</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;读取表.xlsx&#39;</span><span class="p">)</span>  <span class="c1"># 读取excel</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># 选择当前活动的sheet，默认为第一个</span>

<span class="c1"># 插入图片</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>
<span class="n">img</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">img</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>  <span class="c1"># 指定图片尺寸，可省略</span>
<span class="n">ws</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">)</span>

<span class="c1"># 插入批注</span>
<span class="n">comment</span> <span class="o">=</span> <span class="n">Comment</span><span class="p">(</span><span class="s1">&#39;This is the comment text&#39;</span><span class="p">,</span> <span class="s1">&#39;Comment Author&#39;</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="s2">&#34;A1&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="python-excel-manipulation-of-xlwings">Python Excel manipulation of xlwings</h2>
<p>xlwings is a BSD-licensed Python based library. It makes it easy to call each other between Python and Excel:</p>
<ul>
<li>Scripting: Automate the processing of Excel data in Python or interact with Excel using VBA-like syntax.</li>
<li>Macros: Replace VBA macros with powerful and clean Python code.</li>
<li>UDFs (User Defined Functions): Write User Defined Functions (UDFs) in Python, for windows only.</li>
<li>REST API: Open Excel workbooks to the outside through the REST API.</li>
<li>Support for Windows and MacOS</li>
</ul>
<p>xlwings open source free , can be very easy to read and write data in Excel files , and cell formatting changes . xlwings can also seamlessly connect with matplotlib, Numpy and Pandas , support for reading and writing Numpy, Pandas data types , matplotlib visual charts into excel. The most important thing is that xlwings can call the program written by VBA in Excel file, and also can let VBA call the program written in Python. It supports reading of .xls files and reading and writing of .xlsx files.</p>
<p>The main structure of xlwings.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/01/77b9094783934304b9ff66fb57d73ad9.png" alt=""></p>
<p>As you can see, the direct interface with xlwings is the apps, that is, the Excel application, then the workbook books and worksheet sheets, and finally the cell area range, which is quite different from openpyxl, and because of this, xlwings needs to still have the Excel application environment installed.</p>
<h3 id="app-common-syntax">App common syntax</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>

<span class="c1"># 创建应用app：</span>
<span class="c1"># 参数：visible：应用是否可见（True|False）,add_book:是否创建新工作簿(True|False)</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">App</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_book</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">books</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># get新创建的工作簿（刚创建的工作簿为活动工作簿，使用active获取）</span>
<span class="c1"># 警告提示（True|False）</span>
<span class="n">app</span><span class="o">.</span><span class="n">display_alerts</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># 屏幕刷新（True|False）</span>
<span class="n">app</span><span class="o">.</span><span class="n">screen_updating</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># 工作表自动计算{&#39;manual&#39;:&#39;手动计算&#39;,&#39;automatic&#39;:&#39;自动计算&#39;,&#39;semiautomatic&#39;:&#39;半自动&#39;}</span>
<span class="n">app</span><span class="o">.</span><span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;manual&#39;</span>
<span class="c1"># 应用计算,calculate方法同样适用于工作簿，工作表</span>
<span class="n">app</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
<span class="c1"># 退出应用</span>
<span class="n">app</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="book-common-syntax">Book common syntax</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">App</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">add_book</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># 新建工作簿</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">books</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>  <span class="c1"># 方法1</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Book</span><span class="p">()</span>  <span class="c1"># 方法2</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">books</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>

<span class="c1"># 打开工作簿</span>
<span class="n">file_path</span> <span class="o">=</span> <span class="s1">&#39;读取表.xlsx&#39;</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">books</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Book</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

<span class="c1"># 工作簿保存</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># 或者指定path参数保存到其他路径，如果没保存为脚本所在路径</span>

<span class="c1"># 其他：获取名称、激活、关闭</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="s1">&#39;工作簿名称&#39;</span><span class="p">]</span>  <span class="c1"># get指定名称的工作簿</span>
<span class="n">wb</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>  <span class="c1"># 激活为当前工作簿</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">fullname</span><span class="p">)</span>  <span class="c1"># 返回工作簿的绝对路径</span>
<span class="nb">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># 工作簿名称</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># 关闭工作簿</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="sheet-common-syntax">Sheet common syntax</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>

<span class="c1"># 工作表引用</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="s1">&#39;工作簿名字&#39;</span><span class="p">]</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;工作表名字&#39;</span><span class="p">]</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># 也可以使用数字索引,从0开始，类似于vba的worksheets(1)</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># 当前活动工作表，sheets是工作表集合</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">active</span>

<span class="c1"># 新建工作表表</span>
<span class="c1"># 参数：name：新建工作表名称；before创建的工作表位置在哪个工作表前面；after：创建位置在哪个工作表后面；</span>
<span class="c1"># before和after参数可以传入数字，也可以传入已有的工作表名称，传入数字n表示从左往右第n个sheet位置</span>
<span class="c1"># before和after参数不传，创建sheet默认在当前活动工作表左侧</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">after</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;新工作表4&#39;</span><span class="p">,</span> <span class="n">before</span><span class="o">=</span><span class="s1">&#39;新工作表&#39;</span><span class="p">)</span>

<span class="n">sheet</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>  <span class="c1"># 激活为活动工作簿</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># 清除工作表的内容和格式</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">clear_contents</span><span class="p">()</span>  <span class="c1"># 清除工作表内容，不清除样式</span>
<span class="n">sheet_name</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># 工作表名称</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>  <span class="c1"># 删除工作表</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>  <span class="c1"># 工作表计算</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">used_range</span>  <span class="c1"># 工作表的使用范围，等价与vba的usedrange</span>

<span class="c1"># 自动匹配工作表列、行宽度</span>
<span class="c1"># 若要自动调整行，请使用以下内容之一：rows或r</span>
<span class="c1"># 若要自动装配列，请使用以下内容之一：columns或c</span>
<span class="c1"># 若要自动调整行和列，请不提供参数。</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">autofit</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="range-common-syntax">Range common syntax</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="c1"># 单元格引用</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="s1">&#39;工作簿名称&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;工作表名称&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span>
<span class="c1"># 第一个应用第一个工作簿第一张sheet的第一个单元格</span>
<span class="n">xw</span><span class="o">.</span><span class="n">apps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span>

<span class="c1"># 引用活动sheet的单元格,直接接xw，Range首字母大写</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span>  <span class="c1"># a1</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># a1，行列用tuple进行引用，圆括号从1开始</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Range</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># a1:a3</span>

<span class="c1"># 也可以工作表对象接方括号引用单元格</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="s1">&#39;工作簿&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;工作表名称&#39;</span><span class="p">]</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span>  <span class="c1"># a1单元格</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s1">&#39;a1:b5&#39;</span><span class="p">]</span>  <span class="c1"># a1:b5单元格</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>  <span class="c1"># b1单元格，也可以根据行列索引，从0开始为</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[:</span><span class="mi">10</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">]</span>  <span class="c1"># a1:j10</span>

<span class="c1"># 单元格邻近范围</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">current_region</span>  <span class="c1"># a1单元格邻近区域=vba：currentregion</span>

<span class="c1"># 返回excel：ctrl键+方向键跳转单元格对象:上：up，下：down，左：left，右：right</span>
<span class="c1"># 等同于vba：end语法：xlup，xldown，xltoleft，xltoright</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">end</span><span class="p">(</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>

<span class="c1"># 数据的读取</span>
<span class="c1"># 获取单元格的值,单元格的value属性</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;a1:a2&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 一维列表</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;a1:b2&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 二维列表</span>

<span class="c1"># 单元格值默认读取格式</span>
<span class="c1"># 默认情况下，带有数字的单元格被读取为float，带有日期单元格被读取为datetime.datetime, 空单元格转化为None；数据读取可以通过option操作指定格式读取</span>
<span class="n">sheet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">sheet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 输出是1.0</span>
<span class="n">sheet</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 输出是1</span>
<span class="n">sheet</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">dates</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 指定日期格式为datetime.date</span>
<span class="n">sheet</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">empty</span><span class="o">=</span><span class="s1">&#39;NA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 指定空单元格为&#39;NA&#39;</span>

<span class="c1"># 单元格数据写入</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 单个值</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;a1:c1&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># 写入一维列表</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;a1:a3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># option:设置transpose参数转置下</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;a1:a3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># 写入二维列表</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>  <span class="c1"># 也可以直接这样写</span>
<span class="c1"># &#39;&#39;&#39;</span>
<span class="c1"># 尽量减少与excel交互次数有助于提升写入速度</span>
<span class="c1"># sheet.range(&#39;A1&#39;).value = [[1,2],[3,4]]</span>
<span class="c1"># 比sheet.range(&#39;A1&#39;).value = [1, 2] 和 sheet.range(&#39;A2&#39;).value = [3, 4]会更快</span>
<span class="c1"># &#39;&#39;&#39;</span>

<span class="c1"># expand: 动态选择Range维度</span>
<span class="c1"># 可以通过单元格的expand或者options的expand属性动态获取excel中单元格维度；两者再使用区别是， 使用expand方法，只有在访问范围的值才会计算;</span>
<span class="c1"># options方法会随着单元格值范围扩增而相应的范围增大，区别示例如下：</span>
<span class="c1"># expand参数值除了’table’, 还可以使用‘right’：向右延伸，‘down’：向下延伸；</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">sheets</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;工作表名称&#39;</span><span class="p">)</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="n">rng1</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>  <span class="c1"># 使用options方法</span>
<span class="n">rng2</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">)</span>  <span class="c1"># 使用expand方法，默认是table，‘table’参数也可以不填 </span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>  <span class="c1"># 现在新增一行数据</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rng1</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rng2</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># [[1.0, 2.0], [3.0, 4.0]] 使用的expand方法，范围没有扩散</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]],再次expand方法访问，值范围扩散</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="transformer">Transformer</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">books</span><span class="p">[</span><span class="s1">&#39;工作簿&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;工作表名称&#39;</span><span class="p">]</span>
<span class="c1"># 字典转化</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>  <span class="c1"># 字典转化可以将excel两列数据读取为字典，如果是两行数据，使用transpose转置下；</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1:b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># {&#39;a&#39;: 1.0, &#39;b&#39;: 2.0}</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a4:b5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># {&#39;a&#39;: 1.0, &#39;b&#39;: 2.0}</span>
<span class="c1"># numpy转化</span>
<span class="c1"># 相关参数：ndim = None（维度,：1维也可以设置为2转化成二维array）, dtype = None(可指定数据类型)</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Book</span><span class="p">()</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">transpose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;A1:A3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># 返回二维数组</span>
<span class="c1"># 其他方法</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">xw</span><span class="o">.</span><span class="n">Range</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span> <span class="c1"># 引用当前活动工作表的单元格</span>
<span class="n">rng</span><span class="o">.</span><span class="n">add_hyperlink</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;https://www.baidu.com&#39;</span><span class="p">,</span> <span class="s1">&#39;百度&#39;</span><span class="p">,</span><span class="s1">&#39;提示：点击即链接到百度&#39;</span><span class="p">)</span><span class="c1"># 加入超链接</span>
<span class="n">rng</span><span class="o">.</span><span class="n">address</span> <span class="c1">#取得当前range的地址</span>
<span class="n">rng</span><span class="o">.</span><span class="n">get_address</span><span class="p">()</span> <span class="c1">#取得当前range的地址</span>
<span class="n">rng</span><span class="o">.</span><span class="n">clear_contents</span><span class="p">()</span> <span class="c1"># 清除range的内容</span>
<span class="n">rng</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span> <span class="c1"># 清除格式和内容</span>
<span class="n">rng</span><span class="o">.</span><span class="n">color</span> <span class="c1"># 取得range的背景色,以元组形式返回RGB值</span>
<span class="n">rng</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span> <span class="c1"># 设置range的颜色</span>
<span class="n">rng</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># 清除range的背景色</span>
<span class="n">rng</span><span class="o">.</span><span class="n">column</span> <span class="c1"># 获得range的第一列列标</span>
<span class="n">rng</span><span class="o">.</span><span class="n">row</span> <span class="c1"># range的第一行行标</span>
<span class="n">rng</span><span class="o">.</span><span class="n">count</span> <span class="c1"># 返回range中单元格的数据</span>
<span class="n">rng</span><span class="o">.</span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;=SUM(B1:B5)&#39;</span> <span class="c1"># 获取公式或者输入公式</span>
<span class="n">rng</span><span class="o">.</span><span class="n">formula_array</span> <span class="c1"># 数组公式</span>
<span class="n">rng</span><span class="o">.</span><span class="n">get_address</span><span class="p">(</span><span class="n">row_absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">column_absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">include_sheetname</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">external</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># 获得单元格的绝对地址</span>
<span class="n">rng</span><span class="o">.</span><span class="n">column_width</span> <span class="c1"># 获得列宽</span>
<span class="n">rng</span><span class="o">.</span><span class="n">width</span> <span class="c1"># 返回range的总宽度</span>
<span class="n">rng</span><span class="o">.</span><span class="n">hyperlink</span> <span class="c1"># 获得range的超链接</span>
<span class="n">rng</span><span class="o">.</span><span class="n">last_cel</span> <span class="c1"># 获得range中右下角最后一个单元格</span>
<span class="n">rng</span><span class="o">.</span><span class="n">offset</span><span class="p">(</span><span class="n">row_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># range平移</span>
<span class="n">rng</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">row_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="c1"># range进行resize改变range的大小</span>
<span class="n">rng</span><span class="o">.</span><span class="n">row_height</span> <span class="c1"># 行的高度，所有行一样高返回行高，不一样返回None</span>
<span class="n">rng</span><span class="o">.</span><span class="n">height</span> <span class="c1"># 返回range的总高度</span>
<span class="n">rng</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># 返回range的行数和列数</span>
<span class="n">rng</span><span class="o">.</span><span class="n">sheet</span> <span class="c1"># 返回range所在的sheet</span>
<span class="n">rng</span><span class="o">.</span><span class="n">rows</span> <span class="c1"># 返回range的所有行</span>
<span class="n">rng</span><span class="o">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># range的第一行</span>
<span class="n">rng</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">count</span> <span class="c1"># range的总行数</span>
<span class="n">rng</span><span class="o">.</span><span class="n">columns</span> <span class="c1"># 返回range的所有列</span>
<span class="n">rng</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 返回range的第一列</span>
<span class="n">rng</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">count</span> <span class="c1"># 返回range的列数</span>
<span class="n">rng</span><span class="o">.</span><span class="n">autofit</span><span class="p">()</span> <span class="c1"># 所有range的大小自适应</span>
<span class="n">rng</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">autofit</span><span class="p">()</span> <span class="c1"># 所有列宽度自适应</span>
<span class="n">rng</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">autofit</span><span class="p">()</span> <span class="c1"># 所有行宽度自适应</span>
<span class="c1"># Pandas</span>
<span class="c1"># Series与DataFrame转化器</span>
<span class="c1"># 相关参数：ndim = None, index = 1（多列，是否使用第一列为索引）, header = True(表头), dtype = None；</span>
<span class="c1"># DataFrame的表头可以设置为1，2，1等价于True，2表示二维表头；index: 0等价与False，1等价于True，第一列设置为索引</span>
<span class="c1"># 写入两列数据</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;王五&#39;</span><span class="p">,</span> <span class="mi">35</span><span class="p">]]</span>
<span class="c1"># index=0，第一列不为索引，读取结果为DataFrom</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="c1"># index=1，第一列设置为索引，输出为Series</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
<span class="c1"># 写入，不需要索引，index设置为False，保留表头，header=True</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;d1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">df</span>
<span class="c1"># 读取为DataFrame</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
</code></pre></td></tr></table>
</div>
</div><p>Reference link.</p>
<ul>
<li><a href="https://github.com/xlwings/xlwings">https://github.com/xlwings/xlwings</a></li>
<li><a href="https://docs.xlwings.org/zh_CN/latest/index.html">https://docs.xlwings.org/zh_CN/latest/index.html</a></li>
</ul>
<h2 id="python-excel-quick-write-tool-pyexcelerate">Python Excel Quick Write Tool PyExcelerate</h2>
<p><a href="https://github.com/kz26/PyExcelerate">PyExcelerate</a> is claimed to be the best performing Python writing package for Excel xlsx files. It is also relatively easy to use.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">pyexcelerate</span> <span class="kn">import</span> <span class="n">Workbook</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">Fill</span><span class="p">,</span> <span class="n">Format</span>

<span class="c1"># Writing bulk data</span>
<span class="c1"># Fastest</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span> <span class="c1"># data is a 2D array</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Writing bulk data to a range</span>
<span class="c1"># Fastest</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;test&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>
<span class="c1"># Fast</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;test&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;B2&#34;</span><span class="p">,</span> <span class="s2">&#34;C3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Writing cell data</span>
<span class="c1"># Faster</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="c1"># a number</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&#34;=SUM(A1,B1)&#34;</span><span class="p">)</span> <span class="c1"># a formula</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span> <span class="c1"># a date</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Selecting cells by name</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="s2">&#34;A1&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Merging cells</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;A1&#34;</span><span class="p">,</span> <span class="s2">&#34;B1&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">()</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Styling cells</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="n">Font</span><span class="p">(</span><span class="n">italic</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="n">Font</span><span class="p">(</span><span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="n">Font</span><span class="p">(</span><span class="n">strikethrough</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">Fill</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))))</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_value</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_cell_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="n">Format</span><span class="p">(</span><span class="s1">&#39;mm/dd/yy&#39;</span><span class="p">)))</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Styling ranges</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;test&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;A1&#34;</span><span class="p">,</span><span class="s2">&#34;C3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;A1&#34;</span><span class="p">,</span><span class="s2">&#34;C1&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;A2&#34;</span><span class="p">,</span><span class="s2">&#34;C3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;A3&#34;</span><span class="p">,</span><span class="s2">&#34;C3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="s2">&#34;C1&#34;</span><span class="p">,</span><span class="s2">&#34;C3&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">strikethrough</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Styling rows</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_row_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">Fill</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))))</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Styling columns</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_col_style</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">Fill</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))))</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Available style attributes</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">bold</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">underline</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">strikethrough</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">fill</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">alignment</span><span class="o">.</span><span class="n">vertical</span> <span class="o">=</span> <span class="s1">&#39;top&#39;</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">alignment</span><span class="o">.</span><span class="n">horizontal</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">alignment</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">alignment</span><span class="o">.</span><span class="n">wrap_text</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">borders</span><span class="o">.</span><span class="n">top</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">Color</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">borders</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;-.&#39;</span>

<span class="c1"># Setting row heights and column widths</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">set_col_style</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Style</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Linked styles</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">underline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strikethrough</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ws</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">font</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&#34;output.xlsx&#34;</span><span class="p">)</span>

<span class="c1"># Pandas DataFrames</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">new_sheet</span><span class="p">(</span><span class="s2">&#34;sheet name&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="python-read-and-write-excel-tool-pyexcel">Python read and write Excel tool pyexcel</h2>
<p><a href="https://github.com/pyexcel/pyexcel">PyExcel</a> is an open source Excel manipulation library. It wraps a set of APIs for reading and writing file data , this set of APIs accept parameters including two keyword collections , one specifying the data source , the other specifying the destination file , each collection has many keyword parameters to control the read and write details . pyexcel package also implements a workbook , form types for accessing , manipulating and saving data , read and write operations are very fancy.</p>
<h3 id="read-the-file">Read the file</h3>
<p>pyexcel contains some get functions for reading files: get_array, get_dict, get_record, get_book, get_book_dict, get_sheet. These methods convert the file content to various types such as array, dict, sheet/book, etc., masking the file media to be csv/tsv text, xls/xlsx table files, dict/list types, sql database tables, and other details. There is also an equivalent set of iget series functions, the only difference being the return generator for efficiency.</p>
<ul>
<li>The get_sheet function takes the sheet_name parameter, which is used to specify the sheet to be read for Excel tables with multiple sheets, or the 1st sheet if default. get_sheet function also takes the name_columns_by_row/name_rows_by_column parameter for the specified row/column as the column/row name. The default value is 0, which represents the 1st row, and the sheet.Sheet class has a method with the same name for the same operation. Several other functions are more similar to get_sheet and accept the same parameters.</li>
<li>The get_array function converts the file data into an array, i.e. a nested list, with each element of the list corresponding to one row of the table.</li>
<li>The get_dict function converts the file data into an ordered dictionary, using the field in the first row as the key and subsequent rows of values forming a list as the value.</li>
<li>get_record function converts the file data into a list formed by an ordered dictionary, each line of data corresponds to an ordered dictionary, and the dictionary uses the field of the first line of the file as the key and the line of data as the value.</li>
<li>get_book function converts the file into a book.Book object. If read from a csv file, it contains only 1 sheet, the name is the file name; if read from an xls file, it contains all the sheets in the xls file.</li>
<li>get_book_dict function converts the file data into an ordered dictionary of multiple sheets, with sheet name as key and sheet data in the form of a nested list as value, which is more useful in Excel tables containing multiple sheets; for csv files, as there is only 1 sheet, the returned ordered dictionary has only 1 item.</li>
</ul>
<h3 id="data-access">Data Access</h3>
<p><strong>Book and Sheet</strong></p>
<p>Book and pyexcel.book.Sheet types are implemented in pyexcel, which correspond to the concept of book and sheet in Excel sheet files, and can be obtained as book/sheet objects by the above get series functions, or by pyexcel.Book()/ pyexcel.Sheet() function to create.</p>
<p>After getting the book object, the next step is to access the sheets in the book. pyexcel.book.Book class object can index the corresponding sheets by serial number, or you can call the sheet_by_index and sheet_by_name methods to get the specified sheet content, and call the sheet_names method to return Calling the sheet_names method returns the names of all the sheets contained in the book object.</p>
<p>The pyexcel.sheet.Sheet class object has a texttable property, which means that the text, in addition to the sheet name, and the dotted line character to draw the table border, directly print the variable sh and print sh.texttable effect is the same.</p>
<p>In addition, pyexcel.sheet.Sheet class has several very useful properties.</p>
<ul>
<li>content property, compared to displaying the sheet directly, there is less of the sheet name in the first row.</li>
<li>csv property, the csv form of the sheet data, without the table box line.</li>
<li>array property, the array form of the sheet data (nested list), the same as the get_array function returns.</li>
<li>row/column property, very similar to nested list, supports accessing specified row/column by subscript, serial number starts from 0.</li>
</ul>
<p><strong>Rows and Columns</strong></p>
<p>After getting pyexcel.sheet.Sheet object, besides using row/column property to get all the row/column objects collection for further iterative traversal, you can also index any row/column by serial number, which starts from 0. When the serial number exceeds the table row/column range, an IndexError error is thrown, and you can use the row_range/column_range methods of the sheet object to check the row/column range. row_at/column_at methods of pyexcel.sheet. The serial number index is equivalent.</p>
<p><strong>Cells</strong></p>
<p>The pyexcel.sheet.Sheet object supports binary serial number indexing of any cell, or replacing the serial number with a row/column name (please note the code comments below). It can also be indexed in its entirety as an Excel sheet cell address without any conversion.</p>
<h3 id="rewrite-the-file">Rewrite the file</h3>
<p>Rewriting a file includes two steps: rewriting variable values and writing variable objects to the file, which is recommended to be done through pyexcel.book.Sheet or pyexcel.book.</p>
<p>For pyexcel.book.Sheet class object, row and column properties support add, delete and change operations like list, and both have save_as method for writing objects to file. In addition, pyexcel provides the save series wrapper functions: save_as, save_book_as to write to a file, and when specifying the destination file, the parameter names used are prefixed with &ldquo;dest_&rdquo; compared to the get series. For example, get series use file_name to specify the source of the data file, save series use dest_file_name to specify the destination file path; get series use delimiter parameter to specify the csv separator, save series use dest_delimiter to specify the separator used when writing to csv files. pyexcel. Sheet class object can be added, deleted or changed in whole rows/columns, and can also be positioned to assign values to specific cells, and the number of elements should be consistent with the number of columns/rows when using a list of whole rows/columns to assign values. For pyexcel.book.Book class object, you can either extend the whole book as a whole like an operation list, or index only some sheets and then stitch and assign values as a whole. pyexcel.book.Sheet also implements form transpose, region, cut, paste, and map application. paste, map application (map), row filtering (filter), formatting (format) and other fancy operations.</p>
<p>Book class object&rsquo;s save_as method, which is simple and straightforward, and is recommended for operating Excel. You can also use the pyexcel package level save series wrapper functions, which are more suitable for file type conversion, and there is an equivalent set of isave series functions, the main difference is that the variables are only read in when writing, to improve efficiency. These save methods/functions above will automatically discern the format type based on the destination file extension. pyexcel.book.Sheet or pyexcel.book.Book classes also implement the save_to series of functions to write objects to database, ORM, memory, etc.</p>
<h3 id="summary">Summary</h3>
<ul>
<li>The pyexcel package encapsulates the get series of functions for reading and converting data from files, all of which can flexibly support multiple ways of reading files. For manipulating Excel files, the get_sheet function is recommended to be preferred.</li>
<li>pyexcel package support for different formats of files depends on different plug-in packages.</li>
<li>pyexcel package internally implements the book.Sheet or pyexcel.book.Book type, which corresponds to the workbook and form concepts of Excel files, providing a variety of flexible methods for data access, deletion, and visualization.</li>
<li>Book type has the save series of methods to write object variables to files, databases, memory, etc., which is recommended and preferred; also the pyexcel package level save_as series of wrapper functions are very convenient for converting file types; these methods/functions for writing to files automatically discriminate based on the destination file extensions The format type is automatically determined by the destination file extension.</li>
<li>cookbook package encapsulates some utility functions, such as multi-type file merge, table split;</li>
<li>book.Sheet and pyexcel.book.Book and other classes do not implement the full method, call some will throw an error, be aware of this big hole, this article in the ipython environment when writing examples of the error is not given, which is also the reason for the prompt number is not consecutive.</li>
</ul>
<p>Reference links.</p>
<ul>
<li><a href="http://docs.pyexcel.org/">http://docs.pyexcel.org</a></li>
</ul>
<p>Other tools.</p>
<ul>
<li>Excel formula tool: <a href="https://github.com/vinci1it2000/formulas">https://github.com/vinci1it2000/formulas</a></li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          <a href="/tags/excel/">excel</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-11/sklearn-feature-extraction-text/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Extracting text features using Scikit-Learn</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-11/camerax-extensions-api/">
            <span class="next-text nav-default">Apply effects to photos using the CameraX Extensions API</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
