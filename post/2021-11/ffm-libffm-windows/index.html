<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Installation and use of FFM/libffm on Windows/Linux - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Yu-Chin Juan, the author of FFM, has open-sourced the C&#43;&#43; version of the code libffm on GitHub. Since the daily data processing is in a Python environment, expect to find a Python version of FFM. Related projects on Github There are many on Github, such as this one: A Python wrapper for LibFFM. Installation of libffm in Windows&#43;Anaconda environment Installation of libffm-python package The project is installed on Windows as" /><meta name="keywords" content="windows, FFM, libffm, Linux" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-11/ffm-libffm-windows/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Installation and use of FFM/libffm on Windows/Linux" />
<meta property="og:description" content="Yu-Chin Juan, the author of FFM, has open-sourced the C&#43;&#43; version of the code libffm on GitHub. Since the daily data processing is in a Python environment, expect to find a Python version of FFM. Related projects on Github There are many on Github, such as this one: A Python wrapper for LibFFM. Installation of libffm in Windows&#43;Anaconda environment Installation of libffm-python package The project is installed on Windows as" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-11/ffm-libffm-windows/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-11-14T12:07:24+08:00" />
<meta property="article:modified_time" content="2021-11-14T12:07:24+08:00" />

<meta itemprop="name" content="Installation and use of FFM/libffm on Windows/Linux">
<meta itemprop="description" content="Yu-Chin Juan, the author of FFM, has open-sourced the C&#43;&#43; version of the code libffm on GitHub. Since the daily data processing is in a Python environment, expect to find a Python version of FFM. Related projects on Github There are many on Github, such as this one: A Python wrapper for LibFFM. Installation of libffm in Windows&#43;Anaconda environment Installation of libffm-python package The project is installed on Windows as"><meta itemprop="datePublished" content="2021-11-14T12:07:24+08:00" />
<meta itemprop="dateModified" content="2021-11-14T12:07:24+08:00" />
<meta itemprop="wordCount" content="2441">
<meta itemprop="keywords" content="windows,linux," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Installation and use of FFM/libffm on Windows/Linux"/>
<meta name="twitter:description" content="Yu-Chin Juan, the author of FFM, has open-sourced the C&#43;&#43; version of the code libffm on GitHub. Since the daily data processing is in a Python environment, expect to find a Python version of FFM. Related projects on Github There are many on Github, such as this one: A Python wrapper for LibFFM. Installation of libffm in Windows&#43;Anaconda environment Installation of libffm-python package The project is installed on Windows as"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Installation and use of FFM/libffm on Windows/Linux</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-11-14 12:07:24 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 2441 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#installation-of-libffm-in-windowsanaconda-environment">Installation of libffm in Windows+Anaconda environment</a>
          <ul>
            <li><a href="#installation-of-libffm-python-package">Installation of libffm-python package</a></li>
            <li><a href="#compilation-of-libffm-on-windows">Compilation of Libffm on Windows</a></li>
            <li><a href="#use-of-ffm-trainexe-and-ffm-predictexe">Use of ffm-train.exe and ffm-predict.exe</a></li>
          </ul>
        </li>
        <li><a href="#installation-of-libffm-in-linuxanaconda-environment">Installation of libffm in Linux+Anaconda environment</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Yu-Chin Juan, the author of FFM, has open-sourced the C++ version of the code <a href="https://github.com/ycjuan/libffm">libffm</a> on GitHub. Since the daily data processing is in a Python environment, expect to find a Python version of FFM. Related projects on Github There are many on Github, such as this one: <a href="https://github.com/alexeygrigorev/libffm-python">A Python wrapper for LibFFM</a>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/11/14/e01a2e362c2b438f9ee6d935770c785d.png" alt=""></p>
<h2 id="installation-of-libffm-in-windowsanaconda-environment">Installation of libffm in Windows+Anaconda environment</h2>
<h3 id="installation-of-libffm-python-package">Installation of libffm-python package</h3>
<p>The project is installed on Windows as follows.</p>
<ul>
<li>Download the project locally and unzip it.</li>
<li>Install the mingw32 environment. conda install mingw32</li>
<li>Add mingw32 path to environment variable PATH: C:\RBuildTools\3.5\mingw_32\bin</li>
<li>Modify the compilation settings in Python. D:\ProgramData\Anaconda3\Lib\distutils\distutils.cfg If you don&rsquo;t have this file then create it yourself, add the content as.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ini" data-lang="ini"><span class="k">[build]</span>
<span class="na">compiler</span><span class="o">=</span><span class="s">mingw32</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>Execute: python setup.py install in the project directory</li>
</ul>
<p>However, when using it, the following error is reported.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">---------------------------------------------------------------------------
OSError                                   Traceback (most recent call last)
&lt;ipython-input-2-244abf364e9b&gt; in &lt;module&gt;
----&gt; 1 import ffm

D:\ProgramData\Anaconda3\lib\site-packages\ffm-7e8621d-py3.6-win-amd64.egg\ffm\__init__.py in &lt;module&gt;
----&gt; 1 from .ffm import FFMData, FFM, read_model

D:\ProgramData\Anaconda3\lib\site-packages\ffm-7e8621d-py3.6-win-amd64.egg\ffm\ffm.py in &lt;module&gt;
     70 FFM_Problem_ptr = ctypes.POINTER(FFM_Problem)
     71 
---&gt; 72 _lib = ctypes.cdll.LoadLibrary(get_lib_path())
     73 
     74 _lib.ffm_convert_data.restype = FFM_Problem

D:\ProgramData\Anaconda3\lib\ctypes\__init__.py in LoadLibrary(self, name)
    424 
    425     def LoadLibrary(self, name):
--&gt; 426         return self._dlltype(name)
    427 
    428 cdll = LibraryLoader(CDLL)

D:\ProgramData\Anaconda3\lib\ctypes\__init__.py in __init__(self, name, mode, handle, use_errno, use_last_error)
    346 
    347         if handle is None:
--&gt; 348             self._handle = _dlopen(self._name, mode)
    349         else:
    350             self._handle = handle

OSError: [WinError 87] 参数错误。
</code></pre></td></tr></table>
</div>
</div><p>The main reason is that the libffm.so file was not compiled and generated during the installation on Windows. The installation failed.</p>
<h3 id="compilation-of-libffm-on-windows">Compilation of Libffm on Windows</h3>
<p>Since I had problems with the Python package, I thought I would compile it directly using the C++ version of the code. After reading the project description, only v1.21 of libffm supports Windows environment:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">Building Windows <span class="nv">Binaries</span>
<span class="o">=========================</span>

The Windows part is maintained by different maintainer, so it may not always support the latest version.

The latest version it supports is: v1.21

To build them via command-line tools of Visual C++, use the following steps:

1. Open a DOS <span class="nb">command</span> box <span class="o">(</span>or Developer Command Prompt <span class="k">for</span> Visual Studio<span class="o">)</span> and go to LIBFFM directory. If environment
variables of VC++ have not been set, <span class="nb">type</span>

<span class="s2">&#34;C:\Program Files (x86)\Microsoft Visual Studio 12.0\VC\bin\amd64\vcvars64.bat&#34;</span>

You may have to modify the above <span class="nb">command</span> according which version of VC++ or
where it is installed.

2. Type

nmake -f Makefile.win clean all
</code></pre></td></tr></table>
</div>
</div><p>Follow the above procedure to install, the first error encountered: &ldquo;nmake&rdquo; cannot be found</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">nmake : 无法将“nmake”项识别为 cmdlet、函数、脚本文件或可运行程序的名称。请检查名称的拼写，如果包括路径，请确保路径正
确，然后再试一次。
所在位置 行:1 字符: <span class="m">1</span>
+ nmake -f Makefile.win clean all
+ ~~~~~
    + CategoryInfo          : ObjectNotFound: <span class="o">(</span>nmake:String<span class="o">)</span> <span class="o">[]</span>, CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException
</code></pre></td></tr></table>
</div>
</div><p>The initial solution was to add the directory where &ldquo;nmake&rdquo; is located to the environment variable PATH. However, the error is still reported after execution, and this time the main error is that the referenced file cannot be loaded.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">PS E:<span class="se">\D</span>ownload<span class="se">\l</span>ibffm-121&gt; nmake -f Makefile.win clean all

Microsoft <span class="o">(</span>R<span class="o">)</span> Program Maintenance Utility Version 14.00.24210.0
Copyright <span class="o">(</span>C<span class="o">)</span> Microsoft Corporation.  All rights reserved.

        erase /Q *.obj *.exe windows<span class="se">\.</span>
        rd windows
        mkdir windows
        cl.exe /nologo /O2 /EHsc /D <span class="s2">&#34;_CRT_SECURE_NO_DEPRECATE&#34;</span> /D <span class="s2">&#34;USEOMP&#34;</span> /D <span class="s2">&#34;USESSE&#34;</span> /openmp -c ffm.cpp
ffm.cpp
ffm.cpp<span class="o">(</span>21<span class="o">)</span>: warning C4068: unknown pragma
ffm.cpp<span class="o">(</span>22<span class="o">)</span>: fatal error C1034: algorithm: no include path <span class="nb">set</span>
NMAKE : fatal error U1077: <span class="s1">&#39;&#34;C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\bin\cl.exe&#34;&#39;</span> : <span class="k">return</span> code <span class="s1">&#39;0x2&#39;</span>
Stop.
</code></pre></td></tr></table>
</div>
</div><p>After searching online, I found that the water of setting environment variables in VC++ is still deep, you need to add PATH, LIB and INCLUDE. The main reason is that ucrt is added in VS2015, so it needs to introduce Windows 10 SDK, and uuid.lib has to be found in Windows 8.x SDK, so it is still quite troublesome to configure.</p>
<ul>
<li><strong>PATH</strong> C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\bin;C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE</li>
<li><strong>LIB</strong> C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\lib;C:\Program Files (x86)\Windows Kits\10\Lib\10.0.10240.0\ucrt\x86;C:\Program Files (x86)\Windows Kits\10\Lib\10.0.10240.0\ucrt\x86 Program Files (x86)\Windows Kits\8.1\Lib\winv6.3\um\x86</li>
<li><strong>INCLUDE</strong> C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\include;C:\Program Files (x86)\Windows Kits\10\Include\10.0.10240.0\ ucrt</li>
</ul>
<p>Adjust the specific path accordingly according to the location of your installation. After finishing, execute it again to compile successfully. As follows, only a few warning messages appear.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">PS E:<span class="se">\D</span>ownload<span class="se">\l</span>ibffm-121&gt; nmake -f Makefile.win clean all

Microsoft <span class="o">(</span>R<span class="o">)</span> Program Maintenance Utility Version 14.00.24210.0
Copyright <span class="o">(</span>C<span class="o">)</span> Microsoft Corporation.  All rights reserved.

        erase /Q *.obj *.exe windows<span class="se">\.</span>
        rd windows
        mkdir windows
        cl.exe /nologo /O2 /EHsc /D <span class="s2">&#34;_CRT_SECURE_NO_DEPRECATE&#34;</span> /D <span class="s2">&#34;USEOMP&#34;</span> /D <span class="s2">&#34;USESSE&#34;</span> /openmp -c ffm.cpp
ffm.cpp
ffm.cpp<span class="o">(</span>21<span class="o">)</span>: warning C4068: unknown pragma
        cl.exe /nologo /O2 /EHsc /D <span class="s2">&#34;_CRT_SECURE_NO_DEPRECATE&#34;</span> /D <span class="s2">&#34;USEOMP&#34;</span> /D <span class="s2">&#34;USESSE&#34;</span> /openmp -c timer.cpp
timer.cpp
        cl.exe /nologo /O2 /EHsc /D <span class="s2">&#34;_CRT_SECURE_NO_DEPRECATE&#34;</span> /D <span class="s2">&#34;USEOMP&#34;</span> /D <span class="s2">&#34;USESSE&#34;</span> /openmp ffm-train.cpp ffm.obj timer.obj -Fewindows<span class="se">\f</span>fm-train.exe
ffm-train.cpp
ffm-train.cpp<span class="o">(</span>1<span class="o">)</span>: warning C4068: unknown pragma
        cl.exe /nologo /O2 /EHsc /D <span class="s2">&#34;_CRT_SECURE_NO_DEPRECATE&#34;</span> /D <span class="s2">&#34;USEOMP&#34;</span> /D <span class="s2">&#34;USESSE&#34;</span> /openmp ffm-predict.cpp ffm.obj timer.obj -Fewindows<span class="se">\f</span>fm-predict.exe
ffm-predict.cpp
</code></pre></td></tr></table>
</div>
</div><p>After compilation, a new windows folder will be created under the source folder and 2 exe files will be generated.</p>
<ul>
<li>ffm-predict.exe</li>
<li>ffm-train.exe</li>
</ul>
<h3 id="use-of-ffm-trainexe-and-ffm-predictexe">Use of ffm-train.exe and ffm-predict.exe</h3>
<p>The simpler method is to call it directly from the command line, using the method described in the project documentation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">Command Line <span class="nv">Usage</span>
<span class="o">==================</span>

-   <span class="sb">`</span>ffm-train<span class="s1">&#39;
</span><span class="s1">
</span><span class="s1">    usage: ffm-train [options] training_set_file [model_file]
</span><span class="s1">
</span><span class="s1">    options:
</span><span class="s1">    -l &lt;lambda&gt;: set regularization parameter (default 0.00002)
</span><span class="s1">    -k &lt;factor&gt;: set number of latent factors (default 4)
</span><span class="s1">    -t &lt;iteration&gt;: set number of iterations (default 15)
</span><span class="s1">    -r &lt;eta&gt;: set learning rate (default 0.2)
</span><span class="s1">    -s &lt;nr_threads&gt;: set number of threads (default 1)
</span><span class="s1">    -p &lt;path&gt;: set path to the validation set
</span><span class="s1">    --quiet: quiet model (no output)
</span><span class="s1">    --no-norm: disable instance-wise normalization
</span><span class="s1">    --auto-stop: stop at the iteration that achieves the best validation loss (must be used with -p)
</span><span class="s1">
</span><span class="s1">    By default we do instance-wise normalization. That is, we normalize the 2-norm of each instance to 1. You can use
</span><span class="s1">    `--no-norm&#39;</span> to disable this <span class="k">function</span>.
    
    A binary file <span class="sb">`</span>training_set_file.bin<span class="s1">&#39; will be generated to store the data in binary format.
</span><span class="s1">
</span><span class="s1">    Because FFM usually need early stopping for better test performance, we provide an option `--auto-stop&#39;</span> to stop at
    the iteration that achieves the best validation loss. Note that you need to provide a validation <span class="nb">set</span> with <span class="sb">`</span>-p<span class="s1">&#39; when
</span><span class="s1">    you use this option.
</span><span class="s1">
</span><span class="s1">
</span><span class="s1">-   `ffm-predict&#39;</span>

    usage: ffm-predict test_file model_file output_file
</code></pre></td></tr></table>
</div>
</div><p>Alternatively it can be used by calling the command line via Python at</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;E:\Download\libffm-121\windows&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;start ffm-train.exe&#34;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="s2">&#34;ffm-train.exe&#34;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;start ffm-predict.exe&#34;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="s2">&#34;ffm-predict.exe&#34;</span><span class="p">)</span>

<span class="c1">#使用缺省参数训练模型</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-train bigdata.tr.txt model&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#使用bigdata.te.txt作为validation数据</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-train -p bigdata.te.txt bigdata.tr.txt model&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#使用5折交叉验证</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-train -v 5 bigdata.tr.txt&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#用–quiet参数训练时不打印训练信息</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-train –quiet bigdata.tr.txt&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#预测</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-predict bigdata.te.txt model output.txt&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#基于磁盘的训练</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-train –no-rand –on-disk bigdata.tr.txt&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#使用–auto-stop参数，当达到最优的validation损失时停止训练</span>
<span class="n">cmd</span> <span class="o">=</span> <span class="s1">&#39;ffm-train -p bigdata.te.txt -t 100 bigdata.tr.txt&#39;</span>
<span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The address of the training file used for the sample code is</p>
<p><a href="https://github.com/keyunluo/python-ffm/tree/master/example/libffm-format">https://github.com/keyunluo/python-ffm/tree/master/example/libffm-format</a></p>
<p>As the above call is very troublesome, I found a separate <a href="https://github.com/gatapia/py_ml_utils">open source project</a> to further encapsulate it, the encapsulated code is</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">subprocess</span><span class="o">,</span> <span class="nn">shlex</span><span class="o">,</span> <span class="nn">tempfile</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">sklearn.base</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">pandas_extensions</span> <span class="kn">import</span> <span class="o">*</span> 
<span class="kn">from</span> <span class="nn">ExeEstimator</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">LibFFMClassifier</span><span class="p">(</span><span class="n">ExeEstimator</span><span class="p">,</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">base</span><span class="o">.</span><span class="n">ClassifierMixin</span><span class="p">):</span>
  <span class="s1">&#39;&#39;&#39;
</span><span class="s1">  options:
</span><span class="s1">  -l &lt;lambda&gt;: set regularization parameter (default 0)
</span><span class="s1">  -k &lt;factor&gt;: set number of latent factors (default 4)
</span><span class="s1">  -t &lt;iteration&gt;: set number of iterations (default 15)
</span><span class="s1">  -r &lt;eta&gt;: set learning rate (default 0.1)
</span><span class="s1">  -s &lt;nr_threads&gt;: set number of threads (default 1)
</span><span class="s1">  -p &lt;path&gt;: set path to the validation set
</span><span class="s1">  --quiet: quiet model (no output)
</span><span class="s1">  --norm: do instance-wise normalization
</span><span class="s1">  --no-rand: disable random update
</span><span class="s1">  `--norm&#39; helps you to do instance-wise normalization. When it is enabled,
</span><span class="s1">  you can simply assign `1&#39; to `value&#39; in the data.
</span><span class="s1">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">lambda_v</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">eta</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> 
    <span class="n">nr_threads</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">no_rand</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">ExeEstimator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;tolist&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="n">columns</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lambda_v</span> <span class="o">=</span> <span class="n">lambda_v</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">=</span> <span class="n">factor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">=</span> <span class="n">iteration</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">eta</span> <span class="o">=</span> <span class="n">eta</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nr_threads</span> <span class="o">=</span> <span class="n">nr_threads</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span> <span class="o">=</span> <span class="n">normalize</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">no_rand</span> <span class="o">=</span> <span class="n">no_rand</span>

  <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">train_file</span> <span class="o">=</span> <span class="n">X</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">):</span> <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
      <span class="n">train_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_reusable</span><span class="p">(</span><span class="s1">&#39;_libffm_train&#39;</span><span class="p">,</span> <span class="s1">&#39;to_libffm&#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
      
    <span class="c1"># self._model_file = self.save_tmp_file(X, &#39;_libffm_model&#39;, True)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_model_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpfile</span><span class="p">(</span><span class="s1">&#39;_libffm_model&#39;</span><span class="p">)</span>

    <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;utils/lib/ffm-train.exe&#39;</span> <span class="o">+</span> <span class="s1">&#39; -l &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> \
      <span class="s1">&#39; -k &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; -t &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; -r &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> \
      <span class="s1">&#39; -s &#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span> <span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; --quiet&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">:</span> <span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; --norm&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_rand</span><span class="p">:</span> <span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; --no-rand&#39;</span>  
    <span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">train_file</span>
    <span class="n">command</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_file</span>
    <span class="n">running_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_subprocess</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close_process</span><span class="p">(</span><span class="n">running_process</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>

  <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>  
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span> <span class="n">test_file</span> <span class="o">=</span> <span class="n">X</span>
    <span class="k">else</span><span class="p">:</span> 
      <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">):</span> <span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
      <span class="n">test_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_reusable</span><span class="p">(</span><span class="s1">&#39;_libffm_test&#39;</span><span class="p">,</span> <span class="s1">&#39;to_libffm&#39;</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>

    <span class="n">output_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmpfile</span><span class="p">(</span><span class="s1">&#39;_libffm_predictions&#39;</span><span class="p">)</span>

    <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;utils/lib/ffm-predict.exe &#39;</span> <span class="o">+</span> <span class="n">test_file</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_file</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">output_file</span>
    <span class="n">running_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_subprocess</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">close_process</span><span class="p">(</span><span class="n">running_process</span><span class="p">)</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_predictions</span><span class="p">(</span><span class="n">output_file</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">preds</span>

  <span class="k">def</span> <span class="nf">predict_proba</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>    
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">predictions</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
</code></pre></td></tr></table>
</div>
</div><p>In summary, it is very difficult to use libffm in a Windows environment, either for compiling or calling, and it is recommended to use it in a Linux environment if the environment permits.</p>
<h2 id="installation-of-libffm-in-linuxanaconda-environment">Installation of libffm in Linux+Anaconda environment</h2>
<p>The installation of the libffm-python package in Anaconda on Linux also has problems. The specific error reported is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">➜  libffm-python git:<span class="o">(</span>master<span class="o">)</span> python setup.py install
/home/qw/anaconda3/lib/python3.7/site-packages/setuptools/dist.py:481: UserWarning: The version specified <span class="o">(</span><span class="s1">&#39;7e8621d&#39;</span><span class="o">)</span> is an invalid version, this may not work as expected with newer versions of setuptools, pip, and PyPI. Please see PEP <span class="m">440</span> <span class="k">for</span> more details.
  <span class="s2">&#34;details.&#34;</span> % self.metadata.version
running install
running bdist_egg
running egg_info
creating ffm.egg-info
writing ffm.egg-info/PKG-INFO
writing dependency_links to ffm.egg-info/dependency_links.txt
writing requirements to ffm.egg-info/requires.txt
writing top-level names to ffm.egg-info/top_level.txt
writing manifest file <span class="s1">&#39;ffm.egg-info/SOURCES.txt&#39;</span>
reading manifest file <span class="s1">&#39;ffm.egg-info/SOURCES.txt&#39;</span>
writing manifest file <span class="s1">&#39;ffm.egg-info/SOURCES.txt&#39;</span>
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
creating build
creating build/lib.linux-x86_64-3.7
creating build/lib.linux-x86_64-3.7/ffm
copying ffm/__init__.py -&gt; build/lib.linux-x86_64-3.7/ffm
copying ffm/ffm.py -&gt; build/lib.linux-x86_64-3.7/ffm
running build_ext
building <span class="s1">&#39;ffm.libffm&#39;</span> extension
creating build/temp.linux-x86_64-3.7
gcc -pthread -B /home/qw/anaconda3/compiler_compat -Wl,--sysroot<span class="o">=</span>/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I. -I/home/qw/anaconda3/include/python3.7m -c ffm.cpp -o build/temp.linux-x86_64-3.7/ffm.o -Wall -O3 -std<span class="o">=</span>c++0x -march<span class="o">=</span>native -DUSESSE -DUSEOMP
cc1plus: 警告：command line option ‘-Wstrict-prototypes’ is valid <span class="k">for</span> C/ObjC but not <span class="k">for</span> C++
ffm.cpp:578: 警告：忽略 <span class="c1">#pragma omp parallel [-Wunknown-pragmas]</span>
  <span class="m">578</span> <span class="p">|</span> <span class="c1">#pragma omp parallel for schedule(static) reduction(+: loss)</span>
      <span class="p">|</span> 
ffm.cpp:726: 警告：忽略 <span class="c1">#pragma omp parallel [-Wunknown-pragmas]</span>
  <span class="m">726</span> <span class="p">|</span>     <span class="c1">#pragma omp parallel for schedule(static) reduction(+: loss)</span>
      <span class="p">|</span> 
gcc -pthread -B /home/qw/anaconda3/compiler_compat -Wl,--sysroot<span class="o">=</span>/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I. -I/home/qw/anaconda3/include/python3.7m -c timer.cpp -o build/temp.linux-x86_64-3.7/timer.o -Wall -O3 -std<span class="o">=</span>c++0x -march<span class="o">=</span>native -DUSESSE -DUSEOMP
cc1plus: 警告：command line option ‘-Wstrict-prototypes’ is valid <span class="k">for</span> C/ObjC but not <span class="k">for</span> C++
g++ -pthread -shared -B /home/qw/anaconda3/compiler_compat -L/home/qw/anaconda3/lib -Wl,-rpath<span class="o">=</span>/home/qw/anaconda3/lib -Wl,--no-as-needed -Wl,--sysroot<span class="o">=</span>/ build/temp.linux-x86_64-3.7/ffm.o build/temp.linux-x86_64-3.7/timer.o -o build/lib.linux-x86_64-3.7/ffm/libffm.cpython-37m-x86_64-linux-gnu.so -fopenmp
/home/qw/anaconda3/compiler_compat/ld: build/temp.linux-x86_64-3.7/ffm.o: unable to initialize decompress status <span class="k">for</span> section .debug_info
/home/qw/anaconda3/compiler_compat/ld: build/temp.linux-x86_64-3.7/ffm.o: unable to initialize decompress status <span class="k">for</span> section .debug_info
/home/qw/anaconda3/compiler_compat/ld: build/temp.linux-x86_64-3.7/ffm.o: unable to initialize decompress status <span class="k">for</span> section .debug_info
/home/qw/anaconda3/compiler_compat/ld: build/temp.linux-x86_64-3.7/ffm.o: unable to initialize decompress status <span class="k">for</span> section .debug_info
build/temp.linux-x86_64-3.7/ffm.o: file not recognized: file format not recognized
collect2: 错误：ld 返回 <span class="m">1</span>
error: <span class="nb">command</span> <span class="s1">&#39;g++&#39;</span> failed with <span class="nb">exit</span> status <span class="m">1</span>
</code></pre></td></tr></table>
</div>
</div><p>At first I thought there was a problem with the libffm code, so I replaced it with the latest version online and found that it still reported errors. So I checked the code again and found that the code was fine and could be compiled normally in a non-Anaconda environment. Anaconda comes with a connector ld which is stored in ~/anaconda3/compiler_compat directory, the solution is very simple, just change the name of the ld in ~/anaconda3/compiler_compat directory and install it again. The solution is very simple.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/windows/">windows</a>
          <a href="/tags/linux/">linux</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-11/basemap/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Python Geographic Data Visualization Tool Basemap</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-11/systemd-analyze/">
            <span class="next-text nav-default">Linux system boot speed optimization tool systemd-analyze</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
