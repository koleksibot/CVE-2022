<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Node ORM framework Prisma Quick Start - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Introduction Prisma is an open source, next-generation ORM that contains the following components. Prisma Client : auto-generated, type-safe query builder for Node.js and TypeScript Prisma Migrate : data migration system Prisma Studio : Graphical interface for querying and editing data in the database The Prisma client can be used in any Node.js or TypeScript backend application (including Serverless applications and microservices). It can be a REST API, a GraphQL API," /><meta name="keywords" content="prisma, Introduction, nodejs, orm" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/prisma-introduction/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Node ORM framework Prisma Quick Start" />
<meta property="og:description" content="Introduction Prisma is an open source, next-generation ORM that contains the following components. Prisma Client : auto-generated, type-safe query builder for Node.js and TypeScript Prisma Migrate : data migration system Prisma Studio : Graphical interface for querying and editing data in the database The Prisma client can be used in any Node.js or TypeScript backend application (including Serverless applications and microservices). It can be a REST API, a GraphQL API," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/prisma-introduction/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-09T11:16:48+08:00" />
<meta property="article:modified_time" content="2022-01-09T11:16:48+08:00" />

<meta itemprop="name" content="Node ORM framework Prisma Quick Start">
<meta itemprop="description" content="Introduction Prisma is an open source, next-generation ORM that contains the following components. Prisma Client : auto-generated, type-safe query builder for Node.js and TypeScript Prisma Migrate : data migration system Prisma Studio : Graphical interface for querying and editing data in the database The Prisma client can be used in any Node.js or TypeScript backend application (including Serverless applications and microservices). It can be a REST API, a GraphQL API,"><meta itemprop="datePublished" content="2022-01-09T11:16:48+08:00" />
<meta itemprop="dateModified" content="2022-01-09T11:16:48+08:00" />
<meta itemprop="wordCount" content="2193">
<meta itemprop="keywords" content="prisma,nodejs," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Node ORM framework Prisma Quick Start"/>
<meta name="twitter:description" content="Introduction Prisma is an open source, next-generation ORM that contains the following components. Prisma Client : auto-generated, type-safe query builder for Node.js and TypeScript Prisma Migrate : data migration system Prisma Studio : Graphical interface for querying and editing data in the database The Prisma client can be used in any Node.js or TypeScript backend application (including Serverless applications and microservices). It can be a REST API, a GraphQL API,"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Node ORM framework Prisma Quick Start</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-09 11:16:48 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2193 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#official-quickstart-example">Official Quickstart example</a></li>
        <li><a href="#create-a-project-template">Create a project template</a></li>
        <li><a href="#basic-workflow">Basic workflow</a></li>
        <li><a href="#schema-definition">Schema Definition</a>
          <ul>
            <li><a href="#annotations">Annotations</a></li>
            <li><a href="#renaming-tablesfields">Renaming tables/fields</a></li>
            <li><a href="#field-defaults--default-">Field defaults ( <code>@default</code> )</a></li>
            <li><a href="#enumeration-types">Enumeration types</a></li>
            <li><a href="#automatically-store-the-update-time--updatedat-">Automatically store the update time ( <code>@updatedAt</code> )</a></li>
            <li><a href="#indexes--index-">Indexes ( <code>@@index</code> )</a></li>
            <li><a href="#field-constraints">Field constraints</a></li>
          </ul>
        </li>
        <li><a href="#using-prisma-client">Using Prisma Client</a>
          <ul>
            <li><a href="#basic-curd-operations">Basic CURD operations</a></li>
            <li><a href="#transactional">Transactional</a></li>
            <li><a href="#calling-sql">Calling sql</a></li>
          </ul>
        </li>
        <li><a href="#extended-reading">Extended Reading</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="introduction">Introduction</h2>
<p>Prisma is an open source, next-generation ORM that contains the following components.</p>
<ul>
<li><strong>Prisma Client</strong> : auto-generated, type-safe query builder for Node.js and TypeScript</li>
<li><strong>Prisma Migrate</strong> : data migration system</li>
<li><strong>Prisma Studio</strong> : Graphical interface for querying and editing data in the database</li>
</ul>
<p>The Prisma client can be used in any Node.js or TypeScript backend application (including Serverless applications and microservices). It can be a REST API, a GraphQL API, a gRPC API, or anything else that requires a database.</p>
<p>This article will give a quick overview of the basic usage of Prisma.</p>
<h2 id="official-quickstart-example">Official Quickstart example</h2>
<p>Direct access to <a href="https://www.prisma.io/docs/getting-started/quickstart">official example</a></p>
<h2 id="create-a-project-template">Create a project template</h2>
<p>Create a typescript project, using gts:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">mkdir -p hello-prisma
<span class="nb">cd</span> hello-prisma
npx gts init -y
npm install -D @vercel/ncc
</code></pre></td></tr></table>
</div>
</div><p>Install prisma dependencies:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">npm install -D prisma
</code></pre></td></tr></table>
</div>
</div><p>Slightly adjust the contents of tsconfig.json as follows (the module used by gts is configured as commonjs, the main one needs to be adjusted):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;extends&#34;</span><span class="p">:</span> <span class="s2">&#34;./node_modules/gts/tsconfig-google.json&#34;</span><span class="p">,</span>
  <span class="nt">&#34;compilerOptions&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;rootDir&#34;</span><span class="p">:</span> <span class="s2">&#34;src&#34;</span><span class="p">,</span>
    <span class="nt">&#34;outDir&#34;</span><span class="p">:</span> <span class="s2">&#34;dist&#34;</span><span class="p">,</span>
    <span class="nt">&#34;module&#34;</span><span class="p">:</span> <span class="s2">&#34;ES2020&#34;</span><span class="p">,</span>
    <span class="nt">&#34;target&#34;</span><span class="p">:</span> <span class="s2">&#34;ES2020&#34;</span><span class="p">,</span>
    <span class="nt">&#34;lib&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ES2020&#34;</span><span class="p">],</span>
    <span class="nt">&#34;esModuleInterop&#34;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&#34;moduleResolution&#34;</span><span class="p">:</span> <span class="s2">&#34;node&#34;</span>
  <span class="p">},</span>
  <span class="nt">&#34;include&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;src/**/*.ts&#34;</span><span class="p">,</span> <span class="s2">&#34;test/**/*.ts&#34;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Initialize prisma templates:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ npx prisma init

✔ Your Prisma schema was created at prisma/schema.prisma
  You can now open it in your favorite editor.

Next steps:
1. Set the DATABASE_URL in the .env file to point to your existing database. If your database has no tables yet, <span class="nb">read</span> https://pris.ly/d/getting-started
2. Set the provider of the datasource block in schema.prisma to match your database: postgresql, mysql, sqlite, sqlserver or mongodb <span class="o">(</span>Preview<span class="o">)</span>.
3. Run prisma db pull to turn your database schema into a Prisma schema.
4. Run prisma generate to generate the Prisma Client. You can <span class="k">then</span> start querying your database.

More information in our documentation:
https://pris.ly/d/getting-started
</code></pre></td></tr></table>
</div>
</div><p>prisma cli has generated a schema template for us <code>prisma/schema.prisma</code> :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// This is your Prisma schema file,
</span><span class="c1">// learn more about it in the docs: https://pris.ly/d/prisma-schema
</span><span class="c1"></span>
<span class="nx">generator</span> <span class="nx">client</span> <span class="p">{</span>
  <span class="nx">provider</span> <span class="o">=</span> <span class="s2">&#34;prisma-client-js&#34;</span>
<span class="p">}</span>

<span class="nx">datasource</span> <span class="nx">db</span> <span class="p">{</span>
  <span class="nx">provider</span> <span class="o">=</span> <span class="s2">&#34;postgresql&#34;</span>
  <span class="nx">url</span>      <span class="o">=</span> <span class="nx">env</span><span class="p">(</span><span class="s2">&#34;DATABASE_URL&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>and a <code>dotenv</code> configuration file <code>.env</code> :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"># Environment variables declared in this file are automatically made available to Prisma.
# See the documentation for more detail: https://pris.ly/d/prisma-schema#using-environment-variables

# Prisma supports the native connection string format for PostgreSQL, MySQL, SQLite, SQL Server and MongoDB (Preview).
# See the documentation for all the connection string options: https://pris.ly/d/connection-strings

DATABASE_URL=&#34;postgresql://johndoe:randompassword@localhost:5432/mydb?schema=public&#34;
</code></pre></td></tr></table>
</div>
</div><h2 id="basic-workflow">Basic workflow</h2>
<p>Adjust the database connection and just append the table structure definition on top of that. For example, we define a <code>user</code> table:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nx">Int</span>      <span class="kd">@id</span> <span class="kd">@default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
  <span class="nx">createdAt</span> <span class="nx">DateTime</span> <span class="kd">@default</span><span class="p">(</span><span class="nx">now</span><span class="p">())</span>
  <span class="nx">email</span>     <span class="nb">String</span>   <span class="kd">@unique</span>
  <span class="nx">name</span>      <span class="nb">String</span><span class="o">?</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>model naming needs to meet the uppercase hump style and cannot use reserved words, refer to the official documentation <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#naming-conventions">prisma-schema-reference#naming-conventions</a></p>
</blockquote>
<p>Run <code>npx prisma migrate dev --name init</code> to create the database and generate the migration script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;createdAt&#34;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;email&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;User_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- CreateIndex
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="s2">&#34;User_email_key&#34;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Local rapid prototyping also allows you to use <code>db push</code> to modify the database directly without creating a migrate script, which is useful in scenarios where you are iterating locally and don&rsquo;t care about the changes in between.</p>
<p>However, in scenarios where the product environment expects to safely migrate the database without losing data, <code>migrate deploy</code> should be used instead of <code>db push</code>. For a description of <code>db push</code> and a comparison with <code>migrate</code> see the official documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-migrate/db-push">db-push</a></p>
</blockquote>
<p>Modify the schema to add a field:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ts" data-lang="ts"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nx">Int</span>      <span class="kd">@id</span> <span class="kd">@default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
  <span class="nx">createdAt</span> <span class="nx">DateTime</span> <span class="kd">@default</span><span class="p">(</span><span class="nx">now</span><span class="p">())</span>
  <span class="nx">email</span>     <span class="nb">String</span>   <span class="kd">@unique</span>
  <span class="nx">name</span>      <span class="nb">String</span><span class="o">?</span>
  <span class="c1">// 增加一个 foo 字段，定义为 VARCHAR 类型
</span><span class="c1"></span>  <span class="nx">foo</span>       <span class="nb">String</span><span class="o">?</span>  <span class="kd">@db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Run <code>npx prisma migrate dev --name add_foo_column</code> and the resulting sql is as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- AlterTable
</span><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w">     </span><span class="s2">&#34;foo&#34;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Later, modify <code>prisma/schema.prisma</code> and then run <code>npx prisma migrate dev</code> again to synchronize the changes to the database. If you append the <code>--create-only</code> parameter, only the migration.sql file will be generated and not synchronized to the database.</p>
<p>The migrate script (mainly the <code>-migrate dev</code> and <code>-migrate reset</code> commands require the shadow database) requires the createdb permission of the database, otherwise it will report an error. If your environment does not provide createdb permissions, you need to create a separate shadow database, specified by adding <code>shadowDatabaseUrl = env('SHADOW_DATABASE_URL')</code> to the <code>datasource db {}</code> configuration block, see the official documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-migrate/shadow-database">shadow-database</a></p>
<p>The product environment runs the migrate script directly with <code>migrate deploy</code> or <code>migrate resolve</code> without creating a shadow database.</p>
<h2 id="schema-definition">Schema Definition</h2>
<p>Note that Prisma maintains a default set of schema to database type mappings, which can be changed by appending the <code>@db.&lt;database_type&gt;</code> parameter if it does not meet your needs, e.g. the <code>String</code> type maps to the <code>TEXT</code> type of the database by default, and you may want to map to the <code>VARCHAR</code> type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">userName</span> <span class="nb">String</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>prisma schema All supported field types and the database types that can be mapped ( <code>@db.&lt;database_type&gt;</code> ) can be found in the official documentation: <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#model-field-scalar-types">model-field-scalar-types</a></p>
<p>Other common schema definitions</p>
<h3 id="annotations">Annotations</h3>
<p>prisma supports two types of comments <code>//</code> and <code>///</code>, the former is just a normal comment on the code, the latter appears in the node syntax tree (AST) as Data Model Meta Format (DMMF):</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">/// This comment will get attached to the `User` node in the AST
</span><span class="c1"></span><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="c1">/// This comment will get attached to the `id` node in the AST
</span><span class="c1"></span>  <span class="nx">id</span>     <span class="nx">Int</span>   <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
  <span class="c1">// This comment is just for you
</span><span class="c1"></span>  <span class="nx">weight</span> <span class="nx">Float</span> <span class="c1">/// This comment gets attached to the `weight` node
</span><span class="c1"></span><span class="p">}</span>

<span class="c1">// This comment is just for you. It will not
</span><span class="c1">// show up in the AST.
</span><span class="c1"></span>
<span class="c1">/// This comment will get attached to the
</span><span class="c1">/// Customer node.
</span><span class="c1"></span><span class="nx">model</span> <span class="nx">Customer</span> <span class="p">{}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Former prisma does not yet support database level table and field comments (DDL COMMENT), see the official <a href="https://github.com/prisma/prisma/discussions/4800">issue</a></p>
<p>Currently you can only generate sql with <code>-create-only</code> parameter and change it by hand</p>
</blockquote>
<h3 id="renaming-tablesfields">Renaming tables/fields</h3>
<p>To circumvent database case issues, the general database best practice is to name tables and fields consistently using lowercase underscores. For prisma, use the <code>@@map</code> and <code>@map</code> function definitions:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>     <span class="nx">Int</span> <span class="err">@</span><span class="nx">id</span>
  <span class="c1">// @map 用于定义列名
</span><span class="c1"></span>  <span class="nx">cardId</span> <span class="nx">Int</span> <span class="err">@</span><span class="nx">map</span><span class="p">(</span><span class="s2">&#34;card_id&#34;</span><span class="p">)</span>

  <span class="c1">// @@map 用于定义表名
</span><span class="c1"></span>  <span class="err">@@</span><span class="nx">map</span><span class="p">(</span><span class="s2">&#34;user&#34;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The corresponding generated sql is as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;user&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;card_id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;user_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>For naming indexes, constraints, etc., refer to the official documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-schema/names-in-underlying-database#using-custom-constraint-index-names">names-in-underlying-databas#using-custom-constraint-index-names</a></p>
<h3 id="field-defaults--default-">Field defaults ( <code>@default</code> )</h3>
<p><code>@default</code> can define the default value of a field, the parameters can be static fixed values like <code>5</code> , <code>false</code> etc. or several functions provided by prisma like <code>autoincrement()</code> , <code>uuid()</code> , <code>now()</code> etc. See the documentation: <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#default">prisma-schema- reference#default</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nx">Int</span>      <span class="err">@</span><span class="nx">id</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
  <span class="nx">createdAt</span> <span class="nx">DateTime</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">now</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="enumeration-types">Enumeration types</h3>
<p>Fields can be defined as enumerated types:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>    <span class="nx">Int</span>     <span class="err">@</span><span class="nx">id</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
  <span class="nx">email</span> <span class="nb">String</span>  <span class="err">@</span><span class="nx">unique</span>
  <span class="nx">name</span>  <span class="nb">String</span><span class="o">?</span>
  <span class="nx">role</span>  <span class="nx">Role</span>    <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">USER</span><span class="p">)</span>
<span class="p">}</span>

<span class="kr">enum</span> <span class="nx">Role</span> <span class="p">{</span>
  <span class="nx">USER</span>
  <span class="nx">ADMIN</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Corresponding to sql:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- CreateEnum
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="s2">&#34;Role&#34;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;USER&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ADMIN&#39;</span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;email&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;role&#34;</span><span class="w"> </span><span class="s2">&#34;Role&#34;</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">E</span><span class="s1">&#39;USER&#39;</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;User_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- CreateIndex
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="s2">&#34;User_email_key&#34;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="p">(</span><span class="s2">&#34;email&#34;</span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h3 id="automatically-store-the-update-time--updatedat-">Automatically store the update time ( <code>@updatedAt</code> )</h3>
<p>This property automatically sets the update time:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">Post</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nb">String</span>   <span class="err">@</span><span class="nx">id</span>
  <span class="nx">createdAt</span> <span class="nx">DateTime</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">now</span><span class="p">())</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">Timestamptz</span>
  <span class="nx">updatedAt</span> <span class="nx">DateTime</span> <span class="err">@</span><span class="nx">updatedAt</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">Timestamptz</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="indexes--index-">Indexes ( <code>@@index</code> )</h3>
<p>Indexes can be created directly using the <code>@@index</code> function:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">Post</span> <span class="p">{</span>
  <span class="nx">id</span>      <span class="nx">Int</span>     <span class="err">@</span><span class="nx">id</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
  <span class="nx">title</span>   <span class="nb">String</span>
  <span class="nx">content</span> <span class="nb">String</span><span class="o">?</span>

  <span class="err">@@</span><span class="nx">index</span><span class="p">([</span><span class="nx">title</span><span class="p">,</span> <span class="nx">content</span><span class="p">])</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>If you want to customize the index type, you can use <code>npx prisma migrate dev --create-only</code> to generate a <code>migration.sql</code> file and then modify it in <code>migration.sql</code>.</p>
<p>If you expect to define them in the schema file, you need to enable the <code>extendedIndexes</code> preview feature:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">generator</span> <span class="nx">client</span> <span class="p">{</span>
  <span class="nx">provider</span>        <span class="o">=</span> <span class="s2">&#34;prisma-client-js&#34;</span>
  <span class="nx">previewFeatures</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;extendedIndexes&#34;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>You can use the <code>type</code> parameter in <code>@@index</code> to specify the index type:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">Example</span> <span class="p">{</span>
  <span class="nx">id</span>    <span class="nx">Int</span> <span class="err">@</span><span class="nx">id</span>
  <span class="nx">value</span> <span class="nx">Int</span>

  <span class="err">@@</span><span class="nx">index</span><span class="p">([</span><span class="nx">value</span><span class="p">],</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">Hash</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>For documentation on the <code>@@index</code> section refer to: <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference#index">prisma-schema-reference#index</a></p>
<p>Documentation for the <code>extendedIndexes</code> section: <a href="https://www.prisma.io/docs/concepts/components/prisma-schema/indexes">indexes</a></p>
<h3 id="field-constraints">Field constraints</h3>
<h4 id="primary-key--id--id-">primary-key ( <code>@id</code> / <code>@@id</code> )</h4>
<p>Single primary key</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">Table</span> <span class="p">{</span>
  <span class="nx">id</span> <span class="nx">Int</span> <span class="err">@</span><span class="nx">id</span> <span class="err">@</span><span class="k">default</span><span class="p">(</span><span class="nx">autoincrement</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Generate sql:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;Table&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;Table_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Union Primary Key</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">Table</span> <span class="p">{</span>
  <span class="nx">firstName</span> <span class="nb">String</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="nx">lastName</span>  <span class="nb">String</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

  <span class="err">@@</span><span class="nx">id</span><span class="p">([</span><span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">])</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Generate sql:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;Table&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;firstName&#34;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;lastName&#34;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;Table_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;firstName&#34;</span><span class="p">,</span><span class="s2">&#34;lastName&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><h4 id="uniqueness--unique--unique-">uniqueness ( <code>@unique</code> / <code>@@unique</code> )</h4>
<p>Single column uniqueness</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">model</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">  </span><span class="n">id</span><span class="w">    </span><span class="nb">Int</span><span class="w">     </span><span class="o">@</span><span class="n">id</span><span class="w"> </span><span class="o">@</span><span class="k">default</span><span class="p">(</span><span class="n">autoincrement</span><span class="p">())</span><span class="w">
</span><span class="w">  </span><span class="n">email</span><span class="w"> </span><span class="n">String</span><span class="o">?</span><span class="w"> </span><span class="o">@</span><span class="k">unique</span><span class="w">
</span><span class="w">  </span><span class="n">name</span><span class="w">  </span><span class="n">String</span><span class="w">
</span><span class="w"></span><span class="err">}</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Multi-column uniqueness</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nx">Int</span>  <span class="err">@</span><span class="nx">id</span>
  <span class="nx">firstname</span> <span class="nx">Int</span>
  <span class="nx">lastname</span>  <span class="nx">Int</span>
  <span class="nx">card</span>      <span class="nx">Int</span><span class="o">?</span>

  <span class="err">@@</span><span class="nx">unique</span><span class="p">([</span><span class="nx">firstname</span><span class="p">,</span> <span class="nx">lastname</span><span class="p">,</span> <span class="nx">card</span><span class="p">])</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="non-null-constraints">Non-Null Constraints</h4>
<p>The default field types are all non-null, and can be null by adding <code>?</code> and you&rsquo;re done:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nx">Int</span>  <span class="err">@</span><span class="nx">id</span>
  <span class="nx">firstname</span> <span class="nx">Int</span>
  <span class="nx">lastname</span>  <span class="nx">Int</span>
  <span class="nx">card</span>      <span class="nx">Int</span><span class="o">?</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="foreign-key-constraint--relation-">foreign key constraint ( <code>@relation</code> )</h4>
<p>is a little trickier, as you need to define the mutual correspondence between the two models as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">model</span> <span class="nx">User</span> <span class="p">{</span>
  <span class="nx">id</span>        <span class="nx">Int</span>    <span class="err">@</span><span class="nx">id</span>
  <span class="nx">firstname</span> <span class="nb">String</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="nx">lastname</span>  <span class="nb">String</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="nx">Post</span>      <span class="nx">Post</span><span class="p">[]</span>
<span class="p">}</span>

<span class="nx">model</span> <span class="nx">Post</span> <span class="p">{</span>
  <span class="nx">id</span>      <span class="nx">Int</span>    <span class="err">@</span><span class="nx">id</span>
  <span class="nx">author</span>  <span class="nx">User</span>   <span class="err">@</span><span class="nx">relation</span><span class="p">(</span><span class="nx">fields</span><span class="o">:</span> <span class="p">[</span><span class="nx">userId</span><span class="p">],</span> <span class="nx">references</span><span class="o">:</span> <span class="p">[</span><span class="nx">id</span><span class="p">])</span>
  <span class="nx">content</span> <span class="nb">String</span> <span class="err">@</span><span class="nx">db</span><span class="p">.</span><span class="nx">VarChar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
  <span class="nx">userId</span>  <span class="nx">Int</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Generate sql:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;firstname&#34;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;lastname&#34;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;User_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- CreateTable
</span><span class="c1"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;Post&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;content&#34;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">    </span><span class="s2">&#34;userId&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span><span class="w">
</span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;Post_pkey&#34;</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="p">);</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c1">-- AddForeignKey
</span><span class="c1"></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;Post&#34;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="s2">&#34;Post_userId_fkey&#34;</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;userId&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="s2">&#34;User&#34;</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">RESTRICT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>There is a convenient way to quickly create such mappings, which is to use the <code>prisma format</code> function directly.</p>
<p>For example, first create a table association like Hibernate:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">model</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">  </span><span class="n">id</span><span class="w">        </span><span class="nb">Int</span><span class="w">    </span><span class="o">@</span><span class="n">id</span><span class="w">
</span><span class="w">  </span><span class="n">firstname</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="o">@</span><span class="n">db</span><span class="p">.</span><span class="nb">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span><span class="w">  </span><span class="n">lastname</span><span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="o">@</span><span class="n">db</span><span class="p">.</span><span class="nb">VarChar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="err">}</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="n">model</span><span class="w"> </span><span class="n">Post</span><span class="w"> </span><span class="err">{</span><span class="w">
</span><span class="w">  </span><span class="n">id</span><span class="w">      </span><span class="nb">Int</span><span class="w">    </span><span class="o">@</span><span class="n">id</span><span class="w">
</span><span class="w">  </span><span class="n">author</span><span class="w">  </span><span class="k">User</span><span class="w">
</span><span class="w">  </span><span class="n">content</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="o">@</span><span class="n">db</span><span class="p">.</span><span class="nb">VarChar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w">
</span><span class="w"></span><span class="err">}</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>Then execute <code>npx prisma format</code> at the command line, or install the plugin <a href="https://marketplace.visualstudio.com/items?itemName=Prisma.prisma">Prisma</a> in vscode and format it directly in vscode The above model mapping relationships are generated automatically.</p>
<p>For more definitions of mapping relations (one-to-one, one-to-many, many-to-many), please refer to the official documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-schema/relations">relations</a></p>
<h2 id="using-prisma-client">Using Prisma Client</h2>
<p>After defining the schema and completing the migrate, you need to call the schema through <code>prisma-client</code> to complete the database operations.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">npm install @prisma/client
</code></pre></td></tr></table>
</div>
</div><p>After installing <code>@prisma/client</code> for the first time, <code>prisma generate</code> will be called automatically to generate a customized client, later you need to call <code>npx prisma generate</code> manually to generate a new client model after each schema change.</p>
<p>Just introduce the <code>PrismaClient</code> component in your project:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">PrismaClient</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;@prisma/client&#34;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">prisma</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PrismaClient</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><p>To print sql you can configure it like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">prisma</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PrismaClient</span><span class="p">({</span>
  <span class="nx">log</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;query&#34;</span><span class="p">,</span> <span class="s2">&#34;info&#34;</span><span class="p">,</span> <span class="s2">&#34;warn&#34;</span><span class="p">,</span> <span class="s2">&#34;error&#34;</span><span class="p">],</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>PrismaClient uses connection pooling by default. For the configuration of connection pooling, please refer to the official documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-client/working-with-prismaclient/connection-pool">connection-pool</a></p>
<h3 id="basic-curd-operations">Basic CURD operations</h3>
<p>For detailed basic CURD operations refer directly to the official documentation for a complete example: <a href="https://www.prisma.io/docs/concepts/components/prisma-client/crud">crud</a></p>
<p>It&rsquo;s all relatively simple and easy to understand at a glance. The basic model-based CURD functions are mainly the following:</p>
<ul>
<li>findUnique</li>
<li>findFirst</li>
<li>findMany</li>
<li>create</li>
<li>update</li>
<li>upsert</li>
<li>delete</li>
<li>createMany</li>
<li>updateMany</li>
<li>deleteMany</li>
<li>count</li>
<li>aggregate</li>
<li>groupBy</li>
</ul>
<p>In addition, you can control the fields returned via the select attribute:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Returns an object or null
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">getUser</span><span class="o">:</span> <span class="nx">object</span> <span class="o">|</span> <span class="kc">null</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">findUnique</span><span class="p">({</span>
  <span class="nx">where</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">id</span><span class="o">:</span> <span class="mi">22</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">select</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">email</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">name</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>See: <a href="https://www.prisma.io/docs/concepts/components/prisma-client/select-fields">select-fields</a> for more details</p>
<p>Currently prisma does not support exclusion of specific fields (e.g. password), this design is being explored, see issue: <a href="https://github.com/prisma/prisma/issues/5042">prisma/prisma#5042</a></p>
<p>If you want to use correlation queries like <code>join</code>, you can refer to the documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-client/relation-queries">relation-queries</a></p>
<p>For <code>JSONB</code> related queries, the prisma API also has support: <a href="https://www.prisma.io/docs/concepts/components/prisma-client/working-with-">working-with-json-fields</a> fields/working-with-json-fields)</p>
<h3 id="transactional">Transactional</h3>
<p>Each basic CURD operation runs in a separate transaction (you can see the wrapper <code>BEGIN....COMMIT</code> when printing the sql), and you can also explicitly use the <code>$transaction</code> function to wrap multiple operations in a single transaction:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="p">[</span><span class="nx">posts</span><span class="p">,</span> <span class="nx">totalPosts</span><span class="p">]</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">$transaction</span><span class="p">([</span>
  <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">findMany</span><span class="p">({</span> <span class="nx">where</span><span class="o">:</span> <span class="p">{</span> <span class="nx">title</span><span class="o">:</span> <span class="p">{</span> <span class="nx">contains</span><span class="o">:</span> <span class="s2">&#34;prisma&#34;</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}),</span>
  <span class="nx">prisma</span><span class="p">.</span><span class="nx">post</span><span class="p">.</span><span class="nx">count</span><span class="p">(),</span>
<span class="p">]);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="calling-sql">Calling sql</h3>
<p>prisma provides some functions that contain the <code>Raw</code> keyword and can be used directly with sql, such as :</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">$queryRaw</span><span class="sb">`SELECT * FROM User`</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">result</span><span class="o">:</span> <span class="nx">number</span> <span class="o">=</span>
  <span class="kr">await</span> <span class="nx">prisma</span><span class="p">.</span><span class="nx">$executeRaw</span><span class="sb">`UPDATE User SET active = true WHERE emailValidated = true`</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>All functions that call sql directly can be found in the official documentation: <a href="https://www.prisma.io/docs/concepts/components/prisma-client/raw-database-access">raw-database-access</a></p>
<h2 id="extended-reading">Extended Reading</h2>
<ul>
<li><a href="https://www.prisma.io/blog/backend-prisma-typescript-orm-with-postgresql-data-modeling-tsjs1ps7kip1">Backend with TypeScript PostgreSQL &amp; Prisma: Data Modeling &amp; CRUD</a></li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/prisma/">prisma</a>
          <a href="/tags/nodejs/">nodejs</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/multiple-electron-instances-indexeddb-domexception/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Electron application multiple open indexedDB open exception problem analysis and solution</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/the-interface-is-not-that-interface-in-go-1-18/">
            <span class="next-text nav-default">Go generic programming: interface is no longer the interface</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
