<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>A detailed explanation of email port numbers - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="E-mail (E-mail) is one of the oldest protocols on the Internet, but it is also the most widely used communication protocol today. For historical reasons, e-mail uses many different protocols and each protocol uses a different TCP port, which greatly increases the difficulty of setting up e-mail and is very unfriendly to users who do not know computer expertise. Today, we will introduce the relevant protocols and ports systematically, and try to clear the obstacles for novice users." /><meta name="keywords" content="email, Ports" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/email-ports/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="A detailed explanation of email port numbers" />
<meta property="og:description" content="E-mail (E-mail) is one of the oldest protocols on the Internet, but it is also the most widely used communication protocol today. For historical reasons, e-mail uses many different protocols and each protocol uses a different TCP port, which greatly increases the difficulty of setting up e-mail and is very unfriendly to users who do not know computer expertise. Today, we will introduce the relevant protocols and ports systematically, and try to clear the obstacles for novice users." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/email-ports/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-12T13:53:22+08:00" />
<meta property="article:modified_time" content="2022-01-12T13:53:22+08:00" />

<meta itemprop="name" content="A detailed explanation of email port numbers">
<meta itemprop="description" content="E-mail (E-mail) is one of the oldest protocols on the Internet, but it is also the most widely used communication protocol today. For historical reasons, e-mail uses many different protocols and each protocol uses a different TCP port, which greatly increases the difficulty of setting up e-mail and is very unfriendly to users who do not know computer expertise. Today, we will introduce the relevant protocols and ports systematically, and try to clear the obstacles for novice users."><meta itemprop="datePublished" content="2022-01-12T13:53:22+08:00" />
<meta itemprop="dateModified" content="2022-01-12T13:53:22+08:00" />
<meta itemprop="wordCount" content="1686">
<meta itemprop="keywords" content="email," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="A detailed explanation of email port numbers"/>
<meta name="twitter:description" content="E-mail (E-mail) is one of the oldest protocols on the Internet, but it is also the most widely used communication protocol today. For historical reasons, e-mail uses many different protocols and each protocol uses a different TCP port, which greatly increases the difficulty of setting up e-mail and is very unfriendly to users who do not know computer expertise. Today, we will introduce the relevant protocols and ports systematically, and try to clear the obstacles for novice users."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">A detailed explanation of email port numbers</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-12 13:53:22 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1686 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents"></nav>
  </div>
</div>
    <div class="post-content">
      <p>E-mail (E-mail) is one of the oldest protocols on the Internet, but it is also the most widely used communication protocol today. For historical reasons, e-mail uses many different protocols and each protocol uses a different TCP port, which greatly increases the difficulty of setting up e-mail and is very unfriendly to users who do not know computer expertise. Today, we will introduce the relevant protocols and ports systematically, and try to clear the obstacles for novice users.</p>
<p>The essence of email is still email. To figure out how email works, we need to first sort out how the post office üè£ works in our life. In the West or in our cities, every household has a mailbox. It&rsquo;s a real box, usually with a key üîë. Suppose <code>Kevin</code> wants to send a letter to <code>Tony</code> and he needs to drop it off at the nearest post office A. After the post office receives the letter, it will be delivered to Post Office B, which is near Tony&rsquo;s home. Post Office B then sends a letter carrier to deliver the letter to <code>Tony</code>s home mailbox. Tony checks his mailbox when he gets home from work and finds a letter from Kevin. Drawn as a diagram, it looks like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">[Kevin] ----&gt; [Post Office A] ----&gt; [Post Office B] -+
                                    |
[Tony] ----&gt; [Tony Mailbox] &lt;-------------+
</code></pre></td></tr></table>
</div>
</div><p>If <code>Kevin</code> had not gone to the post office but dropped it at a nearby post box, the whole process would have looked like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">[Kevin] ----&gt; [Mailbox] &lt;---- [Post Office A] --+
                                   |
[Tony] ----&gt; [Mailbox] &lt;---- [Post Office B] &lt;-+
</code></pre></td></tr></table>
</div>
</div><p>For the user, sending and receiving is an active act. <code>Kevin</code> needs to take the initiative to send letters, and <code>Tony</code> needs to take the initiative to check his mailbox. The post office generally only docks with the post office. In other words, post office A only needs to send the letter to post office B according to the address after receiving it (it may transit through several post offices in between), but it does not need to send the letter to <code>Tony</code> directly. If we consider <code>Tony</code>&rsquo;s mailbox as part of post office B, then post office B does not need to deal with <code>Tony</code> directly, but just put the letter into <code>Tony</code>&rsquo;s mailbox.</p>
<p>Email simply moves the above process to the Internet. Post office A and post office B become mail service providers like Gmail or Outlook, mailboxes or mailboxes become mail clients, and residential addresses become email addresses.</p>
<p>The whole process becomes something like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">[Kevin] --&gt; [Client] &lt;----SMTP---- [Gmail] ----+
                                            | SMTP 
[Tony] --&gt; [Client] &lt;--IMAP/POP-- [Outlook] &lt;-+
</code></pre></td></tr></table>
</div>
</div><p>The technical term of the client here is Mail User Agent (MUA). There are various MUA software in the market, such as Microsoft Outlook, Apple Mail, Tencent Foxmail, Mozilla Thnuderbird and so on. Nowadays, the mainstream operating systems such as Windows/Macos/iOS/Android etc. have built-in MUA software.</p>
<p>MUA can only communicate with its own mail service provider. Sending mail uses SMTP protocol and receiving mail uses IMAP or POP protocol. The SMTP protocol is also used to transfer emails between service providers. Different protocols use different TCP ports.</p>
<table>
<thead>
<tr>
<th>protocol</th>
<th>port</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SMTP</td>
<td>25</td>
<td>Simple Mail Transfer Protocol</td>
</tr>
<tr>
<td>POP</td>
<td>110</td>
<td>Post Office Protocol</td>
</tr>
<tr>
<td>IMAP</td>
<td>143</td>
<td>Internet Message Access Protocol</td>
</tr>
</tbody>
</table>
<p>In the earliest days there was only SMTP protocol, the Simple Mail Transfer Protocol, which used port 25 of TCP. If <code>Kevin</code> wants to send an email to <code>Tony</code>, he needs to use a client on his computer. After the client connects to Gmail via SMTP and completes authentication, it receives the letter <code>Kevin</code> writes to <code>Tony</code> and then tries to send it to <code>Tony</code>&rsquo;s service provider, Outlook.</p>
<p>How does Gmail find <code>Tony</code>s service provider? This requires the DNS protocol. An email address has two parts: a username and a domain name. Suppose the email addresses of <code>Kevin</code> and <code>Tony</code> are <code>kevin@gmail.com</code> and <code>tony@outlook.com</code> respectively. Where <code>@</code> preceded by <code>kevin</code> and <code>tony</code> is the user name, followed by <code>gmail.com</code> and <code>outlook.com</code> is the domain name.</p>
<p>Gmail receives the letter from <code>Kevin</code> and finds that it is addressed to <code>tony@outlook.com</code>, so it looks up the mail server address of the <code>outlook.com</code> domain through the DNS system. This is done using what is called an <code>MX</code> record, which stands for <strong>Mail Exchange</strong>.</p>
<p>At the time of my writing, the mail server for <code>outlook.com</code> is.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">outlook-com.olc.protection.outlook.com
</code></pre></td></tr></table>
</div>
</div><p>The <code>gmail.com</code>&rsquo;s are.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">gmail-smtp-in.l.google.com
alt1.gmail-smtp-in.l.google.com
alt2.gmail-smtp-in.l.google.com
alt3.gmail-smtp-in.l.google.com
alt4.gmail-smtp-in.l.google.com
</code></pre></td></tr></table>
</div>
</div><p>To ensure that emails are sent and received reliably, generally service providers set up multiple groups of servers, each with different weights. In the example above, we only checked one server. So Gmail will try to connect to port 25 of this server. When the connection is successful, it transfers <code>Kevin</code>s letter to Outlook&rsquo;s server.</p>
<p>If <code>Tony</code> opens his client sometime later, the MUA will use POP or IMAP protocol to connect to Outlook&rsquo;s server and check if there are new emails. There are two problems with doing this. One is that downloading all emails may consume time and traffic, because emails may contain attached contents such as pictures. Second, deleting server-side emails may cause content loss (of course, many service providers can now set up to prevent MUA from deleting copies of emails on the server). In view of this, IMAP protocol has been designed to solve these two problems of POP. With IMAP protocol, you can directly view the sender, subject and other information of emails, instead of downloading the complete email content. Nowadays, the mainstream service providers generally support both POP and IMAP protocols.</p>
<p>POP protocol uses port 110 and IMAP protocol uses port 143.</p>
<p>Well, so far we have covered three ports: SMTP uses port 25, POP uses port 110, and IMAP uses port 143. All of these ports use plaintext to transmit data. This means that the communication is not encrypted and anyone with an ulterior motive can listen to or even tamper with the content of your incoming and outgoing emails! The Internet was designed in its early days by a group of people who &ldquo;thought there were no bad guys in the world&rdquo;.</p>
<p>With the development of the Internet, there are more and more bad guys. People had to start thinking about the security of e-mail. The SSL protocol, Secure Sockets Layer, was designed to encrypt TCP communications. TLS has gone through four versions, 1.0/1.1/1.2/1.3.</p>
<p>However, the problem was that the original ports 25/110/143 were using plaintext communication and could not be directly replaced by SSL/TLS encrypted communication, otherwise the existing clients would have problems. So three ports were reassigned, 465/995/993, through which the client could communicate with the server, and the content had to be encrypted using SSL/TLS.</p>
<p>Port 443 was also assigned to port 80 of the HTTP protocol, along with many other ports. It was immediately clear that there was a problem with this approach, as there were only 1024 well-known ports, and this approach was quickly exhausted. So everyone said that the previously assigned ports were no longer counted and were withdrawn. Each protocol negotiated the use of an encryption protocol on its own plaintext ports, which is called the STARTTLS protocol. What do you mean by renegotiation? Take SMTP for example, the sender first assumes that the receiver is using plaintext communication, so it connects directly to the other side on port 25</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">S: &lt;Listening on TCP port 25&gt;
C: &lt;Establishing a TCP connection&gt;
S: 220 mail.imc.org SMTP service ready
C: EHLO mail.ietf.org
S: 250-mail.imc.org offers a warm hug of welcome
S: 250 STARTTLS
C: STARTTLS
S: 220 Go ahead
C: &lt;starts TLS negotiation&gt;
C &amp; S: &lt;negotiate a TLS session&gt;
C &amp; S: &lt;check result of negotiation&gt;
C: &lt;continues by sending an SMTP command&gt;
. . .
</code></pre></td></tr></table>
</div>
</div><p>Here, after sender C sends EHLO command, receiver S returns 250 STARTTLS, indicating that TLS encryption is supported. So C sends STARTTLS to indicate that TLS negotiation will be done next. When the negotiation is completed, the email data is transmitted using the encrypted channel.</p>
<p>The advantage of using STARTTLS is that it can support both plaintext and encrypted communication on one port. In terms of security, it is not fundamentally different from the dedicated TLS port approach described earlier.</p>
<p>Another special case here is SMTP protocol, which was first used to exchange emails between service providers. When users send emails, MUA also uses SMTP to submit emails, also on port 25. Because many people use ISP&rsquo;s IP address to send spam in the early days, many ISPs will disable port 25. This prevented the user&rsquo;s MUA from communicating properly with the server. For this reason, port 587 was introduced for communication between MUA and server. Of course, this port also supports STARTTLS encryption.</p>
<p>However, by the time people decided to promote STARTTLS, a large number of service providers and client software already supported sending and receiving mail using the previous SSL/TLS port. You couldn&rsquo;t ask all software to update to the new standard. Over time, it was realized that the port issue was not the main conflict, and that the most important thing was to promote TLS encryption. So in 2018 <a href="https://datatracker.ietf.org/doc/html/rfc8314">RFC8314</a> was passed to allow communication using both STARTTLS and TLS. Any protocol that is encrypted is a good protocol.</p>
<p>So, by now we have the following table.</p>
<table>
<thead>
<tr>
<th>protocol</th>
<th>SSL/TLS port</th>
<th>STARTTLS port</th>
</tr>
</thead>
<tbody>
<tr>
<td>SMTP</td>
<td>465</td>
<td>587</td>
</tr>
<tr>
<td>POP</td>
<td>995</td>
<td>110</td>
</tr>
<tr>
<td>IMAP</td>
<td>993</td>
<td>143</td>
</tr>
</tbody>
</table>
<p>Nowadays, the mainstream email service providers basically no longer allow the use of clear-text ports for communication. When setting up an email client, you must specify what protocol the server is using. Generally, IMAP protocol uses port 993, and you need to check SSL or TLS encryption. Some service providers also support POP protocol, which uses port 995 and needs to check SSL or TLS encryption. For SMTP protocol, some use port 465 (such as Google) and need to set SSL or TLS encryption; some use port 587 (such as Microsoft) and need to set STARTTLS encryption.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/email/">email</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/url-design/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Website URL design is not simple</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/kotlin-coroutine-cps/">
            <span class="next-text nav-default">CPS transformations for Kotlin Coroutine</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
