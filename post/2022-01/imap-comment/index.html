<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Develop website message function based on IMAP mailbox - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="The site has been online for a few months now and there has been no message function. A friend suggested adding a message or discussion support. My earliest thought was that leaving a message is a very low frequency operation, and I also left my email address on my personal page. If a friend really needs to discuss a problem, he or she can send an email. But the actual" /><meta name="keywords" content="imap, Comment" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/imap-comment/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Develop website message function based on IMAP mailbox" />
<meta property="og:description" content="The site has been online for a few months now and there has been no message function. A friend suggested adding a message or discussion support. My earliest thought was that leaving a message is a very low frequency operation, and I also left my email address on my personal page. If a friend really needs to discuss a problem, he or she can send an email. But the actual" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/imap-comment/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-05T11:39:58+08:00" />
<meta property="article:modified_time" content="2022-01-05T11:39:58+08:00" />

<meta itemprop="name" content="Develop website message function based on IMAP mailbox">
<meta itemprop="description" content="The site has been online for a few months now and there has been no message function. A friend suggested adding a message or discussion support. My earliest thought was that leaving a message is a very low frequency operation, and I also left my email address on my personal page. If a friend really needs to discuss a problem, he or she can send an email. But the actual"><meta itemprop="datePublished" content="2022-01-05T11:39:58+08:00" />
<meta itemprop="dateModified" content="2022-01-05T11:39:58+08:00" />
<meta itemprop="wordCount" content="1615">
<meta itemprop="keywords" content="imap," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Develop website message function based on IMAP mailbox"/>
<meta name="twitter:description" content="The site has been online for a few months now and there has been no message function. A friend suggested adding a message or discussion support. My earliest thought was that leaving a message is a very low frequency operation, and I also left my email address on my personal page. If a friend really needs to discuss a problem, he or she can send an email. But the actual"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Develop website message function based on IMAP mailbox</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-05 11:39:58 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1615 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents"></nav>
  </div>
</div>
    <div class="post-content">
      <p>The site has been online for a few months now and there has been no message function. A friend suggested adding a message or discussion support. My earliest thought was that leaving a message is a very low frequency operation, and I also left my email address on my personal page. If a friend really needs to discuss a problem, he or she can send an email. But the actual situation is that using email is relatively rare and inconvenient. The common disadvantage of Disqus and Github is that they require registration and have certain privacy risks. I wanted to find a system that supports anonymous comments, and finally found isso. isso uses sqlite to save comment data, supports anonymous comments, and fits my needs in every way. However, it was developed in python, which made it very cumbersome to deploy. Finally, I came up with a rather tricky solution: a simple message board based on IMAP mailbox. Today, I&rsquo;ll put together the ideas and solutions and share them with you.</p>
<p>The comment or message system is also very complex to make complete. Like tree structure, building in building, multi-level replies, likes, etc. But as a blog comment system, is it really necessary to do so complicated? I think not. The core function of a blog commenting system is to provide a communication channel for readers and authors, to establish a connection between readers and authors. Therefore, how to display comments, whether to support quotes and replies are in the secondary. The core function is that readers' messages can be received by authors as soon as possible, and authors can easily reply to readers' questions. From this point of view, there is no big problem in using email to communicate. But, after all, email is not commonly used in China, so we need to find ways to lower the threshold of using messages. For this reason, I hit on the idea of IMAP in the mail system.</p>
<p>Those who know about email must have heard of the terms SMTP/POP/IMAP. Simply speaking, SMTP is used to send emails and POP/IMAP to view emails. The emails sent by others to your email address are saved on the server, and you can configure the client of your cell phone or computer to view the contents of emails. POP protocol can only download emails from the server, while IMAP protocol is more complicated, not only can download, but also upload! What ü§î can be uploaded? The Apple system&rsquo;s notes software supports saving notes to the mail server, using the IMAP upload function. Then can we upload users' messages to mailboxes via IMAP as well?</p>
<p>So I started to study the IMAP protocol. It&rsquo;s a complex protocol, to be fair. Instead of looking into the protocol itself, I tried searching for a Go language IMAP protocol library. I found <a href="https://github.com/emersion/go-imap">go-imap</a>. go-imap&rsquo;s Client object supports uploading emails to an IMAP server via the <a href="https://pkg.go.dev/github.com/emersion/go-imap@v1.2.0/client#Client.Append"><code>Append()</code></a> method to upload emails to the IMAP server. After uploading, the effect is equivalent to receiving a new email and the client will be alerted. Example code is directly attached to the documentation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="s">&#34;github.com/emersion/go-imap/client&#34;</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// ÁôªÂΩï IMAP ÊúçÂä°Âô®
</span><span class="c1"></span>	<span class="nx">c</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">client</span><span class="p">.</span><span class="nf">DialTLS</span><span class="p">(</span><span class="s">&#34;mail.example.org:993&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span> <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">}</span>
	<span class="k">defer</span> <span class="nx">c</span><span class="p">.</span><span class="nf">Logout</span><span class="p">()</span>
	<span class="nx">err</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nf">Login</span><span class="p">(</span><span class="s">&#34;username&#34;</span><span class="p">,</span> <span class="s">&#34;password&#34;</span><span class="p">)</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span> <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">}</span>
  <span class="c1">// ÊûÑÈÄ†ÈÇÆ‰ª∂ÂÜÖÂÆπ
</span><span class="c1"></span>  <span class="kd">var</span> <span class="nx">b</span> <span class="nx">bytes</span><span class="p">.</span><span class="nx">Buffer</span>
  <span class="nx">b</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;From: &lt;root@nsa.gov&gt;\r\n&#34;</span><span class="p">)</span>
  <span class="nx">b</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;To: &lt;root@gchq.gov.uk&gt;\r\n&#34;</span><span class="p">)</span>
  <span class="nx">b</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;Subject: Hey there\r\n&#34;</span><span class="p">)</span>
  <span class="nx">b</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;\r\n&#34;</span><span class="p">)</span>
  <span class="nx">b</span><span class="p">.</span><span class="nf">WriteString</span><span class="p">(</span><span class="s">&#34;Hey &lt;3&#34;</span><span class="p">)</span>
  <span class="c1">// ‰∏ä‰º†ÈÇÆ‰ª∂Âà∞Êî∂‰ª∂ÁÆ± INBOX
</span><span class="c1"></span>  <span class="nx">err</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="s">&#34;INBOX&#34;</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Now</span><span class="p">(),</span> <span class="o">&amp;</span><span class="nx">b</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The whole process is relatively simple and will not be repeated. However, the second step of constructing the content of the email needs to be modified. The email content in the example is in English.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">From: &lt;root@nsa.gov&gt;\r\n
To: &lt;root@gchq.gov.uk&gt;\r\n
Subject: Hey there\r\n
\r\n
Hey &lt;3
</code></pre></td></tr></table>
</div>
</div><p>Where From, To and Subject are all specified, corresponding to sender, recipient and email subject. Because the email protocol was invented by Americans, it did not support Chinese in the early days, and even many western European characters were not supported. In order to solve this problem, people introduced MIME protocol, which is called Multipurpose Internet Mail Extensions, a kind of protocol provision for extending emails, through which we can add HTML tables, pictures, Chinese and even file attachments to emails. The following is a MIME message with Chinese characters.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">Mime-Version: 1.0
From: =?utf-8?q?=E5=BC=A0=E4=B8=89?= &lt;z3@foo.com&gt;
Subject: =?utf-8?b?5YWz5LqO5rab5Y+U?=
To: &lt;hi@taoshu.in&gt;
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Date: Fri, 05 Nov 2021 05:52:37 +0000

=E4=BD=A0=E5=A5=BD

https://taoshu.in/about.html
</code></pre></td></tr></table>
</div>
</div><p>Notice that there is an additional Mime-Version header to specify the MIME protocol version. With this field, it means this is a MIME message.</p>
<p>The following From field seems to be garbled</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">=?utf-8?q?=E5=BC=A0=E4=B8=89?=
</code></pre></td></tr></table>
</div>
</div><p>Don&rsquo;t be afraid. It begins and ends with <code>=? </code> and <code>? =</code>, you can ignore them. The first question mark followed by utf-8 means that the content after it is in utf-8 encoding. The <code>?q?</code> after the first question mark means that the content is in quote encoding. quote encoding is the conversion of each byte of the content into a corresponding hexadecimal string. For example, the utf-8 encoding of &ldquo;Zhang San&rdquo; is <code>0xE5BCA0E4B889</code>, so the conversion to quote encoding is <code>=E5=BC=A0=E4=B8=89</code>. The equal sign here is specified by MIME. Some places also use the percentage sign.</p>
<p>Look at the Subject field. utf-8 is followed by <code>?b?</code>, which means that the content after it has been processed in base64 encoding. The rest of the fields without Chinese are no different from the previous English emails. The following is the Content-Type and Content-Transfer-Encoding. This part is very similar to the HTTP protocol, which specifies the encoding format and transmission format of the email body. The Content-Type is <code>text/plain; charset=utf-8</code>, which means the body is plain text in utf-8 encoding. And Content-Transfer-Encoding is quoted-printable, which means that the body of the message will be converted to quote encoding.</p>
<p>This is the general principle of using email to send non-ASCII content. We certainly don&rsquo;t need to handle such complex encoding operations ourselves. I found an open source library <a href="https://github.com/jhillyerd/enmime">enmime</a> and the whole process was simplified to</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">m</span> <span class="o">:=</span> <span class="nx">enmime</span><span class="p">.</span><span class="nf">Builder</span><span class="p">().</span>
  <span class="nf">From</span><span class="p">(</span><span class="s">&#34;Âº†‰∏â&#34;</span><span class="p">,</span> <span class="s">&#34;z3@foo.com&#34;</span><span class="p">).</span>
  <span class="nf">To</span><span class="p">(</span><span class="s">&#34;Ê∂õÂèî&#34;</span><span class="p">,</span> <span class="s">&#34;hi@taoshu.in&#34;</span><span class="p">).</span>
  <span class="nf">Subject</span><span class="p">(</span><span class="s">&#34;ÈÇÆ‰ª∂ÊëòË¶Å&#34;</span><span class="p">).</span>
  <span class="nf">Text</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;ÈÇÆ‰ª∂Ê≠£Êñá&#34;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>I have combined go-imap with enmime to enable emailing myself <strong>via imap protocol</strong> (comment).</p>
<p>Finally we prepare a form to receive the content of the user&rsquo;s message, with the following fields</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">form</span> <span class="na">onsubmit</span><span class="o">=</span><span class="s">&#34;event.preventDefault(); reply()&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;content&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;ÁïôË®Ä&#34;</span> <span class="na">required</span><span class="p">&gt;&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;email&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;email&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;ÈÇÆÁÆ±ÔºàÂèØÈÄâÔºâ&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;name&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;ÂêçÂ≠óÔºàÂèØÈÄâÔºâ&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;submit&#34;</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;Êèê‰∫§&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The form is submitted using AJAX with the following source code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">reply</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
  <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">&#34;subject&#34;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">);</span>
  <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/+/mail&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
    <span class="nx">body</span><span class="o">:</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">(</span><span class="nx">data</span><span class="p">),</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">resp</span> <span class="p">=&gt;</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;ÁïôË®ÄÊèê‰∫§ÊàêÂäü&#34;</span><span class="p">))</span>
  <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span> <span class="p">=&gt;</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;Êé•Âè£Êä•ÈîôÔºö&#34;</span><span class="o">+</span><span class="nx">error</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>When the server receives the data submitted by the user, it automatically generates a MIME email and then uploads it to the inbox via IMAP. This way I can receive the notification at the first time. If the user himself left an email address, I can also directly reply to the email.</p>
<p>The above is all about using IMAP to implement message board. The code is also published to <a href="https://github.com/epii1/ssltun">GitHub</a>. You can leave me a message now. This approach does not require you to register an account, which is especially friendly to those who pay special attention to privacy protection. And, more importantly, when the author can receive messages by configuring the email client, in learning convenience. But this way does not support real-time display of user comments, which is a pity. However, I think the comments of the blog should be mainly to serve the communication between readers and authors, and the discussion between readers should not be the main conflict. Let&rsquo;s go online first and see the effect. Another advantage of not showing real-time comment content is to dissuade those who want to send advertising messages. Because they can&rsquo;t see it, there is no need to send it.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/imap/">imap</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/systemd-socket-activation/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Use systemd to listen to the service port</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/vim-search-plugin/">
            <span class="next-text nav-default">Developing a simple Vim search plugin</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
