<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Everything you need to know about Promise - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Promise is one of the best APIs for asynchronous operations in JavaScript. As a JavaScript developer, you need to be proficient in Promise. This article will summarise this knowledge, starting with a review of how JavaScript has handled asynchronous operations in the past? Then we&amp;rsquo;ll go into detail about the Promises object and its associated methods. Let&amp;rsquo;s start with a look at JavaScript asynchronous concepts. Asynchronous What is asynchronous? A" /><meta name="keywords" content="javascript, Promise" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/promise/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Everything you need to know about Promise" />
<meta property="og:description" content="Promise is one of the best APIs for asynchronous operations in JavaScript. As a JavaScript developer, you need to be proficient in Promise. This article will summarise this knowledge, starting with a review of how JavaScript has handled asynchronous operations in the past? Then we&rsquo;ll go into detail about the Promises object and its associated methods. Let&rsquo;s start with a look at JavaScript asynchronous concepts. Asynchronous What is asynchronous? A" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/promise/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-13T13:35:03+08:00" />
<meta property="article:modified_time" content="2022-01-13T13:35:03+08:00" />

<meta itemprop="name" content="Everything you need to know about Promise">
<meta itemprop="description" content="Promise is one of the best APIs for asynchronous operations in JavaScript. As a JavaScript developer, you need to be proficient in Promise. This article will summarise this knowledge, starting with a review of how JavaScript has handled asynchronous operations in the past? Then we&rsquo;ll go into detail about the Promises object and its associated methods. Let&rsquo;s start with a look at JavaScript asynchronous concepts. Asynchronous What is asynchronous? A"><meta itemprop="datePublished" content="2022-01-13T13:35:03+08:00" />
<meta itemprop="dateModified" content="2022-01-13T13:35:03+08:00" />
<meta itemprop="wordCount" content="3818">
<meta itemprop="keywords" content="javascript," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Everything you need to know about Promise"/>
<meta name="twitter:description" content="Promise is one of the best APIs for asynchronous operations in JavaScript. As a JavaScript developer, you need to be proficient in Promise. This article will summarise this knowledge, starting with a review of how JavaScript has handled asynchronous operations in the past? Then we&rsquo;ll go into detail about the Promises object and its associated methods. Let&rsquo;s start with a look at JavaScript asynchronous concepts. Asynchronous What is asynchronous? A"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Everything you need to know about Promise</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-13 13:35:03 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 3818 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#asynchronous">Asynchronous</a>
          <ul>
            <li><a href="#asynchronous-callbacks">Asynchronous callbacks</a></li>
            <li><a href="#how-promise-works">How Promise works</a></li>
          </ul>
        </li>
        <li><a href="#promiseany">Promise.any()</a>
          <ul>
            <li><a href="#1-how-it-works">1. How it works</a></li>
            <li><a href="#2-usage-guidelines">2. Usage Guidelines</a></li>
            <li><a href="#summary">Summary</a></li>
          </ul>
        </li>
        <li><a href="#promiseall">Promise.all()</a>
          <ul>
            <li><a href="#1-how-it-works-1">1. How it works</a></li>
            <li><a href="#2-usage-guidelines-1">2. Usage Guidelines</a></li>
            <li><a href="#summary-1">Summary</a></li>
          </ul>
        </li>
        <li><a href="#promiseallsettled">Promise.allSettled()</a>
          <ul>
            <li><a href="#1-how-it-works-2">1. How it works</a></li>
            <li><a href="#2-usage-guidelines-2">2. Usage Guidelines</a></li>
            <li><a href="#summary-2">Summary</a></li>
          </ul>
        </li>
        <li><a href="#promiserace">Promise.race()</a>
          <ul>
            <li><a href="#1-how-it-works-3">1. How it works</a></li>
            <li><a href="#2-usage-guidelines-3">2. Usage Guidelines</a></li>
            <li><a href="#3-usage-scenarios">3. Usage scenarios</a></li>
            <li><a href="#summary-3">Summary</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><code>Promise</code> is one of the best APIs for asynchronous operations in JavaScript. As a JavaScript developer, you need to be proficient in <code>Promise</code>. This article will summarise this knowledge, starting with a review of how JavaScript has handled asynchronous operations in the past? Then we&rsquo;ll go into detail about the Promises object and its associated methods.</p>
<p>Let&rsquo;s start with a look at JavaScript asynchronous concepts.</p>
<h2 id="asynchronous">Asynchronous</h2>
<p>What is asynchronous? A function is asynchronous if the expected result is not yet available to the caller when the function returns, but will be available in the future by some means (e.g. a callback function).</p>
<h3 id="asynchronous-callbacks">Asynchronous callbacks</h3>
<p>Asynchronous callbacks, commonly known as <code>callbacks</code>, were a common way of handling asynchronous operations in JavaScript in the past, such as AJAX, where an HTTP request was initiated and the exact time when the server returned the response data depended on the client&rsquo;s environment and there was a lot of uncertainty, when a callback function was used to trigger the callback function when the response data was returned.</p>
<p>This approach is common when there are multiple requests and subsequent requests need to wait for the response data of the previous request when the callback hell occurs.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">asyncMessage</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
        <span class="nx">callback</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">};</span>

<span class="nx">asyncMessage</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">asyncMessage</span><span class="p">(</span><span class="s2">&#34;cate&#34;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">asyncMessage</span><span class="p">(</span><span class="s2">&#34;content&#34;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;detail&#34;</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The presence of callback hell will cause many problems for project development.</p>
<ul>
<li>It will lead to confusing logic, high coupling, one change will lead to all changes, and when nested, bugs are difficult to find.</li>
<li>You can&rsquo;t use <code>try.... .catch</code> to catch exceptions.</li>
<li>Can&rsquo;t use <code>return</code> to return real data</li>
</ul>
<p>To avoid callback hell, the <code>Promise</code> object was created.</p>
<h3 id="how-promise-works">How Promise works</h3>
<p>A <code>promise</code> object is an object that can be returned synchronously from an asynchronous function and will be in one of 3 possible states.</p>
<ul>
<li><code>fulfilled</code>: <code>onFulfilled()</code> will be called, i.e. the operation is complete (e.g. <code>resolve()</code> is called)</li>
<li><code>rejected</code>: <code>onRejected()</code> will be called, i.e. the operation has failed (e.g. <code>reject()</code> is called)</li>
<li><code>pending</code>: initial state, neither honoured nor rejected</li>
</ul>
<p>If a <code>promise</code> does not hang (it has been resolved or rejected), it will be resolved. Sometimes resolved and resolved are used to indicate the same thing: not <code>pending</code>.</p>
<p>Once a <code>promise</code> has been determined, it cannot be redetermined, and calling <code>resolve()</code> or <code> reject()</code> again will have no effect. A determined <code>promise</code> has immutability.</p>
<p>For monitoring the state of a <code>promise</code> you can use a promise chain, i.e. in the <code>fulfilled</code> honoured state you can use the <code>then</code> method to get the honoured result, and in the <code>rejected</code> rejected state you can use the <code>catch</code> method to get the reason for the rejection.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">myPromise</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">myExecutorFunc</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handleFulfilledA</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handleFulfilledB</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">handleFulfilledC</span><span class="p">)</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">handleRejectedAny</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>It looks a little more elegant than the <code>callback</code> approach, and for needs that require multiple HTTP requests to be initiated for complete rendering, the code looks like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">getPost</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;https://jsonplaceholder.typicode.com/posts/1&#34;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">getAuthor</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;https://jsonplaceholder.typicode.com/users/&#34;</span> <span class="o">+</span> <span class="nx">id</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">getComment</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">=&gt;</span>
    <span class="nx">fetch</span><span class="p">(</span><span class="s2">&#34;https://jsonplaceholder.typicode.com/users/&#34;</span> <span class="o">+</span> <span class="nx">id</span><span class="p">);</span>

<span class="nx">getPost</span><span class="p">()</span> <span class="c1">// #1.fetch post
</span><span class="c1"></span>    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">postResponse</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">postResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span> <span class="c1">// #2. get &amp; return post json
</span><span class="c1"></span>    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">postResponse</span><span class="p">)</span> <span class="p">=&gt;</span>
        <span class="nx">getAuthor</span><span class="p">(</span><span class="nx">postResponse</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="c1">// #3. fetch author
</span><span class="c1"></span>            <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">authorResponse</span><span class="p">)</span> <span class="p">=&gt;</span>
                <span class="nx">authorResponse</span>
                    <span class="p">.</span><span class="nx">json</span><span class="p">()</span> <span class="c1">// #4 get &amp; return author json
</span><span class="c1"></span>                    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">authorResponse</span><span class="p">)</span> <span class="p">=&gt;</span>
                        <span class="nx">getComment</span><span class="p">(</span><span class="nx">postResponse</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="c1">// #5 fetch comment
</span><span class="c1"></span>                            <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">commentResponse</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">commentResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span> <span class="c1">// #6 get &amp; return comment json
</span><span class="c1"></span>                            <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">commentResponse</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
                                <span class="c1">// #7 time to combine all results
</span><span class="c1"></span>                                <span class="k">return</span> <span class="p">{</span>
                                    <span class="nx">postResponse</span><span class="p">,</span>
                                    <span class="nx">authorResponse</span><span class="p">,</span>
                                    <span class="nx">commentResponse</span><span class="p">,</span>
                                <span class="p">};</span> <span class="c1">// #8 combine &amp; return all reponses
</span><span class="c1"></span>                            <span class="p">})</span>
                    <span class="p">)</span>
            <span class="p">)</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">results</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="c1">// #9 read all responses
</span><span class="c1"></span>                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">.</span><span class="nx">postResponse</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">.</span><span class="nx">authorResponse</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">results</span><span class="p">.</span><span class="nx">commentResponse</span><span class="p">);</span>
            <span class="p">})</span>
    <span class="p">)</span>
    <span class="p">.</span><span class="k">catch</span><span class="p">((</span><span class="nx">error</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">));</span> <span class="c1">// # 10 error handling
</span></code></pre></td></tr></table>
</div>
</div><p>Does the above code feel like déjà vu, originally intended to solve callback hell, but there seems to be a gap between the ideal and the reality.</p>
<p>So ES2021 adds new features to the Promise object, including: <code>Promise.any()</code>, <code>Promise.all()</code>, <code>Promise.allSettled()</code>, and <code>Promise.race()</code>.</p>
<h2 id="promiseany">Promise.any()</h2>
<p><code>Promise.any(promises)</code> runs <code>promise</code> in parallel and resolves to the value of the first successfully resolved <code>promise</code> in the list of <code>promises</code>. Note that the <code>Promise.any() </code> method is still experimental and is not fully supported by all browsers.</p>
<p>Here is a look at how <code>Promise.any()</code> works.</p>
<h3 id="1-how-it-works">1. How it works</h3>
<p><code>Promise.any()</code> can be used to perform independent asynchronous operations in a parallel and competitive manner to get the value of any first completed <code>promise</code>.</p>
<p>The function accepts an <code>promise</code> array (usually an iterable object) as an argument, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">anyPromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">any</span><span class="p">(</span><span class="nx">promises</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>When the first <code>promise</code> in the input <code>promises</code> is executed, <code>anyPromise</code> is immediately resolved to the value of that <code>promise</code>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/17039b37c45045e586f70651701e711a.png" alt="image"></p>
<p>The value of the first <code>promise</code> can be extracted using the <code>then</code> method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">anyPromise</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">firstValue</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">firstValue</span><span class="p">;</span> <span class="c1">// 第一个 promise 完成后返回的值
</span><span class="c1"></span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>async/await</code> syntax can also be used.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">firstValue</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">anyPromise</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">firstValue</span><span class="p">);</span> <span class="c1">// 第一个 promise 完成后返回的值
</span></code></pre></td></tr></table>
</div>
</div><p>The <code>promise</code> returned by <code>romise.any()</code> is executed together with any first <code>promise</code> that is executed. Even if some <code>promise</code>s are <code>rejected</code>, these <code>rejections</code> will be ignored.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/d0ef1ffb876c46ac945d6608119115b9.png" alt="image"></p>
<p>However, if all <code>promises</code> in the input array are rejected, or if the input array is empty, then <code> Promise.any()</code> will <code>rejected</code> contain the set of <code>rejection</code> error reasons for the execution of the input <code>promises</code>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/84f78d1cf6804d40953517e47c2d6eea.png" alt="image"></p>
<h3 id="2-usage-guidelines">2. Usage Guidelines</h3>
<p>Before we dive into <code>Promise.any()</code>, let&rsquo;s define 2 simple functions.</p>
<blockquote>
<p>The function <code>resolveTimeout(value, delay)</code> will return a <code>promise</code> that has <code>resolved</code> after <code>delay</code> time has elapsed.</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>The function <code>rejectTimeout(reason, delay)</code> returns a <code>promise</code> that has a <code>reject</code> after the <code>delay</code> time has elapsed.</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, try <code>Promise.any()</code> using the 2 helper functions defined above.</p>
<h4 id="21-completing-all-promises">2.1 Completing all <code>promises</code></h4>
<p>Try running the first parsed list as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>
<span class="kr">const</span> <span class="nx">vegetables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;oranges&#34;</span><span class="p">,</span> <span class="s2">&#34;apples&#34;</span><span class="p">];</span>
<span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">any</span><span class="p">([</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">vegetables</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">promise</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// 1 秒之后
</span><span class="c1"></span><span class="nx">list</span><span class="p">();</span> <span class="c1">// [&#39;potatoes&#39;, &#39;tomatoes&#39;]
</span></code></pre></td></tr></table>
</div>
</div><p><code>promise .any([...])</code> returns a <code>promise</code> that parses the array <code>fruits</code> in <code>1 second</code>, since the <code>promise</code> that parses the fruits finishes first.</p>
<p>The second is a <code>promise</code> that resolves to the array <code>vegetables</code> in <code>2 seconds</code>, and its value is ignored.</p>
<h4 id="22-a-promise-is-rejected">2.2 A <code>promise</code> is <code>rejected</code></h4>
<p>The first <code>promise</code> above is <code>rejected</code> with an exception, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">vegetables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;oranges&#34;</span><span class="p">,</span> <span class="s2">&#34;apples&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">any</span><span class="p">([</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;fruits is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">vegetables</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">promise</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
<span class="p">};</span>

<span class="c1">// 2 秒之后
</span><span class="c1"></span><span class="nx">list</span><span class="p">();</span> <span class="c1">// [ &#39;oranges&#39;, &#39;apples&#39; ]
</span></code></pre></td></tr></table>
</div>
</div><p>In the above code, the first <code>promise</code> is <code>rejected</code> after <code>1 second</code> and it is easy to see from the result of the execution that <code>Promise.any()</code> skips the first <code>promise</code> that is <code>rejected</code> and waits for the second <code>promise</code> that finishes <code>2 seconds</code> later.</p>
<h4 id="23-all-promises-are-rejected">2.3 All <code>promises</code> are <code>rejected</code></h4>
<p>Here&rsquo;s what happens when all <code>promises</code> are <code>rejected</code>, with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">any</span><span class="p">([</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;fruits is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">2000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">promise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">aggregateError</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aggregateError</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">aggregateError</span><span class="p">.</span><span class="nx">errors</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// [AggregateError: All promises were rejected]
</span></code></pre></td></tr></table>
</div>
</div><h3 id="summary">Summary</h3>
<p><code>Promise.any()</code> can be used to execute independent asynchronous operations in parallel in a competitive manner to obtain the value of any first <code>promise</code> that completes successfully. If all input <code>promises</code> to <code>Promise.any()</code> have been <code>rejected</code>, then the <code>promise</code> returned by the helper function will also be rejected as an aggregate error, which contains the reason for the rejection of the input <code>promise</code> in a special property <code>AggregateError</code>: <code> aggregateError.errors</code> .</p>
<h2 id="promiseall">Promise.all()</h2>
<p>method <code>Promise.all(promises)</code>, can process multiple <code>promises</code> at once in parallel and return only one <code>promise</code> instance, the result of the <code>resolve</code> callback for all the <code>promises</code> entered is an array.</p>
<p>Here&rsquo;s how <code>Promise.all()</code> works.</p>
<h3 id="1-how-it-works-1">1. How it works</h3>
<p><code>Promise.all()</code> is a built-in helper function that takes a set of <code>promises</code> (or an iterable object) and returns a <code>promise</code>: <code>Promise.all()</code> is a built-in helper function that takes a set of <code>promises</code> (or an iterable object) and returns a <code>promise</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">const <span class="nv">allPromise</span> <span class="o">=</span> Promise.all<span class="o">([</span>promise1, promise2, ...<span class="o">])</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>The value of the first <code>promise</code> can be extracted using the <code>then</code> method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">allPromise</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">values</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">values</span><span class="p">;</span> <span class="c1">// [valueOfPromise1, valueOfPromise2, ...]
</span><span class="c1"></span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>async/await</code> syntax can also be used.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">values</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">allPromise</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">values</span><span class="p">);</span> <span class="c1">// [valueOfPromise1, valueOfPromise2, ...]
</span></code></pre></td></tr></table>
</div>
</div><p>The way in which the <code>promise</code> returned by <code>Promise.all()</code> was parsed or rejected.</p>
<p>If <code>allPromise</code> are all successfully parsed, then <code>allPromise</code> will use as its result an array containing the values of each <code>promise</code> after it has been executed. The order of the <code>promises</code> in the array is important - the implemented values will be obtained in this order.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/0650ee8a484145c88ac51c0b383dfee3.png" alt="image"></p>
<p>But if at least one <code>promise</code> is <code>rejected</code>, then <code>allPromise</code> is immediately <code>rejected</code> for the same reason (without waiting for the execution of other <code>promises</code>).</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/c167c63b44304b97a78401d78b720b00.png" alt="image"></p>
<p>If all <code>promise</code>s are <code>rejected</code>, wait for all <code>promise</code>s to finish, but only return the <code>reject</code> reason for the first <code>promise</code> that was <code>rejected</code>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/8c8d622229184aa7b0eb2e1da1dc165b.png" alt="image"></p>
<h3 id="2-usage-guidelines-1">2. Usage Guidelines</h3>
<p>Before we dive into <code>Promise.all()</code>, let&rsquo;s define 2 simple functions.</p>
<blockquote>
<p>The function <code>resolveTimeout(value, delay)</code> will return a <code>promise</code> that has <code>resolved</code> after <code>delay</code> time has elapsed.</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>The function <code>rejectTimeout(reason, delay)</code> returns a <code>promise</code> that has a <code>reject</code> after the <code>delay</code> time has elapsed.</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, try <code>Promise.all()</code> using the 2 helper functions defined above.</p>
<h4 id="21-completing-all-promises-1">2.1 Completing all <code>promises</code></h4>
<p>An <code>promise</code> array <code>allPromise</code> is defined below, and all <code>promises</code> are capable of successful <code>resolve</code> values, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>
<span class="kr">const</span> <span class="nx">vegetables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;oranges&#34;</span><span class="p">,</span> <span class="s2">&#34;apples&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">allPromise</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">vegetables</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">];</span>
<span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">allPromise</span><span class="p">);</span>

<span class="c1">// 等待... 2秒后
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">promise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">.</span><span class="nx">errors</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// [ [ &#39;potatoes&#39;, &#39;tomatoes&#39; ], [ &#39;oranges&#39;, &#39;apples&#39; ] ]
</span></code></pre></td></tr></table>
</div>
</div><p>The result of the above execution shows that the <code>resolve</code> array of <code>promise</code> returned by <code>Promise.all()</code> is composed in the order of <code>allPromise</code> before it is executed.</p>
<blockquote>
<p>The order of the <code>promise</code> arrays directly affects the order of the result, regardless of the order in which the execution of <code>promise</code> completes.</p>
</blockquote>
<h4 id="22-a-promise-is-rejected-1">2.2 A <code>promise</code> is <code>rejected</code></h4>
<p>The first <code>promise</code> of the array <code>allPromise</code> above is <code>rejected</code> with an exception, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;fruits is empty&#34;</span><span class="p">),</span> <span class="mi">5000</span><span class="p">),</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">vegetables</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">promise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// Error: fruits is empty
</span></code></pre></td></tr></table>
</div>
</div><p>However, after <code>5 seconds</code>, the first <code>promise</code> is <code>rejected</code> due to an exception, causing <code>allPromise</code> to be <code>rejected</code> as well, and returning the same error message as the first <code>promise</code>: <code>Error: fruits is empty</code>, even though the value of the second <code> promise</code> after <code>1 second</code> is completed, the value of the second <code>promise</code> is not accepted.</p>
<p>Next, all the <code>promises</code> in the array <code>allPromise</code> are thrown with an exception and <code>rejected</code>, and the order of <code>rejected</code> is adjusted by the timer as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;fruits is empty&#34;</span><span class="p">),</span> <span class="mi">5000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">promise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>After <code>5 seconds</code>, the execution completes and the result is <code>Error: vegetables is empty</code>, it is easy to see that <code>allPromise</code> was <code>rejected</code> because the <code>promise</code> that was <code>rejected</code> first.</p>
<p>This behaviour of &gt; <code>Promise.all()</code> is known as fast failure, and if at least one <code>promise</code> in the <code>promise</code> array is <code>rejected</code>, then the returned <code>promise</code> is also rejected. If all of the <code>promise</code> arrays are <code>rejected</code>, then the returned <code>promise</code> is rejected because of the one that was <code>rejected</code> first.</p>
<h3 id="summary-1">Summary</h3>
<p><code>Promise.all() </code> is the best way to perform asynchronous operations in parallel and get all the <code>resolve</code> values, ideal for situations where you need to get the results of the asynchronous operations simultaneously to perform the next operation.</p>
<h2 id="promiseallsettled">Promise.allSettled()</h2>
<p>method <code>Promise.allSettled(promises)</code>, returns a <code>promise</code> after all the given <code>promises</code> have been <code>fulfilled</code> or <code>rejected</code>, with an array of objects, each representing the corresponding <code>promise</code> result.</p>
<p>Here&rsquo;s how <code>Promise.allSettled()</code> works.</p>
<h3 id="1-how-it-works-2">1. How it works</h3>
<p><code>Promise.allSettled()</code> can be used to execute independent asynchronous operations in parallel and collect the results of those asynchronous operations.</p>
<p>The function accepts an <code>promise</code> array (or usually an iterable one) as an argument, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">statusesPromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">(</span><span class="nx">promises</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>When all input <code>promises</code> have been fulfilled or rejected, <code>statusesPromise</code> is resolved to an array with its status.</p>
<ul>
<li><code>{ status: 'fulfilled', value:value }</code> : if the corresponding <code>promise</code> has been fulfilled</li>
<li><code>{ status: 'rejected', reason: reason }</code> : if the corresponding <code>promise</code> was rejected</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/4ecde6b61b434ea28b317ef2085d90a7.png" alt="image"></p>
<p>The state of all <code>promises</code> can be extracted using the <code>then</code> method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">statusesPromise</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">statuses</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">statuses</span><span class="p">;</span> <span class="c1">// [{ status: &#39;...&#39;, value: &#39;...&#39; }, ...]
</span><span class="c1"></span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>async/await</code> syntax can also be used.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">statuses</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">statusesPromise</span><span class="p">;</span>

<span class="nx">statuses</span><span class="p">;</span> <span class="c1">// [{ status: &#39;...&#39;, value: &#39;...&#39; }, ...]
</span></code></pre></td></tr></table>
</div>
</div><p>The promise returned by <code>Promise.allSettled()</code> is always realized with a range of states, regardless of whether some (or all) of the input promises are rejected.</p>
<blockquote>
<p>The big difference between <code>Promise.allSettled()</code> and <code>Promise.all()</code>: <code>Promise.allSettled()</code> will never be <code>rejected</code>.</p>
</blockquote>
<h3 id="2-usage-guidelines-2">2. Usage Guidelines</h3>
<p>Before we dive into the use of <code>Promise.allSettled()</code>, let&rsquo;s define 2 simple functions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, try <code>Promise.allSettled()</code> using the 2 helper functions defined above.</p>
<h4 id="21-completing-all-promises-2">2.1 Completing all <code>promises</code></h4>
<p>An <code>promise</code> array <code>statusesPromise</code> is defined below, and all <code>promises</code> are capable of successful <code>resolve</code> values, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>
<span class="kr">const</span> <span class="nx">vegetables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;oranges&#34;</span><span class="p">,</span> <span class="s2">&#34;apples&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">statusesPromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">([</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">vegetables</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待 2 秒 ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">statuses</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">statusesPromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">statuses</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// [{ status: &#39;fulfilled&#39;, value: [ &#39;potatoes&#39;, &#39;tomatoes&#39; ] },{ status: &#39;fulfilled&#39;, value: [ &#39;oranges&#39;, &#39;apples&#39; ] }]
</span></code></pre></td></tr></table>
</div>
</div><p>From the results of the above execution <code>Promise.allSettled()</code> returns an array of <code>resolve</code> states of a <code>promise</code> in the order in which the <code>statusesPromise</code> were composed before it was executed.</p>
<h4 id="22-a-promise-is-rejected-2">2.2 A <code>promise</code> is <code>rejected</code></h4>
<p>The first <code>promise</code> above is <code>rejected</code> with an exception, with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">statusesPromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">([</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待 2 秒 ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">statuses</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">statusesPromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">statuses</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// // [{ status: &#39;fulfilled&#39;, value: [&#39;potatoes&#39;, &#39;tomatoes&#39;] },{ status: &#39;rejected&#39;, reason: Error(&#39;Vegetables is empty&#39;) }]
</span></code></pre></td></tr></table>
</div>
</div><p>Even if the second <code>promise</code> in the input array is <code>rejected</code>, <code>statusesPromise</code> can still successfully parse the state array.</p>
<h4 id="23-all-promises-are-rejected-1">2.3 All <code>promises</code> are <code>rejected</code></h4>
<p>All of the above <code>promises</code> with exceptions are <code>rejected</code>, with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">statusesPromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">allSettled</span><span class="p">([</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Fruits is empty&#34;</span><span class="p">),</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待 2 秒 ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">statuses</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">statusesPromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">statuses</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// // [{ status: &#39;rejected&#39;, reason: Error(&#39;Fruits is empty&#39;) },{ status: &#39;rejected&#39;, reason: Error(&#39;Vegetables is empty&#39;) }]
</span></code></pre></td></tr></table>
</div>
</div><h3 id="summary-2">Summary</h3>
<p><code>Promise.allSettled()</code> is a good choice when parallel and independent asynchronous operations need to be performed and all results collected, even if some asynchronous operations may fail.</p>
<h2 id="promiserace">Promise.race()</h2>
<p>method <code>Promise.race(promises)</code>, as the name implies, means race, <code>Promise.race([p1, p2, p3]</code> fetches the result of whichever of the <code>promise</code> arrays completes faster, regardless of whether the result itself is a successful fulfillment or a failed rejection state, and outputs only the fastest <code> promise</code>.</p>
<p>Here&rsquo;s how <code>Promise.race()</code> works.</p>
<h3 id="1-how-it-works-3">1. How it works</h3>
<p><code>Promise.race()</code> returns a <code>promise</code> that will be fulfilled or rejected once one of the <code>promises</code> in the iterator has been fulfilled or rejected.</p>
<p>The function accepts an <code>promise</code> array (or usually an iterable) as an argument, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">racePromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">(</span><span class="nx">promises</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>When one of all input <code>promises</code> is quickly fulfilled or rejected, <code>racePromise</code> resolves the fast-completing <code>promise</code> result (fulfilled or rejected) as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/b3c0ec3457404127833f215b7c7663c7.png" alt="image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/13/de44f136bcc743a684916eb9b983a149.png" alt="image"></p>
<p>The result of <code>racePromise</code> can be extracted using the <code>then</code> method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">racePromise</span><span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">fastValue</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">fastValue</span> <span class="c1">// fast completion promise
</span><span class="c1"></span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>async/await</code> syntax can also be used.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">fastPromise</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">racePromise</span><span class="p">;</span>

<span class="nx">fastPromise</span><span class="p">;</span> <span class="c1">// fast-completing promise
</span></code></pre></td></tr></table>
</div>
</div><p><code>Promise.race()</code> Returns a promise with the same information as the first promise to complete.</p>
<blockquote>
<p>Difference between <code>Promise.race()</code> and <code>Promise.any()</code>: <code>Promise.race()</code> looks for the first fulfilled or rejected promise in the list of promises; <code>Promise.any()</code> looks for the first fulfilled promise from the list of promises.</p>
</blockquote>
<h3 id="2-usage-guidelines-3">2. Usage Guidelines</h3>
<p>Before we dive into the use of ``Promise.race()`, let&rsquo;s define 2 simple functions as well.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">resolve</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">rejectTimeout</span><span class="p">(</span><span class="nx">reason</span><span class="p">,</span> <span class="nx">delay</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">((</span><span class="nx">r</span><span class="p">,</span> <span class="nx">reject</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">reject</span><span class="p">(</span><span class="nx">reason</span><span class="p">),</span> <span class="nx">delay</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, try <code>Promise.race()</code> using the 2 helper functions defined above.</p>
<h4 id="21-completing-all-promises-3">2.1 Completing all <code>promises</code></h4>
<p>An <code>promise</code> array <code>racePromise</code> is defined below, and all <code>promises</code> are capable of successful <code>resolve</code> values as follows</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>
<span class="kr">const</span> <span class="nx">vegetables</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;oranges&#34;</span><span class="p">,</span> <span class="s2">&#34;apples&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">racePromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">5000</span><span class="p">),</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">getables</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// wait 1 second ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">fastPromise</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">racePromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fastPromise</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// [ &#39;oranges&#39;, &#39;apples&#39; ]
</span></code></pre></td></tr></table>
</div>
</div><p>From the above execution <code>Promise.race()</code> returns the <code>resolve</code> result of the fastest performing <code>promise</code>.</p>
<h4 id="22-a-promise-is-rejected-3">2.2 A <code>promise</code> is <code>rejected</code></h4>
<p>The first <code>promise</code> above is <code>rejected</code> with an exception, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">racePromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待 1 秒 ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">fastPromise</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">racePromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fastPromise</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// Error: Vegetables is empty
</span></code></pre></td></tr></table>
</div>
</div><p>From the above result, the first <code>promise</code> to complete is <code>rejected</code>, so the <code>promise</code> returned by <code>fastPromise</code> is also <code>rejected</code>.</p>
<p>The following extends the promise time for <code>rejected</code> to 5 seconds, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">fruits</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;potatoes&#34;</span><span class="p">,</span> <span class="s2">&#34;tomatoes&#34;</span><span class="p">];</span>

<span class="kr">const</span> <span class="nx">racePromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
    <span class="nx">resolveTimeout</span><span class="p">(</span><span class="nx">fruits</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">5000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待 2 秒 ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">fastPromise</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">racePromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fastPromise</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// [ &#39;potatoes&#39;, &#39;tomatoes&#39; ]
</span></code></pre></td></tr></table>
</div>
</div><p>As you can see from the above results, the fastest completed <code>promise</code> fulfilled <code>resolve</code>, so the <code>promise</code> returned by <code>fastPromise</code> also fulfilled <code>resolve</code>.</p>
<h4 id="23-all-promises-are-rejected-2">2.3 All <code>promises</code> are <code>rejected</code></h4>
<p>All the <code>promises</code> above are <code>rejected</code> with an exception, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">racePromise</span> <span class="o">=</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">race</span><span class="p">([</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Fruits is empty&#34;</span><span class="p">),</span> <span class="mi">2000</span><span class="p">),</span>
    <span class="nx">rejectTimeout</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&#34;Vegetables is empty&#34;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">),</span>
<span class="p">]);</span>

<span class="c1">// 等待 1 秒 ...
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">list</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">fastPromise</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">racePromise</span><span class="p">;</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fastPromise</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">};</span>

<span class="nx">list</span><span class="p">();</span> <span class="c1">// Error: Vegetables is empty
</span></code></pre></td></tr></table>
</div>
</div><p>From the results, although both promises were rejected, the <code>promise</code> returned by <code>fastPromise</code> was the fastest to be rejected.</p>
<h3 id="3-usage-scenarios">3. Usage scenarios</h3>
<h4 id="31-performance-testing">3.1. Performance testing</h4>
<p>In projects with asynchronous operations, you can use <code>Promises</code> to test the performance of network or database requests by using <code>Promise.race()</code> to test the responsiveness of the two different methods.</p>
<h4 id="32-optimal-choices">3.2 Optimal choices</h4>
<p>For example fetching the same type of data with multiple requesting servers, sending requests to multiple servers at the same time and rendering their data as soon as one of them completes its work, to achieve the effect of choosing the best route. This is done by using <code>Promise.race()</code> to execute <code>promise</code> at the same time and finish as soon as the first one succeeds.</p>
<h3 id="summary-3">Summary</h3>
<p><code>Promise.race()</code> executes a callback function for the first resolved and rejected <code>promise</code>, while <code>Promise.any()</code> executes a callback function for the first fulfilled <code>promise</code> and rejects a special property <code>AggregateError</code> if the unfulfilled <code>promise</code> is rejected.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/javascript/">javascript</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/redis-cluster/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Redis Large Cluster Scaling Performance Optimization in Practice</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/tcp-ip-optimisation-websites/">
            <span class="next-text nav-default">TCP/IP protocol optimisation for large websites</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
