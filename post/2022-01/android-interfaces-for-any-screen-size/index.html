<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Building Android interfaces for any screen size - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="With around 100 million new tablet devices activated in the last 12 months and Chrome OS activations up by 92%, it is the fastest growing desktop platform. This means that with more than 250 million large screen devices running Android on tablets, foldable devices and Chrome OS devices, and the number of foldable devices in use growing by more than 250% year-on-year, the &amp;lsquo;big screen&amp;rsquo; is becoming an important and" /><meta name="keywords" content="Android, Interfaces, Any Screen Size" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/android-interfaces-for-any-screen-size/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Building Android interfaces for any screen size" />
<meta property="og:description" content="With around 100 million new tablet devices activated in the last 12 months and Chrome OS activations up by 92%, it is the fastest growing desktop platform. This means that with more than 250 million large screen devices running Android on tablets, foldable devices and Chrome OS devices, and the number of foldable devices in use growing by more than 250% year-on-year, the &lsquo;big screen&rsquo; is becoming an important and" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/android-interfaces-for-any-screen-size/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-14T10:04:51+08:00" />
<meta property="article:modified_time" content="2022-01-14T10:04:51+08:00" />

<meta itemprop="name" content="Building Android interfaces for any screen size">
<meta itemprop="description" content="With around 100 million new tablet devices activated in the last 12 months and Chrome OS activations up by 92%, it is the fastest growing desktop platform. This means that with more than 250 million large screen devices running Android on tablets, foldable devices and Chrome OS devices, and the number of foldable devices in use growing by more than 250% year-on-year, the &lsquo;big screen&rsquo; is becoming an important and"><meta itemprop="datePublished" content="2022-01-14T10:04:51+08:00" />
<meta itemprop="dateModified" content="2022-01-14T10:04:51+08:00" />
<meta itemprop="wordCount" content="4868">
<meta itemprop="keywords" content="android," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Building Android interfaces for any screen size"/>
<meta name="twitter:description" content="With around 100 million new tablet devices activated in the last 12 months and Chrome OS activations up by 92%, it is the fastest growing desktop platform. This means that with more than 250 million large screen devices running Android on tablets, foldable devices and Chrome OS devices, and the number of foldable devices in use growing by more than 250% year-on-year, the &lsquo;big screen&rsquo; is becoming an important and"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Building Android interfaces for any screen size</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-14 10:04:51 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 4868 words </span>
          <span class="more-meta"> 10 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#user-engagement">User engagement</a></li>
        <li><a href="#window-size-classes-and-reference-devices">Window Size Classes and Reference Devices</a></li>
        <li><a href="#adapting-to-large-screens">Adapting to large screens</a></li>
        <li><a href="#jetpack-compose">Jetpack Compose</a></li>
        <li><a href="#get-a-better-user-experience">Get a better user experience</a></li>
        <li><a href="#testing-and-maintenance">Testing and maintenance</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/7b536cf51cad4a57846226c8be639be6.png" alt="android"></p>
<p>With around 100 million new tablet devices activated in the last 12 months and Chrome OS activations up by 92%, it is the fastest growing desktop platform. This means that with more than 250 million large screen devices running Android on tablets, foldable devices and Chrome OS devices, and the number of foldable devices in use growing by more than 250% year-on-year, the &lsquo;big screen&rsquo; is becoming an important and fastest growing segment of Android devices. This has led device manufacturers to realise that optimising for larger screens is an opportunity to differentiate their devices in the premium phone segment.</p>
<p>With the rapid development of tablets and foldable devices, it&rsquo;s time to stop thinking about phones and tablets separately and instead offer apps for an entire ecosystem to increase their impact in the market. In this article we&rsquo;ll look at how developers can quickly embrace and enter this market segment with the new APIs and tools we offer.</p>
<h2 id="user-engagement">User engagement</h2>
<p>In the months following the Android Developer Summit, the Play Store has introduced new incentives, including the ability to rate apps by device type, to encourage developers to look more towards the big screen. So now is the perfect time to embrace these changes, not only to cater for the market changes that will follow, but also to address the lack of user experience caused by the lack of large screen adaptations.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/f20ffce527eb4b98ae35002f13f288d0.png" alt="large screen"></p>
<p>△ Microsoft Outlook app interface optimised for large screens</p>
<p>We also observed that apps that were optimised for all screen sizes achieved good results in terms of metrics around user interaction, retention and more. One success story, Candy Camera, for example, is that by optimising the layout of foldable devices and large screens, users on these devices have spent 10% more time in the app and have seen a 14% increase in 7-day user retention, and this is not an isolated case. Another case in point is Microsoft Outlook, whose recent update takes full advantage of the large screen by using a dual-window layout to view both inbox and email content, and the ability to compose emails independently in a single window with multiple displays. These examples are a good indication that it&rsquo;s time to start designing and developing freely, free from the constraints of a single interface on a mobile phone.</p>
<p>But don&rsquo;t worry too much, we&rsquo;ve done a lot of work to make the whole development cycle as easy as possible, so take a look at the tools we&rsquo;ve provided to help you get better at adapting to larger screens.</p>
<h2 id="window-size-classes-and-reference-devices">Window Size Classes and Reference Devices</h2>
<p>In a diverse device ecosystem, the different shapes and sizes of Android devices make the layout of apps very flexible. Running the same app on different devices should be flexible enough to fit the screen size of the different devices. To this end, we have delved into the Android device market and taken some inspiration from best practices in adaptive and responsive development for the web to build the basis of a new dynamically resizable Android interface, which we call the window size class.</p>
<p>A window size class is a subjective set of viewport breakpoints against which you can design, develop and test resizable app layouts. These breakpoints will help you understand the key sizes to optimise in order to adapt your application to the entire ecosystem. There are three window size categories, Smaller, Medium and Expanded, which are designed to balance simplicity and flexibility of layout to optimise your application for specific situations. We recommend that you use the window size breakpoints to make advanced application layout decisions, and for changes to the layout grid columns they can also be mapped to Material Design layout breakpoints.</p>
<p>The new WindowSizeClass API, available in Jetpack WindowManager 1.1, will allow you to get rid of the error-prone isTable logic. These new APIs will also eliminate the need for custom logic when switching devices between landscape and portrait, in most cases simply designing for different window size class breakpoints and the app will adapt to the correct layout and various application states.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">WindowMetrics</span> <span class="p">{</span>
    <span class="kr">class</span> <span class="nx">WindowSizeClass</span><span class="p">(</span><span class="nx">val</span> <span class="nx">name</span><span class="o">:</span> <span class="nb">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">companion</span> <span class="nx">object</span> <span class="p">{</span>
            <span class="nx">val</span> <span class="nx">COMPACT</span> <span class="o">=</span> <span class="nx">WindowSizeClass</span><span class="p">(</span><span class="err">“</span><span class="nx">COMPACT</span><span class="err">”</span><span class="p">)</span>
            <span class="nx">val</span> <span class="nx">MEDIUM</span> <span class="o">=</span> <span class="nx">WindowSizeClass</span><span class="p">(</span><span class="err">“</span><span class="nx">MEDIUM</span><span class="err">”</span><span class="p">)</span>
            <span class="nx">val</span> <span class="nx">EXPANDED</span> <span class="o">=</span> <span class="nx">WindowSizeClass</span><span class="p">(</span><span class="err">“</span><span class="nx">EXPANDED</span><span class="err">”</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">val</span> <span class="nx">widthClass</span><span class="o">:</span> <span class="nx">WindowSizeClass</span>
        <span class="nx">get</span><span class="p">()</span> <span class="p">{...}</span>
    <span class="nx">val</span> <span class="nx">heightClass</span><span class="o">:</span> <span class="nx">WindowSizeClass</span>
        <span class="nx">get</span><span class="p">()</span> <span class="p">{...}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>One important point is that from Android 12 onwards, apps will be allowed to be resized at will and all apps will be allowed to run in multi-window mode. In the case of the Samsung Galaxy Fold series, the split-screen mode available makes for seven times better screen utilisation, and the fact that split-screen allows users to resize according to their preferences further highlights the importance of building dynamically resizable interfaces.</p>
<p>Considering the layout from a device and configuration perspective, we have made each window size category representative of a number of typical device configurations (shown below), which will be a useful reference when you are considering designing layouts based on breakpoints. Where smaller represents the typical pattern of a phone in portrait mode, medium represents the size of most tablets and larger foldable devices, and expanded represents the display of a tablet or larger foldable device, or a desktop device in landscape mode.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/dc0418b68a744b44a676210ae75d26a0.png" alt="image"></p>
<p>△ Representation of width-based window size classes</p>
<p>In addition to the three width-based breakpoints above, we have also introduced height-based breakpoints with the same class name to allow for more advanced layout scenarios and to give more flexibility. Suppose we need to use smaller height breakpoints to optimise the layout of a landscape mobile interface, although this may sound complicated, don&rsquo;t worry, according to many Android developers we have spoken to, in most cases it is only necessary to adapt the layout based on width.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/feb73e31c0534dfda1096bb3129f23b2.png" alt="image"></p>
<p>△ Representation of height-based window size classes</p>
<p>All in all, the advent of the window size class represents a major advancement in adaptive and responsive layout development for Android, including updated and optimised guidelines, a new API in Jetpack WindowManager and new tools in Android Studio.</p>
<p>Speaking of Android Studio, we&rsquo;re introducing a new category of tools in Android Studio Bumblebee, which we&rsquo;re calling Reference Devices, and it&rsquo;s been introduced to allow Android apps to be built to be responsive and adaptable to all device classes. After thorough research of market data, we have provided four Reference Devices, representing phones, foldable devices, tablets and desktop devices. They cover both the mainstream devices currently on the market and the fast-growing segments, as well as ensuring that the app will work in most window size categories.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/d16aaab9f41646e6871f12cf23cedccd.png" alt="image"></p>
<p>△ Four types of Reference Devices</p>
<p>If you just want a quick overview of what to look for in this article on adapting to large screens, please keep the following points in mind:</p>
<ol>
<li>to ensure that your app is displayed correctly on different device sizes, give priority to optimising the layout for the smaller and expanded width size categories.</li>
<li>test your application on all Reference Devices, prioritising the best layout in the medium category.</li>
<li>to provide a better user experience, add features that make sense for the application, such as support for the collapsed state of foldable devices or optimisation for keyboard, mouse and stylus input support.</li>
</ol>
<p>For more detailed information on window sizing classes, please refer to <a href="https://developer.android.com/guide/topics/large-screens/support-different-screen-sizes#window_size_classes">window sizing classes</a>.</p>
<p>For an example of a practical application of the Window Size class, see <a href="https://github.com/android/compose-samples/tree/main/JetNews">JetNews Compose example</a>.</p>
<h2 id="adapting-to-large-screens">Adapting to large screens</h2>
<p>Designing a beautiful and responsive interface is the first step in developing an app, but implementing and maintaining that design can be a challenge, and we&rsquo;re committed to providing efficient tools to simplify your work. We&rsquo;ll now look at how to update existing apps with the new Jetpack API and Android Studio features to optimise for all screen sizes.</p>
<p>We&rsquo;ll use as an example Trackr, an open source task management app that we&rsquo;ve recently updated to better support larger screen devices, which was developed to demonstrate best practices for supporting an accessible feature experience in Android, and with the recent updates for larger screens, it&rsquo;s certainly a good example.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/45021a45927c4a3ba5f52416374aa9f3.png" alt="image"></p>
<p>△ The Trackr look before the change</p>
<p>The image above shows Trackr before we made the changes, you will see a single window task list and a bottom application bar to navigate to the archive or settings page, regardless of device or screen. Next, let&rsquo;s optimise Trackr for larger screens.</p>
<p><strong>NavigationRailView</strong></p>
<p>We are working on a new tool in Android Studio Chipmunk, Visual Linting, which allows us to check the interface in Layout Validation and display some warnings and relevant suggestions. We are using Visual Linting to check the layout of Trackr to identify potential problems with the large screen display through the tool. We can do this by opening the main_activity layout and then opening the Layout Validation tool (which can also be found via the View - Tools Window path).</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/7b6a3306c3da4a869dcfc69de5c3bb22.png" alt="image"></p>
<p>△ Checking the interface in Layout Validation</p>
<p>In the Layout Validation interface, you will find a new category for Reference Devices, which allows you to use the new Reference Devices feature in Android Studio. In the top right corner of Layout Validation you will find a warning icon, click on this icon to open the warning window and click on each warning to show which devices are affected. As you can see above, we will find two warnings related to large displays: the bottom application bar is only recommended for smaller screens and some rows of the MaterialTextView contain more than 120 characters.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/8c4ab55ad6fe44f48fe1bd2fa95417b3.png" alt="image"></p>
<p>△ Warning window</p>
<p>Expand Warnings to see if Android Studio offers suggestions for changes, here the suggestions for changes to the bottom app bar warning are to use Navigation Rail, a drawer navigation bar, or use the top app bar instead. For Trackr, I think it would be more constructive to use Navigation Rail. The suggestion for the MaterialTextView would be to either reduce the width of the TextView or consider using a multi-column layout, which in this case would be more appropriate for our application. For Trackr we will use the typical list plus details window style to address these caveats, for devices with medium or large widths we will use NavRail rather than the bottom app bar, and for devices with expanded widths we will use a double window layout to display tasks and related details.</p>
<p>Let&rsquo;s start with the first optimisation, using NavRail instead of the bottom app bar. The first thing we need to consider is the navigation model, but fortunately we won&rsquo;t be changing many specific views, only the way we navigate, as NavRail will always be present in the entire view system and can be used to navigate to any other view. To implement this model, we can add the Navigation Rail View to the main_activity layout as shown in the following code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">// main_activity.xml
<span class="nt">&lt;androidX.coordinatorlayout.widget.CorrdinatorLayout</span>
<span class="err">…</span><span class="nt">&gt;</span>
<span class="nt">&lt;com.google.android.material.navigationrail.NavigationRailView</span>
    <span class="na">android:id=</span><span class="s">&#34;@+id/navigation_rail&#34;</span>
    <span class="err">android</span> <span class="na">:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
    <span class="na">android:layout_height=</span><span class="s">&#34;0dp&#34;</span>
    <span class="na">app:layout_constraintBottom_toBottomOf=</span><span class="s">&#34;parent&#34;</span>
    <span class="na">app:layout_constraintStart_toStartOf=</span><span class="s">&#34;parent&#34;</span>
    <span class="err">app:</span> <span class="na">layout_constraintTop_toTopOf=</span><span class="s">&#34;parent&#34;</span>
    <span class="na">app:headerLayout=</span><span class="s">&#34;@layout/navigation_rail_header&#34;</span>
    <span class="na">app:labelVisibilityMode=</span><span class="s">&#34;unlabeled&#34;</span>
    <span class="na">app:menu=</span><span class="s">&#34;@menu/navigation_rail&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/androidX.coordinatorlayout.widget.CorrdinatorLayout&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Previously, the main_activity consisted only of FragmentContainerView and CoordinatorLayout, and hosted other Fragments through NavHostFragment. layout level, it will persist in all views. Nevertheless, I only want the NavigationRail to be used for screen sizes of 600dp or larger, and an easy way to achieve this is to add a resource-qualified main_activity layout with the FragmentContainerView on the same level as the FragmentContainerView:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">// w600dp/tasks_fragment.xml
<span class="nt">&lt;layout...&gt;</span>
   <span class="nt">&lt;data.../&gt;</span>
   <span class="nt">&lt;androidx.coordinatorlayout.widget.CoordinatorLayout...&gt;</span>
   <span class="nt">&lt;com.google.android.material.appbar.AppBarLayout.../&gt;</span>
   <span class="nt">&lt;androidx.recyclerview.widget.RecyclerView</span>
       <span class="na">android:id=</span><span class="s">&#34;@+id/tasks_list&#34;</span>
       <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
       <span class="na">android:layout_height=</span><span class="s">&#34;match_parent&#34;</span>
       <span class="na">android:clipToPadding=</span><span class="s">&#34;false&#34;</span>
       <span class="na">android:paddingLeft=</span><span class="s">&#34;@dimen/pane_margin&#34;</span>
       <span class="na">android:paddingRight=</span><span class="s">&#34;@dimen/pane_margin&#34;</span>
       <span class="na">tools:ignore=</span><span class="s">&#34;SpeakableTextPresentCheck&#34;</span>
       <span class="na">tools:listitem=</span><span class="s">&#34;@layout/task_summary&#34;</span><span class="nt">/&gt;</span>
   <span class="nt">&lt;/androidx.coordinatorlayout.widget.CoordinatorLayout&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>We also need to update tasks_fragments.xml to remove the bottom application bar from a display that is 600dp wide or larger. In a similar way to the NavRail implementation, a resource-qualified layout can be added to tasks_fragments and then the bottom application bar and associated hover buttons can be removed, leaving everything else intact so that the task list continues to work as intended. Finally, after setting the ID of the NavRail menu bar to match the ID of the existing navigation destination view, set the NavController for NavRail in the MainActivity:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;!=-NavRail Menu --&gt;</span>
<span class="nt">&lt;menu</span> <span class="na">xmlns:android=</span><span class="s">&#34;http://schemas.android.com/apk/res/android&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;item&gt;</span>
        android:id=&#34;@+id/nav_tasks&#34;
        android:icon=&#34;@drawable/ic_task&#34; .../&gt;
    <span class="nt">&lt;item</span>
        <span class="na">android:id=</span><span class="s">&#34;@+id/nav_archives&#34;</span>
        <span class="na">android:icon=</span><span class="s">&#34;@drawable/ic_archive&#34;</span> <span class="err">...</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/menu&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="c1">// MainActivity NavController
</span><span class="c1"></span><span class="kd">class</span> <span class="nc">MainActivity</span><span class="o">:</span> <span class="n">AppCompatActivity</span><span class="o">()</span> <span class="o">{</span>
<span class="o">...</span>
    <span class="n">override</span> <span class="n">func</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">saveInstanceState</span><span class="o">:</span> <span class="n">Bundle</span><span class="o">?)</span> <span class="o">{</span>
    <span class="o">...</span>
        <span class="n">binding</span><span class="o">.</span><span class="na">navigationRail</span><span class="o">?.</span><span class="na">apply</span><span class="o">{</span>
            <span class="n">setupWithNavController</span><span class="o">(</span><span class="n">navController</span><span class="o">)</span>
            <span class="n">setOnItemReselectedListener</span><span class="o">()</span>
            <span class="n">headerView</span><span class="o">?.</span><span class="na">setOnClickListener</span> <span class="o">{</span>
                <span class="n">navController</span><span class="o">.</span><span class="na">navigate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">nav_task_edit_graph</span><span class="o">)</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>That&rsquo;s it, you can check in Android Studio to see if everything is working and switch back and forth between the various Reference Devices to see if the layout is working as we would expect. When looking at the Phone Reference Device, we can still see the bottom app bar, and when we switch to a larger screen, we see that it is starting to use NavRail, and everything is working as we expected.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/0dc64cb3604345c391bf3c8abb07f9be.png" alt="image"></p>
<p>△ The effect under Phone Reference Device</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/4797e1b975424551af064d73a1e79c24.png" alt="image"></p>
<p>△ Effect under Tablet Reference Device</p>
<p><strong>SlidingPanelLayout</strong></p>
<p>Next let&rsquo;s move on to implementing a two-window view layout based on an expanded width device. An easy way to support this layout is to use SlidingPaneLayout, which has the advantage of easily reusing existing layout code, here is the current updated navigation diagram:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/6734b59913654a8887553be03716b1f2.png" alt="image"></p>
<p>△ The updated navigation view</p>
<p>We can navigate to any of the top-level layouts of the app via the NavigationRailView, but we can still navigate to the Fragment of the details page by selecting a single task in the interface. By updating the application navigation in this way, it is possible to have the same navigation map regardless of screen size, meaning that resizing the screen will not result in a change in navigation that would confuse the user.</p>
<p>As both tasks and details are presented in the same new Fragment in the SlidingPaneLayout, we add a new sub-navigation hierarchy specifically for the navigation interaction of that Fragment. This way, when I select a task and the app changes from a double window to a single window, the item will be at the top of the navigation stack and will be visible.</p>
<p>In short, we will use SlidingPaneLayout and FragmentContainerView to add a new Fragment to host the task and detail panes without having to do a major refactoring of the existing code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml">// tasks_two_pane_fragment.xml
<span class="nt">&lt;layout...&gt;</span>
   <span class="nt">&lt;androidx.slidingpanelayout.widget.SlidingPaneLayout</span>
       <span class="na">android:id=</span><span class="s">&#34;@+id/sliding_pane_layout&#34;</span><span class="err">...</span><span class="nt">&gt;</span>
       <span class="nt">&lt;androidx.fragment.app.FragmentContainerView</span>
           <span class="na">android:id=</span><span class="s">&#34;@+id/list_pane&#34;</span>
           <span class="na">android:name=</span><span class="s">&#34;com.example.android.trackr.ui.tasks.TasksFragment&#34;</span>
           <span class="na">android:layout_width=</span><span class="s">&#34;@dimen/list_pane_width&#34;</span>
           <span class="na">android:layout_height=</span><span class="s">&#34;match_parent&#34;</span>
           <span class="na">android:layout_weight=</span><span class="s">&#34;@dimen/list_pane_weight&#34;</span>
           <span class="na">tools:layout=</span><span class="s">&#34;@layout/tasks_fragment&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;androidx.fragment.app.FragmentContainerView</span>
           <span class="na">android:id=</span><span class="s">&#34;@+id/detail_pane&#34;</span>
           <span class="na">android:name=</span><span class="s">&#34;androidx.navigation.fragment.NavHostFragment&#34;</span>
           <span class="na">android:layout_width=</span><span class="s">&#34;@dimen/detail_pane_width&#34;</span>
           <span class="na">android:layout_height=</span><span class="s">&#34;match_parent&#34;</span>
           <span class="na">android:layout_weight=</span><span class="s">&#34;@dimen/detail_pane_weight&#34;</span>
           <span class="na">app:navGraph=</span><span class="s">&#34;@navigation/task_detail&#34;</span>
           <span class="na">tools:layout=</span><span class="s">&#34;@layout/task_detail_fragment&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/androidx.slidingpanelayout.widget.SlidingPaneLayout&gt;</span>
<span class="nt">&lt;/layout&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Then, proceed to update the app&rsquo;s top-level navigation hierarchy so that the new dual-window Fragment becomes the app&rsquo;s starting destination page and removes the details destination page from the app&rsquo;s navigation graph.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="c">&lt;!-- 顶层导航图 --&gt;</span>
<span class="nt">&lt;navigation</span> <span class="err">app:</span> <span class="na">startDestination=</span><span class="s">&#34;@+id/nav_tasks&#34;</span><span class="err">...</span><span class="nt">&gt;</span>
   <span class="nt">&lt;fragment</span>
       <span class="na">android:id=</span><span class="s">&#34;@+id/nav_tasks&#34;</span>
       <span class="na">android:name=</span><span class="s">&#34;..trackr.ui.tasks.TasksTwoPaneFragment&#34;</span> <span class="err">...</span><span class="nt">&gt;</span>
       <span class="nt">&lt;action</span>
           <span class="na">android:id=</span><span class="s">&#34;@+id/to_task_edit&#34;</span>
           <span class="err">app:</span> <span class="na">destination=</span><span class="s">&#34;@id/nav_task_edit_graph&#39; /&gt;
</span><span class="s">   &lt;/fragment&gt;
</span><span class="s">&lt;!-- Remove the &#39;details&#39; destination --&gt;
</span><span class="s">...
</span><span class="s">&lt;/navigation&gt;
</span><span class="s">
</span><span class="s">&lt;!-- SlidingPaneLayout 导航图 --&gt;
</span><span class="s">&lt;navigation...
</span><span class="s">       app:startDestination=&#34;</span><span class="err">@id/nav_task_detail_placeholder&#34;</span><span class="nt">&gt;</span>
       <span class="nt">&lt;action</span>
           <span class="na">android:id=</span><span class="s">&#34;@+id/to_task_detail&#34;</span>
           <span class="na">app:destination=</span><span class="s">&#34;@id/nav_task_detail&#34;</span>
           <span class="na">app:popUpTo=</span><span class="s">&#34;@id/nav_task_detail&#34;</span>
           <span class="err">app</span> <span class="na">:popUpToInclusive=</span><span class="s">&#34;true&#34;</span>
       <span class="err">&lt;fragment</span>
           <span class="na">android:id=</span><span class="s">&#34;@+id/nav_task_detail&#34;</span>
           <span class="na">android:name=</span><span class="s">&#34;..trackr.ui..TaskDetailFragment&#34;</span><span class="err">...</span><span class="nt">&gt;</span>
       <span class="nt">&lt;argument</span>
           <span class="na">android:name=</span><span class="s">&#34;taskId&#34;</span>
           <span class="na">app:argType=</span><span class="s">&#34;long&#34;</span> <span class="nt">/&gt;</span>
   <span class="nt">&lt;/fragment&gt;</span>
<span class="c">&lt;!-- 为其实目的页面使用一个 placeholder --&gt;</span>
   <span class="nt">&lt;fragment</span>
       <span class="na">android:id=</span><span class="s">&#34;@+id/nav_task_detail_placeholder&#34;</span>
       <span class="na">android:name=</span><span class="s">&#34;..trackr.ui.PlaceholderFragment&#34;</span>
       <span class="na">tools:layout=</span><span class="s">&#34;@layout/placeholder_fragment&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/navigation&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Finally, a new navigation map is added specifically for SlidingPaneLayout and the SlidingPaneLayoutNavController configuration logic is handled in the TasksTwoPaneFragment Kotlin code. With these two changes the layout of the app will make more sense under different profiles on different devices. Once this is done, we can see that the new layout works perfectly on all device screens by using the Reference Devices tool in Android Studio again. And for testing at runtime, Android Studio Chipmunk provides a resizable simulator that allows you to switch between the same Reference Devices to quickly verify that the app layout is correct.</p>
<p>Another important feature offered by SlidingPaneLayout is that it is not only suitable for large screen devices, but also for multi-screen devices, Microsoft has recently provided a feature for SlidingPaneLayout that supports hinge detection, allowing it to automatically support splitting windows across screens without any code changes. This means that the app&rsquo;s new list/detail layout will work on all devices, including multi-screen devices.</p>
<p>While the methods mentioned above are useful for optimising large screen displays, many developers have applications based on multiple Activities, for which the new Activity Embedding API released in 12L will make it easy to support new interface paradigms such as dual-window views, so stay tuned.</p>
<h2 id="jetpack-compose">Jetpack Compose</h2>
<p>After the 1.0 release in July 2021, Jetpack Compose has had a huge response from the Android developer community, with thousands of apps already using Compose in production environments, including the Play Store app itself. Jetpack Compose itself is a declarative interface toolkit, through which you can create your own compose based on Compose itself is a declarative interface toolkit through which you can describe the state of the page and Compose will do all the necessary updates itself. All interfaces are described in code, making it easy to make decisions about interface style at runtime, whereas in a traditional view system we compile different screen configurations to configure the view, which is a huge difference. This makes it easy for Compose to address interface changes due to different screen sizes.</p>
<p>Let&rsquo;s show you how to adapt to different screen sizes with Compose by using JetNews, whose main interface shows a long list of scrolling articles, before being optimised for larger screens, as you can see below, and doesn&rsquo;t make good use of the extra screen space.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/f1d1df1933e24ab9b6dac315054b1667.png" alt="image"></p>
<p>△ The main interface of JetNews is shown</p>
<p>The WindowManager API has been introduced in the previous article and we are currently integrating it into Compose to make it easier to access this information from Compose. In the meantime, we can create a composable function to handle the integration with the WindowManager and then easily convert the current Activity&rsquo;s window information into the final window size class, as shown in the code below:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dart" data-lang="dart"><span class="err">@</span><span class="n">Composable</span>
<span class="n">fun</span> <span class="n">Activity</span><span class="p">.</span><span class="n">rememberWindowSizeClass</span><span class="p">()</span><span class="o">:</span> <span class="n">WindowSize</span> <span class="p">{</span>
   <span class="n">val</span> <span class="n">configuration</span> <span class="o">=</span> <span class="n">LocalConfiguration</span><span class="p">.</span><span class="n">current</span>
   <span class="n">val</span> <span class="n">windowMetrics</span> <span class="o">=</span> <span class="n">remember</span> <span class="p">(</span><span class="n">configuration</span><span class="p">)</span> <span class="p">{</span>
       <span class="n">WindowMetricsCalculator</span><span class="p">.</span><span class="n">getOrCreate</span><span class="p">()</span>
           <span class="p">.</span><span class="n">computeCurrentWindowMetrics</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
   <span class="p">}</span>
   <span class="n">val</span> <span class="n">windowDpSize</span> <span class="o">=</span> <span class="kd">with</span> <span class="p">(</span><span class="n">LocalDensity</span><span class="p">.</span><span class="n">current</span><span class="p">)</span> <span class="p">{</span>
       <span class="n">windowMetrics</span><span class="p">.</span><span class="n">bounds</span><span class="p">.</span><span class="n">toComposeRect</span><span class="p">().</span><span class="n">size</span><span class="p">.</span><span class="n">toDpSize</span><span class="p">()</span>
   <span class="p">}</span>
   <span class="n">when</span> <span class="p">{</span>
       <span class="n">windowDpSize</span><span class="p">.</span><span class="n">width</span> <span class="o">&lt;</span> <span class="m">600.</span><span class="n">dp</span> <span class="o">-&gt;</span> <span class="n">WindowSize</span><span class="p">.</span><span class="n">Compact</span>
       <span class="n">windowDpSize</span><span class="p">.</span><span class="n">width</span> <span class="o">&lt;</span> <span class="m">840.</span><span class="n">dp</span>
       <span class="k">else</span> <span class="o">-&gt;</span> <span class="n">WindowSize</span><span class="p">.</span><span class="n">Expanded</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The WindowManager library will soon have an API for using these classes directly, and Compose will soon support more convenient functionality to do this, so stay tuned. For now, you can borrow this code for the time being to fulfil this functional need.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/c57a9925f7b740eda92dcf9d7526ea09.png" alt="image"></p>
<p>△ JetNews side drawer navigation bar display</p>
<p>Returning to JetNews, we can see that the side drawer navigation rail appears as a modal on the large screen, but it extends across the screen with lots of blank areas. The suggested modification, as mentioned earlier, is to use Navigation Rail, which is directly supported by Compose, we just need to set it up and pass in the content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">NavigationRail</span><span class="o">(</span>
    <span class="n">header</span> <span class="o">=</span> <span class="o">{</span>
        <span class="n">JetnewsIcon</span><span class="o">()</span>
    <span class="o">}</span>
<span class="o">)</span> <span class="o">{</span>
    <span class="n">Column</span><span class="o">(</span><span class="n">verticalArrangement</span> <span class="o">=</span> <span class="n">Arrangement</span><span class="o">.</span><span class="na">Center</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Icon</span><span class="o">(</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="n">Icons</span><span class="o">.</span><span class="na">Filled</span><span class="o">.</span><span class="na">Home</span><span class="o">,</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">navigateToHome</span>
        <span class="o">)</span>
        <span class="n">Icon</span><span class="o">(</span>
            <span class="n">icon</span> <span class="o">=</span> <span class="n">Icons</span><span class="o">.</span><span class="na">Filled</span><span class="o">.</span><span class="na">ListAlt</span><span class="o">,</span>
            <span class="n">action</span> <span class="o">=</span> <span class="n">navigateToInterests</span>
        <span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Header icon and two navigation item icons, one for the main page and one for the Interests page, and add their corresponding navigation actions. In order to integrate Navigation Rail into the application, we made a few changes to the top-level application components. Firstly, we took the current window size class and the ModalDrawer on the smaller size and then made sure that the ModalDrawer was set so that it only responded to gestures in that size. The Navigation Rail is then placed side by side with the main navigation chart containing all the screens in the application:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Composable</span>
<span class="n">fun</span> <span class="nf">JetnewsApp</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">val</span> <span class="n">windowSize</span> <span class="o">=</span> <span class="n">rememberWindowSizeState</span><span class="o">()</span>
    <span class="n">val</span> <span class="n">isDrawerActive</span> <span class="o">=</span> <span class="n">windowSize</span> <span class="o">==</span> <span class="n">WindowSize</span><span class="o">.</span><span class="na">Compact</span>
    <span class="nf">ModalDrawer</span><span class="o">(</span>
        <span class="n">gesturesEnabled</span> <span class="o">=</span> <span class="n">isDrawerActive</span>
        <span class="n">drawerContent</span> <span class="o">=</span> <span class="o">{...}</span>
    <span class="o">)</span> <span class="o">{</span>
        <span class="n">val</span> <span class="n">showNavRail</span> <span class="o">=</span> <span class="n">isDrawerActive</span>
        <span class="nf">Row</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">showNavRail</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">AppNavRail</span><span class="o">()</span>
            <span class="o">}</span>
            <span class="n">JetnewsNavGraph</span><span class="o">()</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We then found that as the list of articles was still underutilised on the large screen, we decided to build the list/detail layout on the large screen, which is one of the recommended canonical layouts for large screens in Material Design, allowing us to display the list of articles side-by-side with the open articles. the JetNews app has two components that we can reuse: PostList and PostContent, and this splitting of the interface into components at the start not only made testing easier, but also allowed us to make improvements to the layout easily.</p>
<p>To display the Feed and Post side-by-side, JetNews simply wraps two components in a Row, the first with a fixed width and the second filling the rest of the screen. The Details component is wrapped in a crossfade animation, which allows users to see transitions with animated transitions when they click on a list to open a post.</p>
<p>To build the list/detail structure correctly, we needed to address several issues in addition to the actual layout. One of the more interesting points was to think about how the app would transition between different size layouts, for example for foldable phones where the app might change from a larger screen to a smaller one.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/5c0d815ed63046ad8b4ee6befccafd0f.png" alt="image"></p>
<p>△ Layout transformation on a foldable phone</p>
<p>To properly handle how to collapse list and detail windows into a single window hierarchy when on a smaller screen, we need to know which window the user last interacted with. To do this, we implemented a simple custom modifier to record the last interaction and use this to determine, in different collapsed states, what content should be displayed, thus further enhancing the hierarchy.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Composable</span>
<span class="n">fun</span> <span class="nf">HomeFeedWithArticleDetailsScreen</span><span class="o">(...)</span> <span class="o">{</span>
    <span class="n">Row</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">PostList</span><span class="o">(</span>
            <span class="n">modifier</span>
                <span class="o">.</span><span class="na">width</span><span class="o">(</span><span class="n">334</span><span class="o">.</span><span class="na">dp</span><span class="o">)</span>
                <span class="o">.</span><span class="na">notifyInput</span><span class="o">(</span><span class="n">onInteractWithList</span><span class="o">))</span>
        <span class="n">Crossfade</span><span class="o">(...)</span> <span class="o">{</span>
            <span class="n">PostContent</span><span class="o">(</span>
                <span class="n">modifier</span>
                    <span class="o">.</span><span class="na">fillMaxSize</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">notifyInput</span> <span class="o">{</span>
                        <span class="n">onInteractWithDetail</span><span class="o">(</span><span class="n">detailPost</span><span class="o">.</span><span class="na">id</span><span class="o">)</span>
                    <span class="o">}</span>
            <span class="o">)</span>
        <span class="o">}</span>
    <span class="o">)}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We also need to know what size screen we are moving from showing one of the windows at a time to showing a list/detail layout. In JetNews we first get information about the window size category, showing a single window at smaller and medium widths and a list/detail layout at expanded widths.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">val</span> <span class="nx">windowSize</span> <span class="o">=</span> <span class="nx">rememberWindowSizeState</span><span class="p">()</span>

<span class="nx">val</span> <span class="nx">homeScreenType</span> <span class="o">=</span> <span class="nx">when</span> <span class="p">(</span><span class="nx">windowSize</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">WindowSize</span><span class="p">.</span><span class="nx">Compact</span><span class="p">,</span>
    <span class="nx">WindowSize</span><span class="p">.</span><span class="nx">Medium</span> <span class="o">-&gt;</span> <span class="nx">HomeScreenType</span><span class="p">.</span><span class="nx">Feed</span>
    <span class="nx">WIndowSize</span><span class="p">.</span><span class="nx">Expanded</span> <span class="o">-&gt;</span> <span class="nx">HomeScreenType</span><span class="p">.</span><span class="nx">FeeWithArticleDetails</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Then it was time to start making changes to the navigation of JetNews, which was originally built as a main page and an article page, each with its own ViewModel, and the integration between the navigation and the ViewModel meant that the two pages were always on different navigation paths. However, in order to reorganise the pages into a list/detail layout, we need to display the two screens side by side, and here we have two options. One is to nest the NavHost on the details page, the other is to unify the ViewModel. As there is no next level navigation entry point within the details page and only one open article is displayed, we decided to go for the second approach and combine the two ViewModels into one to simplify the structure.</p>
<p>We created three entry points to the main screen, a HomeFeedScreen which only displays the PostList, an ArticleScreen which displays the PostContent and a new HomeFeedWithArticleDetailsScreen which displays the list/detail layout with the PostList and PostContent.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/a135089df466476a9f09427e6355ec90.png" alt="image"></p>
<p>△ Picture left: HomeFeedScreen entry point Picture right: ArticleScreen entry point</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/14/1b2b6fab34a644a88bd7d27dda3387c5.png" alt="image"></p>
<p>△ Main screen entry point HomeFeedWithArticleDetailsScreen</p>
<p>The image above shows the page style before and after we adapted it, and you can see that the use of screen space has improved dramatically. But this change is a screen size decision, can we make the individual components themselves have different sizes depending on the page? For example we have a card that is adapted to show an image when only the title and sub-title are displayed in the list due to space constraints and more space is available. For such cases we can use Box With Constraints, which is similar to a box layout and can be used for decision making based on the measurement information in the range.</p>
<h2 id="get-a-better-user-experience">Get a better user experience</h2>
<p>In the previous article, we mentioned that in order to provide a better user experience, please add features that make sense for your application, such as support for collapsible devices. Similar to the WindowManager API, we can easily integrate Compose with APIs for collapsible devices. Compose makes it easy to observe the state given by these APIs, so that the interface can be easily transformed. Again, APIs for this functionality will be available in Compose soon, so stay tuned.</p>
<p>In addition to the APIs mentioned so far, we have been working on the internal building blocks of Compose to enhance input devices including keyboard and mouse support, which is particularly useful for applications running on Chrome OS. Stay tuned for more information on Chrome OS and input in our upcoming articles.</p>
<p>For more details on Compose examples, see <a href="https://github.com/android/compose-samples">Compose example code</a>.</p>
<p>The new Compose and Large Screen Guide - <a href="https://developer.android.google.cn/jetpack/compose/layouts/adaptive">Building Adaptive Layouts</a> - will hopefully help you with your development. We hope you find this helpful.</p>
<h2 id="testing-and-maintenance">Testing and maintenance</h2>
<p>Now you know how to easily update your application to build new resizable interfaces. How to test and maintain the project is also a very important topic. Maintaining and supporting all the different sizes of interfaces introduces significant testing complexity, and we&rsquo;ve worked hard to increase test coverage without increasing the workload with new automated testing tools and APIs that allow you to configure more devices. We will be hosting devices through Gradle, enabling you to run existing instrumentation tests by running virtual devices on a variety of screen sizes and API levels. All you need to do is describe the configuration of the device on which you want to run the tests and Gradle will take care of the rest, including pre-configuring the device and running the test jobs.</p>
<p>Simply define the device during the build script and add it to the device group:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">testOptions</span>
    <span class="n">devices</span> <span class="o">{</span>
        <span class="n">pixel2api29</span> <span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">android</span><span class="o">.</span><span class="na">build</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">dsl</span><span class="o">.</span><span class="na">ManagedVirtualDevice</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">nexus9api30</span> <span class="o">(</span><span class="n">com</span><span class="o">.</span><span class="na">android</span><span class="o">.</span><span class="na">build</span><span class="o">.</span><span class="na">api</span><span class="o">.</span><span class="na">dsl</span><span class="o">.</span><span class="na">ManagedVirtualDevice</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">device</span> <span class="o">=</span> <span class="s">&#34;Nexus 9&#34;</span>
            <span class="n">apiLevel</span> <span class="o">=</span> <span class="n">30</span>
            <span class="n">systemImageSource</span> <span class="o">=</span> <span class="s">&#34;google&#34;</span>
            <span class="n">abi</span> <span class="o">=</span> <span class="s">&#34;×86&#34;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="n">deviceGroups</span> <span class="o">{</span>
        <span class="n">mediumAndExpandedWidth</span><span class="o">{</span>
            <span class="n">targetDevices</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">devices</span><span class="o">.</span><span class="na">pixel2api29</span><span class="o">)</span>
            <span class="n">targetDevices</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">devices</span><span class="o">.</span><span class="na">nexus9api30</span><span class="o">)</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The tests are then run using a Gradle hosted device group:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ gradlew -Pandroid.experimental.androidTest.useUnifiedTestPlatform<span class="o">=</span><span class="nb">true</span> mediumAndExpandedWidthGroupDebugAndroidTest
</code></pre></td></tr></table>
</div>
</div><p>As Gradle manages both device configuration and test jobs, Gradle hosted devices also support test slicing, allowing you to split tests across a specified number of identical devices to reduce overall test job time. Simply specify the following parameters to specify the number of shards to be split:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ gradlew -Pandroid.experimental.androidTest.numManagedDeviceShards<span class="o">=</span><span class="m">2</span> deviceDebugAndroidTest
</code></pre></td></tr></table>
</div>
</div><p>However, we know that running a large number of virtual devices can be CPU and memory intensive, which can limit the usefulness of Gradle hosted devices and test slices. To address this, Gradle hosted devices have introduced a new type of virtual device optimised for instrumentation testing, called automated test devices, which run in headless mode, disabling background processes and services not normally required for automated testing, thus reducing the overall CPU and memory usage per device, which will allow you to This will allow you to run tests on multiple devices representing different screen sizes at the same time. This feature is currently available on Android 10 and will be supported at higher API levels over time to ensure that existing screenshot tests can continue to work with automated test devices.</p>
<p>We are also working on a new set of <a href="https://developer.android.google.cn/jetpack/androidx/releases/test">AndroidX Testing APIs</a> that will allow you to put your device into different states for testing. For example, you can test how an app reacts when it changes from a flat fold to a half open state, or when it rotates between portrait or landscape modes.</p>
<h2 id="summary">Summary</h2>
<p>We&rsquo;ve discussed a lot today, from new design guidelines and window size classes to specific APIs for updating existing apps. large screens and foldable devices represent a large and growing segment of Android, and to capture this growth, now is the time to build and design interfaces for these devices to get a great experience for users using the most advanced devices.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/android/">android</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/hive/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Big Data Basics: HIVE</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/linux-process-stuck/">
            <span class="next-text nav-default">What should I do if my Linux process is stuck?</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
