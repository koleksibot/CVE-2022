<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>App Deep Linking and Delayed Deep Linking - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="APP Wakeup and Scene Restoration In App launch promotion, waking up users is a common operation strategy. To get users active again and convert their behavior, the path of users must be restored from the scene to find the mystery of user growth from the root. In this era of advertising, I believe most users have encountered a similar scenario when using an app: when using an information app, they" /><meta name="keywords" content="android, ios" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/deep-link-deferred-deeplink/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="App Deep Linking and Delayed Deep Linking" />
<meta property="og:description" content="APP Wakeup and Scene Restoration In App launch promotion, waking up users is a common operation strategy. To get users active again and convert their behavior, the path of users must be restored from the scene to find the mystery of user growth from the root. In this era of advertising, I believe most users have encountered a similar scenario when using an app: when using an information app, they" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/deep-link-deferred-deeplink/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-19T13:18:06+08:00" />
<meta property="article:modified_time" content="2022-01-19T13:18:06+08:00" />

<meta itemprop="name" content="App Deep Linking and Delayed Deep Linking">
<meta itemprop="description" content="APP Wakeup and Scene Restoration In App launch promotion, waking up users is a common operation strategy. To get users active again and convert their behavior, the path of users must be restored from the scene to find the mystery of user growth from the root. In this era of advertising, I believe most users have encountered a similar scenario when using an app: when using an information app, they"><meta itemprop="datePublished" content="2022-01-19T13:18:06+08:00" />
<meta itemprop="dateModified" content="2022-01-19T13:18:06+08:00" />
<meta itemprop="wordCount" content="8295">
<meta itemprop="keywords" content="android,ios," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="App Deep Linking and Delayed Deep Linking"/>
<meta name="twitter:description" content="APP Wakeup and Scene Restoration In App launch promotion, waking up users is a common operation strategy. To get users active again and convert their behavior, the path of users must be restored from the scene to find the mystery of user growth from the root. In this era of advertising, I believe most users have encountered a similar scenario when using an app: when using an information app, they"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">App Deep Linking and Delayed Deep Linking</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-19 13:18:06 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 8295 words </span>
          <span class="more-meta"> 17 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#app-wakeup-and-scene-restoration">APP Wakeup and Scene Restoration</a></li>
        <li><a href="#common-ways-to-wake-up-an-app">Common ways to wake up an app</a>
          <ul>
            <li><a href="#url-scheme">URL Scheme</a></li>
            <li><a href="#ios-universal-links">iOS Universal Links</a></li>
            <li><a href="#chrome-intent">Chrome Intent</a></li>
            <li><a href="#android-app-link">Android App Link</a></li>
          </ul>
        </li>
        <li><a href="#deeplink-deeplink">Deeplink Deeplink</a></li>
        <li><a href="#deferred-deep-linking">Deferred Deep Linking</a>
          <ul>
            <li><a href="#deferred-deeplink-implementation-idea">Deferred DeepLink implementation idea</a></li>
            <li><a href="#third-party-libraries">Third party libraries</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="app-wakeup-and-scene-restoration">APP Wakeup and Scene Restoration</h2>
<p>In App launch promotion, waking up users is a common operation strategy. To get users active again and convert their behavior, the path of users must be restored from the scene to find the mystery of user growth from the root.</p>
<p>In this era of advertising, I believe most users have encountered a similar scenario when using an app: when using an information app, they browsed to a Taobao product advertisement, and when you clicked on the content of the advertisement, it automatically opened the Taobao app already installed on your mobile phone and positioned to the details page of the product.</p>
<ul>
<li>As a user, you must be thinking: &ldquo;This is so convenient, I don&rsquo;t even need to open Taobao to search for products&rdquo;.</li>
<li>As an advertiser, you&rsquo;re thinking: &ldquo;I&rsquo;ve got another user, maybe I&rsquo;ll even get a conversion&rdquo;.</li>
</ul>
<p>So, how does the information app wake up the Taobao App, and how does the Taobao App jump to the ad page that the user is browsing?</p>
<p>Waking up &amp; scene restoration, as a common means of pulling live growth in operations, is conducive to enhancing the activity of old users in the App, and the scenario-based waking up is more likely to stimulate users' willingness to convert.</p>
<p>It is applicable to several marketing scenarios as follows.</p>
<ul>
<li>Browser -&gt; Wake up APP: User A opened the M site or official website of an APP through the browser on his mobile phone, then guide the user to open the APP or download the APP.</li>
<li>WeChat, QQ, etc. -&gt; Wake up APP: User shared a link to WeChat or QQ through an APP, and after user B clicked the link, user B was guided to open the APP or download the APP.</li>
<li>SMS, email, QR code, etc. -&gt; Wake up APP: User A opened a promotional SMS, email or scanned QR code of an APP, leading the user to open the APP or download the APP.</li>
<li>Other APP -&gt; Wake up APP: User A shared a link to User B through a third party APP, and after User B clicked on the link, User B was guided to open the specified APP or download the specified APP.</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/e9fb784fb07b428d9902b67594001194.png" alt="sobyte"></p>
<h2 id="common-ways-to-wake-up-an-app">Common ways to wake up an app</h2>
<h3 id="url-scheme">URL Scheme</h3>
<p>URI Schema is the most primitive of these methods, it only requires a scheme to be registered during native app development, then when the user clicks on such a link, the app will automatically wake up, and with the help of the URL Router mechanism, it can also jump to a specific page. This is the most widely used and simplest method, but it requires the app to support URL Scheme.</p>
<h4 id="ios-url-scheme">iOS URL Scheme</h4>
<p><strong>Sandboxing for iOS</strong></p>
<p>iOS has chosen to sandbox to protect user privacy and security, but sandboxing also prevents reasonable information sharing between apps, so URL Schemes is the solution. Generally speaking, the smart devices we use have a lot of our personal information on them. For example: contact details, bank/credit card information, account passwords for Alipay/Paypal/major stores, photos and even travel and location information.</p>
<p>If every app on your device, whether official or installed from any store, has access to this information at will, you could receive harassing messages and emails, or even serious consequences. How to keep this information out of the hands of other apps, or how to keep it out of the hands of the device owner, is a core security concern for all smart devices and operating systems.</p>
<p>In the case of iOS, Apple uses a mechanism called &lsquo;sandboxing&rsquo; to address this issue: apps can only access resources that they have declared they can access. All apps submitted to the App Store must adhere to this mechanism.</p>
<p>Sandboxing is a good solution in terms of security, but it is an overkill. Just because we don&rsquo;t want to disclose sensitive personal information doesn&rsquo;t mean that we don&rsquo;t want to share all that information with other apps. For example, if we want to put multiple events into our calendar at once (yes, just once), with information such as date and time and duration, we can&rsquo;t do this if the information is not communicated between apps. Something like adding multiple calendar events at once is a lot of unnecessary repetitive steps we encounter when using our smart devices. Most people are unaware of these repetitive steps, like when they have a batch of files on their computer that need to be renamed in bulk and they mechanically repeat the renaming process. But when we get to grips with the patterns in which these devices operate, or have some tools at our disposal, we can save all these repetitive steps. On iOS, one tool we can use is URL Schemes.</p>
<p><strong>What URL Schemes are</strong></p>
<p>It should be much easier to understand URL Schemes on iOS by comparing web links.</p>
<p>URL Schemes has two words.</p>
<ul>
<li>URL, which we all know well - <a href="http://www.apple.com">http://www.apple.com</a> is a URL, which we also call a link or URL.</li>
<li>Schemes, which refers to a location in a URL - the initial location, i.e. the character before ://. For example, the Schemes for the URL <a href="http://www.apple.com">http://www.apple.com</a> is http.</li>
</ul>
<p>Based on our use of URL Schemes above, we can easily see that on iOS, which is primarily a native application, we can use a special URL to locate an application or even a specific function within an application, just like we can locate a web page. What locates the app is the Schemes part of the app&rsquo;s URL, which is the opening part. For example, SMS is sms:</p>
<p>You can understand the URL of an iOS app in exactly the same way as you understand the URL of a web page - that is, its URL.</p>
<table>
<thead>
<tr>
<th></th>
<th>Web (Apple)</th>
<th>iOS App (WeChat)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Web Home/Open App</td>
<td><a href="http://www.apple.com">http://www.apple.com</a></td>
<td>weixin://</td>
</tr>
<tr>
<td>subpages/specific features</td>
<td><a href="http://www.apple.com/mac/">http://www.apple.com/mac/</a></td>
<td>weixin://dl/moments</td>
</tr>
</tbody>
</table>
<p>Here, <a href="http://www.apple.com">http://www.apple.com</a> and weixin:// both declare whose territory this is. Then add /mac to <a href="http://www.apple.com">http://www.apple.com</a> to jump to a web page (Mac page) belonging to <a href="http://www.apple.com">http://www.apple.com</a>; similarly, add dl/moments to weixin:// to go to a specific WeChat function - the -moments.</p>
<p>However, there are several other important differences between the two.</p>
<ul>
<li>All web pages must have a URL, whether it is the home page or a sub-page. In fact, the status quo is that most apps only have URL Schemes for opening apps, and some apps don&rsquo;t even have URL Schemes for opening apps. almost no app has a URL for every function. Almost no apps have URLs for all functions. So, don&rsquo;t say that so-and-so sucks and doesn&rsquo;t support domestic apps. Whether an app supports URL Schemes depends on whether the author of that app has added URL Schemes-related code to his work.</li>
<li>A URL only corresponds to one web page, but not every URL Schemes corresponds to one app. This is because Apple does not have a mandatory requirement for URL Schemes not to be duplicated, so there have been incidents where apps have used Paypal URL Schemes to block payment accounts and passwords.</li>
<li>URL Schemes on iOS are very difficult to guess because there is no standardized URL Scheme, so it is not practical to guess the URL Schemes of iOS apps.</li>
</ul>
<p><strong>Basic URL Schemes</strong></p>
<p>Basic URL Schemes are simple and limited in their capabilities, but they are the most common use case. By basic URL Schemes, we mean the Schemes part of a URL, such as the weixin: of WeChat mentioned above. The only function of this section is to open the corresponding application, without the ability to jump to any function.</p>
<p>The majority of apps that support URL Schemes generally have only one section, which is usually the name of the app, such as OmniFocus, whose basic URL Schemes is Omnifocus:. If the app&rsquo;s main name is a Chinese name, its URL Schemes might be the pinyin for the app&rsquo;s name, such as moke, whose basic URL Schemes is moke:. But the third of three important differences between web URLs and iOS app URLs is that URL Schemes on iOS are not standardised, and an app&rsquo;s URL can be anything from</p>
<ul>
<li>Coursera&rsquo;s URL is: coursera-mobile:</li>
<li>The URL for the game Duet is: x-kumo-duet:</li>
<li>The URL for the game Monument is: fb690517270143345:</li>
<li>The URL for Feedly is: fb129765800430121:</li>
<li>The URL for Fanzine News is: wx95962d02b9c3e2f7:</li>
</ul>
<p>They don&rsquo;t currently have uniform rules, so there&rsquo;s not much point in guessing an app; you can try, but don&rsquo;t count too much on that approach. The following section will mention how to find the basic URL Schemes for an application, as long as that application supports URL Schemes. Basic URL Schemes are simple and limited in their ability, but the context of use is the most common.</p>
<p><strong>Complex URL Schemes</strong></p>
<p>Mastering complex URL schemes gives you the initial ability to create automated processes that are adapted to your context. complex URL schemes for iOS apps are like links to sub-pages of a website, extending from the home page URL.</p>
<p>Specifically, there are two types of complex URL schemes: one that opens a feature of an app directly, and another that opens a feature and fills in pre-defined characters directly. This makes it a much more useful URL Schemes, as it not only takes you directly to the interface of a feature you need, but also fills in the content you need directly for you, and after the jump, all you need to do is click Done.</p>
<p>With URL schemes like this, apps can collaborate with each other. For example, when we see an article on Mr. Reader with a great piece of software, we can use OmniFocus URL Schemes to save the article name to the task name section and the link to the notes section. Until the advent of iOS 8&rsquo;s Share Sheet, this was the only way to transfer information between apps.</p>
<p>A special use case for complex URL Schemes is Jumpback, which is used a lot by dictionary apps, such as Eurodictionary. The traditional URL Schemes for looking up words using Eurodictionary are</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">eudic://dict/想查的单词
</code></pre></td></tr></table>
</div>
</div><p>To this, add the phrase Jumpback.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">eudic://dict/想查的单词?jumpback<span class="o">=</span>指定URL
</code></pre></td></tr></table>
</div>
</div><p>You will be able to press the back button in the top or bottom left corner to return to the app you want to go back to after looking up a word.</p>
<p>Not every app has its own complex URL Schemes, but generally speaking, apps with systematically standardised complex URL Schemes are the best of their kind.</p>
<p><strong>x-callback-URL</strong></p>
<p>Once you have jumped from one app&rsquo;s interface to another, you will see the words back to the previous app in the top left corner, and a tap will return you to the previous app. This is something we will no doubt want to do when we build our own automation, and while the aforementioned Jumpback is one option, there is a more powerful alternative - x-callback-URL - which has something that the &lsquo;back to previous app&rsquo; feature on iOS 9 cannot replace. What But there&rsquo;s no denying that x-callback-URL is less contextual and more difficult to use.</p>
<p>The URL Schemes we talked about earlier all have one purpose, and whatever the result, the jump will stay in the redirected application&rsquo;s interface once it is complete. However, when using URL Schemes, the result of the run may or may not work, and sometimes we will manually disable it.</p>
<p>If we also want the application to react to different results, we need to use x-callback-URL, for example, when the last URL Schemes run succeeds, do I go back to the application before the jump? Or do I want to take another action (take another URL Scheme and open a function in another application)? Whether you want to jump back to the previous application or open another action, whenever you want to do the next thing with a new URL Scheme after running one, you rely on x-callback-URL, which has the following fixed syntax.</p>
<ul>
<li>appending &amp;x-success to a URL Schemes to indicate what to do next after the previous URL succeeded.</li>
<li>A URL Schemes followed by &amp;x-error, indicating what to do next after the previous URL failed.</li>
<li>a URL Schemes followed by &amp;x-cancel, indicating what to do next after cancelling the result of the previous URL.</li>
<li>There is also an &amp;x-source which we will talk about when we come across it.</li>
</ul>
<p><strong>Encoding of URLs</strong></p>
<p>The characters in a URL can be divided into two categories, some of which can be displayed normally in a link, such as letters, numbers and some symbols such as /. Other than that, all characters cannot be displayed normally and need to be encoded to appear as part of the URL. For example, spaces must be represented as %20 in the URL, and there are many tools available on the web to encode and decode URLs, so that they can be decoded to make them look good to us. These tools can, of course, in turn convert our common characters into characters that can be used in URLs.</p>
<p>So theoretically, all characters that are not supported by URLs have to be encoded.</p>
<p><strong>Custom URL Scheme for jumping</strong></p>
<p>If we want someone to open our app (named SchemeDemo), we need to register a custom URL Scheme by going to info.plist -&gt; URL Types -&gt; item0 -&gt; URL Schemes -&gt; Your TestScheme to set it up, the steps are as follows.</p>
<ol>
<li>
<p>Click on the info.plist file in your project, when the file is displayed in the following window, mouse over the Information Property List at the top of the list, select +, then scroll down the pop-up list and select URL types, type NSArray.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/6b8376d360f749d38956fc07da2a2547.png" alt="sobyte"></p>
</li>
<li>
<p>click on the URL types left cut header to open the list, you can see Item 0, a dictionary entity. Expand Item 0 and you will see URL Identifier, a string object. This string is the name of your custom URL scheme. It is recommended that the name is unique by reversing the domain name, e.g. com.yourCompany.yourApp.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/c128b776c216436ea1aad6e2a49c88dd.png" alt="sobyte"></p>
</li>
<li>
<p>Click on Item 0 to add a new row, select URL Schemes from the drop down list and hit the Enter key to complete the insertion. Note that URL Schemes is an array that allows applications to define multiple URL schemes.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/56155b6f52684f69913c8ce44d88b0a7.png" alt="sobyte"></p>
</li>
<li>
<p>Expand the URL Schemes data and click on Item 0. Here you will define the name of your custom URL scheme. Just the name, do not append ://, for example, if you type iOSDevApp, your custom url will be iOSDevApp://.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/f9131c3202724faba439f5ac15389b48.png" alt="image"></p>
</li>
</ol>
<p>At this point, the entire definition is as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/f0069ea4f260459c964acb67331283d5.png" alt="sobyte"></p>
<h4 id="android-url-scheme">Android URL Scheme</h4>
<p>The custom URL Scheme in Android is an in-page jumping protocol, also known as a URLRouter, that routes an Activity through a web page in a similar way to opening a web page, rather than directly through an explicit Intent. The benefits of this implicit intent method jumping are as follows.</p>
<ul>
<li>Reduced coupling: no need to know exactly which interface to jump to, just send the Intent according to the agreed URL routing protocol, as required.</li>
<li>Safer: no Intent jumps are shown, as long as the Intent that matches the protocol is matched by the corresponding Activity, avoiding jumps to pages that shouldn&rsquo;t be there.</li>
<li>More flexible: there is a wider range of application scenarios, and URL Scheme can be used in a variety of scenarios</li>
</ul>
<p><strong>URL Scheme protocol format</strong>.</p>
<p>As mentioned above, the URL Scheme is a similar way to open a web page to open an Activity through a route, and the protocol format is similar to the URL we enter to open a web page.</p>
<p>A complete URL Scheme protocol consists of scheme, host, port, path and query, and is structured as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">&lt;scheme&gt;://&lt;host&gt;:&lt;port&gt;/&lt;path&gt;?&lt;query&gt;
</code></pre></td></tr></table>
</div>
</div><p>The common protocols in Android include content protocol, http protocol, file protocol, etc. Custom protocols can use custom strings, which are mostly used when we launch third-party applications.</p>
<p>The following is the URI of a custom protocol: xl://goods:8888/goodsDetail?goodsId=10011002</p>
<p>With the above path Scheme, Host, port, path, query all contain:</p>
<ul>
<li>xl, which is Scheme and represents the Scheme protocol name</li>
<li>goods, which is the Host, which represents the address domain that the Scheme acts on</li>
<li>8888, which is the port, representing the port number of the path</li>
<li>goodsDetail, which is the path, representing the page specified by the Scheme</li>
<li>goodsId, which is the query, represents the parameter passed</li>
</ul>
<p><strong>How to use URL Scheme</strong></p>
<p>In short, the use of URL Scheme is to first configure the activity in the manifest that can accept the Scheme method to start; when it needs to be called, add the Scheme protocol&rsquo;s URi to the Intent in the form of Data, and call the activity implicitly.</p>
<ol>
<li>Add <code>&lt;intent-filter&gt;</code> to the <code>&lt;activity&gt;</code> tag in AndroidManifest.xml to set Scheme</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&#34;.MainActivity&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span> <span class="c">&lt;!--正常启动--&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MAIN&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.LAUNCHER&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span> <span class="c">&lt;!--URL Scheme启动--&gt;</span>
        <span class="c">&lt;!--必有项--&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.VIEW&#34;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--如果希望该应用可以通过浏览器的连接启动，则添加该项--&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.BROWSABLE&#34;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--表示该页面可以被隐式调用，必须加上该项--&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.DEFAULT&#34;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--协议部分--&gt;</span>
        <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">&#34;urlscheme&#34;</span>
            <span class="na">android:host=</span><span class="s">&#34;auth_activity&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span>   <span class="na">android:name=</span><span class="s">&#34;emms.intent.action.check_authorization&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.DEFAULT&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;emms.intent.category.authorization&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>As you can see in the above settings, MainActivity contains multiple <code>&lt;intent-filter&gt;</code> settings, the first being the normal launch, i.e. launching in the application list; the second being the launch via URL Scheme, which is itself a type of implicit Intent call, the difference being the addition of the <code>&lt;data&gt;</code> attribute, which defines its acceptance The URL Scheme protocol format is urlschemel://auth_activity</p>
<p>It is important to note that the attributes that make up the URI in the URL Scheme protocol format are optional in the <code>&lt;data &gt;</code> tag, but there are dependencies as follows.</p>
<ul>
<li>if no scheme is specified, then the host parameter is ignored</li>
<li>If host is not specified, then the port parameter is ignored</li>
<li>If neither scheme nor host is specified, the path parameter is ignored</li>
</ul>
<p>When we compare the Uri parameter in the intent object with the URI format specified by the <code>&lt;data&gt;</code> tag in the intent-filter, we only compare the part specified by the <code>&lt;data&gt;</code> tag in the intent-filter, e.g.</p>
<ul>
<li>If only the scheme is specified in the intent-filter, then all URIs with that sheme will match that intent-filter.</li>
<li>If only scheme and authority (authority includes both host and port) are specified in the intent-filter and no path is specified, then all URIs with the same scheme and authority will match that intent-filter regardless of what path is.</li>
<li>If both scheme, authority and path are specified in the intent-filter, then only URIs with the same scheme, authority and path will match the intent-filter.</li>
</ul>
<p>Note that the <code>&lt;data&gt;</code> tag of an intent-filter can use the wildcard * character inside when specifying the value of path, to provide a partial match.</p>
<ol start="2">
<li>Launching an Activity using a URL</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">Uri <span class="nv">data</span> <span class="o">=</span> Uri.parse<span class="o">(</span><span class="s2">&#34;urlschemel://auth_activity&#34;</span><span class="o">)</span><span class="p">;</span>
 Intent <span class="nv">intent</span> <span class="o">=</span> new Intent<span class="o">(</span>Intent.ACTION_VIEW,data<span class="o">)</span><span class="p">;</span>
 //保证新启动的APP有单独的堆栈，如果希望新启动的APP和原有APP使用同一个堆栈则去掉该项
 intent.addFlags<span class="o">(</span>Intent.FLAG_ACTIVITY_NEW_TASK<span class="o">)</span><span class="p">;</span>
 try <span class="o">{</span>
   startActivityForResult<span class="o">(</span>intent, RESULT_OK<span class="o">)</span><span class="p">;</span>
 <span class="o">}</span> catch <span class="o">(</span>Exception e<span class="o">)</span> <span class="o">{</span>
   e.printStackTrace<span class="o">()</span><span class="p">;</span>
   Toast.makeText<span class="o">(</span>MainActivity.this, <span class="s2">&#34;没有匹配的APP，请下载安装&#34;</span>,Toast.LENGTH_SHORT<span class="o">)</span>.show<span class="o">()</span><span class="p">;</span>
 <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>It is of course possible to call from the web page.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;urlschemel://auth_activity&#34;</span><span class="p">&gt;</span>打开新的应用<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Alternatively, call in JS.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html">window.location = &#34;urlschemel://auth_activity&#34;;
</code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>How to determine if a URL Scheme is valid</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kt">boolean</span> <span class="nf">checkUrlScheme</span><span class="o">(</span><span class="n">Intent</span> <span class="n">intent</span><span class="o">){</span>
    <span class="n">PackageManager</span> <span class="n">packageManager</span> <span class="o">=</span> <span class="n">getPackageManager</span><span class="o">();</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">ResolveInfo</span><span class="o">&gt;</span> <span class="n">activities</span> <span class="o">=</span> <span class="n">packageManager</span><span class="o">.</span><span class="na">queryIntentActivities</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="n">0</span><span class="o">);</span>
    <span class="k">return</span> <span class="o">!</span><span class="n">activities</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Hide sub-apps in Home Launcher</strong></p>
<p>Sometimes it is necessary to hide some secondary, more independent APPs in the Home Launcher and only allow some specific APPs to call them. In this case, we can use the URL Scheme protocol to do this, setting the <code>&lt;activity &gt;</code> tag in AndroidManifest.xml as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&#34;.MainActivity&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MAIN&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.LAUNCHER&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.BROWSABLE&#34;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--表示该页面可以被隐式调用，必须加上该项--&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.DEFAULT&#34;</span><span class="nt">/&gt;</span>
        <span class="c">&lt;!--协议部分--&gt;</span>
        <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">&#34;urlscheme&#34;</span>
            <span class="na">android:host=</span><span class="s">&#34;auth_activity&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Because the Home Launcher lists application icons that require an Activity to also meet.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MAIN&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.LAUNCHER&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The above configuration has redundant category and data restrictions present, so it does not match and will not appear in Home Launcher, but can be launched using URL Scheme.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">Uri</span> <span class="n">data</span> <span class="o">=</span> <span class="n">Uri</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">&#34;urlschemel://auth_activity&#34;</span><span class="o">);</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_MAIN</span><span class="o">,</span><span class="n">data</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">addFlags</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">FLAG_ACTIVITY_NEW_TASK</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div><p>This allows a group of APPs to be set up with a unified entry point, and then different sub-APPs can be invoked according to actual needs, i.e. the so-called APP business componentization.</p>
<h4 id="disadvantages-of-url-scheme">Disadvantages of URL Scheme</h4>
<p><strong>Hint box</strong></p>
<p>We can only jump through links with fixed protocol format, and when opening an H5 page, a prompt box will appear: &ldquo;Do you want to open XXX&rdquo;. The user confirms it before jumping to the App, adding to the user process.</p>
<p><strong>Exceptions caused by not installing the App</strong></p>
<p>The error handling situation is difficult to handle uniformly depending on the platform, some APPs will directly jump to the error page (e.g. Android Chrome/41, old Lofter in iOS); some stay on the original page but pop up a prompt &ldquo;cannot open the page&rdquo; (e.g. iOS7); iOS8 and the latest Android Chrome/43 currently stay directly on the current page without popping up an error prompt.</p>
<p><strong>Scenario support</strong></p>
<p>In iOS, Tencent&rsquo;s WeChat and QQ are explicitly forbidden to be used. iOS9 and later Safari no longer support triggering scheme jumps through js, iframes, etc., and a confirmation mechanism has been added, making it basically impossible to automatically wake up the APP through the js timeout mechanism; Android platform varies greatly from app vendor to app vendor, for example, Chrome is the same as Safari since 25 and later.</p>
<p><strong>Naming conflicts or hijacking</strong></p>
<p>Apple has adopted the first-come, first-served principle in subsequent versions of iOS (iOS 11), so that if the same URL scheme is used, only the app that was installed first will be launched. However, an attacker can still exploit this vulnerability in other ways.</p>
<p><strong>Opening method is banned</strong></p>
<p>WeChat and QQ have banned URL Scheme from opening apps, but they each maintain a whitelist, so if Scheme is not on that whitelist, then the app cannot be opened from within their app (if it is blocked then the user can only open the app from within the browser in the top right corner)</p>
<h3 id="ios-universal-links">iOS Universal Links</h3>
<p>Universal Link is one of the new features of iOS9 introduced by Apple at WWDC. This feature is similar to deep linking and makes it easy to launch your client app (with an app installed on your phone) directly by opening an Https link. This new feature provides an excellent user experience when seamlessly linking web-apps compared to the URL Scheme used previously.</p>
<p>When your app supports Universal Link, when a user clicks on a link they can jump to your website and get a seamless redirect to the corresponding app, without the need to go through Safari. If your app does not support it, the link will open in Safari.</p>
<p>Using Universal Link allows users to pull up the corresponding APP in the Safari browser or in the webview of another APP, as well as using the corresponding function within the APP to drive users to the APP. What does this look like? For example, you have a user browsing your company&rsquo;s website in safari, and you have your app installed on your phone; Universal Link enables the user to open your app directly when they open a detail page and reach the corresponding content page in the app to perform the action they want (e.g. view a news item, view the details of a product, etc.). The Universal Link allows the user to open a detail page of your app and go directly to the corresponding content page in the app to perform the action they want (e.g. view a news item, view a product detail, etc.). For example, if you go to the Taobao website in Safari and click on the app, the Universal Link is used to pull up the Taobao app.</p>
<p><strong>Advantages of Universal Link:</strong></p>
<ul>
<li>Custom URL scheme is a custom protocol and therefore cannot be opened directly without the app being installed. Universal Links is itself a standard web link that can point to a web page or content page within the app (e.g. <a href="https://example.com">https://example.com</a>) and is therefore very compatible with other situations. This means that when the app is installed, the app will be launched immediately without loading any web pages; when the app is not installed, it will redirect the user from the current browser to the App Store by default to download and install the app.</li>
<li>Universal links looks up which app needs to be opened from the server, so there is no name grabbing or conflict as in the Custom URL scheme.</li>
<li>Universal links supports jumping to the target app from a UIWebView in another app</li>
<li>Security, when using a universal link to open, only you can open your app by creating and uploading a file that allows this page to go to your app via this URL.</li>
<li>Privacy, providing a universal link to other apps for inter-app communication, however the other app cannot use this method to detect if your app is installed.</li>
</ul>
<p><strong>Features of Universal link.</strong></p>
<ul>
<li>Uniqueness: Unlike a custom URL scheme, it uses the standard HTTPS protocol to link to your web site, so it is generally not claimed by other APPs. In addition, the URL scheme cannot be opened directly without an app installed because it is a custom protocol (and a pop-up window will appear in Safari that will not open), whereas Universal Link is itself an HTTPS link and therefore has better compatibility.</li>
<li>Security: when your APP is installed on the user&rsquo;s phone, the system will go to the website you have configured and download the instructions file you uploaded (this instruction file declares which APPs can be opened by the current HTTPS link). Since only you can upload files to the root of your website, the association between your website and your APP is secure.</li>
<li>Variable: Universal Link (Universal Link) works even when your APP is not installed on the user&rsquo;s phone. If you wish, a user clicking on a link without your app installed will display the content of your website in safari.</li>
<li>Simple: an HTTPS link that works for both the website and the APP.</li>
<li>Private: other APPs can communicate with your APP without needing to know whether your APP is installed or not.</li>
</ul>
<p><strong>Universal link configuration and operation</strong></p>
<ol>
<li>Configure App IDs to support Associated Domains</li>
</ol>
<p>Go to <a href="https://developer.apple.com/">https://developer.apple.com/</a> and locate the App ID in the Apple Developer Center, and in the Application Services list, there is an entry for Associated Domains. Make it Enabled and you&rsquo;re good to go.</p>
<ol start="2">
<li>Configure the iOS App project</li>
</ol>
<p>Xcode version 11.0: Project configuration: targets-&gt;Signing&amp;Capabilites-&gt;Capability-&gt;Associated Domains, fill in the Domains you want to support, you must also prefix it with applinks.</p>
<p>Xcode 11.0 and below: Project Configuration: targets-&gt;Capabilites-&gt;Associated Domains, enter the domain name you wish to support in the Domains section, which must be prefixed with applinks.</p>
<ol start="3">
<li>Configure and upload apple-app-association</li>
</ol>
<p>Exactly which URLs will be recognised as Universal Links depends on this apple-app-association file <a href="https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html">Apple Document UniversalLinks.html</a></p>
<ul>
<li>Your domain must support Https</li>
<li>Put this file apple-app-association under the root of your domain or .well known directory without any suffixes.</li>
<li>The file is json and can be saved as text</li>
<li>json according to the official website</li>
</ul>
<p>apple-app-site-association template.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;applinks&#34;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&#34;apps&#34;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="nt">&#34;details&#34;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&#34;appID&#34;</span><span class="p">:</span> <span class="s2">&#34;9JA89QQLNQ.com.apple.wwdc&#34;</span><span class="p">,</span>
                <span class="nt">&#34;paths&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;/wwdc/news/&#34;</span><span class="p">,</span> <span class="s2">&#34;/videos/wwdc/2015/*&#34;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&#34;appID&#34;</span><span class="p">:</span> <span class="s2">&#34;ABCD1234.com.apple.wwdc&#34;</span><span class="p">,</span>
                <span class="nt">&#34;paths&#34;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&#34;*&#34;</span> <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Description.</p>
<ul>
<li>appID: the composition is yourapp&rsquo;s bundle identifier. e.g. 9JA89QQLNQ above is teamId. login to developer centre, you can find the team ID in Account -&gt; Membership.</li>
<li>paths: Set the list of paths supported by your app, only links from these specified paths will be processed by the app. The asterisk means that all links under the domain are recognised.</li>
</ul>
<p>Upload the specified file: Upload the file to the root directory or .well known directory of your domain, so that Apple can get the file you uploaded. Once you have uploaded the file, visit it yourself to see if it is available. When you type the link into your browser, it should download the apple-app-site-association file directly.</p>
<p><strong>Verify Universal link is active</strong>.</p>
<p>You can use the memo app that comes with iOS, enter the link, long press the link and if the pop-up menu says &ldquo;Open in &lsquo;xxx&rsquo;&rdquo;, then the configuration is active. Alternatively, open the URL you want to test in Safari and scroll down to the top of the page that appears and you will see the &ldquo;Open in &lsquo;xxx&rsquo; app&rdquo; menu.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/d9691d51196d4c24993279ab346873f4.png" alt="sobyte"></p>
<p>When a link is clicked, it will take you directly to our app, but our aim is to be able to get the link the user came from and show the user the appropriate content based on the link.</p>
<p>The official link to implement the proxy method in AppDelegate: <a href="https://developer.apple.com/documentation/xcode/supporting-universal-links-in-your-app">Handling Universal Links</a></p>
<p>Objective-C:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">- (BOOL)application:(UIApplication *)application continueUserActivity:(NSUserActivity *)userActivity restorationHandler:(void (^)(NSArray * _Nullable))restorationHandler {
    if ([userActivity.activityType isEqualToString:NSUserActivityTypeBrowsingWeb])
    {
        NSURL *url = userActivity.webpageURL;
        if (url是我们希望处理的)
        {
            //进行我们的处理
        }
        else
        {
            [[UIApplication sharedApplication] openURL:url];
        }
    }
     
    return YES;
}
</code></pre></td></tr></table>
</div>
</div><p>Swift:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="kc">_</span> <span class="n">application</span><span class="p">:</span> <span class="n">UIApplication</span><span class="p">,</span>
                 <span class="k">continue</span> <span class="n">userActivity</span><span class="p">:</span> <span class="n">NSUserActivity</span><span class="p">,</span>
                 <span class="n">restorationHandler</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="p">([</span><span class="nb">Any</span><span class="p">]?)</span> <span class="p">-&gt;</span> <span class="nb">Void</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span>
<span class="p">{</span>
    <span class="k">guard</span> <span class="n">userActivity</span><span class="p">.</span><span class="n">activityType</span> <span class="p">==</span> <span class="n">NSUserActivityTypeBrowsingWeb</span><span class="p">,</span>
        <span class="kd">let</span> <span class="nv">incomingURL</span> <span class="p">=</span> <span class="n">userActivity</span><span class="p">.</span><span class="n">webpageURL</span><span class="p">,</span>
        <span class="kd">let</span> <span class="nv">components</span> <span class="p">=</span> <span class="n">NSURLComponents</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="n">incomingURL</span><span class="p">,</span> <span class="n">resolvingAgainstBaseURL</span><span class="p">:</span> <span class="kc">true</span><span class="p">),</span>
        <span class="kd">let</span> <span class="nv">path</span> <span class="p">=</span> <span class="n">components</span><span class="p">.</span><span class="n">path</span><span class="p">,</span>
        <span class="kd">let</span> <span class="nv">params</span> <span class="p">=</span> <span class="n">components</span><span class="p">.</span><span class="n">queryItems</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>
    
    <span class="bp">print</span><span class="p">(</span><span class="s">&#34;path = </span><span class="si">\(</span><span class="n">path</span><span class="si">)</span><span class="s">&#34;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="kd">let</span> <span class="nv">albumName</span> <span class="p">=</span> <span class="n">params</span><span class="p">.</span><span class="bp">first</span><span class="p">(</span><span class="k">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">name</span> <span class="p">==</span> <span class="s">&#34;albumname&#34;</span> <span class="p">}</span> <span class="p">)?.</span><span class="n">value</span><span class="p">,</span>
        <span class="kd">let</span> <span class="nv">photoIndex</span> <span class="p">=</span> <span class="n">params</span><span class="p">.</span><span class="bp">first</span><span class="p">(</span><span class="k">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="p">.</span><span class="n">name</span> <span class="p">==</span> <span class="s">&#34;index&#34;</span> <span class="p">})?.</span><span class="n">value</span> <span class="p">{</span>
        
        <span class="bp">print</span><span class="p">(</span><span class="s">&#34;album = </span><span class="si">\(</span><span class="n">albumName</span><span class="si">)</span><span class="s">&#34;</span><span class="p">)</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&#34;photoIndex = </span><span class="si">\(</span><span class="n">photoIndex</span><span class="si">)</span><span class="s">&#34;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">true</span>
        
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&#34;Either album name or photo index missing&#34;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Universal link cross domain issues</strong></p>
<p>Universal Link has cross-domain problem, Universal Link must require cross-domain, if not, it will not jump (iOS 9.2 after the change) require cross-domain capability can be, if the current web page domain is A, the current web page launch jump domain is B, must require B and A is a different domain to trigger Universal Link, if B and A is the same domain, it will only continue to jump in the current WebView. If B and A are the same domain, it will only continue to jump inside the current WebView, even if your Universal Link is working fine and will not open the app at all. 2. Universal Link request apple-app- site-association timing</p>
<ul>
<li>When our app is first run on the device, iOS will automatically GET the apple-app-site-association file under the defined Domain if the Associated Domains feature is supported</li>
<li>iOS will request <a href="https://domain.com/.well-known/apple-app-site-association">https://domain.com/.well-known/apple-app-site-association</a> first, and then go to <a href="https://domain.com/apple-app-site-association">https://domain.com/apple-app-site-association</a> if this file is not requested, so if you want to avoid the server receiving too many GET requests, you can just put apple-app-site-association in the . /well-known directory</li>
</ul>
<p><strong>Universal Link updates</strong></p>
<p>The apple-app-association is updated at two times.</p>
<ul>
<li>The first Launch after each App installation will pull apple-app-association</li>
<li>The first Launch of the Appstore after each App version update will also update apple-app-association</li>
</ul>
<p>So repeatedly re-killing the app and reopening it is completely useless. Deleting the app and reinstalling it does work, but it is unlikely that users will be allowed to do so. That said, once you accidentally apple-app-association by accident and want to redeem and make that part of the user indifferent, the App will just release another version.</p>
<p><strong>Universal Link user behaviour</strong></p>
<p>Universal Link triggered after opening the App, at this time the App&rsquo;s status bar will have a text prompt from XXApp in the upper right corner, you can tap the status bar text to quickly return to the original AP</p>
<p>If the user taps back to WeChat, it will be remembered by Apple that the user does not need to jump out of the original app to open a new app, so the Universal Link for this app will be turned off and will never be valid again.</p>
<p>It is not impossible to turn it on by asking the user to re-open the Universal Link page in Safari and then something like the Apple smart bar will appear, which will open when tapped</p>
<p><strong>H5-side Universal Link business deployment</strong></p>
<p>The Universal Link jump on the H5 side, from a product manager&rsquo;s point of view, needs to meet 2 requirements.</p>
<ul>
<li>If an App is installed, the corresponding interface will be redirected</li>
<li>If no App is installed, jump to the App download interface</li>
</ul>
<p>Example of Universal Link deployment on the H5 side.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">router</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">&#39;/view&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">,</span> <span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">path</span><span class="p">;</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;https://www.xxx.com/view&#39;</span> <span class="o">+</span> <span class="nx">path</span> <span class="o">+</span> <span class="s1">&#39;?xxx=xxx&#39;</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>The whole effect is</p>
<ul>
<li>Jump to <code>https://www.xxx.com/view/*</code>
<ul>
<li>App installed
<ul>
<li>Open App triggers handleUniversalLink</li>
<li>Goes to the /view/ branch and splices the reading page to route the jump</li>
</ul>
</li>
<li>AppWebView is not installed
<ul>
<li>Jump in place <code>https://www.xxx.com/view/*</code></li>
<li>Hit the server&rsquo;s redirection logic</li>
<li>redirects to <code>https://www.xxx.com/view/*</code></li>
<li>Open the corresponding H5 page</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="chrome-intent">Chrome Intent</h3>
<p>In many applications we need to launch the application directly from the browser, most of them use the first scheme way mentioned above, the problem is that if there is no application in the phone, the url will jump to an error screen.</p>
<p>Google has officially introduced a way to launch apps in chrome with Android Intents, by setting the src in the iframe to</p>
<ul>
<li>intent:HOST/URI-path // Optional host</li>
<li>#Intent;</li>
<li>package=[string];</li>
<li>action=[string];</li>
<li>category=[string];</li>
<li>component=[string];</li>
<li>scheme=[string];</li>
<li>end;</li>
</ul>
<p>The mainfest file defines the activity to be launched.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;activity</span>
    <span class="na">android:name=</span><span class="s">&#34;.ui.activity.SplashActivity&#34;</span>
    <span class="na">android:exported=</span><span class="s">&#34;true&#34;</span>
    <span class="na">android:screenOrientation=</span><span class="s">&#34;portrait&#34;</span>
    <span class="na">android:theme=</span><span class="s">&#34;@style/NormalSplash&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.MAIN&#34;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.LAUNCHER&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
    
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.VIEW&#34;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.DEFAULT&#34;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.BROWSABLE&#34;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;data</span>
            <span class="na">android:host=</span><span class="s">&#34;app.puxinwangxiao.com&#34;</span>
            <span class="na">android:scheme=</span><span class="s">&#34;pxwxstudent&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Define an a tag as</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;intent://app.domain.com/#Intent;scheme=xyz;package=com.xxx.xxx;end&#34;</span><span class="o">&gt;</span><span class="nx">open</span> <span class="nx">Android</span> <span class="nx">App</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Click on the a tag in the browser to launch the corresponding activity of the application. If there is no corresponding application in the phone to prevent jumping to the wrong page, set the a tag to</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&#34;intent://app.domain.com/#Intent;scheme= xyz;package=com.xxx.xxx;S.browser_fallback_url=https://www.domain.com;end&#34;</span><span class="o">&gt;</span><span class="nx">open</span> <span class="nx">Android</span> <span class="nx">App</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>This way if there is no corresponding app, the link will jump to the url specified by <code>==S.browser_fallback_url===</code>.</p>
<p>Note: Many third party browsers will block requests for chrome intent to launch applications.</p>
<h3 id="android-app-link">Android App Link</h3>
<p>Similar to Universal Links, <a href="https://developer.android.com/training/app-links/index.html">Android App Link</a> takes a similar mechanism: it uses a standard web page URL and binds the corresponding App. This mechanism is supported on Android &gt;= 6.</p>
<p>Android App Links have the following benefits.</p>
<ul>
<li>Security/specificity: since Android App Links use HTTP/HTTPS URLs to authenticate the connection to the developer&rsquo;s server, other apps cannot use our links</li>
<li>Seamless user experience: When a user does not install our app, it will open a web page directly due to the use of HTTP/HTTPS URLs, where we can show the app description etc. instead of displaying a 404 or other error page</li>
<li>Support for Instant Apps: you can use App Links to open an uninstalled Instant App directly.</li>
<li>Support for Google Search or other browsers: users can open our specific page directly in Google Search/Google Assistant/Mobile Browser/Screen Search by clicking on a URL directly.</li>
</ul>
<p>To add Android App Links to the app, you need to define an intent filter in the app that opens the app via the Http(s) address and verify that you actually own the app and the site. If the system successfully verifies that you own the site, then the system will route the intent corresponding to the URL directly to your app.</p>
<p>In order to verify your ownership of the app and website, the following two steps are necessary.</p>
<ul>
<li>Ask the system in AndroidManifest to automatically perform ownership verification of App Links. This configuration tells the Android system to verify that your app belongs to the URL domain specified within the intent filter.</li>
<li>Place a Json file of digital asset links declaring the relationship between your URL and the app in the following link address: <a href="https://domain.name/.well-known/assetlinks.json">https://domain.name/.well-known/assetlinks.json</a></li>
</ul>
<p><strong>Activate App links in the app</strong></p>
<p>Tell Android to verify the relationship between the app and the domain name. Since we have already registered the domain in the app, no more pop-up boxes will appear. Find the AndroidManifest.xml file and add android:autoVerify=&ldquo;true&rdquo; to intent- in the activity that handles deep link routing (step 3 will explain how to create such an activity). filter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;activity</span>
  <span class="na">android:name=</span><span class="s">&#34;.ParseDeepLinkActivity&#34;</span>
  <span class="na">android:alwaysRetainTaskState=</span><span class="s">&#34;true&#34;</span>
  <span class="na">android:launchMode=</span><span class="s">&#34;singleTask&#34;</span>
  <span class="na">android:noHistory=</span><span class="s">&#34;true&#34;</span>
  <span class="na">android:theme=</span><span class="s">&#34;@android:style/Theme.Translucent.NoTitleBar&#34;</span><span class="nt">&gt;</span>
  
  <span class="nt">&lt;intent-filter</span> <span class="na">android:autoVerify=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">&#34;http&#34;</span> <span class="na">android:host=</span><span class="s">&#34;yourdomain.com&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">&#34;https&#34;</span> <span class="na">android:host=</span><span class="s">&#34;yourdomain.com&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.action.VIEW&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.DEFAULT&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&#34;android.intent.category.BROWSABLE&#34;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>This configuration tells Android to validate a file which is located at <a href="https://yourdomain.com/.well-known/statements.json">https://yourdomain.com/.well-known/statements.json</a>. If this file exists and also validates successfully, then when the user clicks on the link under that domain, they can go directly to the app and the pop-up box can be avoided. Otherwise the app is not made the default option and the pop-up box is presented to the user.</p>
<p><strong>Upload web-app association file (statements.json)</strong></p>
<p>For security reasons, this file must be obtained via a GET request over SSL.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="p">[{</span>
  <span class="s2">&#34;relation&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;delegate_permission/common.handle_all_urls&#34;</span><span class="p">],</span>
  <span class="s2">&#34;target&#34;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&#34;namespace&#34;</span><span class="o">:</span> <span class="s2">&#34;android_app&#34;</span><span class="p">,</span>
    <span class="s2">&#34;package_name&#34;</span><span class="o">:</span> <span class="s2">&#34;com.mycompany.myapp&#34;</span><span class="p">,</span>
    <span class="s2">&#34;sha256_cert_fingerprints&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;6C:EC:C5:0E:34:AE....EB:0C:9B&#34;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}]</span>
</code></pre></td></tr></table>
</div>
</div><p>The package name of the app can be found in the AndroidManifest.xml file. ava keytool should also be run in the terminal to generate a sha256 fingerprint</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">keytool -list -v -keystore /path/to/app/release-key.keystore
</code></pre></td></tr></table>
</div>
</div><p>You need to add the path to the app that holds the app release keys to the keystore. This path depends on the project settings and is therefore different for different apps. More information on how to find the keystore can be found in the Google documentation.</p>
<p>Finally, upload this file to the server at /.well known/statements.json. To avoid having to access the network for every future app link request, Android will only check this file when the app is installed. If you can see this file when you request <a href="https://yourdomain.com/.well-known/statements.json">https://yourdomain.com/.well-known/statements.json</a> (replace it with your own domain name haha) then you can move on to the next step.</p>
<p>Note: Currently you can get this file via http, but in the final version of M you can only authenticate via HTTPS. Make sure your web site supports HTTPS requests.</p>
<p><strong>Handle applink in app</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ParseDeepLinkActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">PRODUCTS_DEEP_LINK</span> <span class="o">=</span> <span class="s">&#34;/products&#34;</span><span class="o">;</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">XMAS_DEEP_LINK</span> <span class="o">=</span> <span class="s">&#34;/campaigns/xmas&#34;</span><span class="o">;</span>
  
  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
    <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">main</span><span class="o">);</span>
 
    <span class="c1">// Extrapolates the deeplink data
</span><span class="c1"></span>    <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">();</span>
    <span class="n">Uri</span> <span class="n">deeplink</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
 
    <span class="c1">// Parse the deeplink and take the adequate action 
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">deeplink</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">parseDeepLink</span><span class="o">(</span><span class="n">deeplink</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
  
  <span class="kd">private</span> <span class="kt">void</span> <span class="nf">parseDeepLink</span><span class="o">(</span><span class="n">Uri</span> <span class="n">deeplink</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// The path of the deep link, e.g. &#39;/products/123?coupon=save90&#39;
</span><span class="c1"></span>    <span class="n">String</span> <span class="n">path</span> <span class="o">=</span> <span class="n">deeplink</span><span class="o">.</span><span class="na">getPath</span><span class="o">();</span>
 
    <span class="k">if</span> <span class="o">(</span><span class="n">path</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="n">PRODUCTS_DEEP_LINK</span><span class="o">))</span> <span class="o">{</span>
      <span class="c1">// Handles a product deep link
</span><span class="c1"></span>      <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">ProductActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
      <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">,</span> <span class="n">deeplink</span><span class="o">.</span><span class="na">getLastPathSegment</span><span class="o">());</span> <span class="c1">// 123
</span><span class="c1"></span>      <span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="s">&#34;coupon&#34;</span><span class="o">,</span> <span class="n">deeplink</span><span class="o">.</span><span class="na">getQueryParameter</span><span class="o">(</span><span class="s">&#34;coupon&#34;</span><span class="o">));</span> <span class="c1">// save90
</span><span class="c1"></span>      <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">XMAS_DEEP_LINK</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">path</span><span class="o">))</span> <span class="o">{</span>
      <span class="c1">// Handles a special xmas deep link
</span><span class="c1"></span>      <span class="n">startActivity</span><span class="o">(</span><span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">XmasCampaign</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>  <span class="k">else</span> <span class="o">{</span>
      <span class="c1">// Fall back to the main activity
</span><span class="c1"></span>      <span class="n">startActivity</span><span class="o">(</span><span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">MainActivity</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="deeplink-deeplink">Deeplink Deeplink</h2>
<p>Deep linking is the action of providing personalised content to a user when they open a mobile app, or taking them to a specific location within the app. By doing this, you can provide your users with a quality user experience that greatly enhances their interaction with the app.</p>
<ul>
<li>Opening the app in a browser or SMS will open the app directly if it is installed, otherwise it leads to a download. For Android, the main technology involved here is deeplink, which can also be seen simply as scheme.</li>
<li>In fact, AppLink is a special Deeplink, except that it has an additional mechanism similar to verification, if the verification passes, it will be set to open by default, if the verification does not, it will degrade to deeplink. &ldquo;true&rdquo;.</li>
<li>Also in WeChat, you can make this operation. If the user has already installed the app, clicking on the jumping app will open the app and jump to the corresponding page via App Store, which is also a kind of AppLink.</li>
</ul>
<p>To sum up, Deeplink, also known as deeplink technology, refers to the technology of clicking on a link in an app/sms/advertisement to jump directly to the specific location of the target app, which breaks the barrier between the website and the app and becomes a bridge between the website and the app. Developers can use deeplink not only to jump from websites to apps, but also to jump from multiple platforms (QQ, WeChat, Weibo, Twitter, Facebook, SMS, major browsers, etc.) to specific pages within apps. For example, if a user sends a link to a detail page in an e-commerce app to other friends and family via SMS, the user can click on the link in the SMS to open the corresponding H5 page and then jump directly to the specified detail page in the e-commerce app, instead of the app home page. If the user has not installed the app, then they will be redirected to the app download page. Deeplinking technology not only enables the rapid restoration of scenes and shortens the user&rsquo;s path, but more importantly, it can be used to promote new apps and reduce user churn.</p>
<p>Deep Linking is just a concept that refers to a link to another website/app and a page directly within it. Deep Linking gives the user a very smooth browsing experience, especially in the web world where Deep Linking is very easy to implement.</p>
<p>URI Scheme, Universal Links, Android App Links, and Chrome Intent are all attempts to solve the problem of Deep Linking from a web page to an app.</p>
<p>Each of these implementations has its own platform and browser, and compatibility with most browsers requires different policies to be applied depending on the User Agent. The behaviour of these implementations is also inconsistent and it may be necessary to work with product requirements to determine which implementations to combine. These implementations are described in more detail below, with the following table providing an overview of the differences between the implementations.</p>
<table>
<thead>
<tr>
<th>Technology</th>
<th>Universal Link</th>
<th>Android App Link</th>
<th>URI Scheme</th>
<th>Chrome Intent</th>
</tr>
</thead>
<tbody>
<tr>
<td>Platform Requirements</td>
<td>&gt;= iOS 9</td>
<td>&gt;= Android 6</td>
<td>Chrome 1 &lt; 25, iOS</td>
<td>Chrome 1 &gt;= 25</td>
</tr>
<tr>
<td>No performance installed</td>
<td>Open Web page</td>
<td>Open Web page</td>
<td>An error occurred</td>
<td>Can open Web page</td>
</tr>
<tr>
<td>Can you not jump</td>
<td>No</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Can I go to a download page</td>
<td>can</td>
<td>can</td>
<td>can</td>
<td>can</td>
</tr>
<tr>
<td>iframe triggering</td>
<td>not supported</td>
<td>not supported</td>
<td>Chrome 1 &lt;= 18, iOS &lt; 9</td>
<td>not supported</td>
</tr>
<tr>
<td>link format 2</td>
<td>normal URLs</td>
<td>normal URLs</td>
<td>custom protocol URLs</td>
<td>intent protocol URLs</td>
</tr>
</tbody>
</table>
<p><strong>JavaScript get success or not</strong></p>
<p>All of the above must be requested from the page (except for iframes in certain cases) and there is no JavaScript API available. In theory there is no callback for the result of a call-up.</p>
<p>In practice, however, it is possible to use setTimeout to check whether the page is still running and whether it has been interrupted. The principle is that if the page cuts away (which means it was successfully raised), the trigger point for the setTimeout callback will be delayed. This approach is not accurate, but it is the only one available.</p>
<ul>
<li>If it is judged to be a successful call-up, it must be a successful call-up.</li>
<li>If the call-up is judged to be a failure, it is possible that the call-up will be successful.</li>
</ul>
<p>That is, there is a high probability of False Negative, but not False Positive.</p>
<p><strong>About domestic browsers</strong></p>
<p>This section discusses the performance of these three browsers: UC, WeChat, and QQ, which hold most of the market share outside of the system browser and perform surprisingly consistently.</p>
<ul>
<li>They block all page launches under Android. Users need to be prompted to open from the system browser.</li>
<li>For iOS they block URI Scheme and neither pop-ups nor call-ups. For Universal Link they open the web page directly without raising it.</li>
</ul>
<p>Where the UC browser is on iOS &lt; 9, attempting a URI Scheme bring-up is likely to crash straight away. Due to browser compatibility issues and the fact that the app installation rate is unlikely to be 100%, the success rate is generally very low, especially on Android.</p>
<h2 id="deferred-deep-linking">Deferred Deep Linking</h2>
<p>Compared to deeplink, it adds 2 functions to determine whether the APP is installed and user matching.</p>
<ul>
<li>Determine whether the APP is installed when the user clicks the link, and guide the user to jump to the app shop to download the app if the user has not installed it.</li>
<li>User matching function, when the user clicks on the link and when the user launches the APP, the user Device Fingerprint (device fingerprint information) is transmitted to the server for fuzzy matching on these two occasions respectively, so that when the user downloads and launches the APP, the corresponding specified page is opened directly.</li>
</ul>
<p>With the above 2 technical solutions, not only.</p>
<ul>
<li>allows the shared user to return to the APP faster and more easily and to the designated active page, but also.</li>
<li>users who have not installed the APP can be guided to download it, and</li>
<li>The relationship chain between the sharer and the sharee will be recorded through the device fingerprint information, and the corresponding reward will be given in the business scenario.</li>
</ul>
<p>Deferred Deeplink can first determine whether the user has already installed the App, and if not, it will first lead to the App shop to download the App, and then jump to the specified App page in Deeplink after the user has installed the App.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/21f60901584c447aa3ad1d93689b5a8c.png" alt="sobyte"></p>
<p>In addition to the above-mentioned Deeplink operation, Deferred Deeplink is more effective in targeting people who have not installed the app. For example, if a user in a shopping app shares a product they like with their social account, if they do not use Deferred Deeplink, their friends may not find the product they shared with them after they clicked to download and install the app. This results in a high churn rate.</p>
<h3 id="deferred-deeplink-implementation-idea">Deferred DeepLink implementation idea</h3>
<p>Any matching problem can be translated into the problem of getting a unique tag. It&rsquo;s easy to think of session and cookies in http, but the sandbox model of mobile phones blocks data sharing between apps. This means that the app&rsquo;s cookies are separate from the mobile browser&rsquo;s cookies and are not interoperable.</p>
<p><strong>Solution 1: By device unique ID</strong></p>
<p>This solution is only suitable for the scenario where one app is diverting traffic to another app.</p>
<p><strong>Solution 2: via IP address + device information (device size, OS, etc.) + time limit (e.g. 10 minutes)</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/19/75d51695132941288a270d270b5d04ef.png" alt="sobyte"></p>
<p><strong>Solution 3: Clipboard Solution</strong></p>
<p>The H5 page automatically calls the clipboard to copy the current user channel ID when clicking on the download, and the APP calls the clipboard each time the content format matches then the user and the H5 user are identified as the same user.</p>
<h3 id="third-party-libraries">Third party libraries</h3>
<p>Third party services that support deep linking and deferred deep linking, such as <a href="https://www.appsflyer.com/">AppsFlyer</a> and <a href="https://branch.io/zh/">Branch</a>. There is a lot more involved, so I won&rsquo;t expand on it here. A separate in-depth analysis will follow later.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/android/">android</a>
          <a href="/tags/ios/">ios</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/k8s-hpa-prometheus/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Kubernetes HPA Controlled Elastic Scaling based on Prometheus Custom Metrics</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/java-valhalla/">
            <span class="next-text nav-default">Java to introduce new object types to solve memory utilization problems</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
