<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>How to Configure Golang Development Environment for Vim - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Today we will introduce you how to configure Go development environment under Vim. If you are interested, you may want to give it a try. System Dependencies Before we start, we need a handy terminal emulation software. There are many such programs, but make sure to choose one that supports utf-8 encoding and 24-bit true color. Here I recommend. linux platform st macos platform iTerm2 window platform Windows Terminal There" /><meta name="keywords" content="vim, golang" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/go-vim/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="How to Configure Golang Development Environment for Vim" />
<meta property="og:description" content="Today we will introduce you how to configure Go development environment under Vim. If you are interested, you may want to give it a try. System Dependencies Before we start, we need a handy terminal emulation software. There are many such programs, but make sure to choose one that supports utf-8 encoding and 24-bit true color. Here I recommend. linux platform st macos platform iTerm2 window platform Windows Terminal There" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/go-vim/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-04T18:35:41+08:00" />
<meta property="article:modified_time" content="2022-01-04T18:35:41+08:00" />

<meta itemprop="name" content="How to Configure Golang Development Environment for Vim">
<meta itemprop="description" content="Today we will introduce you how to configure Go development environment under Vim. If you are interested, you may want to give it a try. System Dependencies Before we start, we need a handy terminal emulation software. There are many such programs, but make sure to choose one that supports utf-8 encoding and 24-bit true color. Here I recommend. linux platform st macos platform iTerm2 window platform Windows Terminal There"><meta itemprop="datePublished" content="2022-01-04T18:35:41+08:00" />
<meta itemprop="dateModified" content="2022-01-04T18:35:41+08:00" />
<meta itemprop="wordCount" content="3045">
<meta itemprop="keywords" content="vim,golang," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to Configure Golang Development Environment for Vim"/>
<meta name="twitter:description" content="Today we will introduce you how to configure Go development environment under Vim. If you are interested, you may want to give it a try. System Dependencies Before we start, we need a handy terminal emulation software. There are many such programs, but make sure to choose one that supports utf-8 encoding and 24-bit true color. Here I recommend. linux platform st macos platform iTerm2 window platform Windows Terminal There"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">How to Configure Golang Development Environment for Vim</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-04 18:35:41 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 3045 words </span>
          <span class="more-meta"> 7 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#system-dependencies">System Dependencies</a></li>
        <li><a href="#basic-configuration">Basic Configuration</a></li>
        <li><a href="#plugin-management">Plugin Management</a></li>
        <li><a href="#theme-plugins">Theme plugins</a></li>
        <li><a href="#file-plug-in">File plug-in</a>
          <ul>
            <li><a href="#viewing-the-directory-structure">Viewing the directory structure</a></li>
            <li><a href="#search-for-file-paths">Search for file paths</a></li>
            <li><a href="#search-file-contents">Search file contents</a></li>
            <li><a href="#recently-used-files">Recently used files</a></li>
          </ul>
        </li>
        <li><a href="#git">Git</a></li>
        <li><a href="#syntax-highlighting">Syntax highlighting</a></li>
        <li><a href="#complementary-jumps">Complementary jumps</a></li>
        <li><a href="#auto-completion">Auto-completion</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Today we will introduce you how to configure Go development environment under Vim. If you are interested, you may want to give it a try.</p>
<h2 id="system-dependencies">System Dependencies</h2>
<p>Before we start, we need a handy terminal emulation software. There are many such programs, but make sure to choose one that supports utf-8 encoding and 24-bit true color. Here I recommend.</p>
<ul>
<li>linux platform <a href="https://st.suckless.org/">st</a></li>
<li>macos platform <a href="https://iterm2.com/">iTerm2</a></li>
<li>window platform <a href="https://www.microsoft.com/zh-cn/p/windows-terminal/9n0dx20hk701">Windows Terminal</a></li>
</ul>
<p>There are also cross-platform terminal emulation software, such as <a href="https://github.com/alacritty/alacritty">Alacritty</a>, which have some problems on different platforms, so beginners should not bother with them.</p>
<p>Everything in this article relies on a UNIX environment, windows users should install Windows Subsystem for Linux. This distribution has new software versions and is especially suitable for developers.</p>
<p>To lower the threshold of command line operation, I recommend using <a href="https://ohmyz.sh/">On My Zsh</a>. Oh My Zsh provides mainly detailed command completion functions, which are very convenient.</p>
<p>Other software that needs to be installed are</p>
<ul>
<li>git version control</li>
<li>tmux terminal reuse</li>
<li>fzf fuzzy matching for file travel</li>
<li>ripgrep file content search, much faster than grep</li>
<li>go language compiler</li>
</ul>
<p>Finally, NeoVim is installed.</p>
<h2 id="basic-configuration">Basic Configuration</h2>
<p>NeoVim&rsquo;s default configuration file is <code>~/.config/nvim/init.vim</code>.</p>
<p>Vim is compatible with vi by default, which is difficult to use, but NeoVim gives up compatibility with vi and enables many configuration items. So there are not many configurations that need to be changed.</p>
<p>I personally recommend adding the following configuration.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="s2">&#34; 打开 24 位真彩色支持
</span><span class="s2">set termguicolors
</span><span class="s2">&#34;</span> 搜索的时候忽略大小字字母
<span class="nb">set</span> ignorecase
<span class="s2">&#34; 若搜索内容中有大写字母，则不再忽略大小写
</span><span class="s2">set smartcase
</span><span class="s2">&#34;</span> 高亮第80列
<span class="nb">set</span> <span class="nv">colorcolumn</span><span class="o">=</span><span class="m">80</span>
<span class="s2">&#34; 高亮光标所在行
</span><span class="s2">set cursorline
</span></code></pre></td></tr></table>
</div>
</div><p>This is all you need for the basic configuration. vim opens the file with the cursor on the first line by default. If you want to automatically jump to the last exit position, you need to add the following configuration.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">autocmd BufReadPost *
      <span class="se">\ </span><span class="k">if</span> line<span class="o">(</span><span class="s2">&#34;&#39;\&#34;&#34;</span><span class="o">)</span> &gt;<span class="o">=</span> <span class="m">1</span> <span class="o">&amp;&amp;</span> line<span class="o">(</span><span class="s2">&#34;&#39;\&#34;&#34;</span><span class="o">)</span> &lt;<span class="o">=</span> line<span class="o">(</span><span class="s2">&#34;</span>$<span class="s2">&#34;</span><span class="o">)</span>
      <span class="se">\ </span><span class="p">|</span>   exe <span class="s2">&#34;normal! g`\&#34;&#34;</span>
      <span class="se">\ </span><span class="p">|</span> endif
</code></pre></td></tr></table>
</div>
</div><p>It would take quite a bit of talking to make sense of how this configuration works. Let&rsquo;s not get hung up on it. Let&rsquo;s start by installing a few plugins.</p>
<h2 id="plugin-management">Plugin Management</h2>
<p>Vim has a lot of plugins for managing plugins. But I don&rsquo;t recommend them, because you can easily manage them with git.</p>
<p>First, let&rsquo;s go to the <code>~/.config/nvim</code> directory and run <code>git init</code>.</p>
<p>Then we create the plugins directory by running <code>mkdir -p pack/vendor/start</code>. The name of the vendor directory can be whatever you want, but the <code>pack/*/start</code> three-level directory structure cannot be changed, it is specified by vim.</p>
<p>All plugins just need to be placed in the <code>pack/*/start/</code> directory and they will work.</p>
<p>If we want to add a plugin we can.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/epii1/fzf.vim pack/vendor/start/fzf
</code></pre></td></tr></table>
</div>
</div><p>If you want to update the plugin you can.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule update --remote pack/vendor/start/fzf
</code></pre></td></tr></table>
</div>
</div><p>If you want to remove the plugin you can.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git rm -rf pack/vendor/start/fzf
</code></pre></td></tr></table>
</div>
</div><p>To be clear, this is a git submodule operation. Here we install the required plugins.</p>
<h2 id="theme-plugins">Theme plugins</h2>
<p>First of all, we need to install a theme that looks a little bit better. I especially recommend tender, which is a theme that supports 24-bit true color and has a cooler tone.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/jacoborus/tender.vim pack/vendor/start/tender
</code></pre></td></tr></table>
</div>
</div><p>Then you need to add the following configuration to open the theme</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">color tender
<span class="s2">&#34; 此处对 tender 主题略做调整，大家可以去掉对比一下效果
</span><span class="s2">autocmd ColorScheme tender
</span><span class="s2">\ | hi Normal guibg=#000000
</span><span class="s2">\ | hi SignColumn guibg=#000000 &#34;</span>
<span class="se">\ </span><span class="p">|</span> hi StatusLine <span class="nv">guibg</span><span class="o">=</span><span class="c1">#444444 guifg=#b3deef</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="file-plug-in">File plug-in</h2>
<h3 id="viewing-the-directory-structure">Viewing the directory structure</h3>
<p>The IDE interface displays a file manager on the left side, and Vim can achieve a similar effect with plugins. I recommend using the venerable NERDTree plugin.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/scrooloose/nerdtree pack/vendor/start/nerdtree
</code></pre></td></tr></table>
</div>
</div><p>Once installed, you can open the file manager with <code>:NERDTreeToggle</code>. If you want NERDTree to locate the current file, you can execute the <code>:NERDTreeFind</code> command.</p>
<p>NERDTree supports many configurations, which can be viewed via <code>:h NERDTree</code>. It is recommended to add the following configuration.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">let</span> g:NERDTreeMinimalUI <span class="o">=</span> <span class="m">1</span>
<span class="nb">let</span> g:NERDTreeChDirMode <span class="o">=</span> <span class="m">2</span>
<span class="nb">let</span> g:NERDTreeWinSize <span class="o">=</span> <span class="m">24</span>
</code></pre></td></tr></table>
</div>
</div><p>Considering that NERDTree is more commonly used, we can set two shortcut keys</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">nnoremap &lt;leader&gt;e :NERDTreeToggle&lt;cr&gt;
nnoremap &lt;leader&gt;f :NERDTreeFind&lt;cr&gt;
</code></pre></td></tr></table>
</div>
</div><p><code>nnoremap</code> indicates that the shortcut key is set in Normal mode. <code>&lt;leader&gt;</code> defaults to <code>\</code>, and generally user-defined shortcut keys start with <code>&lt;leader&gt;</code> to prevent them from affecting the default key position. The final <code>&lt;cr&gt;</code> indicates a carriage return. So when we press <code>\e</code> in Normal mode, Vim will automatically simulate typing <code>:NERDTreeToggle</code> for us and then pressing enter. This is no different than typing the command and executing it ourselves.</p>
<p>NERDTree itself also supports writing extensions. The only extension I recommend here is nerdtree-git-plugin, which displays the status of git changes in NERDTree.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/Xuyuanp/nerdtree-git-plugin pack/vendor/start/nerdtree-git
</code></pre></td></tr></table>
</div>
</div><p>nerdtree-git-plugin requires no additional configuration.</p>
<h3 id="search-for-file-paths">Search for file paths</h3>
<p>If you&rsquo;re not familiar with the project structure, start with NERDTree, but if you are, using NERDTree is a bit unwieldy. This is the time to use fzf as a big tool. I wrote a fzf.vim myself, which is pure and recommended for everyone.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/epii1/fzf.vim pack/vendor/start/fzf
</code></pre></td></tr></table>
</div>
</div><p>fzf.vim needs a shortcut key of its own. I suggest using <code>ctrl-p</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">nnoremap &lt;c-p&gt; :call fzf#Open<span class="o">()</span>&lt;cr&gt;
</code></pre></td></tr></table>
</div>
</div><p>Mapping the ctrl key combination requires the use of pointed brackets, c for ctrl, otherwise it is no different from normal mapping.</p>
<p>This way, pressing <code>ctrl-p</code> in Normal mode opens a search window. Then you can keep typing characters to filter the search results, and finally press enter to open the corresponding file.</p>
<h3 id="search-file-contents">Search file contents</h3>
<p>fzf.vim can only search file paths. If you want to search the contents of a file, you need to use the ripgrep command. I have also written my own plugin called ag.vim.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/epii1/ag.vim pack/vendor/start/ag
</code></pre></td></tr></table>
</div>
</div><p>ag.vim uses the ag command by default. If you use ripgrep, you need to add the following line to configure it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">let</span> g:ag_cli <span class="o">=</span> <span class="s1">&#39;rg&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>If we want to search for the keyword <code>fzf</code>, then we can execute <code>:Ag fzf</code>. Regular expressions are supported, such as <code>:Ag a[0-9]+</code> .</p>
<h3 id="recently-used-files">Recently used files</h3>
<p>The last requirement is to record a list of recently opened files. I wrote a plugin mru.vim for this as well.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/epii1/mru.vim pack/vendor/start/mru
</code></pre></td></tr></table>
</div>
</div><p>Again, you need to set a shortcut key, I use <code>ctrl-u</code> :)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">nnoremap &lt;c-u&gt; :Mru&lt;cr&gt;
</code></pre></td></tr></table>
</div>
</div><p>Once installed, mru.vim will automatically keep a list of recently used files, and will sort and de-duplicate them according to when they were used. Just press <code>ctrl-u</code> to open the file list. The cursor will stop at the last used file. You can open the last used file by pressing enter. You can also move the cursor and select other files.</p>
<p>The above are the main plug-ins related to file operations, which basically cover the common file operations.</p>
<h2 id="git">Git</h2>
<p>For beginners, you should in principle use the command line to work with git. But I found a plugin that shows the status of file changes in real time that I must recommend, called <a href="https://github.com/lewis6991/gitsigns.nvim">gitsigns</a>.</p>
<p>gitsigns can display the change status of a file in real time on the far left side of the window, very fast. gitsigns is developed in lua and can only be run under NeoVim.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/nvim-lua/plenary.nvim pack/vendor/start/plenary
git submodule add https://github.com/lewis6991/gitsigns.nvim pack/vendor/start/gitsigns
</code></pre></td></tr></table>
</div>
</div><p>Because it is written in lua, the way it is loaded and configured is very different from traditional plugins. We start by creating a vim.lua file in the directory where init.vim is located. This file can be named whatever you want, but not init.lua, and then we add a command to init.vim that loads the lua configuration</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">runtime vim.lua
</code></pre></td></tr></table>
</div>
</div><p>The configuration of the lua plugin is written to the vim.lua file. gitsigns also requires little additional configuration, just add a line that says</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">require<span class="s1">&#39;gitsigns&#39;</span>.setup<span class="o">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that the <code>require</code> syntax of lua is used here. You can import files without spaces, and it&rsquo;s an expression with a return value, so you can call the <code>setup()</code> method directly on the return value.</p>
<p>There are many git-related plugins, but they are not recommended for beginners. You should wait until you are familiar with the git command before tinkering with it.</p>
<h2 id="syntax-highlighting">Syntax highlighting</h2>
<p>Vim implements syntax highlighting by default using keywords and regular expressions. But this approach is slow and not smart enough.</p>
<p>NeoVim supports syntax highlighting and code folding using <a href="https://tree-sitter.github.io/tree-sitter/">TreeSitter</a>. TreeSitter does syntax analysis of the code, and incrementally, allowing for more fine-grained syntax coloring.</p>
<p>Installation is also very simple.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/nvim-treesitter/nvim-treesitter pack/vendor/start/treesitter
</code></pre></td></tr></table>
</div>
</div><p>After restarting NeoVim, run <code>:TSInstall</code> to install the required languages.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">:TSInstall go lua vim
</code></pre></td></tr></table>
</div>
</div><p>If you need to update, then you can execute <code>:TSUpdate</code>.</p>
<p>Then we add the following code to vim.lua.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="n">require</span><span class="s1">&#39;nvim-treesitter.configs&#39;</span><span class="p">.</span><span class="n">setup</span><span class="p">{</span>
    <span class="c1">-- 启用高亮</span>
    <span class="n">highlight</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">enable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
	<span class="c1">-- 禁用 vim 基于正则达式的语法高亮，太慢</span>
        <span class="n">additional_vim_regex_highlighting</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1">-- 启用缩进</span>
    <span class="n">indent</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">enable</span> <span class="o">=</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The syntax here is rather odd, but common. In lua, both arrays and dictionaries are represented by <code>{}</code>. Arrays are <code>{1,2}</code> and dictionaries are <code>{a=1,b=2}</code>, which can be defined in nested sets. And lua allows parentheses to be omitted when calling functions. That means <code>setup({a=1})</code> can be abbreviated to <code>setup{a=1}</code> and <code>print(&quot;abc&quot;)</code> can be abbreviated to <code>print &quot;abc&quot;</code>.</p>
<p>We also need to make vim use treesitter to do code folding by adding the following configuration to init.vim.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="s2">&#34; 使用 foldexpr 指定的方式折叠代码
</span><span class="s2">set foldmethod=expr
</span><span class="s2">&#34;</span> 使用 treesitter 根据语言语法折叠代码
<span class="nb">set</span> <span class="nv">foldexpr</span><span class="o">=</span>nvim_treesitter#foldexpr<span class="o">()</span>
<span class="s2">&#34; 默认从第一级开始，大家可以去掉看有什么效果
</span><span class="s2">set foldlevel=1
</span></code></pre></td></tr></table>
</div>
</div><p>Then restart NeoVim and you&rsquo;ll see the highlighting and collapsing effects.</p>
<h2 id="complementary-jumps">Complementary jumps</h2>
<p>The most important thing about writing code is the auto-completion and smart jump features. This is a bit tricky to configure.</p>
<p>In the old days, every IDE would implement a set of code completion and jumping features. Later, Microsoft released the language server protocol (lsp), which aims to abstract out the code completion and jumping features and provide the services to the public using a standard interface.</p>
<p>It was first used in vs code, but now more and more tools are starting to support lsp. NeoVim has a built-in lsp function.</p>
<p>The Go language also maintains its own official language server, called gopls, which we install first:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">go install golang.org/x/tools/gopls@latest
</code></pre></td></tr></table>
</div>
</div><p>Because configuring lsp is relatively cumbersome, each language needs to be configured separately. To make it easier to use, NeoVim maintains an official configuration collection for each language, which is distributed as a plugin. So we also need to install this configuration.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/neovim/nvim-lspconfig pack/vendor/start/lspconfig
</code></pre></td></tr></table>
</div>
</div><p>Finally, you need to enable complement and jump support for the Go language by adding the following code to vim.lua.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">on_attach</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">bufnr</span><span class="p">)</span>
    <span class="c1">-- 为方便使用，定义了两个工具函数</span>
    <span class="kd">local</span> <span class="kr">function</span> <span class="nf">buf_set_keymap</span><span class="p">(...)</span> <span class="n">vim.api</span><span class="p">.</span><span class="n">nvim_buf_set_keymap</span><span class="p">(</span><span class="n">bufnr</span><span class="p">,</span> <span class="p">...)</span> <span class="kr">end</span>
    <span class="kd">local</span> <span class="kr">function</span> <span class="nf">buf_set_option</span><span class="p">(...)</span> <span class="n">vim.api</span><span class="p">.</span><span class="n">nvim_buf_set_option</span><span class="p">(</span><span class="n">bufnr</span><span class="p">,</span> <span class="p">...)</span> <span class="kr">end</span>

    <span class="c1">-- 配置标准补全快捷键</span>
    <span class="c1">-- 在插入模式可以按 &lt;c-x&gt;&lt;c-o&gt; 触发补全</span>
    <span class="n">buf_set_option</span><span class="p">(</span><span class="s1">&#39;omnifunc&#39;</span><span class="p">,</span> <span class="s1">&#39;v:lua.vim.lsp.omnifunc&#39;</span><span class="p">)</span>

    <span class="kd">local</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="n">noremap</span><span class="o">=</span><span class="kc">true</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">true</span> <span class="p">}</span>

    <span class="c1">-- 设置 normal 模式下的快捷键</span>
    <span class="c1">-- 第一个参数 n 表示 normal 模式</span>
    <span class="c1">-- 第二个参数表示按键</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.hover()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 跳转到定义或者声明的地方</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;gD&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.declaration()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;gd&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.definition()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 查看接口的所有实现</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;gi&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.implementation()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 查看所有引用当前对象的地方</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;gr&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.references()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 跳转到下一个/上一个语法错误</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;[d&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.diagnostic.goto_prev()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;]d&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.diagnostic.goto_next()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;c-k&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.signature_help()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 手工触发格式化</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;f&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.formatting()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;D&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.type_definition()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.code_action()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;e&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.diagnostic.show_line_diagnostics()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 列出所有语法错误列表</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;q&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.diagnostic.set_loclist()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="c1">-- 修改当前符号的名字</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;rn&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.rename()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;wa&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.add_workspace_folder()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;wl&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua print(vim.inspect(vim.lsp.buf.list_workspace_folders()))&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
    <span class="n">buf_set_keymap</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;space&gt;wr&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;cmd&gt;lua vim.lsp.buf.remove_workspace_folder()&lt;cr&gt;&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
<span class="kr">end</span>

<span class="n">require</span><span class="s1">&#39;lspconfig&#39;</span><span class="p">.</span><span class="n">gopls.setup</span> <span class="p">{</span>
    <span class="n">on_attach</span> <span class="o">=</span> <span class="n">on_attach</span><span class="p">,</span>
    <span class="n">capabilities</span> <span class="o">=</span> <span class="n">capabilities</span><span class="p">,</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">debounce_text_changes</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that gopls is only supported for projects with go.mod added. Open a Go file, run <code>:LspInfo</code>, and you should see <code>Configured servers list: gopls</code>.</p>
<p>Find a function at random, press <code>gd</code> and it should jump to the corresponding function definition, return to it and press <code>ctrl-t</code>. NeoVim will start the gopls program the first time you use it, so there will be a slight delay. Subsequent use will be quick.</p>
<p>Switch to insert mode, type <code>fmt.</code> and press <code>ctrl-x ctrl-o</code> and you should see a pop-up completion window.</p>
<p>For other functions, please try it yourself according to the comments in the configuration.</p>
<p>This solution is by far the cleanest and fastest solution. However, there are two minor flaws in this solution.</p>
<ul>
<li>Can&rsquo;t automatically import the newly referenced package name</li>
<li>No automatic code formatting</li>
</ul>
<p>How can I put up with this? After a bit of tinkering, we found a solution.</p>
<p>We need to create a <code>ftplugin</code> folder in the init.vim directory, and then create a new go.vim file in it, with the following contents.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua">
<span class="s2">&#34; 这里用到在 vim 中嵌入 lua 代码的特殊语法
</span><span class="s2">lua &lt;&lt;EOF
</span><span class="s2">function org_imports(wait_ms)
</span><span class="s2">    local params = vim.lsp.util.make_range_params()
</span><span class="s2">    params.context = {only = {&#34;</span><span class="n">source.organizeImports</span><span class="s2">&#34;}}
</span><span class="s2">    local result = vim.lsp.buf_request_sync(0, &#34;</span><span class="n">textDocument</span><span class="o">/</span><span class="n">codeAction</span><span class="s2">&#34;, params, wait_ms)
</span><span class="s2">    for _, res in pairs(result or {}) do
</span><span class="s2">      for _, r in pairs(res.result or {}) do
</span><span class="s2">        if r.edit then
</span><span class="s2">          vim.lsp.util.apply_workspace_edit(r.edit)
</span><span class="s2">        else
</span><span class="s2">          vim.lsp.buf.execute_command(r.command)
</span><span class="s2">        end
</span><span class="s2">      end
</span><span class="s2">    end
</span><span class="s2">end
</span><span class="s2">EOF
</span><span class="s2">
</span><span class="s2">&#34;</span> <span class="err">代码补全结束后自动导包</span>
<span class="n">autocmd</span> <span class="n">CompleteDone</span> <span class="o">*</span><span class="p">.</span><span class="n">go</span> <span class="p">:</span><span class="n">lua</span> <span class="n">org_imports</span><span class="p">()</span>
<span class="s2">&#34; 保存代码之前自动格式化
</span><span class="s2">autocmd BufWritePre *.go :lua vim.lsp.buf.formatting()
</span></code></pre></td></tr></table>
</div>
</div><p>Vim automatically executes the vim scripts in the <code>plugin</code> directory. This is not the case for the <code>ftplugin</code> directory. The ft prefix in the name is a shortened version of the file type, and the files in it are named with their extensions. For example, go.vim is only executed when the go source file is opened.</p>
<p>With the above configuration, NeoVim will automatically format the code and import the used package names when it exits.</p>
<h2 id="auto-completion">Auto-completion</h2>
<p>After the previous completion plugin is configured, you need to press <code>ctrl-x ctrl-o</code> in insert mode to trigger the completion. It is not as convenient as IDE. Can you support auto-trigger? Yes, but you need to install a new plugin. Here I recommend using cmp, also developed by lua, which is very fast.</p>
<p>You need to install six related plugins in one go.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git submodule add https://github.com/hrsh7th/nvim-cmp pack/vendor/start/cmp
git submodule add https://github.com/hrsh7th/cmp-path pack/vendor/start/cmp-path
git submodule add https://github.com/hrsh7th/cmp-vsnip pack/vendor/start/cmp-vsnip
git submodule add https://github.com/hrsh7th/cmp-buffer pack/vendor/start/cmp-buffer
git submodule add https://github.com/hrsh7th/cmp-nvim-lsp pack/vendor/start/cmp-lsp
git submodule add https://github.com/hrsh7th/vim-vsnip pack/vendor/start/vim-vsnip
</code></pre></td></tr></table>
</div>
</div><p>Then add the following code to vim.lua.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-lua" data-lang="lua"><span class="kd">local</span> <span class="n">cmp</span> <span class="o">=</span> <span class="n">require</span><span class="s1">&#39;cmp&#39;</span>
<span class="n">cmp.setup</span> <span class="p">{</span>
    <span class="c1">-- 必须指定 snippet 组件</span>
    <span class="n">snippet</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">expand</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="n">vim.fn</span><span class="p">[</span><span class="s1">&#39;vsnip#anonymous&#39;</span><span class="p">](</span><span class="n">args.body</span><span class="p">)</span> <span class="kr">end</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="c1">-- 配置补全内容来源</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">cmp.config</span><span class="p">.</span><span class="n">sources</span> <span class="p">{</span>
        <span class="c1">-- 支持从打开的文件中补全内容</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;buffer&#39;</span><span class="p">,</span> <span class="n">opts</span> <span class="o">=</span> <span class="p">{</span> <span class="n">get_bufnrs</span> <span class="o">=</span> <span class="n">vim.api</span><span class="p">.</span><span class="n">nvim_list_bufs</span> <span class="p">}</span> <span class="p">},</span>
	<span class="c1">-- 支持从 lsp 服务补全</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;nvim_lsp&#39;</span> <span class="p">},</span>
	<span class="c1">-- 支持补全文件路径，可以输入 / 或者 ~ 体验</span>
        <span class="p">{</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;path&#39;</span> <span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="c1">-- 将 cmp-lsp 跟 lsp 服务关联起来</span>
<span class="c1">-- 需要更新一上之前的 gopls 配置</span>
<span class="kd">local</span> <span class="n">capabilities</span> <span class="o">=</span> <span class="n">vim.lsp</span><span class="p">.</span><span class="n">protocol.make_client_capabilities</span><span class="p">()</span>
<span class="n">capabilities</span> <span class="o">=</span> <span class="n">require</span><span class="s1">&#39;cmp_nvim_lsp&#39;</span><span class="p">.</span><span class="n">update_capabilities</span><span class="p">(</span><span class="n">capabilities</span><span class="p">)</span>
<span class="n">require</span><span class="s1">&#39;lspconfig&#39;</span><span class="p">.</span><span class="n">gopls.setup</span> <span class="p">{</span>
    <span class="n">on_attach</span> <span class="o">=</span> <span class="n">on_attach</span><span class="p">,</span>
    <span class="n">flags</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">debounce_text_changes</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>So far you have done all the configuration work, enjoy it as much as you can.</p>
<p>One thing to note, however, is that the first time you use the lsp-related features, NeoVim will start gopls, and there will be a delay of a few seconds. After that, it will be very fast.</p>
<h2 id="summary">Summary</h2>
<p>This article provides Go developers with a complete configuration manual, which implements most of the IDE features with minimal cost. Based on the configuration in this article, it should be easy to do your daily Go development work under NeoVim. I myself believe in the KISS principle, use only the necessary plugins and add only the necessary configuration. After you get started, you should focus on the basics of Vim, and then toss around plugins and configurations when you become proficient!</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/vim/">vim</a>
          <a href="/tags/golang/">golang</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/vim-go-struct-tag/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Quickly editing Go struct tags under vim</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/go-language-generic-design/">
            <span class="next-text nav-default">Go Language Generic Design</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
