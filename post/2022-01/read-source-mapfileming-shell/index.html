<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>read,source,mapfile commands and shell programming - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Bash is a fairly powerful programming language and easy to get to grips with. Here are some little-known but useful bash commands that will help make the shell scripts you write clearer and easier to maintain. After all, it&amp;rsquo;s almost always the shell you see when you open a terminal.
There are some powerful commands in Bash that you may not be aware of, even if you are fairly proficient in the language." /><meta name="keywords" content="shell" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-01/read-source-mapfileming-shell/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="read,source,mapfile commands and shell programming" />
<meta property="og:description" content="Bash is a fairly powerful programming language and easy to get to grips with. Here are some little-known but useful bash commands that will help make the shell scripts you write clearer and easier to maintain. After all, it&rsquo;s almost always the shell you see when you open a terminal.
There are some powerful commands in Bash that you may not be aware of, even if you are fairly proficient in the language." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-01/read-source-mapfileming-shell/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-01-18T13:13:09+08:00" />
<meta property="article:modified_time" content="2022-01-18T13:13:09+08:00" />

<meta itemprop="name" content="read,source,mapfile commands and shell programming">
<meta itemprop="description" content="Bash is a fairly powerful programming language and easy to get to grips with. Here are some little-known but useful bash commands that will help make the shell scripts you write clearer and easier to maintain. After all, it&rsquo;s almost always the shell you see when you open a terminal.
There are some powerful commands in Bash that you may not be aware of, even if you are fairly proficient in the language."><meta itemprop="datePublished" content="2022-01-18T13:13:09+08:00" />
<meta itemprop="dateModified" content="2022-01-18T13:13:09+08:00" />
<meta itemprop="wordCount" content="736">
<meta itemprop="keywords" content="shell," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="read,source,mapfile commands and shell programming"/>
<meta name="twitter:description" content="Bash is a fairly powerful programming language and easy to get to grips with. Here are some little-known but useful bash commands that will help make the shell scripts you write clearer and easier to maintain. After all, it&rsquo;s almost always the shell you see when you open a terminal.
There are some powerful commands in Bash that you may not be aware of, even if you are fairly proficient in the language."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">read,source,mapfile commands and shell programming</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-01-18 13:13:09 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 736 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#the-read-command-asks-for-user-input">The read command asks for user input</a></li>
        <li><a href="#the-mapfile-command-converts-the-lines-of-a-file-into-a-bash-array">The mapfile command converts the lines of a file into a Bash array</a></li>
        <li><a href="#the-source-command-imports-the-variables-in-the-file-into-the-shells-environment-variables">The source command imports the variables in the file into the shell&rsquo;s environment variables</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Bash is a fairly powerful programming language and easy to get to grips with. Here are some little-known but useful bash commands that will help make the shell scripts you write clearer and easier to maintain. After all, it&rsquo;s almost always the shell you see when you open a terminal.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/01/18/36bbcfa88dd7423ab3377cded76fc7ae.png" alt="shell"></p>
<p>There are some powerful commands in Bash that you may not be aware of, even if you are fairly proficient in the language. However, these commands are all very purposeful and can make the shell scripts you write clearer, easier to maintain and more powerful than ever before.</p>
<p>In this tutorial we will illustrate how the read, mapfile, and source commands can be used in practice in bash scripts. We give some common examples that we hope will be helpful.</p>
<h2 id="the-read-command-asks-for-user-input">The read command asks for user input</h2>
<p>The read command allows a script to accept user input and store it in a variable.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="cp">#!/usr/bin/env bash
</span><span class="cp"></span><span class="nb">echo</span> <span class="s2">&#34;What is your name?&#34;</span>
<span class="nb">read</span> name
<span class="nb">echo</span> <span class="s2">&#34;Your name is </span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">!&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>This will wait for user input and then set the value of the <code>name</code> variable to the string entered by the user.</p>
<p>For example, if you specify <code>myfreax.com</code> as your name when running the above script, it will output <code>Your name is myfreax.com</code>.</p>
<p>You can also make the above example more elegant by specifying an option for the <code>read</code> command with <code>-p</code>, which will print the string <code>-p</code> specified after it, and then ask the user to enter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="cp">#!/usr/bin/env bash
</span><span class="cp"></span><span class="nb">read</span> -p <span class="s2">&#34;What is your name? &#34;</span> name
<span class="nb">echo</span> <span class="s2">&#34;Your name is </span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">!&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>You will also notice that I have added a space after <code>What is your name?</code>. If we don&rsquo;t add it, it will make the user look even stranger when typing.</p>
<h2 id="the-mapfile-command-converts-the-lines-of-a-file-into-a-bash-array">The mapfile command converts the lines of a file into a Bash array</h2>
<p>You can use the <code>mapfile</code> command to read the contents of a file and then assign the output to a Bash array, creating an array element whenever a newline is encountered in the file.</p>
<p>For example, we create a file called <code>file.txt</code> containing the following text.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">Line 1
Line 2
Line 3
Line 4
Line 5
</code></pre></td></tr></table>
</div>
</div><p>You can convert this file to a Bash array by running the following command, which assigns the contents of the file to the <code>file_var</code> variable.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="cp">#!/usr/bin/env bash
</span><span class="cp"></span>mapfile file_var &lt; file.txt

<span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file_var</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
	<span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>You will notice that the above also produces some oddly spaced output that does not match the contents of the file, which can be resolved by adding the <code>-t</code> option to the command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="cp">#!/usr/bin/env bash
</span><span class="cp"></span>mapfile -t file_var &lt; file.txt

<span class="k">for</span> i in <span class="s2">&#34;</span><span class="si">${</span><span class="nv">file_var</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">;</span> <span class="k">do</span>
	<span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="k">done</span>
</code></pre></td></tr></table>
</div>
</div><p>Finally, you may notice that the following does not work.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="cp">#!/usr/bin/env bash
</span><span class="cp"></span>cat file.txt <span class="p">|</span> mapfile -t file_var
</code></pre></td></tr></table>
</div>
</div><p>This is because the commands on the right-hand side of the <code>mapfile</code> pipe are executed in a subshell. In other words, it is run in a new instance of Bash, which cannot affect your current shell.</p>
<h2 id="the-source-command-imports-the-variables-in-the-file-into-the-shells-environment-variables">The source command imports the variables in the file into the shell&rsquo;s environment variables</h2>
<p>Suppose you have the following dummy file <code>config.sh</code> whose contents are as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">username</span><span class="o">=</span>myfreax
<span class="nv">domain</span><span class="o">=</span>myfreax.com
</code></pre></td></tr></table>
</div>
</div><p>If you want to get the contents of the file and put it into the environment variable of the current shell, this can be done very simply by using the source command</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">source</span> config.sh
</code></pre></td></tr></table>
</div>
</div><p>You can then check that the variables are assigned as expected. The <code>source</code> command actually runs the specified file in the environment of the current shell, so any commands in that file will be executed.</p>
<p>For example, let&rsquo;s put the following into <code>config.sh</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">name</span><span class="o">=</span><span class="s2">&#34;myfreax&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;Hello </span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">!&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;Have a good day!&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Then, if we run <code>soure config.sh</code>, you will see two <code>echo</code> commands get run, and the <code>name</code> variable is assigned: you can also use <code>.</code> instead of <code>source</code>, which does the same thing as <code>source</code>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>You learn how to use the read command to ask the user for input. How to use the mapfile command to convert the lines of a file into a Bash array. How the source command imports variables from a file into the shell&rsquo;s environment variables. Also know the alias for the source command.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/shell/">shell</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-01/3-ways-how-to-check-the-linux-kernel-version-in-the-command-line/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">3 ways to check the Linux kernel version from the command line</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-01/mail-server/">
            <span class="next-text nav-default">Postfix &amp; Dovecot Build Your Own Mailbox Service</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
