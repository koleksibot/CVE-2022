<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Why IPv6 is a difficult replacement for IPv4 - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="The network layer protocol assumes the two major functions of packet forwarding and routing, and it can provide the upper layer with the responsibility of transporting packets between different hosts. IP protocol, as a network layer protocol, plays an extremely critical role in today&amp;rsquo;s Internet, although it can only provide connectionless and unreliable services.
In general, when we want to access services provided by other hosts, we need to access the target host through an IP address, which is the only way to be accessed by other hosts on the Internet." /><meta name="keywords" content="ipv4, ipv6" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-12/whys-the-design-ipv6-replacing-ipv4/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Why IPv6 is a difficult replacement for IPv4" />
<meta property="og:description" content="The network layer protocol assumes the two major functions of packet forwarding and routing, and it can provide the upper layer with the responsibility of transporting packets between different hosts. IP protocol, as a network layer protocol, plays an extremely critical role in today&rsquo;s Internet, although it can only provide connectionless and unreliable services.
In general, when we want to access services provided by other hosts, we need to access the target host through an IP address, which is the only way to be accessed by other hosts on the Internet." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-12/whys-the-design-ipv6-replacing-ipv4/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-02T15:53:49+08:00" />
<meta property="article:modified_time" content="2021-12-02T15:53:49+08:00" />

<meta itemprop="name" content="Why IPv6 is a difficult replacement for IPv4">
<meta itemprop="description" content="The network layer protocol assumes the two major functions of packet forwarding and routing, and it can provide the upper layer with the responsibility of transporting packets between different hosts. IP protocol, as a network layer protocol, plays an extremely critical role in today&rsquo;s Internet, although it can only provide connectionless and unreliable services.
In general, when we want to access services provided by other hosts, we need to access the target host through an IP address, which is the only way to be accessed by other hosts on the Internet."><meta itemprop="datePublished" content="2021-12-02T15:53:49+08:00" />
<meta itemprop="dateModified" content="2021-12-02T15:53:49+08:00" />
<meta itemprop="wordCount" content="1776">
<meta itemprop="keywords" content="ipv4,ipv6," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Why IPv6 is a difficult replacement for IPv4"/>
<meta name="twitter:description" content="The network layer protocol assumes the two major functions of packet forwarding and routing, and it can provide the upper layer with the responsibility of transporting packets between different hosts. IP protocol, as a network layer protocol, plays an extremely critical role in today&rsquo;s Internet, although it can only provide connectionless and unreliable services.
In general, when we want to access services provided by other hosts, we need to access the target host through an IP address, which is the only way to be accessed by other hosts on the Internet."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Why IPv6 is a difficult replacement for IPv4</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-12-02 15:53:49 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1776 words </span>
          <span class="more-meta"> 9 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#nat">NAT</a></li>
        <li><a href="#compatibility">Compatibility</a></li>
        <li><a href="#address-control">Address Control</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>The network layer protocol assumes the two major functions of packet forwarding and routing, and it can provide the upper layer with the responsibility of transporting packets between different hosts. IP protocol, as a network layer protocol, plays an extremely critical role in today&rsquo;s Internet, although it can only provide connectionless and unreliable services.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/9a7877bf866d49ea8abdb56f93c729a0.png" alt=""></p>
<p>In general, when we want to access services provided by other hosts, we need to access the target host through an IP address, which is the only way to be accessed by other hosts on the Internet. IP addresses are like home addresses, and we need to ensure that all host IP addresses are unique so that we can find the correct host.</p>
<p>The first major version of the IP protocol, IPv4, which was created in 1974, uses a 32-bit representation of addresses and provides a total of 2^32 (4,294,967,296) IP addresses. 4.2 billion IP addresses may seem like a lot, but the number of available IPv4 addresses has been decreasing in recent years, and as early as 2011, the top IPv4 addresses were were all allocated</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/477dfc68f3334eef9b2609a041cf9221.png" alt=""></p>
<p>To address the imminent exhaustion of IP addresses, the IETF released a draft of the IPv6 protocol in 1998 and it officially became an Internet standard in 2017. IPv6 uses 128-bit IP addresses, which can represent a total of 2^128 addresses, and IPv6 can even assign separate addresses to the sands of the earth:</p>
<p>2<sup>128</sup>=340282366920938463463374607431768211456≈3.4∗10<sup>38</sup></p>
<p>The designers of the IPv6 protocol originally thought that IPv6 would be adopted rapidly as IPv4 addresses dwindled, and they originally estimated that IPv6 would be deployed worldwide by 2003, but from today&rsquo;s perspective, these predictions were overly optimistic. These predictions are still overly optimistic from today&rsquo;s perspective.</p>
<p>The question we want to analyze in this paper is why, with all its benefits and ability to solve the IPv4 address shortage, the IPv6 protocol has not been adopted on a large scale even 17 years after the original prediction of 2003. We will discuss several reasons for this here.</p>
<ul>
<li>NAT technology has largely alleviated the IPv4 address shortage.</li>
<li>IPv6 protocols were not designed with compatibility with IPv4 in mind.</li>
<li>finer-grained control of IPv4 addresses and recovery of idle resources.</li>
</ul>
<h2 id="nat">NAT</h2>
<p>Network Address Translation (NAT) is a technology that modifies network addresses as IP packets pass through a router, mapping the IP address in the current address space to another address space. When switching networks or upstream ISPs change, NAT technology can avoid modifying the IPs of all nodes in the network. We can think of NAT technology as a translation table that stores the translation relationships from external addresses and ports to internal addresses and ports.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/6e22e42858af4f9382abddbc1bbc5141.png" alt=""></p>
<p>When a packet accesses the external network from the inside, the NAT assigns a port to the current request, overwrites the source address and port in the packet, and stores the address and port information in a local translation table; when a packet enters the internal network from the outside, the NAT looks up the IP address and port number of the packet to the corresponding host and port number in the private network and overwrites the destination address and port in the packet.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/76f03191aa0d43ffb231f72439f56066.png" alt=""></p>
<p>With NAT as an intermediate layer, we can not only protect our private network, but also alleviate the shortage of IP addresses. However, NAT technology does not have only benefits, it also brings a lot of problems. In addition to the fact that a host under a NAT network does not have a true end-to-end connection to the other side and cannot participate in some of the Internet protocols, the NAT protocol brings the following problems that are controversial.</p>
<ol>
<li>the port numbers used by NAT are for process addressing and not for host addressing.</li>
<li>that the NAT router, as a Layer 3 (network layer) device, should only handle packets that reach the network layer</li>
<li>that NAT violates the principle that hosts should talk directly to each other.</li>
</ol>
<p>Although NAT brings a lot of controversy and problems, NAT has become a widely used technology throughout the Internet, and engineers have tried to solve the problems it brings through various NAT traversal techniques, such as SOCKS, UPnP and ALG, etc.</p>
<h2 id="compatibility">Compatibility</h2>
<p>Software and protocols are designed for the present and the predictable future, but it is difficult to predict the specific future trend, and the current design will gradually become inapplicable as the scenario changes. All software and protocols need to be updated and iterated, and in the process of updating we need to consider compatibility, which can generally be divided into Forward compatibility and Backward compatibility.</p>
<ul>
<li>Forward compatibility: the old version of the system can receive and process the data generated by the new version of the system.</li>
<li>Backward compatibility: the new version of the system can receive and process the data generated by the old version of the system.</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/c2fe82696a9e4eb98ee3bcb3cd0c498b.png" alt=""></p>
<p>If the IPv6 protocol is forward-compatible with IPv4, then the hardware devices used to handle IPv4 can handle IPv6 data without updating, but the benefits of IPv6 cannot be enjoyed without updating the system; if the IPv6 protocol is backward-compatible with IPv4, then the IPv6 hardware can If the IPv6 protocol is backward-compatible with IPv4, then IPv6 hardware can handle both IPv4 and IPv6 packets, and the entire network can be upgraded seamlessly by replacing IPv4 devices with IPv6 devices.</p>
<p>If IPv4 and IPv6 were forward-compatible or backward-compatible, the advancement of the IPv6 protocol might not be so complicated, but the IPv6 protocol was not designed with compatibility with earlier versions of the protocol in mind. Although IPv4 and IPv6 are both IP protocols, they are not compatible with each other, so we can only transition protocols through dual stacks, tunneling, or NAT64.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/d9b8f4bf86c24de4967d02da72fe596a.png" alt=""></p>
<p>It is understandable that the IPv6 protocol wants to get rid of the historical baggage and achieve a completely incompatible design. In the process of applying the IP protocol in the past decades, we have encountered many problems, and it is not impossible to move forward with the historical baggage, but as the core protocol of the Internet, although the designers of the IP protocol admit that the failure of IPv6 to achieve backward compatibility is the biggest mistake, the authors believe that it is good in the long run to get rid of the historical baggage quickly through incompatibility.</p>
<h2 id="address-control">Address Control</h2>
<p>IPv4 addresses are indeed a scarce resource in general, but like other scarce resources, it has always been a major issue to allocate them properly and provide utilization. ) are the organizations responsible for assigning IP addresses. Except for some IP addresses reserved for proprietary networks, the remaining addresses are generally assigned in the form of address blocks through subnets.</p>
<p>In the early development of the Internet Protocol, subnets were divided by the leftmost 8 bits of the IP address, but because this allowed only 256 networks to be divided, it was quickly replaced by the Classful Network Architecture in 1981. The Classful Network Architecture contains three types of networks, A, B and C</p>
<table>
<thead>
<tr>
<th>Class</th>
<th>Number of Networks</th>
<th>Number of Hosts</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>128</td>
<td>16,777,214</td>
</tr>
<tr>
<td>B</td>
<td>16,384</td>
<td>65,534</td>
</tr>
<tr>
<td>C</td>
<td>2,097,152</td>
<td>254</td>
</tr>
</tbody>
</table>
<p>Class A addresses can only be assigned to 128 different networks, each of which can contain 16 million hosts, while Class C addresses can be assigned to 2 million organizations and the network can contain more than 200 hosts. By classifying IP addresses, we are able to assign IP address blocks more rationally, but although it classifies IP addresses, it is still a crude division of addresses.</p>
<p>The IETF proposed Classless Inter-Domain Routing (CIDR) in 1993 as an alternative to the classified network architecture, which is based on Variable-length Subnet Masking (VLSM) and has two main purposes</p>
<ol>
<li>mitigating the rate of growth of router transit tables in the Internet.</li>
<li>mitigating the rate of IPv4 address exhaustion.</li>
</ol>
<p>The segmentation of addresses in the classified network architecture is still a bit too ideal, as too small address blocks are often insufficient and slightly larger address blocks are more wasteful. Unlike categorical network architectures that use only fixed-length subnet masks of 8, 16, and 24 to divide IP address blocks into three classes, CIDR uses variable-length subnet masks to divide address blocks, as shown in the CIDR representation below, where N denotes the prefix length, which can be any value from 0 to 32.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">A</span><span class="p">.</span><span class="nx">B</span><span class="p">.</span><span class="nx">C</span><span class="p">.</span><span class="nx">D</span><span class="o">/</span><span class="nx">N</span>
</code></pre></td></tr></table>
</div>
</div><p>A.B.C.D/8, A.B.C.D/16, and A.B.C.D/24 can represent different address blocks of A, B, and C, respectively, in a categorical network architecture, while other numbers can be used to more flexibly represent a specific number of networks and hosts in a subnet.</p>
<p>In addition to more granular address allocation, recycling and reusing IP resources that are no longer in use is an important means of extending the life of IPv4, but we won&rsquo;t go into that here. From IP address allocation, we can see the change of attitude towards resource usage from abundant to scarce, from the first rough allocation to the later fine-grained control, abundant resources will always be abused, and only when resources become really scarce, we start to calculate carefully.</p>
<h2 id="summary">Summary</h2>
<p>Nearly 40 years have passed since the IPv4 protocol was released in 1981, and in that time it has assumed significant responsibility for packet forwarding and routing as a key protocol in the Internet protocol cluster, and as network environments and end devices have become more complex, we have needed more IP addresses to meet today&rsquo;s needs.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/02/3e46d57599874690966735fcca4698f5.png" alt=""></p>
<p>The IPv6 protocol has shed much of its historical baggage, and while more and more websites and network devices are beginning to support IPv6, it is difficult for IPv6 to completely replace IPv4 for many reasons, so let&rsquo;s revisit the content of this article.</p>
<ul>
<li>NAT technology can largely alleviate the IPv4 address shortage and protect private internal networks, providing a firewall function.</li>
<li>IPv4 and IPv6 protocols are completely incompatible, and we need to introduce dual stack, tunneling, or NAT64 to address compatibility issues, and there are additional costs associated with applying these technologies.</li>
<li>IP address exhaustion can be delayed by fine-grained control of resources and reclaiming IP addresses that are no longer in use.</li>
</ul>
<p>The imagination of engineers is boundless, and over the last decade or so we have tried to renew the IPv4 protocol in various ways to slow down the exhaustion of IP resources, but in the foreseeable future the IPv4 protocol will be replaced by IPv6 and we will have an almost endless supply of IP addresses. Finally, let&rsquo;s look at some of the more open-ended questions that interested readers can ponder.</p>
<ul>
<li>What does the IPv5 protocol do? Why haven&rsquo;t you heard of the IPv5 protocol?</li>
<li>How soon do you think the IPv6 protocol will overtake IPv4 in terms of share?</li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/ipv4/">ipv4</a>
          <a href="/tags/ipv6/">ipv6</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-12/whys-the-design-mysql-auto-increment/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Why MySQL&#39;s self-incrementing primary keys are not monotonic or continuous</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-12/whys-the-design-non-unique-mac-address/">
            <span class="next-text nav-default">Why MAC addresses do not need to be globally unique</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
