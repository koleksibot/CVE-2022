<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Why is the UDP header only 8 bytes long? - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="The two transport protocols, UDP and TCP, are core members of the IP protocol cluster. The RFC 768, published in 1980, defines the UDP protocol, which allows us to pass data across a network of multiple computer connections. The common DNS protocol can use the UDP protocol to obtain the results of domain name resolution
UDP is the simplest protocol that can transmit data, and its protocol header (also called protocol header) is only 8 bytes." /><meta name="keywords" content="udp, 8 byte" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-12/whys-the-design-udp-minimum-header/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Why is the UDP header only 8 bytes long?" />
<meta property="og:description" content="The two transport protocols, UDP and TCP, are core members of the IP protocol cluster. The RFC 768, published in 1980, defines the UDP protocol, which allows us to pass data across a network of multiple computer connections. The common DNS protocol can use the UDP protocol to obtain the results of domain name resolution
UDP is the simplest protocol that can transmit data, and its protocol header (also called protocol header) is only 8 bytes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-12/whys-the-design-udp-minimum-header/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-09T14:52:03+08:00" />
<meta property="article:modified_time" content="2021-12-09T14:52:03+08:00" />

<meta itemprop="name" content="Why is the UDP header only 8 bytes long?">
<meta itemprop="description" content="The two transport protocols, UDP and TCP, are core members of the IP protocol cluster. The RFC 768, published in 1980, defines the UDP protocol, which allows us to pass data across a network of multiple computer connections. The common DNS protocol can use the UDP protocol to obtain the results of domain name resolution
UDP is the simplest protocol that can transmit data, and its protocol header (also called protocol header) is only 8 bytes."><meta itemprop="datePublished" content="2021-12-09T14:52:03+08:00" />
<meta itemprop="dateModified" content="2021-12-09T14:52:03+08:00" />
<meta itemprop="wordCount" content="1542">
<meta itemprop="keywords" content="udp," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Why is the UDP header only 8 bytes long?"/>
<meta name="twitter:description" content="The two transport protocols, UDP and TCP, are core members of the IP protocol cluster. The RFC 768, published in 1980, defines the UDP protocol, which allows us to pass data across a network of multiple computer connections. The common DNS protocol can use the UDP protocol to obtain the results of domain name resolution
UDP is the simplest protocol that can transmit data, and its protocol header (also called protocol header) is only 8 bytes."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Why is the UDP header only 8 bytes long?</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-12-09 14:52:03 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1542 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#data-transfer">Data Transfer</a></li>
        <li><a href="#process-location">Process location</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>The two transport protocols, UDP and TCP, are core members of the IP protocol cluster. The <a href="https://tools.ietf.org/html/rfc768">RFC 768</a>, published in 1980, defines the UDP protocol, which allows us to pass data across a network of multiple computer connections. The common DNS protocol can use the UDP protocol to obtain the results of domain name resolution</p>
<p>UDP is the simplest protocol that can transmit data, and its protocol header (also called protocol header) is only 8 bytes. Many people, especially fresh graduates, can temporarily memorize the contents of the UDP protocol header by rote, but knowing the contents of the header does not mean we really understand the reason behind it. This article will analyze why only 8 bytes of the UDP protocol can transmit data, and I believe this article will help you better understand the role of the fields in the UDP protocol header.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/09/18b9fa9781304fe8a819b8806e284e59.png" alt=""></p>
<p>The UDP protocol header contains only 4 fields, source port, destination port, length, and checksum, each of which occupies 16 bits, or 2 bytes, and these 4 fields serve the following purposes.</p>
<ul>
<li>Source port is an optional field that indicates the port number of the sender&rsquo;s process, which the receiver can use (not necessarily exactly) to send information to the sender.</li>
<li>Destination Port is the port number of the recipient of the datagram, which is meaningful only under the IP address of the destination.</li>
<li>Length is the sum of the protocol header and the length of the data in the datagram, indicating the size of the entire datagram.</li>
<li>Checksum is calculated using the IP header, the UDP header and the data in the datagram. The receiver can verify the accuracy of the data through the checksum and find problems in the transmission process.</li>
</ul>
<p>Packet capture by Wireshark to see the value of the UDP protocol initials in actual use. When we execute the <code>dig baidu.com</code> command, a DNS query is sent locally to the DNS server, and the following is an example of the UDP initials in a DNS query.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">0000 ff 7c 00 35 00 23 c2 6e
</code></pre></td></tr></table>
</div>
</div><p>The values of the four fields in the UDP prefix above correspond to the following.</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>source port</td>
<td><code>0xff7c = 65404</code></td>
</tr>
<tr>
<td>destination port</td>
<td><code>0x0035 = 53</code></td>
</tr>
<tr>
<td>length</td>
<td><code>0x0023 = 35</code></td>
</tr>
<tr>
<td>checksum</td>
<td><code>0xc26e</code></td>
</tr>
</tbody>
</table>
<p>Since the DNS protocol uses port 534, the destination port in the UDP prefix above is 53. The source port is the port on which the DNS request is made locally and which is also used to receive the DNS response.</p>
<p>The RFC 768 document defining the UDP protocol is only three pages long, and since the UDP protocol requires neither guaranteed delivery nor guaranteed order, it is not as complex as the TCP protocol. Mechanisms such as the three handshakes5 , congestion control algorithms, and retransmission policies in the TCP protocol are all necessary to provide reliability, but the UDP protocol does not require these policies; it only tries to ensure that datagrams are delivered.</p>
<p>Today we will analyze why the UDP protocol, with a first 8 bytes, is able to transmit data to its destination and have it received and processed by a specific service. We can divide the application-to-application transfer process into two parts: host-to-host data transfer and host-to-application data forwarding.</p>
<ul>
<li>The Internet Protocol (IP) underlying the UDP protocol will be responsible for the transmission of packets between hosts.</li>
<li>The port number at the beginning of the UDP protocol is used to locate the specific process that handles the data and forwards it.</li>
</ul>
<p>We all say that UDP protocol is a transport layer protocol, but it is the IP protocol that really does the work of &lsquo;data transfer&rsquo; between hosts, and UDP protocol only serves to locate the specific process.</p>
<h2 id="data-transfer">Data Transfer</h2>
<p>RFC768 introduces the UDP protocol by emphasizing that the UDP protocol assumes that the underlying layer will use the IP protocol, which is a core member of the TCP/IP stack and does not guarantee end-to-end data reliability or order, nor does it contain mechanisms such as flow control, whose role is to transfer packets from source to destination. In this article, we only need to know that the IP protocol header contains the source IP and the destination IP, so we will not go into the specific implementation of the IP protocol. Interested readers can read <a href="https://tools.ietf.org/html/rfc791">RFC791</a> and related documents for more details.</p>
<p>The phrase &ldquo;the UDP protocol can only try to deliver data&rdquo; is &ldquo;inherited&rdquo; from the lower layer of UDP, the IP protocol. The UDP protocol, which contains only two port numbers, cannot provide routing and addressing functions by itself; it still needs a lower layer protocol to solve this problem.</p>
<p>The above-mentioned design of each of these layers stems from the hierarchical structure of network communication protocols. Abstraction is a fundamental concept in computer science, and by defining good interfaces and building abstraction layers, we can reduce the number of simultaneous concerns and allow each layer to focus on the problem that needs to be addressed. the TCP/IP protocol cluster divides the communication process into four abstraction layers: Link, Internet, Transport and the application layer (Application)</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/09/0d878795e24049b08c7cdde625a06b7b.png" alt=""></p>
<p>Different abstraction layers have completely different functions, so let&rsquo;s look at the responsibilities of the network layer and the transport layer. the main role of transport layer protocols such as TCP and UDP is to establish the basic data pipeline for applications and provide data transfer capabilities for specific tasks, while the main role of network layer protocols such as IP is addressing and routing, which helps us send data to the target host.</p>
<p>To briefly summarize, the IP protocol under the UDP protocol implements the transmission of data packets, and although UDP is a transport layer protocol, it does not provide host-to-host data transfer capability on its own.</p>
<h2 id="process-location">Process location</h2>
<p>At the software level, a port is a logical concept used to represent a specific process or a specific type of network service. The concept of a port is also found in computer hardware, but the port in this case is not physical. When a host receives an IP packet, it is given to a different module for processing based on the protocol number, and the TCP and UDP protocols determine the corresponding process based on the port number.</p>
<p>Although both TCP and UDP protocols have the concept of port numbers, because they are not under the same namespace (TCP and UDP are two sets of namespaces), TCP and UDP can both use the same port number, e.g., <code>53/TCP</code> and <code>53/UDP</code>, and the services behind these two port numbers both handle DNS requests. From this point of view, the only way to locate a specific service on the network is by IP address, transport layer protocol, and port number; it is not feasible to rely on IP address and port number alone.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/09/54835428334449e7aed4ac9515202e6b.png" alt=""></p>
<p>The two port numbers in the UDP protocol account for half of the overhead of the UDP protocol header, which illustrates the importance of port numbers in the UDP protocol and the primary function of the UDP protocol. The host receiving the IP packet can use the destination port number to find a specific process, and that process can use the source port number in the packet to reply to the sender.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/09/1c3c2eaf10c14f9f8827a1cedf161311.png" alt=""></p>
<p>TCP and UDP port numbers are an intermediate layer between the host and the process. Processes and port numbers can have either a one-to-one or a one-to-many relationship, and the introduction of port numbers allows multiple processes on the same host to provide services externally, or one process to provide multiple services externally. With port numbers, requests to access a host service also do not require the use of process identifiers, for example, to locate the specific process providing the service.</p>
<h2 id="summary">Summary</h2>
<p>To briefly answer the question posed in this article: the UDP protocol uses the underlying IP protocol to provide basic data transfer capabilities, and its role is to introduce the concept of port numbers to allow the same host to provide multiple external services at the same time, with the protocol itself taking up only 8 bytes since reliability is not guaranteed.</p>
<p>Ideally, we could build a new transport layer protocol on top of the IP protocol to achieve specific needs, but in practice, due to the protocol number limitation, the new transport layer protocol cannot be recognized and supported by a large number of deployed Network address translation (NAT) devices, so building a new transport layer protocol in this way is difficult to implement in practice.</p>
<blockquote>
<p>The protocol number is a field in the IP header that indicates the protocol used for the current message data area; the most common protocol numbers for TCP and UDP protocols are 6 and 17, respectively.</p>
<p>The SCTP protocol is a transport layer protocol in the RFC standard, but compatibility issues with NAT devices can cause SCTP messages to be discarded</p>
</blockquote>
<p>Because the UDP protocol is so simple, many new transport layer protocols will be implemented based on UDP, e.g., Google&rsquo;s QUIC protocol. Finally, let&rsquo;s look at some of the more open-ended questions that interested readers can ponder.</p>
<ul>
<li>Can the length and checksum be omitted from the UDP protocol? Why?</li>
<li>Do other IP-based transport layer protocols besides UDP and TCP have the concept of port numbers?</li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/udp/">udp</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-12/whys-the-design-tcp-performance/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Why the TCP protocol has performance problems</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-12/golang-array/">
            <span class="next-text nav-default">Implementation principles of Go language arrays</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
