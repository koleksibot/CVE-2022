<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Common coordinate systems in autonomous driving - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Introduction In autonomous driving, there are several coordinate systems involved from the car&amp;rsquo;s sensors to global positioning, which are briefly organized below.
Sensor Coordinate System Each sensor has its own coordinate system, which can be divided into relative measurement (measuring environmental information) and absolute measurement (measuring its own information) according to its measurement principle. Relative sensors such as cameras and LiDAR measure environmental information for indirect positioning, while absolute sensors such as IMUs, tachometers, and GPS measure their own motion (speed, position, attitude, etc." /><meta name="keywords" content="Common coordinate, autonomous driving" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-12/mapping_coordinate_systems/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Common coordinate systems in autonomous driving" />
<meta property="og:description" content="Introduction In autonomous driving, there are several coordinate systems involved from the car&rsquo;s sensors to global positioning, which are briefly organized below.
Sensor Coordinate System Each sensor has its own coordinate system, which can be divided into relative measurement (measuring environmental information) and absolute measurement (measuring its own information) according to its measurement principle. Relative sensors such as cameras and LiDAR measure environmental information for indirect positioning, while absolute sensors such as IMUs, tachometers, and GPS measure their own motion (speed, position, attitude, etc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-12/mapping_coordinate_systems/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-12-31T14:00:57+08:00" />
<meta property="article:modified_time" content="2021-12-31T14:00:57+08:00" />

<meta itemprop="name" content="Common coordinate systems in autonomous driving">
<meta itemprop="description" content="Introduction In autonomous driving, there are several coordinate systems involved from the car&rsquo;s sensors to global positioning, which are briefly organized below.
Sensor Coordinate System Each sensor has its own coordinate system, which can be divided into relative measurement (measuring environmental information) and absolute measurement (measuring its own information) according to its measurement principle. Relative sensors such as cameras and LiDAR measure environmental information for indirect positioning, while absolute sensors such as IMUs, tachometers, and GPS measure their own motion (speed, position, attitude, etc."><meta itemprop="datePublished" content="2021-12-31T14:00:57+08:00" />
<meta itemprop="dateModified" content="2021-12-31T14:00:57+08:00" />
<meta itemprop="wordCount" content="1687">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Common coordinate systems in autonomous driving"/>
<meta name="twitter:description" content="Introduction In autonomous driving, there are several coordinate systems involved from the car&rsquo;s sensors to global positioning, which are briefly organized below.
Sensor Coordinate System Each sensor has its own coordinate system, which can be divided into relative measurement (measuring environmental information) and absolute measurement (measuring its own information) according to its measurement principle. Relative sensors such as cameras and LiDAR measure environmental information for indirect positioning, while absolute sensors such as IMUs, tachometers, and GPS measure their own motion (speed, position, attitude, etc."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Common coordinate systems in autonomous driving</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-12-31 14:00:57 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1687 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#sensor-coordinate-system">Sensor Coordinate System</a>
          <ul>
            <li><a href="#camera-coordinate-system">Camera coordinate system</a></li>
            <li><a href="#lidar-coordinate-system">Lidar coordinate system</a></li>
            <li><a href="#imu-coordinate-system">IMU Coordinate System</a></li>
            <li><a href="#gps">GPS</a></li>
            <li><a href="#tachymeter">Tachymeter</a></li>
          </ul>
        </li>
        <li><a href="#car-coordinate-system">Car Coordinate System</a></li>
        <li><a href="#navigation-coordinate-system">Navigation Coordinate System</a></li>
        <li><a href="#world-coordinate-system">World coordinate system</a>
          <ul>
            <li><a href="#geographic-coordinate-system-gcs">Geographic Coordinate System (GCS)</a></li>
            <li><a href="#projection-coordinate-system">Projection coordinate system</a></li>
          </ul>
        </li>
        <li><a href="#flow-relationships-between-sensor-data">Flow relationships between sensor data</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="introduction">Introduction</h2>
<p>In autonomous driving, there are several coordinate systems involved from the car&rsquo;s sensors to global positioning, which are briefly organized below.</p>
<h2 id="sensor-coordinate-system">Sensor Coordinate System</h2>
<p>Each sensor has its own coordinate system, which can be divided into relative measurement (measuring environmental information) and absolute measurement (measuring its own information) according to its measurement principle. Relative sensors such as cameras and LiDAR measure environmental information for indirect positioning, while absolute sensors such as IMUs, tachometers, and GPS measure their own motion (speed, position, attitude, etc.) directly for positioning. For relative measurement sensors, the measurement value is usually under its own sensor; while absolute measurement is usually measured by its own coordinate system relative to other coordinate systems (local or world coordinate system, etc.). The following is a summary of common measurement sensors.</p>
<h3 id="camera-coordinate-system">Camera coordinate system</h3>
<p>The camera as an environmental sensor can reflect the environmental information on the picture according to the projection principle. Each point on the picture can be projected onto the normalized plane of the camera by back-projection, and the camera coordinate system is shown in the following figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/e32fe868125040e8abe103da93156a18.png" alt="image"></p>
<p>The orientation of the camera coordinate system is generally: X -&gt; Right, Y -&gt; Down, Z -&gt; Front</p>
<h3 id="lidar-coordinate-system">Lidar coordinate system</h3>
<p>LiDAR can be divided into 2D and 3D, and each frame of information is a point cloud. Each point in the point cloud can be expressed in polar (distance and angle) or Cartesian (x, y, z) coordinates, which are in the LIDAR coordinate system. The orientation of the LIDAR coordinate system varies from model to model, in general the Z-axis and the LIDAR rotation axis coincide pointing upwards when placed flat, and the XY-plane is parallel to the ground, as illustrated in the following diagram of the Ouster OS-1-64 coordinate system.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/364582664a094702a34b18eb36a2194a.png" alt="image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/dbc981402cbe4061bdaac4abd4d17e7a.png" alt="image"></p>
<h3 id="imu-coordinate-system">IMU Coordinate System</h3>
<p>Unlike cameras and LiDAR, IMU, GPS and tachometer do not collect environmental information, but directly measure the state of the sensor itself by different principles.</p>
<p>The measurement principle of IMU can be found in my previous blog: <a href="https://xiaotaoguo.com/p/imu-model/">IMU Measurement Model</a>. IMU can be divided into 6-axis and 9-axis, 6-axis IMU contains accelerometer and gyroscope. IMU itself has a coordinate system defined as shown below.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/901375c234f6484cb283ebe8f846b047.png" alt="image"></p>
<p>The measurements of IMU accelerometer and gyroscope are the acceleration and angular velocity of IMU coordinate system relative to the inertial system, respectively. The choice of inertial system can be different depending on the use scenario and accuracy requirements. For small range and short time positioning, we can approximate the local coordinate system as the inertial system, which is simpler to solve the carrier state, and for large range and long time with high accuracy requirements, we can choose the world coordinate system (ECEF coordinate system mentioned below) as the inertial system, which needs to consider the information of earth rotation The calculation is relatively complicated because it needs to consider information such as the rotation speed of the Earth and the altitude of the carrier.</p>
<h3 id="gps">GPS</h3>
<p>GPS has no coordinate system, it measures the coordinates of the carrier in the world coordinate system (WGS84). It consists of longitude and latitude.</p>
<h3 id="tachymeter">Tachymeter</h3>
<p>A wheel tachometer usually has no coordinate system of its own. The measurement of a single encoder is the speed of that wheel. The tangential velocity at the center of the line connecting the two wheels can be obtained by combining the encoders on both wheels with a checkpoint model. This is shown in the following figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/2eda37b426de47c49b9562c5c2a40e02.png" alt="image"></p>
<h2 id="car-coordinate-system">Car Coordinate System</h2>
<p>The automotive coordinate system is a human-defined coordinate system fixed at a point of the car. As a reference coordinate system of the car system itself and each sensor coordinate system are linked by external reference. The orientation of the vehicle coordinate system is generally FLU (Front-Left-Upper), and its position varies with different scenarios. point, as shown below. In some cases where there are few sensors, the IMU, GPS or some sensor coordinate system can also be used as the car coordinate system.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/0ba799de10bb4509a32142bea92e8191.png" alt="image"></p>
<h2 id="navigation-coordinate-system">Navigation Coordinate System</h2>
<p>The odometer in autonomous driving tracks the motion of the car in successive moments, leading to the concept of a navigation coordinate system. The navigation coordinate system is generally fixed at the position of the car at the starting moment. In the case where gravity can be aligned (with inertial sensors such as IMU), there are generally two directions, ENU (East-North-East-Earth) or NED (North-East-Earth), and if gravity cannot be aligned, the direction is the initial attitude of the car&rsquo;s coordinate system. The car&rsquo;s attitude measured by the odometer is the attitude in the navigation coordinate system. It can be considered as a local coordinate system compared to the world coordinate system.</p>
<h2 id="world-coordinate-system">World coordinate system</h2>
<p>In practice, an unmanned vehicle may pass through the same area several times for positioning and map building. The origin of the navigation coordinate system is not the same every time, which obviously does not meet the demand. Therefore there is a need for global measurements to obtain the absolute position of the car on the Earth, which leads to the concept of a world coordinate system. The world coordinate system usually encompasses the whole earth and has its origin fixed somewhere on the earth (geocentric), in the form of geocentric and Dicard coordinate systems. Since the Earth itself is an (ellipsoidal) sphere, the conversion from the geocentric to the Dicard coordinate system needs to follow some kind of projection, which involves distortion and deformation.</p>
<h3 id="geographic-coordinate-system-gcs">Geographic Coordinate System (GCS)</h3>
<h4 id="geocentric-geofixed-coordinate-system-ecef">Geocentric Geofixed Coordinate System (ECEF)</h4>
<p>The geocentric ground-fixed coordinate system (Earth-Centered,Earth-Fixed, ECEF) has the origin at the center of mass of the Earth, the x-axis points to the intersection of the prime meridian and the equator, the y-axis is perpendicular to the xOz plane (i.e., the intersection of 90 degrees East and the equator), and the z-axis points to the North Pole, and its relationship with the navigation coordinate system (in the case of ENU) is shown in the following figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/2b27986e6011478e9e225646ec9f45a0.png" alt="image"></p>
<h4 id="geodetic-coordinate-system-lla">Geodetic Coordinate System (LLA)</h4>
<p>Since the Earth&rsquo;s surface itself is ellipsoidal, it is not intuitive to describe the geographic location in terms of ECEF. Therefore, in addition to describing it in a Cartesian coordinate system, a geodetic coordinate system can also be used to describe the location of a point on the Earth. As can be seen from the figure above, there are two parametric methods to locate the position of a point on the Earth, one is to describe it using the <code>x,y,z</code> coordinates in the ECEF system, and the other is to describe it using the <code>λ,ϕ,h</code> in the geodetic coordinate system, which is the method we commonly use to describe latitude and longitude (and altitude). The standard currently in use is WGS-84, and the formula for transferring from WGS-84 to ECEF is</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/e0b53dfead9c497fa477752488cd61aa.png" alt="image"></p>
<p>where <code>a</code> and <code>b</code> are the radii of the long axis and short axis of the Earth, respectively.</p>
<p>When calculating the distance between two points expressed in latitude and longitude, the distance calculated is not the shortest distance between two points, but the shortest distance between two points along the Earth&rsquo;s surface (Great-circle distance) because the Earth&rsquo;s surface is a curved surface is taken into account, and the calculation formula is</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/ec7d1efbbaee4ed1a84a82ac6739b8fc.png" alt="image"></p>
<p>where <code>R=6371000</code> is the radius of the Earth, and <code>ϕ,λ</code> are the latitude and longitude of the two points, respectively. To be less demanding in terms of accuracy, the equation can be simplified as</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/0e1df83c1823487a847cebf54fc1eec9.png" alt="image"></p>
<h3 id="projection-coordinate-system">Projection coordinate system</h3>
<p>Since the Earth&rsquo;s surface is curved, it is not convenient to calculate the distance between two points along the Earth&rsquo;s surface for both ECEF and LLA coordinate systems, so it is often necessary to project the Earth onto a 2D plane for visualization and map positioning, so the concept of projection coordinate system is introduced. Two types of projection coordinate systems are presented here.</p>
<h4 id="universal-transverse-mercator-projection-utm">Universal Transverse Mercator Projection UTM</h4>
<p>The UTM coordinates divide the Earth into 60 longitude and 20 latitude zones. The following figure shows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/3058ee87c5f5451f99e3548e912665c0.png" alt="image"></p>
<p>In the UTM system, each point on the Earth can be located by four parameters: the longitude band number, the dimensional band number, the distance of the point from the projection of the central meridian of that longitude zone, and the distance of the point from the projection of the equator.</p>
<h4 id="web-mercator-projection-web-mercator">Web Mercator Projection Web Mercator</h4>
<p>Web Mercator is capable of projecting latitude and longitude as two X/Y coordinates. The computational relationship is</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/66e6befd35fd4b7f82cb86372f505028.png" alt="image"></p>
<p>The inverse projection relationship is</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/f3663195beee4250a69996b8fa9cabb5.png" alt="image"></p>
<h2 id="flow-relationships-between-sensor-data">Flow relationships between sensor data</h2>
<p>In general, the relationship between different coordinate systems for a typical positioning and map building scenario situation is as follows.</p>
<p>Sensor data (e.g. LIDAR, camera, etc.) are obtained as measurements in their own coordinate system, including state measurement sensors (e.g. IMU, tachometer) which also measure based on their own state (although in general it can be assumed that the state of these sensors is the same as the state of the car itself considering that the IMU and encoder are solidly connected), so it is necessary to transform these measurements into measurements in the car coordinate system by external reference.</p>
<p>After the sensor data is unified to the car coordinate system, the state of the car in the reference coordinate system (<strong>positioning</strong>) can be obtained by different fusion methods compared to the global measurement data (under the navigation coordinate system or under the world coordinate system), and the environmental data measured by the sensors is updated to the reference coordinate system (<strong>building map</strong>) to complete the overall process. In the case of absolute position measurement (latitude and longitude), it is generally converted to the projection coordinate system first for the convenience of calculation, and the same is passed to the car coordinate system by external reference, and the other sensor data are fused, and the position after the fusion is completed is also passed through the opposite process to finally obtain the latitude and longitude data under the geographic coordinate system.</p>
<p>In the absence of absolute measurements, the navigation coordinate system can be used as the reference coordinate system. When absolute measurements are available, the navigation coordinate system is generally used as a tool to calculate distances, angles, etc. between surrounding features, which is more convenient to calculate than the projected coordinate system.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/12/31/e2959ebb319c491f82470f99ec613a86.png" alt="image"></p>

    </div>

    
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/2021-12/cpp-smart-pointers/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Basic usage of smart pointers in C&#43;&#43;</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-12/computing-advertising-cpi-fraud/">
            <span class="next-text nav-default">CPI/CPA advertising common cheating methods summary</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
