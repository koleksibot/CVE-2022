<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Installing SonarQube in Centos7 - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="SonarQube is a code quality management open platform that integrates thousands of automatic static code analysis rules designed to improve the quality and security of developers&#39; code, enabling developers to write cleaner, safer code. Three main and larger features are provided.
 Code reliability support: catch and alert errors in code in advance, thus avoiding undefined behaviors affecting end users. Application Security Support: Fixes vulnerabilities that could compromise applications and learns AppSec through security hotspots (simply understood to mean that it will learn and identify new vulnerabilities)." /><meta name="keywords" content="centos,install-SonarQube" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-06/installing-sonarqube-in-centos7/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Installing SonarQube in Centos7" />
<meta property="og:description" content="SonarQube is a code quality management open platform that integrates thousands of automatic static code analysis rules designed to improve the quality and security of developers&#39; code, enabling developers to write cleaner, safer code. Three main and larger features are provided.
 Code reliability support: catch and alert errors in code in advance, thus avoiding undefined behaviors affecting end users. Application Security Support: Fixes vulnerabilities that could compromise applications and learns AppSec through security hotspots (simply understood to mean that it will learn and identify new vulnerabilities)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-06/installing-sonarqube-in-centos7/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-27T19:25:01+08:00" />
<meta property="article:modified_time" content="2021-06-27T19:25:01+08:00" />

<meta itemprop="name" content="Installing SonarQube in Centos7">
<meta itemprop="description" content="SonarQube is a code quality management open platform that integrates thousands of automatic static code analysis rules designed to improve the quality and security of developers&#39; code, enabling developers to write cleaner, safer code. Three main and larger features are provided.
 Code reliability support: catch and alert errors in code in advance, thus avoiding undefined behaviors affecting end users. Application Security Support: Fixes vulnerabilities that could compromise applications and learns AppSec through security hotspots (simply understood to mean that it will learn and identify new vulnerabilities)."><meta itemprop="datePublished" content="2021-06-27T19:25:01+08:00" />
<meta itemprop="dateModified" content="2021-06-27T19:25:01+08:00" />
<meta itemprop="wordCount" content="1503">
<meta itemprop="keywords" content="sonarqube,centos," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Installing SonarQube in Centos7"/>
<meta name="twitter:description" content="SonarQube is a code quality management open platform that integrates thousands of automatic static code analysis rules designed to improve the quality and security of developers&#39; code, enabling developers to write cleaner, safer code. Three main and larger features are provided.
 Code reliability support: catch and alert errors in code in advance, thus avoiding undefined behaviors affecting end users. Application Security Support: Fixes vulnerabilities that could compromise applications and learns AppSec through security hotspots (simply understood to mean that it will learn and identify new vulnerabilities)."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Installing SonarQube in Centos7</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-06-27 19:25:01 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/tools/"> tools </a>
            </div>
          <span class="more-meta"> 1503 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#sonarqube-installation">SonarQube Installation</a>
          <ul>
            <li><a href="#install-jdk11">Install JDK11</a></li>
            <li><a href="#installing-postgresql-database">Installing PostgreSQL database</a></li>
            <li><a href="#installing-the-sonarqube-service">Installing the SonarQube service</a></li>
          </ul>
        </li>
        <li><a href="#sonarqube-use">SonarQube use</a></li>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><a href="https://www.sonarqube.org/">SonarQube</a> is a code quality management open platform that integrates thousands of automatic static code analysis rules designed to improve the quality and security of developers' code, enabling developers to write cleaner, safer code. Three main and larger features are provided.</p>
<ul>
<li>Code reliability support: catch and alert errors in code in advance, thus avoiding undefined behaviors affecting end users.</li>
<li>Application Security Support: Fixes vulnerabilities that could compromise applications and learns <code>AppSec</code> through security hotspots (simply understood to mean that it will learn and identify new vulnerabilities).</li>
<li>Technical debt support: Ensure that the managed code base is clean and maintainable in order to improve the development efficiency of developers.</li>
</ul>
<p>Currently <code>SonarQube</code> supports 27 programming languages, basically covering projects written in the current mainstream programming languages:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/7813c510ebf9444d816c1de763cc8d9e.png" alt=" "></p>
<p>While the features mentioned above may be rather general, the R&amp;D team can actually do the following things based on <code>SonarQube</code>:</p>
<ul>
<li>The <code>CI/CD</code> process adds a <code>SonarQube</code> scanning session.</li>
<li>A code quality threshold is implemented, and only after passing this quality threshold test can we move to the next process.</li>
<li>Projects with code quality below the threshold have to adjust the corresponding code in time.</li>
</ul>
<p>Quality thresholds can be customized, and <code>SonarQube</code> will have detailed panel information for each project, which will give the current health status of the project, classification and breakdown of different levels of vulnerabilities, vulnerabilities corresponding to the submitter and other multi-dimensional statistical information to facilitate the tracking and repair of problems. For example, the author&rsquo;s project in the last company needs to run a pipeline, and <code>SonarQube</code> set different levels of thresholds, for old projects, will use the lowest level of thresholds: the number of blocking errors required for <code>0</code>, for some new projects, the quality of strict requirements such as the number of serious errors required for 0, etc., as long as it can not pass the quality threshold check, then the project is unable to go online</p>
<h2 id="sonarqube-installation">SonarQube Installation</h2>
<p>In general, you only need to install the community version of the free <code>SonarQube</code> service, which can be installed based on binaries or directly using <code>Docker</code> to download images to start. The binary installation process is more complicated because <code>SonarQube</code> internally relies on the built-in <code>ElasticSearch</code> to do searches in <code>Linux</code> systems You need to add a non-<code>root</code> user and modify some system parameters such as the maximum number of open files supported by the system. In addition, <code>SonarQube</code> is a <code>Java</code> application and requires a local installation of the <code>JDK</code>. Since version <code>7.9</code> of <code>SonarQube</code>, the support for <code>MySQL</code> database has been dropped, and only four storage engines are supported under version <code>8.3.1</code>, namely, in-memory mode, <code>PostgreSQL</code>, <code>Microsoft SQL Server</code> and <code>Oracle</code>. I have researched that the installation of <code>PostgreSQL</code> is relatively easy among the three databases in persistent mode. The following is a detailed documentation of the process of installing <code>SonarQube</code> service based on binary files.</p>
<table>
<thead>
<tr>
<th>Software/System</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>CentOS</td>
<td>7.x</td>
</tr>
<tr>
<td>OpenJDK</td>
<td>11.x</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>12.x</td>
</tr>
<tr>
<td>SonarQube</td>
<td>8.3.1</td>
</tr>
</tbody>
</table>
<blockquote>
<p>If the firewall is on, you need to open the corresponding port number.</p>
</blockquote>
<h3 id="install-jdk11">Install JDK11</h3>
<p>The installation of OpenJDK is relatively simple</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">mdkir /data/openjdk
<span class="nb">cd</span> /data/openjdk
wget https://download.java.net/openjdk/jdk11/ri/openjdk-11+28_linux-x64_bin.tar.gz
<span class="c1">## By default, it will be extracted to the /data/openjdk/jdk-11 folder</span>
tar -zxvf openjdk-11+28_linux-x64_bin.tar.gz
</code></pre></td></tr></table>
</div>
</div><p>If there is no default JDK on the system, you can add it to <code>/etc/profile</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">vim /etc/profile

<span class="c1">## Add the following to the /etc/profile file</span>
<span class="nb">export</span> <span class="nv">JAVA_HOME</span><span class="o">=</span>/data/openjdk/jdk-11
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$JAVA_HOME</span>/bin:<span class="nv">$PATH</span>

<span class="c1">## Refresh environment variables</span>
<span class="nb">source</span> /etc/profile
</code></pre></td></tr></table>
</div>
</div><p>To test:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="o">[</span>root@localhost jdk-11<span class="o">]</span><span class="c1"># java -version</span>
openjdk version <span class="s2">&#34;11&#34;</span> 2018-09-25
OpenJDK Runtime Environment 18.9 <span class="o">(</span>build 11+28<span class="o">)</span>
OpenJDK 64-Bit Server VM 18.9 <span class="o">(</span>build 11+28, mixed mode<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="installing-postgresql-database">Installing PostgreSQL database</h3>
<p>The installation of PostgreSQL is also relatively simple, and the official documentation has very detailed steps:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/1a36bef01aed474ea90bc5f76f26f77d.png" alt="postgresql"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm
yum install -y postgresql12
yum install -y postgresql12-server
/usr/pgsql-12/bin/postgresql-12-setup initdb
systemctl <span class="nb">enable</span> postgresql-12
systemctl start postgresql-12
</code></pre></td></tr></table>
</div>
</div><p>Modify the <code>/var/lib/pgsql/12/data/pg_hba.conf</code> configuration to open access to all <code>Host</code>s.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/ce93e7114b54483a8205677a5474e12b.png" alt=" "></p>
<p>Next, restart PostgreSQL:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">systemctl restart postgresql-12
</code></pre></td></tr></table>
</div>
</div><p>Switch users to the <code>PostgreSQL</code> command line, and add a new database user <code>sonar</code> and a new database <code>sonar</code> for backup</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="n">su</span><span class="w"> </span><span class="n">postgres</span><span class="w">
</span><span class="w"></span><span class="n">psql</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">postgres</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="n">sonar</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">PASSWORD</span><span class="w"> </span><span class="s1">&#39;sonar&#39;</span><span class="p">;</span><span class="w">
</span><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">sonar</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="k">OWNER</span><span class="w"> </span><span class="n">sonar</span><span class="w"> </span><span class="k">ENCODING</span><span class="w"> </span><span class="s1">&#39;UTF8&#39;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/2bf0a093509a4f0b9e910130c2778846.png" alt=" "></p>
<p>This creates a database with the name <code>sonar</code>, the username <code>sonar</code> and the password <code>sonar</code>.</p>
<h3 id="installing-the-sonarqube-service">Installing the SonarQube service</h3>
<p>Before installing the <code>SonarQube</code> service, you can refer to the <a href="https://docs.sonarqube.org/latest/requirements/requirements">Prerequisites and Overview</a> to adjust the system parameters, most of which are actually related to <code>ElasticSearch</code>, check the parameters:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1">## The maximum number of VMAs (virtual memory areas) a process can have</span>
sysctl vm.max_map_count
<span class="c1">## Maximum number of files to be opened simultaneously </span>
sysctl fs.file-max
<span class="c1">## Maximum number of file descriptors that can be opened</span>
<span class="nb">ulimit</span> -n
<span class="c1">## Maximum number of threads that can be started</span>
<span class="nb">ulimit</span> -u
</code></pre></td></tr></table>
</div>
</div><p>If the current session is the <code>root</code> user, you can modify these four parameters directly with the following command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">sysctl -w vm.max_map_count<span class="o">=</span><span class="m">262144</span>
sysctl -w fs.file-max<span class="o">=</span><span class="m">65536</span>
<span class="nb">ulimit</span> -n <span class="m">65536</span>
<span class="nb">ulimit</span> -u <span class="m">4096</span>
</code></pre></td></tr></table>
</div>
</div><p>Otherwise, you need to manually modify the <code>/etc/security/limits.conf</code> file by adding at the end of the file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">* soft nofile <span class="m">65536</span>
* hard nofile <span class="m">65536</span>
* soft nproc <span class="m">4096</span>
* hard nproc <span class="m">4096</span>
</code></pre></td></tr></table>
</div>
</div><p>Modify the <code>/etc/sysctl.conf</code> file by adding at the end of the file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">vm.max_map_count<span class="o">=</span><span class="m">262144</span>
fs.file-max<span class="o">=</span><span class="m">65536</span>
</code></pre></td></tr></table>
</div>
</div><p><code>/etc/security/limits.conf</code> and <code>/etc/sysctl.conf</code> must be <strong>restarted after updating the server</strong>.</p>
<p>Next, add a new user <code>sonarqube</code> (the underlying reason is that <code>ElasticSearch</code> cannot be started with the <code>root</code> user).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">adduser sonarqube
<span class="c1"># This step requires a password, where the password is also tentatively set sonarqube</span>
passwd sonarqube
<span class="c1"># Assign Permissions</span>
chown -R sonarqube:sonarqube /data/sonarqube
</code></pre></td></tr></table>
</div>
</div><p>Next, download and install <code>SonarQube</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/6a4e819991fd4cd2871329f4fb6cbbca.png" alt=" "></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">mdkir /data/sonarqube
<span class="nb">cd</span> /data/sonarqube
wget https://binaries.sonarsource.com/D
istribution/sonarqube/sonarqube-8.3.1.34397.zip
uzip sonarqube-8.3.1.34397.zip
</code></pre></td></tr></table>
</div>
</div><p>Modify the configuration <code>/data/sonarquebe-/sonarquebe-8.3.1.34397/conf/sonar.properties</code> to add the following properties:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">sonar.jdbc.username=sonar
sonar.jdbc.password=sonar
sonar.jdbc.url=jdbc:postgresql://localhost:5432/sonar
</code></pre></td></tr></table>
</div>
</div><p>After completing all the configuration, you can try to start the <code>SonarQube</code> service from the console:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">cd</span> /data/sonarqube/sonarqube-8.3.1.34397/bin/linux-x86-64
./sonar.sh console
</code></pre></td></tr></table>
</div>
</div><p>If it starts normally, the logs are as follows:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/6b7ac9d3e8944d4ab7565c87b74c715e.png" alt=" "></p>
<p>Then <code>Ctrl C</code> to exit the console and use <code>. /sonar.sh start</code> to start the <code>SonarQube</code> service in the background</p>
<h4 id="the-problems-that-may-be-encountered-are-categorized-here">The problems that may be encountered are categorized here</h4>
<ul>
<li>The root user cannot start because <code>ElasticSearch</code> does not allow the <code>root</code> user to start, so a new normal user can be created.</li>
<li>Some folders are not accessible, usually because the new normal user has not been assigned write access to the directory where <code>SonarQube</code> is located.</li>
<li>The limit on the number of file descriptors or threads is usually caused by not changing <code>vm.max_map_count</code>, <code>fs.file-max</code>, <code>ulimit -n</code> and <code>ulimit -u</code> parameters.</li>
</ul>
<h2 id="sonarqube-use">SonarQube use</h2>
<blockquote>
<p>The initialized account password for <code>SonarQube</code> administrators are <code>admin</code>. If you need to change the password or assign users with different privileges, you can do it in the menu bar of the administrator.</p>
</blockquote>
<p>Visit <code>http://192.168.56.200:9000</code> to enter <code>WebUI</code> of <code>SonarQube</code>, you can first go to the plug-in market to install a Chinese plug-in <code>Chinese Pack</code>, and restart the service after the plug-in installation is finished to realize the Chineseization.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/5e269fdc7ad0424faa20d755d8f150ab.png" alt=" "></p>
<p><code>SonarQube</code> provides different types of <code>SonarScanner</code> for code scanning and result submission, here is <code>Maven</code> as an example. The <code>settings.xml</code> of <code>Maven</code> needs to introduce the following configuration (note that the parent tag already exists, adding the parent tag repeatedly will cause an exception).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;settings&gt;</span>
    <span class="nt">&lt;pluginGroups&gt;</span>
        <span class="nt">&lt;pluginGroup&gt;</span>org.sonarsource.scanner.maven<span class="nt">&lt;/pluginGroup&gt;</span>
    <span class="nt">&lt;/pluginGroups&gt;</span>
    <span class="nt">&lt;profiles&gt;</span>
        <span class="nt">&lt;profile&gt;</span>
            <span class="nt">&lt;id&gt;</span>sonar<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;activation&gt;</span>
                <span class="nt">&lt;activeByDefault&gt;</span>true<span class="nt">&lt;/activeByDefault&gt;</span>
            <span class="nt">&lt;/activation&gt;</span>
            <span class="nt">&lt;properties&gt;</span>
                <span class="c">&lt;!-- Optional URL to server. Default value is http://localhost:9000 --&gt;</span>
                <span class="nt">&lt;sonar.host.url&gt;</span>
                  <span class="c">&lt;!-- This location needs to be replaced with the `SonarQube` service address, for examplehttp://192.168.56.200:9000 --&gt;</span>
                  http://myserver:9000
                <span class="nt">&lt;/sonar.host.url&gt;</span>
            <span class="nt">&lt;/properties&gt;</span>
        <span class="nt">&lt;/profile&gt;</span>
     <span class="nt">&lt;/profiles&gt;</span>
<span class="nt">&lt;/settings&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>Maven</code> plugin <code>sonar-maven-plugin</code> needs to be introduced in the project to be scanned, the current version is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.sonarsource.scanner.maven<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>sonar-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.7.0.1746<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>After completing the configuration, simply execute the command to scan in the project. The first execution will be slow because it requires downloading a large number of rulebases and plug-ins</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1"># Execute without specifying the plugin version</span>
mvn clean install
mvn sonar:sonar

<span class="c1"># Or specify the plugin version to execute</span>
mvn org.sonarsource.scanner.maven:sonar-maven-plugin:<span class="si">${</span><span class="nv">Version</span><span class="p"> number of the plugin</span><span class="si">}</span>:sonar
</code></pre></td></tr></table>
</div>
</div><p>In addition, the parameters of <code>SonarQube</code> can be specified via <code>&lt;properties&gt;</code> in the <code>pom</code> file, such as:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;properties&gt;</span>
   <span class="nt">&lt;sonar.host.url&gt;</span>[...]<span class="nt">&lt;/sonar.host.url&gt;</span>
   <span class="nt">&lt;ssonar.projectKey&gt;</span>[...]<span class="nt">&lt;/sonar.projectKey&gt;</span>
   <span class="nt">&lt;sonar.projectName&gt;</span>[...]<span class="nt">&lt;/sonar.projectName&gt;</span>
   <span class="nt">&lt;sonar.projectVersion&gt;</span>[...]<span class="nt">&lt;/sonar.projectVersion&gt;</span>
   <span class="nt">&lt;sonar.login&gt;</span>[...]<span class="nt">&lt;/sonar.login&gt;</span>
   <span class="nt">&lt;sonar.password&gt;</span>[...]<span class="nt">&lt;/sonar.password&gt;</span>
   <span class="nt">&lt;sonar.sourceEncoding&gt;</span>[...]<span class="nt">&lt;/sonar.sourceEncoding&gt;</span>
   ......
<span class="nt">&lt;/properties&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>After the project scan results are submitted, you can see the project list at <code>http://192.168.56.200:9000/projects</code>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/8ad3f0e783d64f1ca6c4e1e3f05a09ec.png" alt=" "></p>
<p>Detailed reports and statistics from the project scan can be seen by clicking in.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/27/df5ae9b1b7654ab8b227b74b3b4c295d.png" alt=" "></p>
<h2 id="summary">Summary</h2>
<p>Quality management is an important part of <code>DevOps</code>, <code>SonarQube</code> is a very good open platform for code quality management, I previously migrated services to cloud services, the pipeline configuration on the cloud can be introduced into the <code>SonarQube</code> service through the form of plug-ins, which has played a low-cost and high-yield effect.</p>
<h2 id="reference">Reference</h2>
<ul>
<li><a href="https://docs.sonarqube.org/latest/">https://docs.sonarqube.org/latest/</a></li>
<li><a href="https://www.postgresql.org/download/linux/redhat">https://www.postgresql.org/download/linux/redhat</a></li>
</ul>
<hr>
<p>Reference <code>https://www.throwx.cn/2020/05/17/sonarqube-install-guide/</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/sonarqube/">sonarqube</a>
          <a href="/tags/centos/">centos</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-06/the-underlying-implementation-of-annotations-in-the-jdk/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">The Underlying Implementation of Annotations in the Jdk</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-06/about-service-worker-and-pwa/">
            <span class="next-text nav-default">About Service Worker and Pwa</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
