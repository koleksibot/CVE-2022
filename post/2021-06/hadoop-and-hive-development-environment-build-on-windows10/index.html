<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Hadoop and Hive Development Environment Build on Windows10 - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="There are numerous problems with the installation and operation of components such as Hadoop and Hive on Windows systems
With the help of several Internet references, I completed the construction of Hadoop and Hive development environment on Windows 10. This article documents the specific steps, problems encountered, and corresponding solutions for the entire build process.
Environmental Preparation    Software Version Description     Windows 10 Operating System   JDK 8 Do not use a version greater than or equal to JDK9 for the time being, because unknown exceptions will occur when starting the virtual machine   MySQL 8." /><meta name="keywords" content="hadoop,hive,windows10" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-06/hadoop-and-hive-development-environment-build-on-windows10/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Hadoop and Hive Development Environment Build on Windows10" />
<meta property="og:description" content="There are numerous problems with the installation and operation of components such as Hadoop and Hive on Windows systems
With the help of several Internet references, I completed the construction of Hadoop and Hive development environment on Windows 10. This article documents the specific steps, problems encountered, and corresponding solutions for the entire build process.
Environmental Preparation    Software Version Description     Windows 10 Operating System   JDK 8 Do not use a version greater than or equal to JDK9 for the time being, because unknown exceptions will occur when starting the virtual machine   MySQL 8." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-06/hadoop-and-hive-development-environment-build-on-windows10/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-17T10:49:21+08:00" />
<meta property="article:modified_time" content="2021-06-17T10:49:21+08:00" />

<meta itemprop="name" content="Hadoop and Hive Development Environment Build on Windows10">
<meta itemprop="description" content="There are numerous problems with the installation and operation of components such as Hadoop and Hive on Windows systems
With the help of several Internet references, I completed the construction of Hadoop and Hive development environment on Windows 10. This article documents the specific steps, problems encountered, and corresponding solutions for the entire build process.
Environmental Preparation    Software Version Description     Windows 10 Operating System   JDK 8 Do not use a version greater than or equal to JDK9 for the time being, because unknown exceptions will occur when starting the virtual machine   MySQL 8."><meta itemprop="datePublished" content="2021-06-17T10:49:21+08:00" />
<meta itemprop="dateModified" content="2021-06-17T10:49:21+08:00" />
<meta itemprop="wordCount" content="2366">
<meta itemprop="keywords" content="hadoop,hive," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hadoop and Hive Development Environment Build on Windows10"/>
<meta name="twitter:description" content="There are numerous problems with the installation and operation of components such as Hadoop and Hive on Windows systems
With the help of several Internet references, I completed the construction of Hadoop and Hive development environment on Windows 10. This article documents the specific steps, problems encountered, and corresponding solutions for the entire build process.
Environmental Preparation    Software Version Description     Windows 10 Operating System   JDK 8 Do not use a version greater than or equal to JDK9 for the time being, because unknown exceptions will occur when starting the virtual machine   MySQL 8."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Hadoop and Hive Development Environment Build on Windows10</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-06-17 10:49:21 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/big-data/"> big-data </a>
            </div>
          <span class="more-meta"> 2366 words </span>
          <span class="more-meta"> 12 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#environmental-preparation">Environmental Preparation</a></li>
        <li><a href="#configuring-and-starting-hadoop">Configuring and starting Hadoop</a></li>
        <li><a href="#configuring-and-starting-hive">Configuring and starting Hive</a></li>
        <li><a href="#connecting-to-hive-using-jdbc">Connecting to Hive using JDBC</a></li>
        <li><a href="#possible-problems-encountered">Possible problems encountered</a>
          <ul>
            <li><a href="#java-virtual-machine-startup-failure">Java virtual machine startup failure</a></li>
            <li><a href="#hadoop-execution-file-not-found-exception">Hadoop execution file not found exception</a></li>
            <li><a href="#unable-to-access-localhost50070">Unable to access localhost:50070</a></li>
            <li><a href="#hive-connection-to-mysql-exception">Hive connection to MySQL exception</a></li>
            <li><a href="#hive-cant-find-the-batch-file">Hive can&rsquo;t find the batch file</a></li>
            <li><a href="#folder-permission-issues">Folder permission issues</a></li>
            <li><a href="#sessionnotrunning-exception"><code>SessionNotRunning</code> exception</a></li>
            <li><a href="#hiveserver2-port-conflict">HiveServer2 port conflict</a></li>
            <li><a href="#data-node-security-mode-exception">Data node security mode exception</a></li>
            <li><a href="#authorizationexception">AuthorizationException</a></li>
            <li><a href="#mapredtasks-permissions-problem">MapRedTask&rsquo;s Permissions Problem</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>There are numerous problems with the installation and operation of components such as Hadoop and Hive on Windows systems</p>
<p>With the help of several Internet references, I completed the construction of Hadoop and Hive development environment on Windows 10. This article documents the specific steps, problems encountered, and corresponding solutions for the entire build process.</p>
<h2 id="environmental-preparation">Environmental Preparation</h2>
<table>
<thead>
<tr>
<th>Software</th>
<th>Version</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows</td>
<td>10</td>
<td>Operating System</td>
</tr>
<tr>
<td>JDK</td>
<td>8</td>
<td>Do not use a version greater than or equal to JDK9 for the time being, because unknown exceptions will occur when starting the virtual machine</td>
</tr>
<tr>
<td>MySQL</td>
<td>8.x</td>
<td>Metadata for managing <code>Hive</code></td>
</tr>
<tr>
<td>Apache Hadoop</td>
<td>3.3.0</td>
<td>-</td>
</tr>
<tr>
<td>Apache Hive</td>
<td>3.1.2</td>
<td>-</td>
</tr>
<tr>
<td>Apache Hive src</td>
<td>1.2.2</td>
<td>Because only the 1.x version of the Hive source code provides a .bat startup script, the ability to write their own scripts do not need to download this source code package</td>
</tr>
<tr>
<td>winutils</td>
<td>hadoop-3.3.0</td>
<td>Startup dependencies for Hadoop on Windows</td>
</tr>
</tbody>
</table>
<p>Some of the components are listed below with their corresponding download addresses:</p>
<ul>
<li>Apache Hadoop 3.3.0：<a href="https://mirror.bit.edu.cn/apache/hadoop/common/hadoop-3.3.0/hadoop-3.3.0.tar.gz">https://mirror.bit.edu.cn/apache/hadoop/common/hadoop-3.3.0/hadoop-3.3.0.tar.gz</a></li>
<li>Apache Hive 3.1.2：<a href="https://mirrors.bfsu.edu.cn/apache/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz">https://mirrors.bfsu.edu.cn/apache/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz</a></li>
<li>Apache Hive 1.2.2 src：<a href="https://mirrors.bfsu.edu.cn/apache/hive/hive-1.2.2/apache-hive-1.2.2-src.tar.gz">https://mirrors.bfsu.edu.cn/apache/hive/hive-1.2.2/apache-hive-1.2.2-src.tar.gz</a></li>
<li>winutils：<a href="https://github.com/kontext-tech/winutils">https://github.com/kontext-tech/winutils</a></li>
</ul>
<p>After downloading some of these software, MySQL is installed normally as a system service with system self-start. Unzip <code>hadoop-3.3.0.tar.gz</code>, <code>apache-hive-3.1.2-bin.tar.gz</code>, <code>apache-hive-1.2.2-src.tar.gz</code> and <code>winutils</code> to the specified directory</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/ea5081007df74685a6169fdbf4afcd82.png" alt="folder"></p>
<p>Next, copy the files in the bin directory of the unpacked source package <code>apache-hive-1.2.2-src.tar.gz</code> to the bin directory of `apache-hive-3.1.2-bin:.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/2736e7c621bc4ea99c726bf4bd0aedbe.png" alt="apache-hive-1.2.2-src.tar.gz"></p>
<p>Then copy the <code>hadoop.dll</code> and <code>winutils.exe</code> files from the <code>hadoop-3.3.0\bin</code> directory in <code>winutils</code> to the bin folder in the unpacked directory of <code>Hadoop</code>.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/43769c97fb214cfbb3dfa02d30ad6763.png" alt="Hadoop"></p>
<p>Finally, configure the <code>JAVA_HOME</code> and <code>HADOOP_HOME</code> environment variables, and add <code>%JAVA_HOME%\bin;</code> and <code>%HADOOP_HOME%\bin</code> to the <code>Path</code>:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/4a7b5833d852425fb4a8af4a509812f4.png" alt="environment variables"></p>
<p>Next, test it on the command line. If the above steps are OK, the console output will be as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/d697d442aeab4689abad88bd9d952cd5.png" alt="cmd"></p>
<h2 id="configuring-and-starting-hadoop">Configuring and starting Hadoop</h2>
<p>In the <code>etc\hadoop</code> subdirectory of <code>HADOOP_HOME</code>, find and modify the following configuration files.</p>
<p><strong>core-site.xml</strong> (the tmp directory here must be configured as a non-virtual directory, don&rsquo;t use the default <code>tmp</code> directory, otherwise you will encounter permission assignment failure problems later)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>fs.defaultFS<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>hdfs://localhost:9000<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>  
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>hadoop.tmp.dir<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>/e:/LittleData/hadoop-3.3.0/data/tmp<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>  
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>hdfs-site.xml</strong> (here to pre-create <code>nameNode</code> and <code>dataNode</code> data storage directory, note that each directory should start with <code>/</code>, I pre-create <code>nameNode</code> and <code>dataNode</code> subdirectories in <code>HADOOP_HOME/data</code> here)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>dfs.replication<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>dfs.http.address<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>0.0.0.0:50070<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property&gt;</span>    
        <span class="nt">&lt;name&gt;</span>dfs.namenode.name.dir<span class="nt">&lt;/name&gt;</span>    
        <span class="nt">&lt;value&gt;</span>/e:/LittleData/hadoop-3.3.0/data/nameNode<span class="nt">&lt;/value&gt;</span>    
    <span class="nt">&lt;/property&gt;</span>    
    <span class="nt">&lt;property&gt;</span>    
        <span class="nt">&lt;name&gt;</span>dfs.datanode.data.dir<span class="nt">&lt;/name&gt;</span>    
        <span class="nt">&lt;value&gt;</span>/e:/LittleData/hadoop-3.3.0/data/dataNode<span class="nt">&lt;/value&gt;</span>  
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>dfs.permissions.enabled<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>false<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>mapred-site.xml</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>mapreduce.framework.name<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>yarn<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>yarn-site.xml</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>yarn.nodemanager.aux-services<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>mapreduce_shuffle<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
    <span class="nt">&lt;property&gt;</span>
        <span class="nt">&lt;name&gt;</span>yarn.nodemanager.aux-services.mapreduce.shuffle.class<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;value&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class="nt">&lt;/value&gt;</span>
    <span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>At this point, the minimalist configuration is basically complete. Then you need to format the <code>namenode</code> and start the <code>Hadoop</code> service. Switch to the <code>$HADOOP_HOME/bin</code> directory, use CMD to enter the command <code>hdfs namenode -format</code> (format <code>namenode</code> remember not to repeat the execution).</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/58f7d2a6e09647bea7ec576f93e1eb1a.png" alt="-"></p>
<p>After formatting <code>namenode</code>, switch to the <code>$HADOOP_HOME/sbin</code> directory and execute the start-all.cmd script.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/1d2307fb07d14e9ab8d512849f3dabd1.png" alt="-"></p>
<p>Here the command line will prompt <code>start-all.cmd</code> script has expired, it is recommended to use <code>start-dfs.cmd</code> and <code>start-yarn.cmd</code> instead. Similarly, if the execution of <code>stop-all.cmd</code> will also have a similar prompt, you can use <code>stop-dfs.cmd</code> and <code>stop-yarn.cmd</code> instead. After the successful execution of <code>start-all.cmd</code>, four JVM instances will be created (see the above figure in the Shell window automatically created four new Tabs), at this time you can view the current JVM instances through jps.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd">λ jps
19408 ResourceManager
16324 NodeManager
14792 Jps
15004 NameNode
2252 DataNode
</code></pre></td></tr></table>
</div>
</div><p>You can see that four applications <code>ResourceManager</code>, <code>NodeManager</code>, <code>NameNode</code> and <code>DataNode</code> have been started, so that the standalone version of <code>Hadoop</code> has been started successfully. Exit these four processes with the <code>stop-all.cmd</code> command. You can check the status of the scheduling tasks via <code>http://localhost:8088/</code>:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/4c5a1576fe0c4e1d9574597a3a28a2fb.png" alt="hadoop"></p>
<p>Go through <code>http://localhost:50070/</code> to see the status of <code>HDFS</code> and the files.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/ebb9d6e44c8a42b18d8cd055e5185654.png" alt="HDFS"></p>
<p>To restart Hadoop: execute the stop-all.cmd script first, then the start-all.cmd script.</p>
<h2 id="configuring-and-starting-hive">Configuring and starting Hive</h2>
<p>Hive is built on HDFS, so make sure Hadoop is up and running; the default file path for Hive in HDFS is prefixed with /user/hive/warehouse, so you can create this folder in HDFS from the command line first</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd">hdfs dfs -mkdir /user/hive/warehouse
hdfs dfs -chmod -R 777 /user/hive/warehouse
</code></pre></td></tr></table>
</div>
</div><p>You also need to create and grant permissions to the tmp directory with the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd">hdfs dfs -mkdir /tmp
hdfs dfs -chmod -R 777 /tmp
</code></pre></td></tr></table>
</div>
</div><p>Add <code>HIVE_HOME</code> to the system variables, configure the specific value as <code>E:\LittleData\apache-hive-3.1.2-bin</code>, and add <code>%HIVE_HOME%\bin;</code> to the Path variable, similar to the previous configuration of <code>HADOOP_HOME</code>. Download and copy a <code>mysql-connector-java-8.0.x.jar</code> to the `$HIVE_HOME/lib directory.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/919db0a37d5f4f94a28baf2b42a194c3.png" alt="mysql-connector-java-8.0.x.jar"></p>
<p>To create the Hive configuration file, there is already a corresponding configuration file template in the $HIVE_HOME/conf directory, which needs to be copied and renamed as follows:</p>
<ul>
<li>$HIVE_HOME/conf/hive-default.xml.template =&gt; $HIVE_HOME/conf/hive-site.xml</li>
<li>$HIVE_HOME/conf/hive-env.sh.template =&gt; $HIVE_HOME/conf/hive-env.sh</li>
<li>$HIVE_HOME/conf/hive-exec-log4j.properties.template =&gt; - $HIVE_HOME/conf/hive-exec-log4j.properties</li>
<li>$HIVE_HOME/conf/hive-log4j.properties.template =&gt; $HIVE_HOME/conf/hive-log4j.properties</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/7bd77908269f4cc18ecb08f931903d3c.png" alt="properties"></p>
<p>Modify the hive-env.sh script by adding the following to the end.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nb">export</span> <span class="nv">HADOOP_HOME</span><span class="o">=</span>E:<span class="se">\L</span>ittleData<span class="se">\h</span>adoop-3.3.0
<span class="nb">export</span> <span class="nv">HIVE_CONF_DIR</span><span class="o">=</span>E:<span class="se">\L</span>ittleData<span class="se">\a</span>pache-hive-3.1.2-bin<span class="se">\c</span>onf
<span class="nb">export</span> <span class="nv">HIVE_AUX_JARS_PATH</span><span class="o">=</span>E:<span class="se">\L</span>ittleData<span class="se">\a</span>pache-hive-3.1.2-bin<span class="se">\l</span>ib
</code></pre></td></tr></table>
</div>
</div><p>Modify the hive-site.xml file, mainly by changing the following property items.</p>
<table>
<thead>
<tr>
<th>Property Name</th>
<th>Property Value</th>
<th>Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>hive.metastore.warehouse.dir</code></td>
<td><code>/user/hive/warehouse</code></td>
<td>The data storage directory for <code>Hive</code>, which is the default value</td>
</tr>
<tr>
<td><code>hive.exec.scratchdir</code></td>
<td><code>/tmp/hive</code></td>
<td>The temporary data directory for <code>Hive</code>, which is the default value</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionURL</code></td>
<td><code>jdbc:mysql://localhost:3306/hive?characterEncoding=UTF-8&amp;amp;serverTimezone=UTC</code></td>
<td><code>Hive</code> database connection for metadata storage</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionDriverName</code></td>
<td><code>com.mysql.cj.jdbc.Driver</code></td>
<td>Database driver for <code>Hive</code> metadata storage</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionUserName</code></td>
<td><code>root</code></td>
<td><code>Hive</code> database user for metadata storage</td>
</tr>
<tr>
<td><code>javax.jdo.option.ConnectionPassword</code></td>
<td><code>root</code></td>
<td>Password of the database where <code>Hive</code> metadata is stored</td>
</tr>
<tr>
<td><code>hive.exec.local.scratchdir</code></td>
<td><code>E:/LittleData/apache-hive-3.1.2-bin/data/scratchDir</code></td>
<td>Create local directory <code>$HIVE_HOME/data/scratchDir</code></td>
</tr>
<tr>
<td><code>hive.downloaded.resources.dir</code></td>
<td><code>E:/LittleData/apache-hive-3.1.2-bin/data/resourcesDir</code></td>
<td>Create local directory <code>$HIVE_HOME/data/resourcesDir</code></td>
</tr>
<tr>
<td><code>hive.querylog.location</code></td>
<td><code>E:/LittleData/apache-hive-3.1.2-bin/data/querylogDir</code></td>
<td>Create local directory <code>$HIVE_HOME/data/querylogDir</code></td>
</tr>
<tr>
<td><code>hive.server2.logging.operation.log.location</code></td>
<td><code>E:/LittleData/apache-hive-3.1.2-bin/data/operationDir</code></td>
<td>Create local directory <code>$HIVE_HOME/data/operationDir</code></td>
</tr>
<tr>
<td><code>datanucleus.autoCreateSchema</code></td>
<td><code>true</code></td>
<td>Optional</td>
</tr>
<tr>
<td><code>datanucleus.autoCreateTables</code></td>
<td><code>true</code></td>
<td>Optional</td>
</tr>
<tr>
<td><code>datanucleus.autoCreateColumns</code></td>
<td><code>true</code></td>
<td>Optional</td>
</tr>
<tr>
<td><code>hive.metastore.schema.verification</code></td>
<td><code>false</code></td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p>After the modification, the local MySQL service to create a new database hive, encoding and character set can choose a relatively large range of utf8mb4 (although the official recommendation is latin1, but the character set to a wide range of options have no impact):</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/b7af62d1e89945a5a9895b6ad0055701.png" alt="database"></p>
<p>After the above preparations are done, you can perform the initialization of the Hive metadatabase by executing the following script in the $HIVE_HOME/bin directory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">hive --service schematool -dbType mysql -initSchema
</code></pre></td></tr></table>
</div>
</div><p>Here&rsquo;s a little problem, line 3215 of the hive-site.xml file has a magic unrecognizable symbol</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/a17f624838f74dbb9c8d501878366a74.png" alt="-"></p>
<p>This unrecognizable symbol will cause Hive&rsquo;s command execution exceptions and needs to be removed. When the console outputs <code>Initialization script completed schemaTool completed</code>, it means that the metadatabase has been initialized.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/15aa618913424172b46c3367dec121ac.png" alt="-"></p>
<p>In the $HIVE_HOME/bin directory, you can connect to Hive via hive.cmd (close the console to exit)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd"><span class="p">&gt;</span> hive.cmd
</code></pre></td></tr></table>
</div>
</div><p>Try to create a table <code>t_test</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd">hive<span class="p">&gt;</span>  create table t_test(id INT,name string);
hive<span class="p">&gt;</span>  show tables;
</code></pre></td></tr></table>
</div>
</div><p>Check <code>http://localhost:50070/</code> to confirm that the <code>t_test</code> table has been created successfully.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/0b1ef0c8035e4dd39d5e30e7e4b69da4.png" alt="-"></p>
<p>Try to execute a write statement and a query statement.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd">hive<span class="p">&gt;</span>  insert into t_test(id,name) values(1,&#39;throwx&#39;);
hive<span class="p">&gt;</span>  select * from t_test;
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/bf1c90d75b63490e8848ace30f06411d.png" alt="-"></p>
<p>It took more than 30 seconds to write and 0.165 seconds to read.</p>
<h2 id="connecting-to-hive-using-jdbc">Connecting to Hive using JDBC</h2>
<p><code>HiveServer2</code> is the <code>Hive</code> server-side interface module, which must be started for remote clients to write and query data to <code>Hive</code>. Currently, this module is still based on <code>Thrift RPC</code> implementation, which is an improved version of <code>HiveServer</code>, supporting multi-client access and authentication and other functions. The following common properties of <code>HiveServer2</code> can be modified in the configuration file <code>hive-site.xml</code></p>
<table>
<thead>
<tr>
<th>Property Name</th>
<th>Property Value</th>
<th>Remark</th>
</tr>
</thead>
<tbody>
<tr>
<td>hive.server2.thrift.min.worker.threads</td>
<td>5</td>
<td>Minimum number of threads to work with, default value is 5</td>
</tr>
<tr>
<td>hive.server2.thrift.max.worker.threads</td>
<td>500</td>
<td>Maximum number of working threads, default value is 500</td>
</tr>
<tr>
<td>hive.server2.thrift.port</td>
<td>10000</td>
<td>The TCP port number to listen on, the default value is 10000</td>
</tr>
<tr>
<td>hive.server2.thrift.bind.host</td>
<td>127.0.0.1</td>
<td>Bound host, the default value is 127.0.0.1</td>
</tr>
<tr>
<td>hive.execution.engine</td>
<td>mr</td>
<td>Execution engine, default value is mr</td>
</tr>
</tbody>
</table>
<p>Execute the following command in the $HIVE_HOME/bin directory to start HiveServer2</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cmd" data-lang="cmd">hive.cmd --service hiveserver2
</code></pre></td></tr></table>
</div>
</div><p>The client needs to introduce <code>hadoop-common</code> and <code>hive-jdbc</code> dependencies, and try to correspond to the <code>Hadoop</code> and <code>Hive</code> versions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.hadoop<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>hadoop-common<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.3.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.apache.hive<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>hive-jdbc<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>3.1.2<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-jdbc<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>2.3.5.RELEASE<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>hadoop-common</code> dependency chain is quite long and will download a lot of other related dependencies along with it, so you can find some free time to hang the task of downloading that dependency in some Maven project first. Finally add a unit test class <code>HiveJdbcTest</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Slf4j</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HiveJdbcTest</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="n">JdbcTemplate</span> <span class="n">TEMPLATE</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">HikariDataSource</span> <span class="n">DS</span><span class="o">;</span>

    <span class="nd">@BeforeClass</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">beforeClass</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">HikariConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HikariConfig</span><span class="o">();</span>
        <span class="n">config</span><span class="o">.</span><span class="na">setDriverClassName</span><span class="o">(</span><span class="s">&#34;org.apache.hive.jdbc.HiveDriver&#34;</span><span class="o">);</span>
        <span class="c1">// I modified the corresponding configuration in hive-site.xml, because the port is not the default 10000
</span><span class="c1">//        config.setJdbcUrl(&#34;jdbc:hive2://127.0.0.1:10091&#34;);
</span><span class="c1"></span>        <span class="n">config</span><span class="o">.</span><span class="na">setJdbcUrl</span><span class="o">(</span><span class="s">&#34;jdbc:hive2://127.0.0.1:10091/db_test&#34;</span><span class="o">);</span>
        <span class="n">DS</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HikariDataSource</span><span class="o">(</span><span class="n">config</span><span class="o">);</span>
        <span class="n">TEMPLATE</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JdbcTemplate</span><span class="o">(</span><span class="n">DS</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@AfterClass</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">afterClass</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">DS</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCreateDb</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">TEMPLATE</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">&#34;CREATE DATABASE db_test&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCreateTable</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">TEMPLATE</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="s">&#34;CREATE TABLE IF NOT EXISTS t_student(id INT,name string,major string)&#34;</span><span class="o">);</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Create t_student table successfully&#34;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testInsert</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">update</span> <span class="o">=</span> <span class="n">TEMPLATE</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="s">&#34;INSERT INTO TABLE t_student(id,name,major) VALUES(?,?,?)&#34;</span><span class="o">,</span> <span class="n">p</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">p</span><span class="o">.</span><span class="na">setInt</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">10087</span><span class="o">);</span>
            <span class="n">p</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">2</span><span class="o">,</span> <span class="s">&#34;throwable&#34;</span><span class="o">);</span>
            <span class="n">p</span><span class="o">.</span><span class="na">setString</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="s">&#34;math&#34;</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;Write to t_student successfully, update the number of records:{}&#34;</span><span class="o">,</span> <span class="n">update</span><span class="o">);</span>  <span class="c1">// Here is more amazing, the data is written, the number of update returned is 0
</span><span class="c1"></span>    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSelect</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="n">TEMPLATE</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="s">&#34;SELECT * FROM t_student&#34;</span><span class="o">,</span> <span class="n">rs</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
            <span class="k">while</span> <span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">next</span><span class="o">())</span> <span class="o">{</span>
                <span class="n">Student</span> <span class="n">student</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
                <span class="n">student</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getLong</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">));</span>
                <span class="n">student</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">));</span>
                <span class="n">student</span><span class="o">.</span><span class="na">setMajor</span><span class="o">(</span><span class="n">rs</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">&#34;major&#34;</span><span class="o">));</span>
                <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">student</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
        <span class="o">});</span>
        <span class="c1">// Print log: query t_student successful, results:[HiveJdbcTest.Student(id=10087, name=throwable, major=math)]
</span><span class="c1"></span>        <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;The query of t_student is successful, the result:{}&#34;</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Data</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="o">{</span>

        <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
        <span class="kd">private</span> <span class="n">String</span> <span class="n">major</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="possible-problems-encountered">Possible problems encountered</h2>
<h3 id="java-virtual-machine-startup-failure">Java virtual machine startup failure</h3>
<p>Currently positioned to be Hadoop can not use any version of JDK [9 + JDK, it is recommended to switch to any small version of JDK8.</p>
<h3 id="hadoop-execution-file-not-found-exception">Hadoop execution file not found exception</h3>
<p>Make sure you have copied the <code>hadoop.dll</code> and <code>winutils.exe</code> files from the <code>hadoop-3.3.0\bin</code> directory in <code>winutils</code> to the bin folder of the unpacked directory of Hadoop.</p>
<p>When executing the <code>start-all.cmd</code> script, there is a possibility that the batch script cannot be found. This problem has occurred on the company&rsquo;s development machine, but has not been reproduced on the home development machine. The specific solution is to add cd $HADOOP_HOME to the first line of the start-all.cmd script, such as <code>cd E:\LittleData\hadoop-3.3.0</code>.</p>
<h3 id="unable-to-access-localhost50070">Unable to access localhost:50070</h3>
<p>Generally because the hdfs-site.xml configuration misses the dfs.http.address configuration item, add.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>dfs.http.address<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>0.0.0.0:50070<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Then just call stop-all.cmd and then call start-all.cmd to restart Hadoop.</p>
<h3 id="hive-connection-to-mysql-exception">Hive connection to MySQL exception</h3>
<p>Note whether the MySQL driver package has been copied correctly to <code>$HIVE_HOME/lib</code> and check whether the four properties <code>javax.jdo.option.ConnectionURL</code> and so on are configured correctly. If they are all correct, pay attention to whether there is a problem with the MySQL version or the service version does not match the driver version.</p>
<h3 id="hive-cant-find-the-batch-file">Hive can&rsquo;t find the batch file</h3>
<p>The general description is <code>xxx.cmd' is not recognized as an internal or external command...</code> , which is usually an exception in Hive&rsquo;s command execution, you need to copy all the .cmd scripts in the bin directory of the Hive 1.x source package to the corresponding directory of <code>$HIVE_HOME/bin</code>.</p>
<h3 id="folder-permission-issues">Folder permission issues</h3>
<p>Common exceptions such as <code>CreateSymbolicLink</code> can cause Hive to be unable to write data using INSERT or LOAD commands. Such problems can be solved by the following.</p>
<p>Win + R and run gpedit.msc - Computer Settings - Windows Settings - Security Settings - Local Policies - User Rights Assignment - Create Symbolic Link - Add Current User.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/d5d20b14e5fc43b4b1906d621b500e88.png" alt="-"></p>
<p>Or just start CMD with administrator account or administrator privileges, and then execute the corresponding script to start Hadoop or Hive.</p>
<h3 id="sessionnotrunning-exception"><code>SessionNotRunning</code> exception</h3>
<p>This exception may occur when starting HiveServer2 or when an external client connects to HiveServer2, specifically <code>java.lang.ClassNotFoundException: org.apache.tez.dag.api.TezConfiguration</code> exception. The solution is: the configuration file hive-site.xml in the hive.execution.engine property value from tez to mr, and then restart HiveServer2 can be. Because there is no tez integration, the restart will still report an error, but after 60000ms it will automatically retry to start (usually after the retry will start successfully):</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/17/c99ffef092cd4bd78a013af5001f6b2d.png" alt="-"></p>
<p>This is a legacy issue, but it does not affect the client&rsquo;s normal connection, only the startup time will be 60 seconds longer.</p>
<h3 id="hiveserver2-port-conflict">HiveServer2 port conflict</h3>
<p>Modify the value of the hive.server2.thrift.port property in the configuration file hive-site.xml to an unoccupied port, and restart HiveServer2.</p>
<h3 id="data-node-security-mode-exception">Data node security mode exception</h3>
<p>Generally <code>SafeModeException</code> exceptions appear, prompting <code>Safe mode is ON</code>. Through the command <code>hdfs dfsadmin -safemode leave</code> to remove the safe mode.</p>
<h3 id="authorizationexception">AuthorizationException</h3>
<p>It is common for this exception to occur when Hive connects to the HiveServer2 service via the JDBC client, specifically the message: `User: xxx is not allowed to impersonate anonymous. this case just needs to modify the Hadoop configuration file core-site. xml, add.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>hadoop.proxyuser.xxx.hosts<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>*<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
<span class="nt">&lt;property&gt;</span>
    <span class="nt">&lt;name&gt;</span>hadoop.proxyuser.xxx.groups<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;value&gt;</span>*<span class="nt">&lt;/value&gt;</span>
<span class="nt">&lt;/property&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Then just restart the Hadoop service.</p>
<h3 id="mapredtasks-permissions-problem">MapRedTask&rsquo;s Permissions Problem</h3>
<p>The common exception is thrown when Hive connects to the <code>HiveServer2</code> service via a JDBC client to perform an INSERT or LOAD operation, generally described as <code>Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec MapRedTask. Permission denied: user=anonymous, access=EXECUTE, inode=&quot;/tmp/hadoop-yarn&quot;:xxxx:supergroup:drwx------</code>. Just give the anonymous user /tmp directory read and write access through the command <code>hdfs dfs -chmod -R 777 /tmp</code>.</p>
<h2 id="summary">Summary</h2>
<p>It is better to build the development environment of Hadoop and Hive directly in Linux or Unix system. The file path and permission problems of Windows system can lead to many unexpected problems. This article refers to a large number of Internet materials and introductory books on Hadoop and Hive, so I won&rsquo;t post them here, standing on the shoulders of giants.</p>
<hr>
<p>Reference <code>https://www.throwx.cn/2020/11/03/hadoop-hive-dev-env-in-win-10/</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/hadoop/">hadoop</a>
          <a href="/tags/hive/">hive</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-06/rsync-usage-tutorial/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Rsync Usage Tutorial</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-06/several-ways-to-stop-goroutine-in-golang/">
            <span class="next-text nav-default">Several Ways to Stop Goroutine in Golang</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
