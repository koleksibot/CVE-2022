<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>React Code Sharing Best Practices Approach - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="When any project grows to a certain complexity, it is bound to face the problem of logic reuse. In React, there are several ways to implement logic reuse: Mixin, HOC, Decorator, Render Props, Hook, etc. This article mainly analyzes the advantages and disadvantages of these ways to help developers make a more suitable way for business scenarios. Mixin Mixin has been widely used in various object-oriented languages to create a" /><meta name="keywords" content="react,code-share,Mixin,HOC,Decorator,Render-Props,Hook" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-06/react-code-sharing-best-practices-approach/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="React Code Sharing Best Practices Approach" />
<meta property="og:description" content="When any project grows to a certain complexity, it is bound to face the problem of logic reuse. In React, there are several ways to implement logic reuse: Mixin, HOC, Decorator, Render Props, Hook, etc. This article mainly analyzes the advantages and disadvantages of these ways to help developers make a more suitable way for business scenarios. Mixin Mixin has been widely used in various object-oriented languages to create a" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-06/react-code-sharing-best-practices-approach/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-18T20:13:24+08:00" />
<meta property="article:modified_time" content="2021-06-18T20:13:24+08:00" />

<meta itemprop="name" content="React Code Sharing Best Practices Approach">
<meta itemprop="description" content="When any project grows to a certain complexity, it is bound to face the problem of logic reuse. In React, there are several ways to implement logic reuse: Mixin, HOC, Decorator, Render Props, Hook, etc. This article mainly analyzes the advantages and disadvantages of these ways to help developers make a more suitable way for business scenarios. Mixin Mixin has been widely used in various object-oriented languages to create a"><meta itemprop="datePublished" content="2021-06-18T20:13:24+08:00" />
<meta itemprop="dateModified" content="2021-06-18T20:13:24+08:00" />
<meta itemprop="wordCount" content="2910">
<meta itemprop="keywords" content="react," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="React Code Sharing Best Practices Approach"/>
<meta name="twitter:description" content="When any project grows to a certain complexity, it is bound to face the problem of logic reuse. In React, there are several ways to implement logic reuse: Mixin, HOC, Decorator, Render Props, Hook, etc. This article mainly analyzes the advantages and disadvantages of these ways to help developers make a more suitable way for business scenarios. Mixin Mixin has been widely used in various object-oriented languages to create a"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">React Code Sharing Best Practices Approach</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-06-18 20:13:24 </span>
        <div class="post-category">
            <a href="/categories/frontend/"> frontend </a>
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 2910 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#mixin">Mixin</a>
          <ul>
            <li><a href="#using-mixin-in-react">Using Mixin in React</a></li>
          </ul>
        </li>
        <li><a href="#higher-order-componentshoc">Higher-Order Components(HOC)</a>
          <ul>
            <li><a href="#conventions-for-using-hoc">Conventions for using HOC</a></li>
            <li><a href="#advantages-and-disadvantages-of-hoc">Advantages and disadvantages of HOC</a></li>
          </ul>
        </li>
        <li><a href="#render-props">Render Props</a>
          <ul>
            <li><a href="#render-props-usage-scenarios">Render Props usage scenarios</a></li>
            <li><a href="#render-props-usage-restrictions">render props usage restrictions</a></li>
            <li><a href="#pros-and-cons-of-render-props">Pros and cons of render props</a></li>
          </ul>
        </li>
        <li><a href="#hook">Hook</a>
          <ul>
            <li><a href="#hook-pros-and-cons">Hook Pros and Cons</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>When any project grows to a certain complexity, it is bound to face the problem of logic reuse. In React, there are several ways to implement logic reuse: <code>Mixin</code>, <code>HOC</code>, <code>Decorator</code>, <code>Render Props</code>, <code>Hook</code>, etc. This article mainly analyzes the advantages and disadvantages of these ways to help developers make a more suitable way for business scenarios.</p>
<h2 id="mixin">Mixin</h2>
<p>Mixin has been widely used in various object-oriented languages to create a multi-inheritance-like effect for single-inheritance languages, and is perhaps the first approach that developers moving from <code>Vue</code> to <code>React</code> can think of. Although React has now abandoned it, <code>Mixin</code> was indeed a design pattern that React used to implement code sharing.</p>
<p>The mixin method, in the broad sense, is a way to assign the methods in the mixin object to the original object to achieve object mixing, similar to the role of <code>Object.assign()</code> in ES6. The principle is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">mixin</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">mixins</span><span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">newObj</span> <span class="o">=</span> <span class="nx">obj</span>
  <span class="nx">newObj</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">)</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">prop</span> <span class="k">in</span> <span class="nx">mixins</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Iterate through mixins&#39; properties
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">mixins</span><span class="p">.</span><span class="nx">hasOwnPrototype</span><span class="p">(</span><span class="nx">prop</span><span class="p">))</span> <span class="p">{</span>
      <span class="c1">// Determine if it is the mixin&#39;s own property
</span><span class="c1"></span>      <span class="nx">newObj</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">prop</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mixins</span><span class="p">[</span><span class="nx">prop</span><span class="p">];</span> <span class="c1">// 
</span><span class="c1"></span>    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">newObj</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="using-mixin-in-react">Using Mixin in React</h3>
<p>Assuming that multiple components in our project need to set the default <code>name</code> property, using <code>mixin</code> allows us to not have to write multiple identical <code>getDefaultProps</code> methods in different components, we can define a <code>mixin</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">DefaultNameMixin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">getDefaultProps</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">name</span><span class="o">:</span> <span class="s2">&#34;Joy&#34;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>In order to use <code>mixin</code>, you need to add the <code>mixins</code> property to the component, and then wrap our written <code>mixin</code> into an array and use it as the value of the <code>mixins</code> property</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">ComponentOne</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">DefaultNameMixin</span><span class="p">]</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>The written mixin can be reused in other components.</p>
<p>Since the <code>mixins</code> property value is an array, it means that we can call multiple <code>mixin</code>s in the same component. A slight change in the above example gives us</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">DefaultFriendMixin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">getDefaultProps</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">friend</span><span class="o">:</span> <span class="s2">&#34;Yummy&#34;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">ComponentOne</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">DefaultNameMixin</span><span class="p">,</span> <span class="nx">DefaultFriendMixin</span><span class="p">]</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">my</span> <span class="nx">friend</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">friend</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

</code></pre></td></tr></table>
</div>
</div><p>We can even include other <code>mixin</code>s within a <code>mixin</code>.</p>
<p>For example, write a new <code>mixin</code> <code>DefaultProps</code> containing the above <code>DefaultNameMixin</code> and <code>DefaultFriendMixin</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">DefaultPropsMixin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">DefaultNameMixin</span><span class="p">,</span> <span class="nx">DefaultFriendMixin</span><span class="p">]</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">ComponentOne</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">DefaultPropsMixin</span><span class="p">]</span>
  <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
        <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">This</span> <span class="nx">is</span> <span class="nx">my</span> <span class="nx">friend</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">friend</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h2&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">})</span>

</code></pre></td></tr></table>
</div>
</div><p>At this point, we can conclude that mixin has at least the following advantages:</p>
<ul>
<li>The possibility of using the same mixin in multiple components.</li>
<li>The possibility of using multiple mixins in the same component.</li>
<li>Multiple mixins can be nested within the same mixin</li>
</ul>
<p>However, in different scenarios, advantages can become disadvantages.</p>
<ul>
<li>Breaking the encapsulation of the original component and possibly having to go and maintain new states such as <code>state</code> and <code>props</code>.</li>
<li>The naming in different <code>mixin</code>s is unpredictable and very prone to conflicts</li>
<li>May create recursive call problems, increasing project complexity and maintenance difficulties</li>
</ul>
<p>In addition, <code>mixin</code> has its own logic for handling issues such as state conflicts, method conflicts, and the calling order of multiple lifecycle methods. If you are interested, you can refer to the following articles:</p>
<ul>
<li><a href="http://simblestudios.com/blog/development/react-mixins-by-example.html">react-mixins-by-example</a></li>
<li><a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html">Mixins Considered Harmful</a></li>
</ul>
<h2 id="higher-order-componentshoc">Higher-Order Components(HOC)</h2>
<p>Since <code>mixin</code> has the above-mentioned shortcomings, <code>React</code> stripped <code>mixin</code> and replaced it with <code>HOC</code>.</p>
<p><code>HOC</code> is essentially a function that accepts a component as an argument and returns a new component.</p>
<p>React officially uses <code>HOC</code> when implementing some public components, such as <code>withRouter</code> in <code>react-router</code>, and <code>connect</code> in <code>Redux</code>. Here&rsquo;s an example of <code>withRouter</code>.</p>
<p>By default, the component must be rendered by <code>Route</code> route match before <code>this.props</code> exists, before it has route parameters, and before it can execute <code>this.props.history.push('/next')</code> to jump to the page corresponding to the route using the functional navigation writeup. The role of <code>withRouter</code> in <code>HOC</code> is to wrap a component that is not wrapped by <code>Route</code> route into <code>Route</code>, so that the three objects <code>history</code>, <code>location</code> and <code>match</code> of <code>react-router</code> can be put into the <code>props</code> property of the component, thus enabling functional navigation jumping.</p>
<p>The principle of <code>withRouter</code> implementation:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">withRouter</span> <span class="o">=</span> <span class="p">(</span><span class="nx">Component</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">displayName</span> <span class="o">=</span> <span class="sb">`withRouter(</span><span class="si">${</span><span class="nx">Component</span><span class="p">.</span><span class="nx">displayName</span> <span class="o">||</span> <span class="nx">Component</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">)`</span>
  <span class="kr">const</span> <span class="nx">C</span> <span class="o">=</span> <span class="nx">props</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span> <span class="nx">wrappedComponentRef</span><span class="p">,</span> <span class="p">...</span><span class="nx">remainingProps</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">RouterContext</span><span class="p">.</span><span class="nx">Consumer</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="nx">context</span> <span class="p">=&gt;</span> <span class="p">{</span>
          <span class="nx">invariant</span><span class="p">(</span>
            <span class="nx">context</span><span class="p">,</span>
            <span class="sb">`You should not use &lt;</span><span class="si">${</span><span class="nx">displayName</span><span class="si">}</span><span class="sb"> /&gt; outside a &lt;Router&gt;`</span>
          <span class="p">);</span>
          <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">Component</span>
              <span class="p">{...</span><span class="nx">remainingProps</span><span class="p">}</span>
              <span class="p">{...</span><span class="nx">context</span><span class="p">}</span>
              <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">wrappedComponentRef</span><span class="p">}</span>
            <span class="o">/&gt;</span>
          <span class="p">)</span>
        <span class="p">}}</span>
      <span class="o">&lt;</span><span class="err">/RouterContext.Consumer&gt;</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Use code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;react&#34;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">withRouter</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;react-router&#34;</span>
<span class="kr">class</span> <span class="nx">TopHeader</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="nx">导航栏</span>
        <span class="p">{</span><span class="cm">/* Click to jump to login */</span><span class="p">}</span>
        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">exit</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Exit</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>

  <span class="nx">exit</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// After the withRouter HOC wrapping, you can use this.props for jumping operations
</span><span class="c1"></span>    <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&#34;/login&#34;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// Use the withRouter wrapper component to return history, location, etc.
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">withRouter</span><span class="p">(</span><span class="nx">TopHeader</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Since <code>HOC</code> is essentially a method that gets a component and returns a new component, it can theoretically implement multiple nesting just like <code>mixin</code>.</p>
<p>For example:</p>
<p>Write a HOC that empowers singing</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">const</span> <span class="nx">widthSinging</span> <span class="o">=</span> <span class="nx">WrappedComponent</span> <span class="p">=&gt;</span> <span class="p">{</span>
	<span class="k">return</span> <span class="kr">class</span> <span class="nx">HOC</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
		<span class="nx">constructor</span> <span class="p">()</span> <span class="p">{</span>
			<span class="kr">super</span><span class="p">(...</span><span class="nx">arguments</span><span class="p">)</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">singing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">singing</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="nx">singing</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;i am singing!&#39;</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="o">/&gt;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Write a HOC that empowers dancing</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span>

<span class="kr">const</span> <span class="nx">widthDancing</span> <span class="o">=</span> <span class="nx">WrappedComponent</span> <span class="p">=&gt;</span> <span class="p">{</span>
	<span class="k">return</span> <span class="kr">class</span> <span class="nx">HOC</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
		<span class="nx">constructor</span> <span class="p">()</span> <span class="p">{</span>
			<span class="kr">super</span><span class="p">(...</span><span class="nx">arguments</span><span class="p">)</span>
			<span class="k">this</span><span class="p">.</span><span class="nx">dancing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dancing</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="nx">dancing</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
			<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;i am dancing!&#39;</span><span class="p">)</span>
		<span class="p">}</span>

		<span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedComponent</span> <span class="o">/&gt;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Use the above HOC</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;react&#34;</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">widthSing</span><span class="p">,</span> <span class="nx">widthDancing</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;hocs&#34;</span>

<span class="kr">class</span> <span class="nx">Joy</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="nx">Joy</span><span class="o">&lt;</span><span class="err">/div&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Empowering Joy&#39;s singing and dancing talents
</span><span class="c1"></span><span class="kr">export</span> <span class="k">default</span> <span class="nx">widthSinging</span><span class="p">(</span><span class="nx">withDancing</span><span class="p">(</span><span class="nx">Joy</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>As you can see above, with a simple wrap using HOC, you can turn the original simple Joy into a nightclub prince who can both sing and dance!</p>
<h3 id="conventions-for-using-hoc">Conventions for using HOC</h3>
<p>When using HOC, there are some inkling conventions:</p>
<ul>
<li>Passing irrelevant <code>Props</code> to wrapper components (passing <code>props</code> that are not related to their specific content).</li>
<li>step-by-step combination (avoiding different forms of <code>HOC</code> calls in tandem).</li>
<li>include display <code>displayName</code> for easy debugging (each <code>HOC</code> should conform to a regular display name).</li>
<li>do not use higher-order components in the <code>render</code> function (each time <code>render</code>, the higher order returns a new component, affecting <code>diff</code> performance).</li>
<li>static methods must be copied (the new component returned after a higher order does not contain the static methods of the original component).</li>
<li>Avoid using <code>ref</code> (<code>ref</code> will not be passed);</li>
</ul>
<h3 id="advantages-and-disadvantages-of-hoc">Advantages and disadvantages of HOC</h3>
<p>At this point we can summarize the advantages of the Higher Order Component (HOC):</p>
<ul>
<li>HOC is a pure function, easy to use and maintain.</li>
<li>Again, since HOC is a pure function, it supports the passing of multiple parameters, enhancing its scope of application.</li>
<li><code>HOC</code> returns a component, which can be combined and nested for flexibility.</li>
</ul>
<p>Of course there are some problems with HOC.</p>
<ul>
<li>When multiple <code>HOC</code>s are used in nesting, it is impossible to directly determine from which <code>HOC</code> the <code>props</code> of the child component is responsible for passing.</li>
<li>When parent and child components have the same name <code>props</code>, it leads to the problem that the parent component overwrites the child component with the same name <code>props</code>, and <code>react</code> does not report errors, which is low developer-awareness.</li>
<li>each <code>HOC</code> returns a new component, thus creating a lot of useless components, while deepening the component hierarchy and not making it easy to troubleshoot problems.</li>
</ul>
<p><code>Decorator</code> and <code>HOC</code> belong to the same schema and will not be discussed here.</p>
<h2 id="render-props">Render Props</h2>
<p>This is the official <code>React</code> definition of <code>Render Props</code></p>
<blockquote>
<p>The term “render prop” refers to a technique for sharing code between React components using a prop whose value is a function.</p>
</blockquote>
<p>Official example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JS" data-lang="JS"><span class="o">&lt;</span><span class="nx">DataProvider</span> <span class="nx">render</span><span class="o">=</span><span class="p">{(</span><span class="nx">data</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span> <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">target</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h1&gt;} /</span><span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>As above, the <code>DataProvider</code> component has a <code>props</code> property called <code>render</code> (it can also be called by other names), which is a function, and this function returns a <code>React Element</code> that is rendered inside the component by calling this function, then this component uses the <code>render props</code> technique.</p>
<p>Readers may wonder, &ldquo;Why do we need to call the <code>props</code> property to achieve internal rendering of the component instead of rendering directly inside the component&rdquo;? To borrow from the official <code>React</code> answer, <code>render props</code> is not a skill that every <code>React</code> developer needs to master, and you may never even use this method, but it does exist to provide developers with an additional option when thinking about component code sharing.</p>
<h3 id="render-props-usage-scenarios">Render Props usage scenarios</h3>
<p>We may need to use pop-up windows frequently in project development, pop-up windows <code>UI</code> can be varied, but the function is similar, that is, open and close. Take <code>antd</code> as an example</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Modal</span><span class="p">,</span> <span class="nx">Button</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;antd&#34;</span>
<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span> <span class="p">}</span>

  <span class="c1">// Control pop-up windows to show and hide
</span><span class="c1"></span>  <span class="nx">toggleModal</span> <span class="o">=</span> <span class="p">(</span><span class="nx">visible</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">visible</span> <span class="p">})</span>
  <span class="p">};</span>

  <span class="nx">handleOk</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Do something
</span><span class="c1"></span>    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span> <span class="p">})</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span> <span class="nx">visible</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">Button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggleModal</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kc">true</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">Open</span><span class="o">&lt;</span><span class="err">/Button&gt;</span>
        <span class="o">&lt;</span><span class="nx">Modal</span>
          <span class="nx">title</span><span class="o">=</span><span class="s2">&#34;Basic Modal&#34;</span>
          <span class="nx">visible</span><span class="o">=</span><span class="p">{</span><span class="nx">visible</span><span class="p">}</span>
          <span class="nx">onOk</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOk</span><span class="p">}</span>
          <span class="nx">onCancel</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggleModal</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kc">false</span><span class="p">)}</span>
        <span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Some</span> <span class="nx">contents</span><span class="p">...</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
        <span class="o">&lt;</span><span class="err">/Modal&gt;</span>
      <span class="o">&lt;</span><span class="err">/div&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>The above is the simplest example of using <code>Model</code>, even if it is simple to use, we still need to pay attention to its display state and implement its switching method. But the developer really only wants to focus on the business logic related to <code>onOk</code>, the ideal usage should be like this</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="o">&lt;</span><span class="nx">MyModal</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">Button</span><span class="o">&gt;</span><span class="nx">Open</span><span class="o">&lt;</span><span class="err">/Button&gt;</span>
  <span class="o">&lt;</span><span class="nx">Modal</span> <span class="nx">title</span><span class="o">=</span><span class="s2">&#34;Basic Modal&#34;</span> <span class="nx">onOk</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleOk</span><span class="p">}</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Some</span> <span class="nx">contents</span><span class="p">...</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
  <span class="o">&lt;</span><span class="err">/Modal&gt;</span>
<span class="o">&lt;</span><span class="err">/MyModal&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The above usage can be achieved by <code>render props</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">Modal</span><span class="p">,</span> <span class="nx">Button</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;antd&#34;</span>
<span class="kr">class</span> <span class="nx">MyModal</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">on</span><span class="o">:</span> <span class="kc">false</span> <span class="p">}</span>

  <span class="nx">toggle</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
      <span class="nx">on</span><span class="o">:</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">on</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="nx">renderButton</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="o">&lt;</span><span class="nx">Button</span> <span class="p">{...</span><span class="nx">props</span><span class="p">}</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggle</span><span class="p">}</span> <span class="o">/&gt;</span>

  <span class="nx">renderModal</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">onOK</span><span class="p">,</span> <span class="p">...</span><span class="nx">rest</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Modal</span>
      <span class="p">{...</span><span class="nx">rest</span><span class="p">}</span>
      <span class="nx">visible</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">on</span><span class="p">}</span>
      <span class="nx">onOk</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">onOK</span> <span class="o">&amp;&amp;</span> <span class="nx">onOK</span><span class="p">()</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">toggle</span><span class="p">()</span>
      <span class="p">}}</span>
      <span class="nx">onCancel</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggle</span><span class="p">}</span>
    <span class="o">/&gt;</span>
  <span class="p">)</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">({</span>
      <span class="nx">Button</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderButton</span><span class="p">,</span>
      <span class="nx">Modal</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">renderModal</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>This completes a <code>Modal</code> with state and basic functionality, and we only need to focus on specific business logic when we use the <code>Modal</code> in other pages.</p>
<p>As you can see above, <code>render props</code> is a real <code>React</code> component, not just a function that returns a component like <code>HOC</code>, which also means that using <code>render props</code> will not create the problem of nested components like <code>HOC</code>, and you don&rsquo;t have to worry about the override problem caused by <code>props</code> naming conflicts.</p>
<h3 id="render-props-usage-restrictions">render props usage restrictions</h3>
<p>The use of arrow functions in <code>render props</code> should be avoided because of the performance impact this can cause.</p>
<p>For example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Bad example
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">MouseTracker</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">Mouse</span> <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="nx">mouse</span> <span class="p">=&gt;</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">Cat</span> <span class="nx">mouse</span><span class="o">=</span><span class="p">{</span><span class="nx">mouse</span><span class="p">}</span> <span class="o">/&gt;</span>
      <span class="p">)}</span><span class="o">/&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>This is not a good way to write it, because the <code>render</code> method is possible to render multiple times, and using the arrow function will cause the value passed into <code>render</code> to be different each time it is rendered, while there is actually no difference, which will lead to performance problems.</p>
<p>So a better way to write it would be to define the function passed into <code>render</code> as an instance method, so that even though we render it multiple times, it is always the same function that is bound.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 好的示例
</span><span class="c1"></span><span class="kr">class</span> <span class="nx">MouseTracker</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">renderCat</span><span class="p">(</span><span class="nx">mouse</span><span class="p">)</span> <span class="p">{</span>
  	<span class="k">return</span> <span class="o">&lt;</span><span class="nx">Cat</span> <span class="nx">mouse</span><span class="o">=</span><span class="p">{</span><span class="nx">mouse</span><span class="p">}</span> <span class="o">/&gt;</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
		  <span class="o">&lt;</span><span class="nx">Mouse</span> <span class="nx">render</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderTheCat</span><span class="p">}</span> <span class="o">/&gt;</span>
    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="pros-and-cons-of-render-props">Pros and cons of render props</h3>
<p>Advantages</p>
<ul>
<li><code>props</code> naming is modifiable and does not override each other.</li>
<li>Clarity of <code>props</code> origin.</li>
<li>No multi-layer nesting of components.</li>
</ul>
<p>Disadvantages</p>
<ul>
<li>Cumbersome writing style.</li>
<li>inability to access data outside of the return statement.</li>
<li>prone to function callback nesting.</li>
</ul>
<p>The following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">MyComponent</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">Mouse</span><span class="o">&gt;</span>
      <span class="p">{({</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">Page</span><span class="o">&gt;</span>
          <span class="p">{({</span> <span class="nx">x</span><span class="o">:</span> <span class="nx">pageX</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="nx">pageY</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">Connection</span><span class="o">&gt;</span>
              <span class="p">{({</span> <span class="nx">api</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="c1">// yikes
</span><span class="c1"></span>              <span class="p">}}</span>
            <span class="o">&lt;</span><span class="err">/Connection&gt;</span>
          <span class="p">)}</span>
        <span class="o">&lt;</span><span class="err">/Page&gt;</span>
      <span class="p">)}</span>
    <span class="o">&lt;</span><span class="err">/Mouse&gt;</span>
  <span class="p">)</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="hook">Hook</h2>
<p>The core of <code>React</code> is components, so <code>React</code> has been working on optimizing and refining the way components are declared. From the earliest class components to function components, there are advantages and disadvantages to each. Class components provide us with a complete lifecycle and state, but they are clunky to write, while function components are very simple and lightweight, but they have the limitation that they must be pure functions, cannot contain state, and do not support lifecycle.</p>
<p>The <code>React</code> team felt that the best way to write components was as functions, not classes, which led to the creation of <code>React Hooks</code>.</p>
<p><code>React Hooks</code> is designed to be an enhanced version of the function component, a full-featured component written without using &ldquo;classes&rdquo; at all.</p>
<p>Why class components are &ldquo;bulky&rdquo;, to borrow from the official <code>React</code> example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;react&#34;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Button</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">()</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">buttonText</span><span class="o">:</span> <span class="s2">&#34;Click me, please&#34;</span> <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="nx">handleClick</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span> <span class="nx">buttonText</span><span class="o">:</span> <span class="s2">&#34;Thanks, been clicked!&#34;</span> <span class="p">}</span>
    <span class="p">})</span>
  <span class="p">}</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="p">{</span> <span class="nx">buttonText</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">buttonText</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The above is a simple button component that contains the most basic state and click methods, and the state changes when the button is clicked.</p>
<p>This is a very simple functional component, but it requires a lot of code to implement. Since function components don&rsquo;t contain state, we can&rsquo;t use a function component to declare a component with the above functionality. But we can use Hook to implement it:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span> <span class="p">}</span> <span class="nx">from</span> <span class="s2">&#34;react&#34;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="nx">Button</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">buttonText</span><span class="p">,</span> <span class="nx">setButtonText</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="s2">&#34;Click me,   please&#34;</span><span class="p">)</span>

  <span class="kd">function</span> <span class="nx">handleClick</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">setButtonText</span><span class="p">(</span><span class="s2">&#34;Thanks, been clicked!&#34;</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">buttonText</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>In comparison, <code>Hook</code> appears to be more lightweight and preserves its own state while staying close to the function component.</p>
<p>In addition to the first hook <code>useState()</code> introduced in the above example, <code>React</code> also officially provides hooks <code>useEffect()</code>, <code>useContext()</code>, <code>useReducer()</code> and so on. See the official hooks and their usage for details.</p>
<p>The flexibility of Hook also lies in the fact that, in addition to the officially provided basic hooks, we can use these basic hooks to wrap and customize hooks for easier code reuse.</p>
<h3 id="hook-pros-and-cons">Hook Pros and Cons</h3>
<p>Advantages</p>
<ul>
<li>Easier to reuse code</li>
<li>Cleaner code style</li>
<li>Less code volume</li>
</ul>
<p>Disadvantages</p>
<ul>
<li>State is not synchronized (functions run independently and each function has a separate copy of the scope)</li>
<li>Need to use <code>useEffect</code> more rationally</li>
<li>Small granularity, need to abstract a lot of <code>hook</code> for complex logic</li>
</ul>
<h2 id="summary">Summary</h2>
<p>Except for <code>Mixin</code>, which is a little bit behind because of its obvious shortcomings, there is no best solution for <code>HOC</code>, <code>render props</code>, and <code>react hook</code>, which all have both advantages and disadvantages.Even for the most popular <code>react hook</code>, although each <code>hook</code> looks so short and refreshing, but in the actual business, usually a business function corresponds to multithe <code>hook</code>, which means that when the business changes, you need to maintain multiple <code>hook</code> changes, compared to maintaining a <code>class</code>, the mental burden may be  This means that when the business changes, you need to maintain multiple <code>hook</code> changes, which may increase the mental burden compared to maintaining one <code>class</code>. Only the way that suits your business is the best solution.</p>
<hr>
<p>Reference <code>https://juejin.cn/post/6961000054018539550</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/react/">react</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-06/real-time-hot-reloading-of-go-programs-using-air/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Real Time Hot Reloading of Go Programs Using Air</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-06/fasttemplate-simple-tutorial/">
            <span class="next-text nav-default">Fasttemplate Simple Tutorial</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
