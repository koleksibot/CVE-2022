<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Learn React hooks easily: useEffect() as an example - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Recently I&amp;rsquo;ve come to realize that React hooks are very useful and I&amp;rsquo;ve reacquainted myself with the React framework. Here&amp;rsquo;s how to understand hooks properly, and to analyze useEffect(), one of the most important hooks, in depth. The content will be as common as possible, so that friends who are not familiar with React can also read.
React&amp;rsquo;s two sets of APIs Previously, there was only one set of React API, but now there are two: the class API and the function-based hooks API." /><meta name="keywords" content="react,hooks,useEffect" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-06/learn-react-hooks-easily/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Learn React hooks easily: useEffect() as an example" />
<meta property="og:description" content="Recently I&rsquo;ve come to realize that React hooks are very useful and I&rsquo;ve reacquainted myself with the React framework. Here&rsquo;s how to understand hooks properly, and to analyze useEffect(), one of the most important hooks, in depth. The content will be as common as possible, so that friends who are not familiar with React can also read.
React&rsquo;s two sets of APIs Previously, there was only one set of React API, but now there are two: the class API and the function-based hooks API." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-06/learn-react-hooks-easily/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-28T11:20:21+08:00" />
<meta property="article:modified_time" content="2021-06-28T11:20:21+08:00" />

<meta itemprop="name" content="Learn React hooks easily: useEffect() as an example">
<meta itemprop="description" content="Recently I&rsquo;ve come to realize that React hooks are very useful and I&rsquo;ve reacquainted myself with the React framework. Here&rsquo;s how to understand hooks properly, and to analyze useEffect(), one of the most important hooks, in depth. The content will be as common as possible, so that friends who are not familiar with React can also read.
React&rsquo;s two sets of APIs Previously, there was only one set of React API, but now there are two: the class API and the function-based hooks API."><meta itemprop="datePublished" content="2021-06-28T11:20:21+08:00" />
<meta itemprop="dateModified" content="2021-06-28T11:20:21+08:00" />
<meta itemprop="wordCount" content="1719">
<meta itemprop="keywords" content="react," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Learn React hooks easily: useEffect() as an example"/>
<meta name="twitter:description" content="Recently I&rsquo;ve come to realize that React hooks are very useful and I&rsquo;ve reacquainted myself with the React framework. Here&rsquo;s how to understand hooks properly, and to analyze useEffect(), one of the most important hooks, in depth. The content will be as common as possible, so that friends who are not familiar with React can also read.
React&rsquo;s two sets of APIs Previously, there was only one set of React API, but now there are two: the class API and the function-based hooks API."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Learn React hooks easily: useEffect() as an example</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-06-28 11:20:21 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/frontend/"> frontend </a>
            </div>
          <span class="more-meta"> 1719 words </span>
          <span class="more-meta"> 9 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#reacts-two-sets-of-apis">React&rsquo;s two sets of APIs</a></li>
        <li><a href="#the-difference-between-classes-and-functions">The difference between classes and functions</a></li>
        <li><a href="#what-are-the-side-effects">What are the side effects?</a></li>
        <li><a href="#the-role-of-hooks">The role of hooks</a></li>
        <li><a href="#usage-of-useeffect">Usage of useEffect()</a></li>
        <li><a href="#the-second-parameter-of-useeffect">The second parameter of useEffect()</a></li>
        <li><a href="#uses-of-useeffect">Uses of useEffect()</a></li>
        <li><a href="#the-return-value-of-useeffect">The return value of useEffect()</a></li>
        <li><a href="#notes-on-useeffect">Notes on useEffect()</a></li>
        <li><a href="#reference-links">Reference Links</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Recently I&rsquo;ve come to realize that <code>React</code> hooks are very useful and I&rsquo;ve reacquainted myself with the <code>React</code> framework. Here&rsquo;s how to understand hooks properly, and to analyze <code>useEffect()</code>, one of the most important hooks, in depth. The content will be as common as possible, so that friends who are not familiar with <code>React</code> can also read.</p>
<h2 id="reacts-two-sets-of-apis">React&rsquo;s two sets of APIs</h2>
<p>Previously, there was only one set of <code>React API</code>, but now there are two: the class API and the function-based hooks API.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/28/16bce48af2c8413bb4a673f04187f73c.png" alt="react"></p>
<p>Any component that can be written in a class or a hook. Here is how the class is written.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">Welcome</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Look again at the way hooks are written, that is, functions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">Welcome</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>These two ways of writing serve exactly the same purpose. It&rsquo;s natural for beginners to ask, &ldquo;Which API set should I use?&rdquo;</p>
<p>The official recommendation is to use hooks (functions) rather than classes. Because hooks are cleaner, less code-intensive, and &ldquo;lighter&rdquo; to use, while classes are &ldquo;heavier&rdquo;. Also, hooks are functions, which is more in line with the functional nature of React.</p>
<p>Here is a comparison of the amount of code in the class component (left) and the function component (right). For complex components, the difference is much more.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/28/32a64a89ca3045fa98fe58bbfe0c3b05.png" alt=" "></p>
<p>However, hooks are so flexible that they are not very easy for beginners to understand. Many people have a half-understanding and can easily write confusing and unmaintainable code. Then it would be better to use classes. Because classes have a lot of mandatory syntax constraints and are not easy to mess up.</p>
<h2 id="the-difference-between-classes-and-functions">The difference between classes and functions</h2>
<p>Strictly speaking, there is a difference between class components and function components. The different ways of writing them represent different programming methodologies.</p>
<p>A class is an encapsulation of data and logic. That is, the state and operation methods of the component are encapsulated together. If you choose to write a class, you should write all the relevant data and operations in the same class.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/28/5ff7e4f8c9a74cb8aecd5b8dbe4191c1.png" alt=" "></p>
<p><strong>Functions in general should only do one thing, which is to return a value</strong>. If you have multiple operations, each operation should be written as a separate function. Also, the state of the data should be separated from the operation method. According to this philosophy, React&rsquo;s function component should do only one thing: return the component&rsquo;s HTML code, and nothing else.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/28/4849184ee7f342f7b5d68d16edf7a5ad.png" alt=" "></p>
<p>Still using the function component above as an example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js">
<span class="kd">function</span> <span class="nx">Welcome</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>This function does only one thing, it returns the HTML code of the component, based on the input parameters. This kind of function that only performs pure data computation (conversion) is called a &ldquo;pure function&rdquo; within functional programming.</p>
<h2 id="what-are-the-side-effects">What are the side effects?</h2>
<p>When you see this, you may have a question: If pure functions can only perform data computation, where should those operations that do not involve computation (such as generating logs, storing data, changing application state, etc.) be written?</p>
<p>Functional programming refers to operations that are not related to data computation as &ldquo;side effects&rdquo;. If a function contains operations that produce side effects directly inside the function, it is no longer a pure function, and we call it an impure function.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/28/9f07778233704a45a83a69eb577ea88f.png" alt=" "></p>
<p>Pure functions can contain side effects internally only by indirect means (i.e., through other function calls).</p>
<h2 id="the-role-of-hooks">The role of hooks</h2>
<p>Having said all that, what exactly are hooks?</p>
<p>In a nutshell, a hook is a side effect solution for React function components that is used to introduce side effects to the function component. The body of the function component should only be used to return the component&rsquo;s HTML code, all other operations (side effects) must be introduced via hooks.</p>
<p>Since there are so many side effects, there are many kinds of hooks, and React provides dedicated hooks for many common operations (side effects).</p>
<ul>
<li><code>useState()</code>: save state</li>
<li><code>useContext()</code>: save context</li>
<li><code>useRef()</code>: save reference</li>
<li>&hellip;&hellip;</li>
</ul>
<p>All of these hooks introduce a specific side effect, while <code>useEffect()</code> is the generic side effect hook. If you can&rsquo;t find a corresponding hook, you can use it. In fact, as you can see from the name, it is directly related to side effect.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/28/5983fbc3ab274cf6961229239f11d75c.png" alt=" "></p>
<h2 id="usage-of-useeffect">Usage of useEffect()</h2>
<p><code>useEffect()</code> itself is a function, provided by the <code>React</code> framework, that can be called from within the function component.</p>
<p>For example, we want the page title (document.title) to change when the component is loaded. Then, the action of changing the page title is a side effect of the component and must be implemented with <code>useEffect()</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">Welcome</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="s1">&#39;Loading completed&#39;</span><span class="p">;</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, the argument to <code>useEffect()</code> is a function that is the side effect (changing the page title) to be accomplished. Once the component is loaded, <code>React</code> will execute this function. (<a href="https://codesandbox.io/s/interesting-dubinsky-dx6oq?file=/src/index.js">See the results of the run</a>)</p>
<p>What <code>useEffect()</code> does is to specify a side effect function that is automatically executed once for every rendering of the component. The side effect function is also executed after the component is loaded for the first time in the web page <code>DOM</code>.</p>
<h2 id="the-second-parameter-of-useeffect">The second parameter of useEffect()</h2>
<p>Sometimes we don&rsquo;t want <code>useEffect()</code> to be executed every time we render, in which case we can use its second argument to specify the dependencies of the side effect function using an array, and only if the dependencies change will they be re-rendered.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js">
<span class="kd">function</span> <span class="nx">Welcome</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="sb">`Hello, </span><span class="si">${</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">]);</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, the second argument to <code>useEffect()</code> is an array specifying the dependencies (<code>props.name</code>) of the first argument (the side effect function). The side effect function will be executed only if this variable changes.</p>
<p>If the second argument is an empty array, it means that the side effect parameter does not have any dependencies. Therefore, the side effect function will only be executed once at this point after the component is loaded into the <code>DOM</code>, and not again when the component is re-rendered later. This makes sense, because the side effect does not depend on any variables, so the result of the side effect function will not change no matter how those variables change, so running it once is enough.</p>
<h2 id="uses-of-useeffect">Uses of useEffect()</h2>
<p>Any side effect can be introduced using <code>useEffect()</code> as long as it is a side effect. It has the following common uses.</p>
<ul>
<li>fetching data (data fetching)</li>
<li>Event listening or subscription (setting up a subscription)</li>
<li>Changing the DOM (changing the DOM)</li>
<li>Exporting logs (logging)</li>
</ul>
<p>The following is an example of getting data from a remote server. (<a href="https://codesandbox.io/s/intelligent-yonath-olihz?file=/src/index.js">View the results of the run</a>)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">useState</span><span class="p">,</span> <span class="nx">useEffect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">axios</span> <span class="nx">from</span> <span class="s1">&#39;axios&#39;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">data</span><span class="p">,</span> <span class="nx">setData</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">({</span> <span class="nx">hits</span><span class="o">:</span> <span class="p">[]</span> <span class="p">});</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">fetchData</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">axios</span><span class="p">(</span>
        <span class="s1">&#39;https://hn.algolia.com/api/v1/search?query=redux&#39;</span><span class="p">,</span>
      <span class="p">);</span>

      <span class="nx">setData</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="nx">fetchData</span><span class="p">();</span>
  <span class="p">},</span> <span class="p">[]);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
      <span class="p">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">hits</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="p">=&gt;</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">objectID</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/a&gt;</span>
        <span class="o">&lt;</span><span class="err">/li&gt;</span>
      <span class="p">))}</span>
    <span class="o">&lt;</span><span class="err">/ul&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">App</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, <code>useState()</code> is used to generate a state variable (data) to store the fetched data; the side effect function of <code>useEffect()</code> has an <code>async</code> function inside to fetch the data from the server asynchronously. After getting the data, <code>setData()</code> is used to trigger the re-rendering of the component.</p>
<p>The second argument of <code>useEffect()</code> in the above example is an empty array, since fetching data only needs to be executed once.</p>
<h2 id="the-return-value-of-useeffect">The return value of useEffect()</h2>
<p>Side effects occur as the component is loaded, then it may be necessary to clean up these side effects when the component is unloaded.</p>
<p><code>useEffect()</code> allows to return a function that is executed when the component is unloaded to clean up the side effects. If there is no need to clean up side effects, <code>useEffect()</code> does not need to return any value.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">subscription</span> <span class="o">=</span> <span class="nx">props</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">();</span>
  <span class="k">return</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">subscription</span><span class="p">.</span><span class="nx">unsubscribe</span><span class="p">();</span>
  <span class="p">};</span>
<span class="p">},</span> <span class="p">[</span><span class="nx">props</span><span class="p">.</span><span class="nx">source</span><span class="p">]);</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, <code>useEffect()</code> subscribes to an event when the component is loaded and returns a cleanup function that is unsubscribed when the component is unloaded.</p>
<p>In practice, since the side effect function is executed every time it is rendered by default, the cleanup function will not only be executed once when the component is unloaded, but also once every time before the side effect function is re-executed to clean up the side effects of the last rendering.</p>
<h2 id="notes-on-useeffect">Notes on useEffect()</h2>
<p>There is one thing to note when using <code>useEffect()</code>. If you have multiple side effects, you should call multiple <code>useEffect()</code>s and should not combine them and write them together.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">varA</span><span class="p">,</span> <span class="nx">setVarA</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">varB</span><span class="p">,</span> <span class="nx">setVarB</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">timeoutA</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">setVarA</span><span class="p">(</span><span class="nx">varA</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="kr">const</span> <span class="nx">timeoutB</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">setVarB</span><span class="p">(</span><span class="nx">varB</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2000</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
      <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeoutA</span><span class="p">);</span>
      <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeoutB</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">varA</span><span class="p">,</span> <span class="nx">varB</span><span class="p">]);</span>

  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">varA</span><span class="p">},</span> <span class="p">{</span><span class="nx">varB</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/span&gt;;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The above example is the wrong way to write it, there are two timers inside the side effect function, they are not related to each other, in fact they are two unrelated side effects and should not be written together. The correct way to write them is to write them separately as two <code>useEffect()</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">varA</span><span class="p">,</span> <span class="nx">setVarA</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="kr">const</span> <span class="p">[</span><span class="nx">varB</span><span class="p">,</span> <span class="nx">setVarB</span><span class="p">]</span> <span class="o">=</span> <span class="nx">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">setVarA</span><span class="p">(</span><span class="nx">varA</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">varA</span><span class="p">]);</span>

  <span class="nx">useEffect</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">timeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">setVarB</span><span class="p">(</span><span class="nx">varB</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2000</span><span class="p">);</span>

    <span class="k">return</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">timeout</span><span class="p">);</span>
  <span class="p">},</span> <span class="p">[</span><span class="nx">varB</span><span class="p">]);</span>

  <span class="k">return</span> <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">varA</span><span class="p">},</span> <span class="p">{</span><span class="nx">varB</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/span&gt;;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="reference-links">Reference Links</h2>
<ul>
<li><a href="https://medium.com/swlh/useeffect-4-tips-every-developer-should-know-54b188b14d9c">React useEffect: 4 Tips Every Developer Should Know</a>, Helder Esteves</li>
<li><a href="https://reactjs.org/docs/hooks-effect.html">Using the Effect Hook</a>, React</li>
<li><a href="https://www.robinwieruch.de/react-hooks-fetch-data">How to fetch data with React Hooks?</a>, Robin Wieruch</li>
</ul>
<hr>
<p>Reference <code>https://www.ruanyifeng.com/blog/2020/09/react-hooks-useeffect-tutorial.html</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/react/">react</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-06/write-a-springboot-shell-script/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Write a Springboot Shell Script</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-06/the-underlying-implementation-of-annotations-in-the-jdk/">
            <span class="next-text nav-default">The Underlying Implementation of Annotations in the Jdk</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
