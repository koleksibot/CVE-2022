<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Clipboard Operations Clipboard Api Tutorial - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="1, Introduction Browsers allow JavaScript scripts to read and write to the clipboard to automatically copy or paste content.
In general, scripts should not alter the user&amp;rsquo;s clipboard in a way that does not meet the user&amp;rsquo;s expectations. However, there are times when this is convenient, such as the &amp;ldquo;one-click copy&amp;rdquo; feature, where the user clicks a button and the specified content automatically goes to the clipboard.
Currently, there are three ways to implement clipboard operations." /><meta name="keywords" content="golang, kubernetes, python, javascript, linux, java, docker, rust" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-06/clipboard-operations-clipboard-api-tutorial/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Clipboard Operations Clipboard Api Tutorial" />
<meta property="og:description" content="1, Introduction Browsers allow JavaScript scripts to read and write to the clipboard to automatically copy or paste content.
In general, scripts should not alter the user&rsquo;s clipboard in a way that does not meet the user&rsquo;s expectations. However, there are times when this is convenient, such as the &ldquo;one-click copy&rdquo; feature, where the user clicks a button and the specified content automatically goes to the clipboard.
Currently, there are three ways to implement clipboard operations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-06/clipboard-operations-clipboard-api-tutorial/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-06-13T17:29:31+08:00" />
<meta property="article:modified_time" content="2021-06-13T17:29:31+08:00" />

<meta itemprop="name" content="Clipboard Operations Clipboard Api Tutorial">
<meta itemprop="description" content="1, Introduction Browsers allow JavaScript scripts to read and write to the clipboard to automatically copy or paste content.
In general, scripts should not alter the user&rsquo;s clipboard in a way that does not meet the user&rsquo;s expectations. However, there are times when this is convenient, such as the &ldquo;one-click copy&rdquo; feature, where the user clicks a button and the specified content automatically goes to the clipboard.
Currently, there are three ways to implement clipboard operations."><meta itemprop="datePublished" content="2021-06-13T17:29:31+08:00" />
<meta itemprop="dateModified" content="2021-06-13T17:29:31+08:00" />
<meta itemprop="wordCount" content="1869">
<meta itemprop="keywords" content="js," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Clipboard Operations Clipboard Api Tutorial"/>
<meta name="twitter:description" content="1, Introduction Browsers allow JavaScript scripts to read and write to the clipboard to automatically copy or paste content.
In general, scripts should not alter the user&rsquo;s clipboard in a way that does not meet the user&rsquo;s expectations. However, there are times when this is convenient, such as the &ldquo;one-click copy&rdquo; feature, where the user clicks a button and the specified content automatically goes to the clipboard.
Currently, there are three ways to implement clipboard operations."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Clipboard Operations Clipboard Api Tutorial</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-06-13 17:29:31 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/frontend/"> frontend </a>
            </div>
          <span class="more-meta"> 1869 words </span>
          <span class="more-meta"> 9 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-introduction">1, Introduction</a></li>
        <li><a href="#2-documentexeccommand-method">2, Document.execCommand() method</a></li>
        <li><a href="#3-asynchronous-clipboard-api">3, Asynchronous Clipboard API</a></li>
        <li><a href="#4-clipboard-object">4, Clipboard object</a>
          <ul>
            <li><a href="#41-clipboardreadtext">4.1 Clipboard.readText()</a></li>
            <li><a href="#42-clipboardread">4.2 Clipboard.read()</a></li>
            <li><a href="#43-clipboardwritetext">4.3 Clipboard.writeText()</a></li>
            <li><a href="#44-clipboardwrite">4.4 Clipboard.write()</a></li>
          </ul>
        </li>
        <li><a href="#5-copy-event-cut-event">5, copy event, cut event</a></li>
        <li><a href="#6-paste-event">6, paste event</a></li>
        <li><a href="#7-reference-links">7, Reference Links</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="1-introduction">1, Introduction</h2>
<p>Browsers allow JavaScript scripts to read and write to the clipboard to automatically copy or paste content.</p>
<p>In general, scripts should not alter the user&rsquo;s clipboard in a way that does not meet the user&rsquo;s expectations. However, there are times when this is convenient, such as the &ldquo;one-click copy&rdquo; feature, where the user clicks a button and the specified content automatically goes to the clipboard.</p>
<p>Currently, there are three ways to implement clipboard operations.</p>
<blockquote>
<ul>
<li><code>Document.execCommand()</code> method</li>
<li>Asynchronous Clipboard API</li>
<li><code>copy</code> event and <code>paste</code> event</li>
</ul>
</blockquote>
<p>This article introduces each of these three methods.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/13/173e694a3d20433d8ba9173035d242fd.jpeg" alt="copy text to chipboard using javascript"></p>
<h2 id="2-documentexeccommand-method">2, Document.execCommand() method</h2>
<p><code>Document.execCommand()</code> is the traditional method for manipulating the clipboard and is supported by various browsers.</p>
<p>It supports the three operations of copy, cut and paste.It supports the three operations of copy, cut and paste.</p>
<blockquote>
<ul>
<li><code>document.execCommand('copy')</code></li>
<li><code>document.execCommand('cut')</code></li>
<li><code>document.execCommand('paste')</code></li>
</ul>
</blockquote>
<p>（1）Copy Operation</p>
<p>To copy, first select the text, then call <code>document.execCommand('copy')</code> and the selected text will go to the clipboard.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">inputElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#input&#39;</span><span class="p">);</span>
<span class="nx">inputElement</span><span class="p">.</span><span class="nx">select</span><span class="p">();</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="s1">&#39;copy&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, the script first selects the text inside the input box <code>inputElement</code> (<code>inputElement.select()</code>) and then <code>document.execCommand('copy')</code> copies it to the clipboard.</p>
<p>Note that the copy operation is best placed inside an event listener function, triggered by the user (e.g., if the user clicks a button). Some browsers may report an error if the script is executed autonomously.Note that the copy operation is best placed inside an event listener function, triggered by the user (e.g., if the user clicks a button). Some browsers may report an error if the script is executed autonomously.</p>
<p>（2）Paste operation</p>
<p>When pasting, calling <code>document.execCommand('paste')</code> will output the contents of the clipboard to the current focus element.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">pasteText</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;#output&#39;</span><span class="p">);</span>
<span class="nx">pasteText</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="s1">&#39;paste&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>（3）Disadvantages</p>
<p>The <code>Document.execCommand()</code> method is convenient, but it has some disadvantages.</p>
<p>First, it can only copy the selected content to the clipboard, and cannot write arbitrary content to the clipboard.</p>
<p>Second, it is a synchronous operation, so if you copy/paste a lot of data, the page will lag. Some browsers also pop up a prompt box asking for user permission, at which point the page loses response before the user can make a choice.</p>
<p>To solve these problems, browser vendors have proposed the asynchronous Clipboard API.</p>
<h2 id="3-asynchronous-clipboard-api">3, Asynchronous Clipboard API</h2>
<p>The Clipboard API is the next generation of clipboard manipulation, more powerful and logical than the traditional <code>document.execCommand()</code> method.</p>
<p>All its operations are asynchronous, returning Promise objects without causing page lag. Moreover, it can put any content (e.g. images) into the clipboard.</p>
<p>The <code>navigator.clipboard</code> property returns the clipboard object, through which all operations are performed.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">clipboardObj</span> <span class="o">=</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>If the <code>navigator.clipboard</code> property returns <code>undefined</code>, then the current browser does not support this API.</p>
<p>Since users may put sensitive data (e.g. passwords) in the clipboard, allowing scripts to read it arbitrarily poses a security risk, so this API has a number of security restrictions.</p>
<p>First, Chrome requires that only pages with the HTTPS protocol can use this API, although the development environment (<code>localhost</code>) allows the use of non-encrypted protocols.</p>
<p>Second, the user&rsquo;s permission needs to be explicitly obtained when calling it. Permissions are implemented using the Permissions API, and there are two clipboard-related permissions: <code>clipboard-write</code> (write permission) and <code>clipboard-read</code> (read permission). write permission&quot; is automatically granted to the script, while &ldquo;read permission&rdquo; must be granted with the user&rsquo;s explicit consent. In other words, writing to the clipboard can be done automatically by the script, but when reading the clipboard, the browser will pop up a dialog asking the user if he/she agrees to read it.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/06/13/ab10dde4cff745479b72c4132b607377.jpeg" alt="permission"></p>
<p>Also, note that the script always reads the clipboard of the current page. One problem with this is that if you paste the relevant code into Developer Tools and run it directly, it may report an error, because the current page is then the Developer Tools window, not the web page.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
<span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="p">})();</span>
</code></pre></td></tr></table>
</div>
</div><p>If you take the above code, paste it into the Developer Tools and run it, it will report an error. Because when the code is run, the Developer Tools window is the current page, and this page does not have the DOM interface that the Clipboard API depends on. A workaround is to put the code inside <code>setTimeout()</code> to delay the run and quickly click on the browser page window before calling the function to make it the current page.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">setTimeout</span><span class="p">(</span><span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
 <span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span><span class="p">();</span>
 <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>After pasting the above code into the developer tool and running it, give a quick click on the page window of the web page to make it the current page so that no error is reported.</p>
<h2 id="4-clipboard-object">4, Clipboard object</h2>
<p>The Clipboard object provides four methods to read and write to the clipboard. They are all asynchronous methods that return Promise objects.</p>
<h3 id="41-clipboardreadtext">4.1 Clipboard.readText()</h3>
<p>The <code>Clipboard.readText()</code> method is used to copy the text data inside the clipboard.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span>
  <span class="s1">&#39;click&#39;</span><span class="p">,</span>
  <span class="kr">async</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, when the user clicks on the page, the text inside the clipboard is output. Note that the browser will pop up a dialog box at this point asking the user if they agree to the script reading the clipboard.</p>
<p>If the user does not agree, the script will report an error. In this case, you can use the <code>try... .catch</code> structure to handle error reporting.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">getClipboardContents</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span><span class="p">();</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Pasted content: &#39;</span><span class="p">,</span> <span class="nx">text</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Failed to read clipboard contents: &#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="42-clipboardread">4.2 Clipboard.read()</h3>
<p>The <code>Clipboard.read()</code> method is used to copy the data inside the clipboard, either text data or binary data (e.g. images). This method requires explicit permission from the user.</p>
<p>The method returns a Promise object. Once the state of the object is resolved, an array is obtained, each member of which is an instance of the ClipboardItem object.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">getClipboardContents</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">clipboardItems</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">read</span><span class="p">();</span>
    <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">clipboardItem</span> <span class="k">of</span> <span class="nx">clipboardItems</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">type</span> <span class="k">of</span> <span class="nx">clipboardItem</span><span class="p">.</span><span class="nx">types</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">blob</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">clipboardItem</span><span class="p">.</span><span class="nx">getType</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">blob</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The ClipboardItem object represents a single clipboard item, each of which has a <code>ClipboardItem.types</code> property and a <code>ClipboardItem.getType()</code> method.</p>
<p>The <code>ClipboardItem.types</code> property returns an array whose members are the MIME types available for the clipboard item, for example, if a clipboard item can be pasted in HTML format or in plain text format, then it has two MIME types (<code>text/html</code> and <code>text/plain</code>) ).</p>
<p>The <code>ClipboardItem.getType(type)</code> method is used to read the data of the clipboard item, returning a Promise object. The method accepts the MIME type of the clipboard item as a parameter and returns the data of that type, which is required, otherwise an error is reported.</p>
<h3 id="43-clipboardwritetext">4.3 Clipboard.writeText()</h3>
<p>The <code>Clipboard.writeText()</code> method is used to write the text content to the clipboard.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span>
  <span class="s1">&#39;click&#39;</span><span class="p">,</span>
  <span class="kr">async</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">writeText</span><span class="p">(</span><span class="s1">&#39;Yo&#39;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The above example is a script that writes text data to the clipboard after the user clicks on a web page.</p>
<p>This method does not require user permission, but it is best to also put it in <code>try.... .catch</code> to prevent error reporting.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">async</span> <span class="kd">function</span> <span class="nx">copyPageUrl</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">writeText</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Page URL copied to clipboard&#39;</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Failed to copy: &#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="44-clipboardwrite">4.4 Clipboard.write()</h3>
<p>The <code>Clipboard.write()</code> method is used to write arbitrary data to the clipboard, either as text data or as binary data.</p>
<p>This method accepts a ClipboardItem instance as an argument, indicating the data to be written to the clipboard.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="k">try</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">imgURL</span> <span class="o">=</span> <span class="s1">&#39;https://dummyimage.com/300.png&#39;</span><span class="p">;</span>
  <span class="kr">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">imgURL</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">blob</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">data</span><span class="p">.</span><span class="nx">blob</span><span class="p">();</span>
  <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">write</span><span class="p">([</span>
    <span class="k">new</span> <span class="nx">ClipboardItem</span><span class="p">({</span>
      <span class="p">[</span><span class="nx">blob</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span><span class="o">:</span> <span class="nx">blob</span>
    <span class="p">})</span>
  <span class="p">]);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Image copied.&#39;</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, the script writes an image to the clipboard. Note that Chrome currently only supports writing images in PNG format.</p>
<p><code>ClipboardItem()</code> is a constructor provided natively by the browser to generate a <code>ClipboardItem</code> instance, which accepts as a parameter an object whose key name is the MIME type of the data, and whose key value is the data itself.</p>
<p>The following example takes the same clipboard item and writes its value in multiple formats to the clipboard, one with text data and another with binary data for different occasions of pasting.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">copy</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">image</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;kitten.png&#39;</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Blob</span><span class="p">([</span><span class="s1">&#39;Cute sleeping kitten&#39;</span><span class="p">],</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">});</span>
  <span class="kr">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ClipboardItem</span><span class="p">({</span>
    <span class="s1">&#39;text/plain&#39;</span><span class="o">:</span> <span class="nx">text</span><span class="p">,</span>
    <span class="s1">&#39;image/png&#39;</span><span class="o">:</span> <span class="nx">image</span>
  <span class="p">});</span>
  <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">write</span><span class="p">([</span><span class="nx">item</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="5-copy-event-cut-event">5, copy event, cut event</h2>
<p>The <code>copy</code> event will be triggered when the user puts data into the clipboard.</p>
<p>The following example takes the text that the user puts into the clipboard and converts it to uppercase.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">source</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;.source&#39;</span><span class="p">);</span>

<span class="nx">source</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;copy&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">selection</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getSelection</span><span class="p">();</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">clipboardData</span><span class="p">.</span><span class="nx">setData</span><span class="p">(</span><span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="nx">selection</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">toUpperCase</span><span class="p">());</span>
  <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, the <code>clipboardData</code> property of the event object contains the clipboard data. It is an object with the following properties and methods.</p>
<blockquote>
<ul>
<li><code>Event.clipboardData.setData(type, data)</code> ：To modify the clipboard data, you need to specify the data type.</li>
<li><code>Event.clipboardData.getData(type)</code> ：Get the clipboard data, you need to specify the data type.</li>
<li><code>Event.clipboardData.clearData([type])</code> ：To clear the clipboard data, you can specify the data type. If no type is specified, all types of data will be cleared.</li>
<li><code>Event.clipboardData.items</code> ：An array-like object that contains all the clipping items, although there is usually only one clipping item.</li>
</ul>
</blockquote>
<p>The following example intercepts the user&rsquo;s copy operation and puts the specified content into the clipboard.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">clipboardItems</span> <span class="o">=</span> <span class="p">[];</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;copy&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">clipboardItems</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">item</span> <span class="k">of</span> <span class="nx">e</span><span class="p">.</span><span class="nx">clipboardData</span><span class="p">.</span><span class="nx">items</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">item</span><span class="p">.</span><span class="nx">type</span><span class="p">.</span><span class="nx">startsWith</span><span class="p">(</span><span class="s1">&#39;image/&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">continue</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nx">clipboardItems</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">ClipboardItem</span><span class="p">({</span>
          <span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">type</span><span class="p">]</span><span class="o">:</span> <span class="nx">item</span><span class="p">,</span>
        <span class="p">})</span>
      <span class="p">);</span>
      <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">clipboardItems</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Image copied.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>In the above example, the default clipboard operation is cancelled using <code>e.preventDefault()</code>, and then the script takes over the copy operation.</p>
<p>The <code>cut</code> event is triggered when the user performs a cut operation, and it is handled exactly the same as the <code>copy</code> event, which also gets the cut data from the <code>Event.clipboardData</code> property.</p>
<h2 id="6-paste-event">6, paste event</h2>
<p>The <code>paste</code> event is triggered when the user uses the clipboard data and performs a paste operation.</p>
<p>The following example intercepts the paste operation and the script takes out the data from the clipboard.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;paste&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
  <span class="kr">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">readText</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Pasted text: &#39;</span><span class="p">,</span> <span class="nx">text</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="7-reference-links">7, Reference Links</h2>
<ul>
<li><a href="https://web.dev/async-clipboard/">Unblocking clipboard access</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Interact_with_the_clipboard">Interact with the clipboard</a></li>
<li><a href="https://blog.tomayac.com/2020/03/20/multi-mime-type-copying-with-the-async-clipboard-api/">Multi-MIME Type Copying with the Async Clipboard API</a></li>
</ul>
<hr>
<p>Reference <code>http://www.ruanyifeng.com/blog/2021/01/clipboard-api.html</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/js/">js</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-06/exploring-the-react-native-startup-version-checking-mechanism/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Exploring the React Native Startup Version Checking Mechanism</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-06/redis-expired-key-removal-policy/">
            <span class="next-text nav-default">Redis Expired Key Removal Policy</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
