<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python file reading and writing operations - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="When programming in Python, you will often encounter operations that read and write files. The various modes of reading and writing files (such as read, write, append, etc.) can sometimes be really confusing, as well as confusing the use of methods such as open, read, readline, readlines, write, writelines, etc. can also throw you for a loop. I hope this article will help you better understand how to read and" /><meta name="keywords" content="python, Read Write File" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-10/python-read-write-file/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python file reading and writing operations" />
<meta property="og:description" content="When programming in Python, you will often encounter operations that read and write files. The various modes of reading and writing files (such as read, write, append, etc.) can sometimes be really confusing, as well as confusing the use of methods such as open, read, readline, readlines, write, writelines, etc. can also throw you for a loop. I hope this article will help you better understand how to read and" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-10/python-read-write-file/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-30T13:54:49+08:00" />
<meta property="article:modified_time" content="2021-10-30T13:54:49+08:00" />

<meta itemprop="name" content="Python file reading and writing operations">
<meta itemprop="description" content="When programming in Python, you will often encounter operations that read and write files. The various modes of reading and writing files (such as read, write, append, etc.) can sometimes be really confusing, as well as confusing the use of methods such as open, read, readline, readlines, write, writelines, etc. can also throw you for a loop. I hope this article will help you better understand how to read and"><meta itemprop="datePublished" content="2021-10-30T13:54:49+08:00" />
<meta itemprop="dateModified" content="2021-10-30T13:54:49+08:00" />
<meta itemprop="wordCount" content="1823">
<meta itemprop="keywords" content="python," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python file reading and writing operations"/>
<meta name="twitter:description" content="When programming in Python, you will often encounter operations that read and write files. The various modes of reading and writing files (such as read, write, append, etc.) can sometimes be really confusing, as well as confusing the use of methods such as open, read, readline, readlines, write, writelines, etc. can also throw you for a loop. I hope this article will help you better understand how to read and"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python file reading and writing operations</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-30 13:54:49 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1823 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-a-document">What is a document?</a></li>
        <li><a href="#file-path">File path</a></li>
        <li><a href="#end-of-line">End of line</a></li>
        <li><a href="#python-traversal-method-for-folders">Python traversal method for folders</a>
          <ul>
            <li><a href="#use-walk">Use walk()</a></li>
            <li><a href="#using-listdir">Using listdir</a></li>
            <li><a href="#glob-module">glob module</a></li>
          </ul>
        </li>
        <li><a href="#python-reads-and-writes-file-contents">Python reads and writes file contents</a>
          <ul>
            <li><a href="#open-a-file-with-the-with-statement">Open a file with the with statement</a></li>
            <li><a href="#text-reading-the-difference-between-read-readline-readlines">Text reading: the difference between read(), readline(), readlines()</a></li>
            <li><a href="#text-writing-write-and-writelines">Text writing: write() and writelines()</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>When programming in Python, you will often encounter operations that read and write files. The various modes of reading and writing files (such as read, write, append, etc.) can sometimes be really confusing, as well as confusing the use of methods such as open, read, readline, readlines, write, writelines, etc. can also throw you for a loop.</p>
<p>I hope this article will help you better understand how to read and write files and use the most appropriate methods in the most appropriate places.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/30/8d1b408efc5e4abb94ed25a8b8990a1a.png" alt=""></p>
<h2 id="what-is-a-document">What is a document?</h2>
<p>Before we start looking at how to use files in Python, it&rsquo;s important to understand exactly what files are and how modern operating systems handle certain aspects of them.</p>
<p>Essentially, a file is a contiguous set of bytes used to store data. This data is organized in a specific format and can be anything as simple as a text file, or as complex as a program executable. Finally, these byte files are translated into binary files1,0 for easier processing by the computer.</p>
<p>A file on most modern file systems consists of three main parts.</p>
<ul>
<li><strong>Header</strong> : metadata about the contents of the file (file name, size, type, etc.)</li>
<li><strong>Data</strong> : the contents of the file as written by the creator or editor</li>
<li><strong>End of File (EOF)</strong> : A special character indicating the end of the file</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/30/05e5ff4e0bbd4479a69fc112bd72b938.png" alt=""></p>
<p>The content of the data representation depends on the format specification used and is usually indicated by the extension. For example, a file with a .gif extension is most likely to conform to the <a href="https://en.wikipedia.org/wiki/GIF">Graphics Interchange Format</a> specification. There are hundreds, if not thousands, of <a href="https://en.wikipedia.org/wiki/List_of_filename_extensions">file extensions</a>.</p>
<h2 id="file-path">File path</h2>
<p>File paths are required to access files on the operating system. A file path is a string that represents the location of a file. It is divided into three main parts.</p>
<ul>
<li>folder path: the location of the folder on the file system, with subsequent folders separated by a forward slash / (Unix) or a backslash \ (Windows)</li>
<li>filename: the actual name of the file</li>
<li>Extension: the file path is pre-set with a period (.) at the end , used to indicate the file type</li>
</ul>
<p>Python file path-related operations.</p>
<ul>
<li>Use getcwd() to get the current working directory, i.e., the path to the directory where the Python script is currently working, similar to the pwd command in Linux.
<ul>
<li>If you want to print a file name or path that contains Chinese in Windows, you need to use &ldquo;GBK&rdquo; to decode it.</li>
</ul>
</li>
<li>Merge paths using path.join()
<ul>
<li>Use sep for backslashes in Windows and forward slashes in Linux (backslashes need to be escaped with \)</li>
</ul>
</li>
<li>Relative paths
<ul>
<li>(.) Dot indicates the current folder</li>
<li>(. ) dot means parent folder</li>
</ul>
</li>
<li>Relative path, absolute path conversion
<ul>
<li>path.abspath(path): return absolute path</li>
<li>path.isabs(path): determine if it is an absolute path</li>
<li>path.relpath(path,start): return relative path</li>
</ul>
</li>
<li>path.split.</li>
<li>path.dirname(path): return the directory where the file is located, os.path.basename(path): return the file name</li>
<li>path.split(path) == (os.path.dirname(path), os.path.basename(path)).silit(os.sep) is splitting the path by separator</li>
<li>path.basename(): get the file name</li>
<li>path.splitext(): split the extension</li>
<li>View file size: path.getsize(filename), can only count files, not folders, if you need to count folders, you need to traverse by yourself.</li>
<li>Get file attributes: stat(file)</li>
<li>Check the validity of the path
<ul>
<li>path.exists: whether the path exists</li>
<li>path.isdir: if or not it is a directory</li>
<li>path.isfile: if or not it is a file</li>
</ul>
</li>
<li>Return all files and directory names in the specified directory: listdir()</li>
</ul>
<p>Other methods.</p>
<ul>
<li>remove files: os.remove()</li>
<li>Remove directories: removedirs(r &ldquo;c:\python&rdquo;)</li>
<li>rename: rename(old, new) # files or directories are used with this command</li>
<li>Create multi-level directories: makedirs(r &ldquo;c:\python\test&rdquo;), which will create intermediate folders, similar to the Linux command mkdir -p</li>
<li>Create a single directory: mkdir(&ldquo;test&rdquo;)</li>
<li>Modify file permissions and timestamps: chmod(file)</li>
</ul>
<p>Directory operations.</p>
<ul>
<li>Copy a file.
<ul>
<li>copyfile(&ldquo;oldfile&rdquo;, &ldquo;newfile&rdquo;) # Both oldfile and newfile can only be files</li>
<li>copy(&ldquo;oldfile&rdquo;, &ldquo;newfile&rdquo;) # oldfile can only be a folder, newfile can be a file or a target directory</li>
</ul>
</li>
<li>copy folder: copytree(&ldquo;olddir&rdquo;, &ldquo;newdir&rdquo;) # both olddir and newdir can only be directories, and newdir must not exist</li>
<li>Move a file (directory): move(&ldquo;oldpos&rdquo;, &ldquo;newpos&rdquo;)</li>
<li>Delete a directory
<ul>
<li>rmdir(&ldquo;dir&rdquo;) # Only empty directories can be deleted</li>
<li>rmtree(&ldquo;dir&rdquo;) # Empty directories and directories with contents can be deleted</li>
</ul>
</li>
</ul>
<h2 id="end-of-line">End of line</h2>
<p>A common problem encountered when working with file data is the representation of new lines or line endings. Line endings originated in the days of Morse code, when a specific symbol was used to indicate the end of a transmission or the end of a line.</p>
<p>Later, the International Organization for Standardization (ISO) and the American Standards Association (ASA) standardized teletypewriters. the ASA standard specifies that line endings should use carriage returns (sequence CR or \r) and line feed (LF or \n) characters (CR+LF or \r\n). However, the ISO standard allows CR+LF characters or LF characters only.</p>
<p>Windows uses the CR+LF character for newlines, while Unix and newer Mac versions use only the LF character. This can lead to some complications when you are working with files that originate on different operating systems. Here&rsquo;s a simple example. Suppose we examine the file dog_breeds.txt created on a Windows system.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">Pug\r\n
Jack Russel Terrier\r\n
English Springer Spaniel\r\n
German Shepherd\r\n
Staffordshire Bull Terrier\r\n
Cavalier King Charles Spaniel\r\n
Golden Retriever\r\n
West Highland White Terrier\r\n
Boxer\r\n
Border Terrier\r\n
</code></pre></td></tr></table>
</div>
</div><p>The same output will be interpreted differently on Unix devices.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">Pug\r
\n
Jack Russel Terrier\r
\n
English Springer Spaniel\r
\n
German Shepherd\r
\n
Staffordshire Bull Terrier\r
\n
Cavalier King Charles Spaniel\r
\n
Golden Retriever\r
\n
West Highland White Terrier\r
\n
Boxer\r
\n
Border Terrier\r
\n
</code></pre></td></tr></table>
</div>
</div><p>Solution.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="python-traversal-method-for-folders">Python traversal method for folders</h2>
<h3 id="use-walk">Use walk()</h3>
<p>Output is always folder first and then file name</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*- </span>
<span class="kn">import</span> <span class="nn">os</span> 
<span class="k">def</span> <span class="nf">echo_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">):</span> 
    <span class="n">list_dirs</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">root_dir</span><span class="p">)</span> 
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">list_dirs</span><span class="p">:</span> 
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span> 
            <span class="nb">print</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span> 
            <span class="nb">print</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="using-listdir">Using listdir</h3>
<p>The output follows the directory tree structure and is sorted alphabetically.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*- </span>
<span class="kn">import</span> <span class="nn">os</span> 

<span class="k">def</span> <span class="nf">echo_path</span><span class="p">(</span><span class="n">root_dir</span><span class="p">):</span> 
    <span class="k">for</span> <span class="n">dir_list</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">root_dir</span><span class="p">):</span> 
        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_dir</span><span class="p">,</span> <span class="n">dir_list</span><span class="p">)</span> 
        <span class="nb">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span> 
            <span class="n">echo_path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="glob-module">glob module</h3>
<p>The glob module is one of the simplest modules, with very little content. Use it to find pathnames of files that match specific rules.</p>
<p><strong>glob.glob</strong></p>
<p>returns a list of all matching file paths. It has only one argument, pathname, which defines the file path matching rules, here it can be either absolute or relative paths. Example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">glob</span>  

<span class="c1">#获取指定目录下的所有图片  </span>
<span class="nb">print</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;E:\Picture\*\*.jpg&#34;</span><span class="p">)</span> <span class="p">)</span>

<span class="c1">#获取上级目录的所有.py文件  </span>
<span class="nb">print</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;../*.py&#39;</span><span class="p">)</span> <span class="c1">#相对路径)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="python-reads-and-writes-file-contents">Python reads and writes file contents</h2>
<h3 id="open-a-file-with-the-with-statement">Open a file with the with statement</h3>
<p>Reading and writing files in Python requires 3 steps.</p>
<ul>
<li>Calling the open function, which returns a File object</li>
<li>Calling the read() or write() method of the File object</li>
<li>Calling the close() method of the File object to close the file</li>
</ul>
<p>Common opening modes for files.</p>
<ul>
<li>&lsquo;r&rsquo;: read-only (default. Throws an error if the file does not exist)</li>
<li>&lsquo;w&rsquo;: write-only (if the file does not exist, the file is automatically created)</li>
<li>&lsquo;a&rsquo;: append to the end of the file</li>
<li>&lsquo;r+': read and write</li>
</ul>
<p>If you need to open the file in binary mode, you need to add the character &ldquo;b&rdquo; after mode, such as &ldquo;rb&rdquo;, &ldquo;wb&rdquo;, etc.</p>
<p>If you don&rsquo;t use the with statement, the code is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;/tmp/foo.txt&#34;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>There are two problems here :</p>
<ul>
<li>Possible forgetting to close the file handle.</li>
<li>File read data exception occurred and nothing was done about it.</li>
</ul>
<p>Enhanced code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">try</span><span class="p">:</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;xxx&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s1">&#39;fail to open&#39;</span>
    <span class="n">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">do</span> <span class="n">something</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">do</span> <span class="n">something</span>
<span class="k">finally</span><span class="p">:</span>
     <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Although this code works well, it is too long. with, in addition to having a more elegant syntax, also does a good job of handling exceptions generated by the contextual environment.</p>
<p>The with version of the code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;/tmp/foo.txt&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>The workflow of with.</p>
<ul>
<li>After the statement immediately following with is evaluated, the <code>__enter__()</code> method of the returned object is called, and the return value of this method will be assigned to the variable following as.</li>
<li>When the block of code following the with has all been executed, the <code>__exit__()</code> method of the preceding return object is called.</li>
</ul>
<p>Sometimes you may want to read a file and write to another file at the same time. If you use the example shown when learning how to write to a file, it can actually be merged into the following.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">d_path</span> <span class="o">=</span> <span class="s1">&#39;dog_breeds.txt&#39;</span>
<span class="n">d_r_path</span> <span class="o">=</span> <span class="s1">&#39;dog_breeds_reversed.txt&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">d_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">d_r_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
    <span class="n">dog_breeds</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">dog_breeds</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="text-reading-the-difference-between-read-readline-readlines">Text reading: the difference between read(), readline(), readlines()</h3>
<p><strong>read()</strong></p>
<p>read() is the simplest way to read all the contents of a file at once in one big string, i.e., in memory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;test.txt&#39;</span><span class="p">)</span> 
<span class="k">try</span><span class="p">:</span>
    <span class="n">file_context</span> <span class="o">=</span> <span class="n">file_object</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> 
    <span class="n">file_context</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>   <span class="o">//</span> <span class="n">file_context是一个list</span><span class="err">，</span><span class="n">每行文本内容是list中的一个元素</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">file_object</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Advantages of read().</p>
<ul>
<li>Convenient and simple</li>
<li>Reads the file in one big string at a time, fastest</li>
</ul>
<p>Disadvantages of read().</p>
<ul>
<li>When the file is too large, it will take up too much memory</li>
</ul>
<p><strong>readline()</strong></p>
<p>readline() reads text line by line, the result is a list</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>Advantages of readline().</p>
<ul>
<li>Small memory footprint, read line by line</li>
</ul>
<p>Disadvantages of readline().</p>
<ul>
<li>Slower because it reads line by line</li>
</ul>
<p><strong>readlines()</strong></p>
<p>readlines() reads all the contents of the text at once, the result is a list</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>This method reads text with a &lsquo;\n&rsquo; line break at the end of each line (you can use L.rstrip('\n&rsquo;) to remove the line break)</p>
<p>Advantages of readlines().</p>
<ul>
<li>Reads text content in one go, faster</li>
</ul>
<p>Disadvantages of readlines().</p>
<ul>
<li>As the text grows, it takes up more and more memory</li>
</ul>
<h3 id="text-writing-write-and-writelines">Text writing: write() and writelines()</h3>
<ul>
<li>write() is passed a string</li>
<li>writelines() passes in an array</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;line1&#39;</span><span class="p">,</span> <span class="s1">&#39;line2&#39;</span><span class="p">]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;filename.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span>

<span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;line1&#39;</span><span class="p">,</span> <span class="s1">&#39;line2&#39;</span><span class="p">]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;filename.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">l</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10/python-pickle/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Python object persistence storage tool pickle</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10/jupyterlab-hive/">
            <span class="next-text nav-default">JupyterLab HIVE Data Synchronization Process</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
