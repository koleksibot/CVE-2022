<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Using the Python Logging Module - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="logging module is a standard module built in Python, mainly used for outputting runtime logs, you can set the output log level, log save path, log file rollback, etc. Compared with print, it has the following advantages. you can set different logging levels to output only important information in the release version without having to display a lot of debugging information print outputs all the information to the standard output," /><meta name="keywords" content="python, Logging" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-10/python-logging/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Using the Python Logging Module" />
<meta property="og:description" content="logging module is a standard module built in Python, mainly used for outputting runtime logs, you can set the output log level, log save path, log file rollback, etc. Compared with print, it has the following advantages. you can set different logging levels to output only important information in the release version without having to display a lot of debugging information print outputs all the information to the standard output," />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-10/python-logging/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-27T22:36:26+08:00" />
<meta property="article:modified_time" content="2021-10-27T22:36:26+08:00" />

<meta itemprop="name" content="Using the Python Logging Module">
<meta itemprop="description" content="logging module is a standard module built in Python, mainly used for outputting runtime logs, you can set the output log level, log save path, log file rollback, etc. Compared with print, it has the following advantages. you can set different logging levels to output only important information in the release version without having to display a lot of debugging information print outputs all the information to the standard output,"><meta itemprop="datePublished" content="2021-10-27T22:36:26+08:00" />
<meta itemprop="dateModified" content="2021-10-27T22:36:26+08:00" />
<meta itemprop="wordCount" content="4647">
<meta itemprop="keywords" content="python," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using the Python Logging Module"/>
<meta name="twitter:description" content="logging module is a standard module built in Python, mainly used for outputting runtime logs, you can set the output log level, log save path, log file rollback, etc. Compared with print, it has the following advantages. you can set different logging levels to output only important information in the release version without having to display a lot of debugging information print outputs all the information to the standard output,"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Using the Python Logging Module</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-27 22:36:26 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 4647 words </span>
          <span class="more-meta"> 10 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#components-of-the-logging-module">Components of the logging module</a></li>
        <li><a href="#logrecord">LogRecord</a>
          <ul>
            <li><a href="#logger">Logger</a></li>
            <li><a href="#handler">handler</a></li>
            <li><a href="#filter">Filter</a></li>
            <li><a href="#formatter">Formatter</a></li>
          </ul>
        </li>
        <li><a href="#configuration-of-the-logging-module">Configuration of the logging module</a>
          <ul>
            <li><a href="#basic-configuration-basicconfig">Basic configuration basicConfig</a></li>
            <li><a href="#dictionary-configuration-dictconfig">Dictionary configuration dictConfig</a></li>
            <li><a href="#file-configuration-fileconfig">File configuration fileConfig</a></li>
          </ul>
        </li>
        <li><a href="#example-of-logging-module-usage">Example of logging module usage</a>
          <ul>
            <li><a href="#basic-use">Basic Use</a></li>
            <li><a href="#custom-logger">Custom logger</a></li>
            <li><a href="#problems-in-practice">Problems in practice</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>logging module is a standard module built in Python, mainly used for outputting runtime logs, you can set the output log level, log save path, log file rollback, etc. Compared with print, it has the following advantages.</p>
<ul>
<li>you can set different logging levels to output only important information in the release version without having to display a lot of debugging information</li>
<li>print outputs all the information to the standard output, which seriously affects the developer&rsquo;s ability to view other data from the standard output; logging allows the developer to decide where and how to output the information.</li>
</ul>
<p>The main advantages of the logging module are.</p>
<ul>
<li>Support for multiple threads</li>
<li>Classification of logging by different levels</li>
<li>Flexibility and configurability</li>
<li>Separation of how logging is done from what is logged</li>
</ul>
<h2 id="components-of-the-logging-module">Components of the logging module</h2>
<p>The logging library is modular in design, with four main components of the logging module:</p>
<table>
<thead>
<tr>
<th>Component name</th>
<th>corresponding class name</th>
<th>function description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logger</td>
<td>Logger</td>
<td>exposes functions to the application that determine which logs are valid based on logger and filter levels</td>
</tr>
<tr>
<td>Handler</td>
<td>Handler</td>
<td>sends log records created by the logger to the appropriate destination output</td>
</tr>
<tr>
<td>Filter</td>
<td>Filter</td>
<td>provides more granular control tools to determine which log records to output and which to discard</td>
</tr>
<tr>
<td>Formatter</td>
<td>Formatter</td>
<td>determines the final output format of the log records</td>
</tr>
</tbody>
</table>
<p>Log event information is passed between Logger, Handler, Filter, Formatter in the form of LogRecord instances.</p>
<p>The official logging module workflow diagram is as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/27/2514085f7832471db053b438fbb1e7c2.png" alt=""></p>
<p>The entire workflow of logging.</p>
<ul>
<li>Determine whether the Logger object is available for the set level, if so, execute downward, otherwise, the process ends.</li>
<li>Create LogRecord object, if the Filter object registered to Logger object returns False after filtering, no logging is done and the process is finished, otherwise, the process is executed downward.</li>
<li>If the log level of the Handler object is larger than the set log level, then judge whether the Filter object registered to the Handler object returns True after filtering and release the output log information, otherwise, the process ends.</li>
<li>If the incoming Handler is greater than the level set in the Logger, that is, the Handler is valid, the process is executed downward, otherwise, the process ends.</li>
<li>Determine if this Logger object has a parent Logger object, if not (which means the current Logger object is the top Logger object root Logger), the process ends. Otherwise, set the Logger object as its parent Logger object, repeat steps 3 and 4 above, and output the log output from the parent Logger object until it is the root Logger.</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/27/6b978c5924994f93aeadbb3eea33860e.png" alt=""></p>
<p>Association between components.</p>
<ul>
<li>The logger (logger) needs to output the log information to the target location through the processor (handler)</li>
<li>Different processors (handlers) can output logs to different locations</li>
<li>The logger can set multiple handlers to output the same log record to different locations</li>
<li>Each handler can set its own filter to filter the logs so that only the logs of interest are retained</li>
<li>Each handler can set its own formatter to output the same log in different formats to different locations</li>
</ul>
<p>For a log message to be finalized, it needs to be filtered in the following order.</p>
<ul>
<li>Logger level filtering</li>
<li>Logger&rsquo;s filter filtering</li>
<li>Logger&rsquo;s processor level filtering</li>
<li>Filtering by the logger&rsquo;s processor</li>
</ul>
<p>In summary: the logger is the entry point, and the real work is done by the handler, which can also filter and format the log content to be output through the filter and formatter. A Logger can contain one or more Handlers and Filters, and a Logger has a one-to-many relationship with a Handler or Fitler. A Logger instance can add multiple Handlers, and a Handler can add multiple formatters or multiple filters, and the logging level will be inherited.</p>
<h2 id="logrecord">LogRecord</h2>
<p>Logger creates LogRecord instances each time it records a log. These properties of LogRecord are used to merge log data records into formatted strings. The following table lists the common property names.</p>
<table>
<thead>
<tr>
<th>property name</th>
<th>format</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>args</td>
<td>No formatting of args</td>
<td>argument tuple, will be merged into msg to produce message</td>
</tr>
<tr>
<td>asctime</td>
<td>%(asctime)s</td>
<td>Time when LogRecord was created, default form is 2003-07-08 16:49:45,896</td>
</tr>
<tr>
<td>filename</td>
<td>%(filename)s</td>
<td>the filename part of pathname</td>
</tr>
<tr>
<td>funcName</td>
<td>%(funcName)s</td>
<td>the name of the function where the log call was made</td>
</tr>
<tr>
<td>levelname</td>
<td>%(levelname)s</td>
<td>the level name of the message DEBUG, INFO, WARNING, ERROR, CRITICAL</td>
</tr>
<tr>
<td>lineno</td>
<td>%(lineno)d</td>
<td>the source line number where the log call was made (if available)</td>
</tr>
<tr>
<td>module</td>
<td>%(module)s</td>
<td>module (the name part of the file name)</td>
</tr>
<tr>
<td>msecs</td>
<td>%(msecs)d</td>
<td>the millisecond portion of the LogRecord creation time</td>
</tr>
<tr>
<td>message</td>
<td>%(message)s</td>
<td>Log message, the result of the calculation of msg % args. This property is set when Formatter.format() is called.</td>
</tr>
<tr>
<td>msg</td>
<td>No formatting required for msg</td>
<td>The original formatted string passed in during the log call, and merged with args to produce either a message or an arbitrary object (see Using Arbitrary Objects as Messages)</td>
</tr>
<tr>
<td>name</td>
<td>%(name)s</td>
<td>the name of the logger that records the log</td>
</tr>
<tr>
<td>pathname</td>
<td>%(pathname)s</td>
<td>the full pathname of the file where the log call was made (if available)</td>
</tr>
<tr>
<td>process</td>
<td>%(process)d</td>
<td>process ID (if available)</td>
</tr>
<tr>
<td>processName</td>
<td>%(processName)s</td>
<td>process name (if available)</td>
</tr>
<tr>
<td>thread</td>
<td>%(thread)d</td>
<td>thread ID (if available)</td>
</tr>
<tr>
<td>threadName</td>
<td>%(threadName)s</td>
<td>thread name (if available)</td>
</tr>
</tbody>
</table>
<h3 id="logger">Logger</h3>
<p>The Logger object is the most commonly used object in the logging library. The Logger object serves three main purposes.</p>
<ul>
<li>Expose info, warning, error and other methods for the application, through which the application can create the corresponding level of logging.</li>
<li>Determine which logs can be passed to the next process based on the Filter and logging level settings.</li>
<li>Passing logs to all relevant Handlers.</li>
</ul>
<p>Loggers are never instantiated directly, but are often obtained through the module-level function logging.getLogger(name), where root is used if name is not given. each instance has a name, and they are conceptually organized into a hierarchical namespace, using dots(periods) as a separator. For example, &lsquo;scan&rsquo; is the parent Logger of &lsquo;scan.text&rsquo; , &lsquo;scan.html&rsquo;, &lsquo;scan.pdf The name of the logger can be arbitrarily named to indicate the part of the application where the logged information is generated. This naming scheme, the back of the loggers is the front logger of the child logger, automatically inherit the log information of the parent loggers, because of this, there is no need to configure all the loggers of an application once, as long as the top-level logger is configured, and then the child loggers inherit the line as needed.</p>
<p>A good habit of naming Logger is to use module-level logger, and use logging in each module, the command is as follows: logger = logging.getLogger(<code>__name__</code>)</p>
<p>If you add a Handler to a Logger and one or more of its ancestors, it may be printed multiple times with the same records. In general, you should not add a Handler to more than one Logger. If you add a Handler to only the appropriate Logger and it is an elder in the Logger hierarchy, then it will see all events logged by the child Loggers.</p>
<p>The most common methods of Logger objects are divided into two categories: configuration methods and message sending methods</p>
<p>The most common configuration methods are as follows.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-Logger.setLevel()</td>
<td>-sets the minimum severity level of log messages that the logger will process</td>
</tr>
<tr>
<td>Logger.addHandler() and Logger.removeHandler()</td>
<td>add and remove a handler object for this logger object</td>
</tr>
<tr>
<td>Logger.addFilter() and Logger.removeFilter()</td>
<td>add and remove a filter object for the logger object</td>
</tr>
</tbody>
</table>
<p>Note on the Logger.setLevel() method: The lowest level of the built-in levels is DEBUG, and the highest level is CRITICAL. e.g. setLevel(<code>logging.INFO</code>), where the function argument is INFO, then the logger will only handle INFO, WARNING, ERROR and CRITICAL level logging, and DEBUG level messages will be ignored/discarded.</p>
<p>logger.setLevel(logging.ERROR) # Set the logging level to ERROR, i.e. only logs with a logging level greater than or equal to ERROR will be output. Note that the root logger will always have an explicit level setting (default is WARNING).</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/27/1a0031cd4ef24c8c92cdd2a3bdaf4223.png" alt=""></p>
<p>Log level (from highest to lowest).</p>
<table>
<thead>
<tr>
<th>level</th>
<th>value</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>CRITICAL</td>
<td>50</td>
<td>The message logged when a serious error occurs that prevents the application from continuing to run</td>
</tr>
<tr>
<td>ERROR</td>
<td>40</td>
<td>The message logged when some function does not work properly due to a more serious problem</td>
</tr>
<tr>
<td>WARNING</td>
<td>30</td>
<td>The message logged when something undesirable happens (e.g., low disk free space), but the application is still running normally</td>
</tr>
<tr>
<td>INFO</td>
<td>20</td>
<td>Second only to DEBUG in terms of detail, usually only key node information is logged to confirm that everything is working as we expect</td>
</tr>
<tr>
<td>DEBUG</td>
<td>10</td>
<td>The most detailed logging information, typically used for problem diagnosis</td>
</tr>
<tr>
<td>NOTSET</td>
<td>0</td>
<td></td>
</tr>
</tbody>
</table>
<p>Once the logger object is configured, logging can be created using the following methods.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Logger.debug(msg, *arg, **kwargs), Logger.info(msg, *arg, **kwargs), Logger.warning(msg, *arg, **kwargs), Logger.error(msg, *arg, **kwargs), Logger.critical(msg, *arg, **kwargs)</code></td>
<td>create a log record with the level corresponding to their method name</td>
</tr>
<tr>
<td><code>Logger.exception(msg, *arg, **kwargs)</code></td>
<td>creates a log message similar to Logger.error()</td>
</tr>
<tr>
<td><code>Logger.log(level, msg, *arg, **kwargs)</code></td>
<td>need to get an explicit log level parameter to create a log record</td>
</tr>
</tbody>
</table>
<p>The four keyword arguments exc_info, stack_info, stacklevel and extra are checked in kwargs .</p>
<ul>
<li>If the exc_info parameter does not evaluate to False, the exception information is added to the log message, usually by passing in a tuple (similar in format to what exc_info() returns) or an exception instance; otherwise, sys.exc_info() is called on its own to get the exception information.</li>
<li>The value of stack_info defaults to False; if it is True, stack information is added to the log message, including the process where logging is called. Unlike exc_info, which records the stack frame from the bottom of the stack to the logging call in the current thread, the latter is the exception trace when searching for exception handlers.</li>
<li>stacklevel defaults to 1, if greater than 1, the log event will skip the corresponding number of line numbers and function names when generating LogRecord, stack frame creation.</li>
<li>extra is a reserved keyword argument to pass a dictionary that can be populated into LogRecord&rsquo;s <code>__dict__</code> for subsequent use of these user-defined attributes. For example, if fmt='%(asctime)-15s %(clientip)s %(user)-8s %(message)s&rsquo; is defined in the formatter, then you can pass in: warning( &ldquo;Problem: %s&rdquo;, &ldquo;connection timeout&rdquo;, extra={&lsquo;clientip&rsquo;: &lsquo;192.168.0.1&rsquo;, &lsquo;user&rsquo;: &lsquo;fbloggs&rsquo;}).</li>
</ul>
<p>Description.</p>
<ul>
<li>The difference between exception() and Logger.error() is that <code>Logger.exception()</code> will output stack trace information, plus usually just call the method in an exception handler.</li>
<li>log() is not as convenient compared to <code>Logger.debug()</code> and <code>Logger.info()</code>, although it needs to pass one more level parameter, but when you need to log a custom level, you still need this method to do it.</li>
</ul>
<h3 id="handler">handler</h3>
<p>The role of the Handler object is to distribute messages (based on the level of the log message) to the location specified by the handler (file, network, mail, etc.). the Logger object can add zero or more Handler objects to itself via the addHandler() method. For example, an application may want to implement several logging requirements as follows.</p>
<ul>
<li>Send all logs to a log file</li>
<li>Send all logs with severity level greater than or equal to error to stdout (standard output)</li>
<li>Send all logs with a severity level of critical to an email address</li>
</ul>
<p>This scenario requires 3 different handlers, each of which sends a log of a specific severity level to a specific location.</p>
<p>There are only a very few methods in a handler that the application developer needs to care about. For application developers using the built-in handler object, it seems that the only relevant handler methods are the following configuration methods.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Handler.setLevel()</td>
<td>Sets the minimum severity level of log messages that the handler will handle</td>
</tr>
<tr>
<td>Handler.setFormatter()</td>
<td>set a formatter object for the handler</td>
</tr>
<tr>
<td>Handler.addFilter() and Handler.removeFilter()</td>
<td>add and remove a filter object for the handler</td>
</tr>
</tbody>
</table>
<p>It is important to note that application code should not instantiate and use Handler instances directly. Because Handler is a base class, it only defines the interface that all handlers should have, and provides some default behavior that subclasses can use directly or override. Here are some commonly used Handlers.</p>
<table>
<thead>
<tr>
<th>handler(handler)</th>
<th>class defination(type definition)</th>
<th>package(package location)</th>
<th>describe(description)</th>
</tr>
</thead>
<tbody>
<tr>
<td>StreamHandler</td>
<td>StreamHandler(stream=None)</td>
<td>logging</td>
<td>output LogRecord to a stream like sys.stdout, sys.stderr, or any file-like object</td>
</tr>
<tr>
<td>FileHandler</td>
<td>FileHandler(filename, mode=&lsquo;a&rsquo;, encoding=None, delay=False)</td>
<td>logging</td>
<td>Inherits the StreamHandler output function to output LogRecord to a hard drive file</td>
</tr>
<tr>
<td>NullHandler</td>
<td>NullHandler</td>
<td>logging</td>
<td>A new handler added to Python 3.1 that does not do any formatting or output operations, it is essentially a &ldquo;null operation&rdquo; for library developers to use</td>
</tr>
<tr>
<td>WatchedFileHandler</td>
<td>WatchedFileHandler(filename, mode=&lsquo;a&rsquo;, encoding=None, delay=False)</td>
<td>logging.handlers</td>
<td>Similar to FileHandler, which can only be used under Unix/Linux to monitor the closing and reopening of logs when log files are changed due to log rotation by programs such as newsyslog or logrotation</td>
</tr>
<tr>
<td>RotatingFileHandler</td>
<td>RotatingFileHandler(filename, mode=&lsquo;a&rsquo;, maxBytes=0, backupCount=0, encoding=None, delay=False)</td>
<td>logging. False)</td>
<td>logging.handlers</td>
</tr>
<tr>
<td>TimedRotatingFileHandler</td>
<td>TimedRotatingFileHandler(filename, when=&lsquo;h&rsquo;, interval=1, backupCount=0, encoding= None, delay=False, utc=False, atTime=None)</td>
<td>logging.handlers</td>
<td>subclass of BaseRotatingHandler, rotates logs based on time. when specifies the interval type, interval specifies the interval time, and the rotated old log files are appended with The extension depends on the rotation interval, generally %Y-%m-%d_%H:%M:%S is used. backupCount is not 0, then only backupCount old log files are saved at most</td>
</tr>
<tr>
<td>SocketHandler</td>
<td>SocketHandler(host, port)</td>
<td>logging.handlers</td>
<td>outputs LogRecord to a network socket, the default is a TCP socket, if the port is not set then a Unix domain socket is used</td>
</tr>
<tr>
<td>DatagramHandler</td>
<td>DatagramHandler(host, port)</td>
<td>logging.handlers</td>
<td>Inherits from SocketHandler output function, the default is to use a UDP socket, if not set the port will use a Unix domain socket</td>
</tr>
<tr>
<td>SysLogHandler</td>
<td>SysLogHandler(address=(&lsquo;localhost&rsquo;, SYSLOG_UDP_PORT), facility=LOG_USER, socktype=socket. DGRAM)</td>
<td>logging.handlers</td>
<td>exports LogRecord to the remote or local Unxi system log (Unix syslog). If address is not set, the default is (&lsquo;localhost&rsquo;, 514); the default is a UDP socket, if you want to use a TCP socket (not supported by Windows), you need to set the socktype to socket.SOCK_STREAM</td>
</tr>
<tr>
<td>NTEventLogHandler</td>
<td>NTEventLogHandler(appname, dllname=None, logtype=&lsquo;Application&rsquo;)</td>
<td>logging.handlers</td>
<td>support output LogRecord to the local Windows NT, Windows 2000, or Windows XP event log, provided you have the Win32 extension for Python installed; appname will be shown in the event log, provided you create an appropriate registry entry with that name; dllname should give the .dll or .dll name that defines the log message dll or .exe that defines the log message, the default is win32service.pyd; logtype can be Application, System, and Security</td>
</tr>
<tr>
<td>SMTPHandler</td>
<td>SMTPHandler(mailhost, fromaddr, toaddrs, subject, credentials=None, secure=None, timeout=1.0)</td>
<td>logging.handlers</td>
<td>output via SMTP protocol LogRecord to a specified set of email addresses; supports the use of the security protocol TLS and requires identity credentials</td>
</tr>
<tr>
<td>MemoryHandler</td>
<td>MemoryHandler(capacity, flushLevel=ERROR, target=None, flushOnClose=True)</td>
<td>logging.handlers</td>
<td>is a more general implementation of BufferingHandler that allows buffer the LogRecord into memory, and when the buffer size specified by capacity is exceeded, the log will be flushed to target</td>
</tr>
<tr>
<td>HTTPHandler</td>
<td>HTTPHandler(host, url, method=&lsquo;GET&rsquo;, secure=False, credentials=None, context=None)</td>
<td>logging. handlers</td>
<td>supports exporting LogRecord to a web server, supports GET and POST methods, and when using HTTPS connections, the secure, credentials, and context parameters need to be specified</td>
</tr>
<tr>
<td>QueueHandler</td>
<td>QueueueHandler(queue)</td>
<td>logging.handlers</td>
<td>supports exporting LogRecord to queues, such as those implemented in queue and multiprocessing. Logging can work in a separate thread, which is beneficial in some web applications where the client thread needs to respond as quickly as possible and any potentially slow operations can be done on a separate thread. Its enqueue(record) method uses the queue&rsquo;s put_nowait() method by default, but you can of course override this behavior</td>
</tr>
<tr>
<td>QUeueListener</td>
<td>QueueueListener(queue, *handlers, respect_handler_level=False)</td>
<td>logging.handlers</td>
<td>This is not actually a handler but needs to work with the QueueHandler. The dequeue(block) method calls the queue&rsquo;s get() method by default, but you can override this behavior</td>
</tr>
</tbody>
</table>
<h3 id="filter">Filter</h3>
<p>Filter actually complements logger.level by providing a more granular tool for determining which LogRecord to output. Multiple filters can be applied to both logger and handler. Users can declare their own filter as an object, use the filter method to get LogRecord as input, and provide True/False as output. filter can be used by Handler and Logger for more granular and complex filtering than level. filter is a filter base class that only allows log events under a certain logger level to pass the filter. The class is defined as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">class</span> <span class="nc">Filter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="s2">&#34;&#34;&#34;
</span><span class="s2">        Return a value indicating true if the record is to be
</span><span class="s2">        processed.  Possibly modify the record, if deemed
</span><span class="s2">        appropriate by the filter.
</span><span class="s2">        &#34;&#34;&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>For example, if a filter is instantiated with a name parameter value of &lsquo;A.B&rsquo; passed in, then that filter instance will only allow log records generated by loggers with names similar to the following rules to pass the filter: &lsquo;A.B&rsquo;, &lsquo;A.B &lsquo;A.B,C&rsquo;, &lsquo;A.B.C.D&rsquo;, &lsquo;A.B.D&rsquo;, and loggers with names &lsquo;A.BB &lsquo;, &lsquo;B.A.B&rsquo; loggers generate logs that are filtered out. If the value of name is an empty string, then all log events are allowed to pass the filter.</p>
<p>The filter method is used to specifically control whether the passed record can pass the filter, if the method returns a value of 0 means it cannot pass the filter, a non-zero return value means it can pass the filter.</p>
<p>Description.</p>
<ul>
<li>The record can also be changed inside the filter(record) method if needed, such as adding, removing or modifying some properties.</li>
<li>We can also do some statistical work with filter, for example, we can count the number of records processed by a special logger or handler, etc.</li>
</ul>
<h3 id="formatter">Formatter</h3>
<p>The Formater object is used to configure the final order, structure and content of log messages. Unlike the logging.Handler base class, application code can instantiate the Formatter class directly. Alternatively, if your application requires some special processing behavior, a subclass of Formatter can be implemented to accomplish this.</p>
<p>The constructor method of the Formatter class is defined as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;%&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>As can be seen, the constructor takes 3 optional parameters.</p>
<ul>
<li>fmt: specifies the message formatting string, if this parameter is not specified then the original value of message is used by default</li>
<li>datefmt: specifies the date formatting string, or &ldquo;%Y-%m-%d %H:%M:%S&rdquo; if not specified.</li>
<li>style: new parameter in Python 3.2, can take the values of &lsquo;%&rsquo;, &lsquo;{&rsquo; and &lsquo;$&rsquo;, if not specified, the default is &lsquo;%&rsquo;</li>
</ul>
<p>formatter specifies the form of the final output of the LogRecord. If not provided, the default is to use &lsquo;%(message)s&rsquo;, a value that contains only the messages passed in when LogRecord is called. The general formatter is provided by the logging library and is constructed as <code>ft = logging.Formatter.__init__(fmt=None, datefmt=None, style='%')</code>, and then placeholders can be used in a LogRecord declare all attributes in a LogRecord; if datafmt is not specified it defaults to the %Y-%m-%d %H:%M:%S style.</p>
<table>
<thead>
<tr>
<th>field/property name</th>
<th>usage format</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>asctime</td>
<td>%(asctime)s</td>
<td>the time when the log event occurred-human readable time, e.g., 2003-07-08 16:49:45,896</td>
</tr>
<tr>
<td>created</td>
<td>%(created)f</td>
<td>the time of the log event - the timestamp, which is the value returned by the call to the time.time() function at that time</td>
</tr>
<tr>
<td>relativeCreated</td>
<td>%(relativeCreated)d</td>
<td>the relative number of milliseconds between the time the logging event occurred and the time the logging module loaded (not sure what this is for yet)</td>
</tr>
<tr>
<td>msecs</td>
<td>%(msecs)d</td>
<td>the millisecond portion of the logging event occurrence event</td>
</tr>
<tr>
<td>levelname</td>
<td>%(levelname)s</td>
<td>the log level in text form (&lsquo;DEBUG&rsquo;, &lsquo;INFO&rsquo;, &lsquo;WARNING&rsquo;, &lsquo;ERROR&rsquo;, &lsquo;CRITICAL&rsquo;) of this log</td>
</tr>
<tr>
<td>levelno</td>
<td>%(levelno)s</td>
<td>the log level in numeric form for this log entry (10, 20, 30, 40, 50)</td>
</tr>
<tr>
<td>name</td>
<td>%(name)s</td>
<td>the name of the logger used, the default is &lsquo;root&rsquo; because the default is rootLogger</td>
</tr>
<tr>
<td>message</td>
<td>%(message)s</td>
<td>The text content of the log entry, as computed by msg % args</td>
</tr>
<tr>
<td>pathname</td>
<td>%(pathname)s</td>
<td>the full path to the source file where the logging function was called</td>
</tr>
<tr>
<td>filename</td>
<td>%(filename)s</td>
<td>the filename part of pathname, including the file suffix</td>
</tr>
<tr>
<td>module</td>
<td>%(module)s</td>
<td>the name part of filename, without the suffix</td>
</tr>
<tr>
<td>lineno</td>
<td>%(lineno)d</td>
<td>The line number of the source code where the logging function is called</td>
</tr>
<tr>
<td>funcName</td>
<td>%(funcName)s</td>
<td>the name of the function that called the logging function</td>
</tr>
<tr>
<td>process</td>
<td>%(process)d</td>
<td>process ID</td>
</tr>
<tr>
<td>processName</td>
<td>%(processName)s</td>
<td>process name, new in Python 3.1</td>
</tr>
<tr>
<td>thread</td>
<td>%(thread)d</td>
<td>thread ID</td>
</tr>
<tr>
<td>threadName</td>
<td>%(thread)s</td>
<td>thread name</td>
</tr>
</tbody>
</table>
<h2 id="configuration-of-the-logging-module">Configuration of the logging module</h2>
<p>The main benefit of a logging system such as this is that it is possible to control the amount and content of logging output obtained from an application without having to change the source code of that application. Therefore, while it is possible to perform configuration via the logging API, it must also be possible to change the logging configuration without changing the application at all. For long-running applications like Zope, it should be possible to change the logging configuration while the application is running.</p>
<p>The configuration includes the following.</p>
<ul>
<li>The level of logging that the logger or handler should be interested in.</li>
<li>Which handlers should be attached to which loggers.</li>
<li>Which filters should be attached to which handlers and loggers.</li>
<li>Specify properties specific to certain handlers and filters.</li>
</ul>
<p>In general, each application has its own requirements for how users configure logging output. However, each application will specify the required configuration for the logging system through a standard mechanism.</p>
<p>The simplest configuration is that of a single handler, which is written to stderr and connected to the root logger. This configuration is set by calling the basicConfig() function after importing the logging module.</p>
<h3 id="basic-configuration-basicconfig">Basic configuration basicConfig</h3>
<p>The following is the simplest setup.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&#34;INFO&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>This will build a base StreamHandler so that any LogRecord above the INFO level will be output on the console. Here are some parameters for the base setup.</p>
<table>
<thead>
<tr>
<th>parameter name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>filename</td>
<td>Specifies the filename of the log output target file. Specify this setting so that the log confidence will not be output to the console</td>
</tr>
<tr>
<td>filemode</td>
<td>Specifies the open mode of the log file, the default is &lsquo;a&rsquo;. Note that this option is only available when filename is specified</td>
</tr>
<tr>
<td>format</td>
<td>Specifies the log format string, which specifies the fields to be included in the log output and their order. logging module defined format fields are listed below.</td>
</tr>
<tr>
<td>datefmt</td>
<td>Specifies the date/time format. Note that this option is only valid if the format contains the time field %(asctime)s</td>
</tr>
<tr>
<td>level</td>
<td>Specifies the logging level of the logger</td>
</tr>
<tr>
<td>stream</td>
<td>Specifies the log output target stream, such as sys.stdout, sys.stderr, and network stream; note that stream and filename cannot be provided at the same time, otherwise a ValueError exception will be thrown</td>
</tr>
<tr>
<td>style</td>
<td>A new configuration item added in Python 3.2. Specifies the style of the format string, which can take the values &lsquo;%&rsquo;, &lsquo;{&rsquo;, and &lsquo;$&rsquo;, with the default being &lsquo;%&rsquo;</td>
</tr>
<tr>
<td>handlers</td>
<td>A new configuration item added in Python 3.3. If this option is specified, it should be an iterable object that creates multiple Handlers that will be added to the root logger. Otherwise, a ValueError exception will be thrown.</td>
</tr>
</tbody>
</table>
<h3 id="dictionary-configuration-dictconfig">Dictionary configuration dictConfig</h3>
<p>A dictionary can be used to describe the settings of the elements. This dictionary should consist of different parts, including logger, handler, formatter and some basic generic parameters. Code example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;formatters&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;short&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> </span><span class="si">%(levelname)s</span><span class="s1"> </span><span class="si">%(name)s</span><span class="s1">: </span><span class="si">%(message)s</span><span class="s1">&#39;</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;console&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
            <span class="s1">&#39;formatter&#39;</span><span class="p">:</span> <span class="s1">&#39;short&#39;</span><span class="p">,</span>
            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;logging.StreamHandler&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;console&#39;</span><span class="p">],</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;DEBUG&#39;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s1">&#39;plugins&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;console&#39;</span><span class="p">],</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;INFO&#39;</span><span class="p">,</span>
            <span class="s1">&#39;propagate&#39;</span><span class="p">:</span> <span class="kc">False</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">}</span>

<span class="kn">import</span> <span class="nn">logging.config</span>
<span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>When referenced, dictConfig will disable all running loggers unless disable_existing_loggers is set to False. This is usually required because many modules declare a global logger that will be instantiated when it is imported before dictConfig is called.</p>
<h3 id="file-configuration-fileconfig">File configuration fileConfig</h3>
<p>logging.conf is configured using pattern matching, with the regular expression r&rsquo;^[(. *)]$&rsquo;, thus matching all components. For multiple instances of the same component a comma &lsquo;,&rsquo; is used to separate them.</p>
<p>Configuration file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">#logger.conf
###############################################
[loggers]
keys=root,example01,example02
[logger_root]
level=DEBUG
handlers=hand01,hand02
[logger_example01]
handlers=hand01,hand02
qualname=example01
propagate=0
[logger_example02]
handlers=hand01,hand03
qualname=example02
propagate=0
###############################################
[handlers]
keys=hand01,hand02,hand03
[handler_hand01]
class=StreamHandler
level=INFO
formatter=form02
args=(sys.stderr,)
[handler_hand02]
class=FileHandler
level=DEBUG
formatter=form01
args=(&#39;myapp.log&#39;, &#39;a&#39;)
[handler_hand03]
class=handlers.RotatingFileHandler
level=INFO
formatter=form02
args=(&#39;myapp.log&#39;, &#39;a&#39;, 10*1024*1024, 5)
###############################################
[formatters]
keys=form01,form02
[formatter_form01]
format=%(asctime)s %(filename)s[line:%(lineno)d] %(levelname)s %(message)s
datefmt=%a, %d %b %Y %H:%M:%S
[formatter_form02]
format=%(name)-12s: %(levelname)-8s %(message)s
datefmt=
</code></pre></td></tr></table>
</div>
</div><p>Then use in the code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">logging.config</span>

<span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">fileConfig</span><span class="p">(</span><span class="s2">&#34;logger.conf&#34;</span><span class="p">)</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&#34;example01&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="example-of-logging-module-usage">Example of logging module usage</h2>
<h3 id="basic-use">Basic Use</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;This is a debug message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;This is an info message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;This is a warning message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;This is an error message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s1">&#39;This is a critical message&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Output results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">WARNING:root:This is a warning message
ERROR:root:This is an error message
CRITICAL:root:This is a critical message
</code></pre></td></tr></table>
</div>
</div><p>The default logging level for printing is WARNING, which is not output to a file, and the format is default. Of course, we can pass some parameters in basicConfig to customize it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&#34;test.log&#34;</span><span class="p">,</span>
                    <span class="n">filemode</span><span class="o">=</span><span class="s2">&#34;w&#34;</span><span class="p">,</span>
                    <span class="nb">format</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2">:</span><span class="si">%(levelname)s</span><span class="s2">:</span><span class="si">%(message)s</span><span class="s2">&#34;</span><span class="p">,</span>
                    <span class="n">datefmt</span><span class="o">=</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">,</span>
                    <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;This is a debug message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;This is an info message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;This is a warning message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;This is an error message&#39;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s1">&#39;This is a critical message&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>After running it, we can see the following in test.log.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">2021-07-08 18:48:43 root:DEBUG:This is a debug message
2021-07-08 18:48:43 root:INFO:This is an info message
2021-07-08 18:48:43 root:WARNING:This is a warning message
2021-07-08 18:48:43 root:ERROR:This is an error message
2021-07-08 18:48:43 root:CRITICAL:This is a critical message
</code></pre></td></tr></table>
</div>
</div><p>Note that at this point the output goes to the file, so the screen is not printing anything.</p>
<h3 id="custom-logger">Custom logger</h3>
<p>Code example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&#34;logger&#34;</span><span class="p">)</span>

<span class="n">handler1</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
<span class="n">handler2</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&#34;test.log&#34;</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="n">handler1</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>
<span class="n">handler2</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="n">formatter</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(name)s</span><span class="s2"> </span><span class="si">%(levelname)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&#34;</span><span class="p">)</span>
<span class="n">handler1</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>
<span class="n">handler2</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">formatter</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler1</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler2</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;This is a customer debug message&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;This is an customer info message&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;This is a customer warning message&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;This is an customer error message&#39;</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="s1">&#39;This is a customer critical message&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Console output results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">2021-07-08 18:45:46,879 logger WARNING This is a customer warning message
2021-07-08 18:45:46,879 logger ERROR This is an customer error message
2021-07-08 18:45:46,879 logger CRITICAL This is a customer critical message
</code></pre></td></tr></table>
</div>
</div><p>File output results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">2021-07-08 18:45:46,879 logger DEBUG This is a customer debug message
2021-07-08 18:45:46,879 logger INFO This is an customer info message
2021-07-08 18:45:46,879 logger WARNING This is a customer warning message
2021-07-08 18:45:46,879 logger ERROR This is an customer error message
2021-07-08 18:45:46,879 logger CRITICAL This is a customer critical message
</code></pre></td></tr></table>
</div>
</div><p>Note: If you create a custom Logger object, don&rsquo;t use the logging output methods in logging, they use the default Logger object and the output log messages will be duplicated.</p>
<h3 id="problems-in-practice">Problems in practice</h3>
<h4 id="chinese-messy-code-solution">Chinese messy code solution</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># 自定义 Logger 配置</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&#34;test.log&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>

<span class="c1"># 使用默认的 Logger 配置</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">handlers</span><span class="o">=</span><span class="p">[</span><span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s2">&#34;test.log&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)],</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="temporarily-disable-log-output">Temporarily disable log output</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">logging</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

<span class="n">logger</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="log-files-are-divided-by-time-or-by-size">Log files are divided by time or by size</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># 每隔 1000 Byte 划分一个日志文件，备份文件为 3 个</span>
<span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span><span class="s2">&#34;test.log&#34;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;w&#34;</span><span class="p">,</span> <span class="n">maxBytes</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>

<span class="c1"># 每隔 1小时 划分一个日志文件，interval 是时间间隔，备份文件为 10 个</span>
<span class="n">handler2</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">TimedRotatingFileHandler</span><span class="p">(</span><span class="s2">&#34;test.log&#34;</span><span class="p">,</span> <span class="n">when</span><span class="o">=</span><span class="s2">&#34;H&#34;</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="logging-json-logs">Logging JSON logs</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">logging.config</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ATTR_TO_JSON</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;created&#39;</span><span class="p">,</span> <span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;funcName&#39;</span><span class="p">,</span> <span class="s1">&#39;levelname&#39;</span><span class="p">,</span> <span class="s1">&#39;lineno&#39;</span><span class="p">,</span> <span class="s1">&#39;module&#39;</span><span class="p">,</span> <span class="s1">&#39;msecs&#39;</span><span class="p">,</span> <span class="s1">&#39;msg&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;pathname&#39;</span><span class="p">,</span> <span class="s1">&#39;process&#39;</span><span class="p">,</span> <span class="s1">&#39;processName&#39;</span><span class="p">,</span> <span class="s1">&#39;relativeCreated&#39;</span><span class="p">,</span> <span class="s1">&#39;thread&#39;</span><span class="p">,</span> <span class="s1">&#39;threadName&#39;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">JsonFormatter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="n">obj</span><span class="o">=</span><span class="p">{</span><span class="n">attr</span><span class="p">:</span><span class="nb">getattr</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">ATTR_TO_JSON</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

    <span class="n">handler</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
    <span class="n">handler</span><span class="o">.</span><span class="n">formatter</span><span class="o">=</span><span class="n">JsonFormatter</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&#34;Hello&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10/readability/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Readability, a web body extraction tool</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10/python-module-package-library-framework/">
            <span class="next-text nav-default">Python modules, packages, libraries, frameworks</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
