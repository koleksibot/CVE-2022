<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python JSON/JSONP Data Parsing - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="JSON Introduction JSON, JavaScript Object Natation, is a lightweight data interchange format that is ideal for server interaction with JavaScript. In ordinary Web applications, developers often struggle with XML parsing, either server-side generation or processing of XML, or client-side parsing of XML with JavaScript, often resulting in complex code and very low development efficiency. In fact, for most Web applications, many AJAX applications even return pieces of HTML directly to" /><meta name="keywords" content="python, Jsonp, json" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-10/python-json-jsonp/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python JSON/JSONP Data Parsing" />
<meta property="og:description" content="JSON Introduction JSON, JavaScript Object Natation, is a lightweight data interchange format that is ideal for server interaction with JavaScript. In ordinary Web applications, developers often struggle with XML parsing, either server-side generation or processing of XML, or client-side parsing of XML with JavaScript, often resulting in complex code and very low development efficiency. In fact, for most Web applications, many AJAX applications even return pieces of HTML directly to" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-10/python-json-jsonp/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-31T11:03:11+08:00" />
<meta property="article:modified_time" content="2021-10-31T11:03:11+08:00" />

<meta itemprop="name" content="Python JSON/JSONP Data Parsing">
<meta itemprop="description" content="JSON Introduction JSON, JavaScript Object Natation, is a lightweight data interchange format that is ideal for server interaction with JavaScript. In ordinary Web applications, developers often struggle with XML parsing, either server-side generation or processing of XML, or client-side parsing of XML with JavaScript, often resulting in complex code and very low development efficiency. In fact, for most Web applications, many AJAX applications even return pieces of HTML directly to"><meta itemprop="datePublished" content="2021-10-31T11:03:11+08:00" />
<meta itemprop="dateModified" content="2021-10-31T11:03:11+08:00" />
<meta itemprop="wordCount" content="3718">
<meta itemprop="keywords" content="python,json,jsonp," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python JSON/JSONP Data Parsing"/>
<meta name="twitter:description" content="JSON Introduction JSON, JavaScript Object Natation, is a lightweight data interchange format that is ideal for server interaction with JavaScript. In ordinary Web applications, developers often struggle with XML parsing, either server-side generation or processing of XML, or client-side parsing of XML with JavaScript, often resulting in complex code and very low development efficiency. In fact, for most Web applications, many AJAX applications even return pieces of HTML directly to"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python JSON/JSONP Data Parsing</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-31 11:03:11 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 3718 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#json-introduction">JSON Introduction</a></li>
        <li><a href="#difference-between-json-and-python-dictionary">Difference between JSON and Python dictionary</a></li>
        <li><a href="#python-standard-library-json-module">Python standard library JSON module</a>
          <ul>
            <li><a href="#json-string-to-python-dictionary">JSON string to Python dictionary</a></li>
            <li><a href="#python-dictionary-to-json-string">Python dictionary to JSON string</a></li>
            <li><a href="#python-json-data-beautification">Python JSON data beautification</a></li>
            <li><a href="#json-file-reading-and-writing">JSON file reading and writing</a></li>
            <li><a href="#difference-between-json-and-simplejson">Difference between json and simplejson</a></li>
            <li><a href="#other-json-parsing-tools">Other JSON parsing tools</a></li>
          </ul>
        </li>
        <li><a href="#python-and-jsonp">Python and JSONP</a>
          <ul>
            <li><a href="#jsonp-client-side-implementation">JSONP client-side implementation</a></li>
            <li><a href="#jquery-implementation-of-jsonp">jQuery implementation of JSONP</a></li>
            <li><a href="#similarities-and-differences-between-ajax-and-jsonp">Similarities and differences between ajax and jsonp</a></li>
            <li><a href="#python-with-jsonp">Python with JSONP</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/77c57e70c6e24ad09566a3caaeecde9a.png" alt=""></p>
<h2 id="json-introduction">JSON Introduction</h2>
<p>JSON, JavaScript Object Natation, is a lightweight data interchange format that is ideal for server interaction with JavaScript.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/2cb2d9fb5cde43b99e50b5090a296988.png" alt=""></p>
<p>In ordinary Web applications, developers often struggle with XML parsing, either server-side generation or processing of XML, or client-side parsing of XML with JavaScript, often resulting in complex code and very low development efficiency. In fact, for most Web applications, many AJAX applications even return pieces of HTML directly to build dynamic Web pages. Returning HTML fragments greatly reduces the complexity of the system compared to returning XML and parsing it, but lacks some flexibility.</p>
<p>JSON provides an alternative data interchange format for Web application developers. Like XML, JSON is a plain text-based data format. Because JSON is inherently intended for JavaScript, the JSON data format is very simple. You can use JSON to transfer a simple String, Number, Boolean, an array, or a complex Object object.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/b5bb8adaac9d40c696a969a91f6b2bf8.png" alt=""></p>
<p>The structure of JSON is based on the following two points</p>
<ul>
<li><strong>Collection of name/value pairs</strong> understood in different languages as object, record, structure, dictionary, hash table, keyed list, etc.</li>
<li><strong>ordered lists of values</strong> are understood as arrays in most languages</li>
</ul>
<p>JSON represents JavaScript objects as a specific string. If a string of this form is assigned to any JavaScript variable, the variable becomes an object reference, and the object is constructed from the string.</p>
<p>Suppose here that we need to create a User object with the following properties.</p>
<ul>
<li>User ID</li>
<li>User name</li>
<li>Website</li>
</ul>
<p>You can use the following JSON form to represent the User object.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;UserID&#34;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="nt">&#34;Name&#34;</span><span class="p">:</span><span class="s2">&#34;biaodianfu&#34;</span><span class="p">,</span> <span class="nt">&#34;website&#34;</span><span class="p">:</span><span class="s2">&#34;https://www.biaodianfu.com&#34;</span><span class="p">}</span><span class="err">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Then if this string is given to a JavaScript variable, then either property of the object can be used directly.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;script&gt;</span>
    var User = {&#34;UserID&#34;: 100, &#34;Name&#34;: &#34;biaodianfu&#34;, &#34;Website&#34;: &#34;https://www.biaodianfu.com&#34;};
    alert(User.Name);
<span class="nt">&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The actual use may be a little more complicated, for example, if we define a more detailed structure for Name, so that it has EnglishName and ChineseName.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;UserID&#34;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="nt">&#34;Name&#34;</span><span class="p">:{</span><span class="nt">&#34;EnglishName&#34;</span><span class="p">:</span><span class="s2">&#34;biaodianfu&#34;</span><span class="p">,</span><span class="nt">&#34;ChineseName&#34;</span><span class="p">:</span><span class="s2">&#34;标点符&#34;</span><span class="p">},</span> <span class="nt">&#34;Website&#34;</span><span class="p">:</span><span class="s2">&#34;https://www.biaofianfu.com&#34;</span><span class="p">}</span><span class="err">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Full code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;script&gt;</span>
    var User = {
        &#34;UserID&#34;: 100,
        &#34;Name&#34;: {&#34;EnglishName&#34;: &#34;biaodianfu&#34;, &#34;ChineseName&#34;: &#34;标点符&#34;},
        &#34;Website&#34;: &#34;https://www.biaofianfu.com&#34;
    };
    alert(User.Name.ChineseName);
<span class="nt">&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>If a page needs a list of users, not just a single user information, then you need to create a list of users array. The following code demonstrates the use of JSON to define this list of users.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;script&gt;</span>
    var UserList = [
        {
            &#34;UserID&#34;: 100,
            &#34;Name&#34;: {&#34;EnglishName&#34;: &#34;biaodianfu&#34;, &#34;ChineseName&#34;: &#34;标点符&#34;},
            &#34;Website&#34;: &#34;https://www.biaofianfu.com &#34;
        },
        {
            &#34;UserID&#34;: 101,
            &#34;Name&#34;: {&#34;EnglishName&#34;: &#34;biaodianfu&#34;, &#34;ChineseName&#34;: &#34;标点符&#34;},
            &#34;Website&#34;: &#34;https://www.biaofianfu.com &#34;
        },
        {
            &#34;UserID&#34;: 102,
            &#34;Name&#34;: {&#34;EnglishName&#34;: &#34;biaodianfu&#34;, &#34;ChineseName&#34;: &#34;标点符&#34;},
            &#34;Website&#34;: &#34;https://www.biaofianfu.com &#34;
        },
    ];
    alert(UserList[0].Name.ChineseName);
<span class="nt">&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>In addition to using the &ldquo;.&rdquo; reference attribute, the following statement can be used.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">alert</span><span class="p">(</span><span class="nx">UserList</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&#34;Name&#34;</span><span class="p">][</span><span class="s2">&#34;ChineseName&#34;</span><span class="p">]);</span>
<span class="nx">alert</span><span class="p">(</span><span class="nx">UserList</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">Name</span><span class="p">[</span><span class="s2">&#34;ChineseName&#34;</span><span class="p">]);</span>
</code></pre></td></tr></table>
</div>
</div><p>Some rules of JSON.</p>
<ul>
<li>An object is a collection of attribute and value pairs. An object starts with &ldquo;{&rdquo; and ends with &ldquo;}&rdquo;. Each attribute name and value is prompted with &ldquo;:&rdquo; and separated by &ldquo;,&rdquo; between attributes.</li>
<li>An array is an ordered collection of values. An array starts at &ldquo;[&rdquo; and ends at &ldquo;]&rdquo;, and values are separated by &ldquo;,&rdquo;.</li>
<li>Values can be quoted strings, numbers, true, false, null, or objects or arrays. All these structures can be nested.</li>
<li>Strings and numbers are defined in much the same way as in C or Java.</li>
</ul>
<p>Some advantages of JSON.</p>
<ul>
<li>JSON provides an excellent object-oriented method for caching metadata to clients.</li>
<li>JSON helps separate validation data from logic.</li>
<li>JSON helps provide the essence of Ajax for Web applications</li>
</ul>
<h2 id="difference-between-json-and-python-dictionary">Difference between JSON and Python dictionary</h2>
<p>JSON and Python dict is very similar, are stored in the form of key-value data, and json, dict can also be very convenient through dumps, loads for mutual conversion of the format.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/4d924f54862e47389459fcb7e2db0dad.png" alt=""></p>
<p>Since they are all in key-value format, why do they need format conversion?</p>
<ul>
<li>JSON (JavaScript Object Notation): json is a data format, which is a pure string. It can be parsed into Python&rsquo;s dict or other forms.</li>
<li>dict (dictionary): A dictionary is a complete data structure, an implementation of the data structure HashTable, a set of schemes that encapsulates everything from storage to extraction. It uses a built-in hash function to plan the storage location of the key corresponding to the value, so as to obtain a faster data reading speed.</li>
</ul>
<p>The difference between JSON and dict.</p>
<ul>
<li>json&rsquo;s key can only be a string, python&rsquo;s dict can be any hashable object.</li>
<li>json&rsquo;s key can be ordered and repeated, python&rsquo;s dict&rsquo;s key can&rsquo;t be repeated.</li>
<li>There is a default value undefined for json&rsquo;s key, and no default value for dict.</li>
<li>The value of json can only be a string, float, boolean, or null, or an array or object of them.</li>
<li>json can be accessed as [], or as . The value of a dict can only be accessed by the subscript [].</li>
<li>The string of json is forced to be double-quoted, and the string of dict can be single-quoted or double-quoted.</li>
<li>Only arrays are available in json, dict can nest tuples.</li>
<li>Chinese in json must be unicode encoding, such as &ldquo;hello&rdquo; in json should be &ldquo;\u4f60\u597d&rdquo;.</li>
<li>The data type of json is string (str), and the data type of dictionary is dictionary (dict).</li>
<li>json defines boolean and null values: true, false, null.</li>
<li>Python defines boolean and null values: True, False, None.</li>
</ul>
<h2 id="python-standard-library-json-module">Python standard library JSON module</h2>
<p>JSON data can be coded and decoded in Python using the json module, which contains two functions.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/2d2b0b4f66564c05b2d5e5ddb006d7f2.png" alt=""></p>
<h3 id="json-string-to-python-dictionary">JSON string to Python dictionary</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PY" data-lang="PY"><span class="c1"># Import the module</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># String with JSON format</span>
<span class="n">data_JSON</span> <span class="o">=</span> <span class="s2">&#34;&#34;&#34;
</span><span class="s2">{
</span><span class="s2">    &#34;size&#34;: &#34;Medium&#34;,
</span><span class="s2">    &#34;price&#34;: 15.67,
</span><span class="s2">    &#34;toppings&#34;: [&#34;Mushrooms&#34;, &#34;Extra Cheese&#34;, &#34;Pepperoni&#34;, &#34;Basil&#34;],
</span><span class="s2">    &#34;client&#34;: {
</span><span class="s2">        &#34;name&#34;: &#34;Jane Doe&#34;,
</span><span class="s2">        &#34;phone&#34;: &#34;455-344-234&#34;,
</span><span class="s2">        &#34;email&#34;: &#34;janedoe@email.com&#34;
</span><span class="s2">    }
</span><span class="s2">}
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="c1"># Convert JSON string to dictionary</span>
<span class="n">data_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data_JSON</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data_dict</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&#34;size&#34;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&#34;price&#34;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&#34;toppings&#34;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&#34;client&#34;</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><p>Output content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">&lt;class &#39;dict&#39;&gt;
Medium
15.67
[&#39;Mushrooms&#39;, &#39;Extra Cheese&#39;, &#39;Pepperoni&#39;, &#39;Basil&#39;]
{&#39;name&#39;: &#39;Jane Doe&#39;, &#39;phone&#39;: &#39;455-344-234&#39;, &#39;email&#39;: &#39;janedoe@email.com&#39;}
</code></pre></td></tr></table>
</div>
</div><p>Data type conversion in the JSON to Python dictionary process.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/84cccc00394748d99a46ccbe918a594f.png" alt=""></p>
<h3 id="python-dictionary-to-json-string">Python dictionary to JSON string</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># Import the module</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Python Dictionary</span>
<span class="n">client</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Nora&#34;</span><span class="p">,</span>
    <span class="s2">&#34;age&#34;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span>
    <span class="s2">&#34;id&#34;</span><span class="p">:</span> <span class="s2">&#34;45355&#34;</span><span class="p">,</span>
    <span class="s2">&#34;eye_color&#34;</span><span class="p">:</span> <span class="s2">&#34;green&#34;</span><span class="p">,</span>
    <span class="s2">&#34;wears_glasses&#34;</span><span class="p">:</span> <span class="kc">False</span>
<span class="p">}</span>

<span class="c1"># Get a JSON formatted string</span>
<span class="n">client_JSON</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">client_JSON</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">client_JSON</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Output content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">&lt;class &#39;str&#39;&gt;
{&#34;name&#34;: &#34;Nora&#34;, &#34;age&#34;: 56, &#34;id&#34;: &#34;45355&#34;, &#34;eye_color&#34;: &#34;green&#34;, &#34;wears_glasses&#34;: false}
</code></pre></td></tr></table>
</div>
</div><p>Data type conversion for Python dictionary to JSON.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/0c9b1de3264c48059be551278e65f56c.png" alt=""></p>
<h3 id="python-json-data-beautification">Python JSON data beautification</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">client_JSON</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">client_JSON</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Output content.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">{
    &#34;name&#34;: &#34;Nora&#34;,
    &#34;age&#34;: 56,
    &#34;id&#34;: &#34;45355&#34;,
    &#34;eye_color&#34;: &#34;green&#34;,
    &#34;wears_glasses&#34;: false
}
</code></pre></td></tr></table>
</div>
</div><h3 id="json-file-reading-and-writing">JSON file reading and writing</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># Open the orders.json file</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;orders.json&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="c1"># Load its content and make a new dictionary</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="c1"># Delete the &#34;client&#34; key-value pair from each order</span>
    <span class="k">for</span> <span class="n">order</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&#34;orders&#34;</span><span class="p">]:</span>
        <span class="k">del</span> <span class="n">order</span><span class="p">[</span><span class="s2">&#34;client&#34;</span><span class="p">]</span>

<span class="c1"># Open (or create) an orders_new.json file </span>
<span class="c1"># and store the new version of the data.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;orders_new.json&#34;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="difference-between-json-and-simplejson">Difference between json and simplejson</h3>
<p>We see many projects using the simplejson module instead of the json module in the standard library. Why use these alternatives instead of the alternatives in the standard library?</p>
<p>The json module in the Python standard library is actually simplejson, except that it is updated more slowly than the standalone simplejson. Both are similar in functionality, but simplejson is a bit better in performance.</p>
<p>It is recommended to use it like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">simplejson</span> <span class="k">as</span> <span class="nn">json</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">json</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="other-json-parsing-tools">Other JSON parsing tools</h3>
<ul>
<li><a href="https://github.com/python-rapidjson/python-rapidjson">python-rapidjson</a>: RapidJSON is an efficient C JSON parser and generator open source by Tencent. It is currently packaged as a Python library.</li>
<li><a href="https://github.com/ultrajson/ultrajson">ultrajson</a>: json parsing library written in C</li>
<li><a href="https://github.com/TkTech/pysimdjson">pysimdjson</a>: Python binding for the simdjson project, which is a SIMD-accelerated JSON parser. If no SIMD directive is available, a fallback parser is used so that pysimdjson is safe to use anywhere.</li>
<li><a href="https://github.com/ijl/orjson">orjson</a>: orjson is written in Rust language, no local Rust environment he will prompt you need Rust environment, installation is more troublesome, performance is said to be very fast.</li>
<li><a href="https://github.com/marshmallow-code/marshmallow">marshmallow</a>: marshmallow is an ORM/ODM/framework-agnostic library for converting complex datatypes, such as objects, to and from native Python datatypes.</li>
</ul>
<h2 id="python-and-jsonp">Python and JSONP</h2>
<p>JSONP (JSON with Padding) is a JSON &ldquo;usage pattern&rdquo; that allows web pages to request data from other web domains.</p>
<p>Due to the same-origin policy, web pages located at <code>server1.example.com</code> generally cannot communicate with servers that are not <code>server1.example</code>.com, with the exception of the <code>&lt;script&gt;</code> element in HTML. Using this open strategy of the <code>&lt;script&gt;</code> element, web pages can get JSON information dynamically generated from other sources, and this usage pattern is known as JSONP. The information captured with JSONP is not JSON, but arbitrary JavaScript, which is executed with a JavaScript translator instead of being parsed with a JSON parser.</p>
<p>To understand how this pattern works, imagine that there is a URL that returns a JSON file, and the Javascript program can use XMLHttpRequest to ask for information from this URL. Suppose our URL is <code>http://server2.example.com/RetrieveUser?UserId=xxx</code>. Suppose Ming&rsquo;s UserId is 1234, and when the browser passes Ming&rsquo;s UserId through the URL, that is, it crawls <code>http://server2.example.com/</code> RetrieveUser?UserId=1234, we get.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;Name&#34;</span><span class="p">:</span> <span class="s2">&#34;小明&#34;</span><span class="p">,</span> <span class="nt">&#34;Id&#34;</span><span class="p">:</span> <span class="mi">1823</span><span class="p">,</span> <span class="nt">&#34;Rank&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>This JSON information may be generated dynamically based on the query parameters passed to the URL.</p>
<p>In this case, it is conceivable to set the src attribute of the <code>&lt;script&gt;</code> element to a URL that returns the JSON, which means that it is possible to grab the JSON from the HTML page through the script element.</p>
<p>However, a JSON file is not a JavaScript program. In the JSONP usage model, the URL is a dynamically generated JSON wrapped in a function call, which is the &ldquo;padding&rdquo; or &ldquo;prepending&rdquo; of JSONP. &quot; or &ldquo;prefix&rdquo; in JSONP.</p>
<p>By convention, the browser provides the name of the callback function as part of the named query parameters in the request sent to the server, e.g.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src=</span><span class="s">&#34;http://server2.example.com/RetrieveUser?UserId=1234&amp;jsonp=parseResponse&#34;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The server fills the callback function (parseResponse) with JSON data before passing it to the browser. The response the browser gets is no longer a mere narrative of information but a script. In this case, the browser gets the following.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">parseResponse</span><span class="p">({</span><span class="s2">&#34;Name&#34;</span><span class="p">:</span> <span class="s2">&#34;Cheeso&#34;</span><span class="p">,</span> <span class="s2">&#34;Id&#34;</span><span class="p">:</span> <span class="mi">1823</span><span class="p">,</span> <span class="s2">&#34;Rank&#34;</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><p>While the padding (pre-padding) is &ldquo;usually&rdquo; a callback function defined in the context of browser execution, it can also be a variable assignment, an if narrative, or other JavaScript narrative. the response to a JSONP request (i.e., a request using the JSONP schema) is not JSON and is not treated as such JSON parsed - the return can be any operator, and need not even be JSON at all, although the padding part is still conventionally a small snippet of JavaScript that triggers a function call that acts on the JSON-formatted material.</p>
<p>Alternatively, a typical JSONP is a solution that wraps an existing JSON API with a function request to achieve cross-domain access. In order to initiate a JSONP request (or rather, to use this pattern), you need a script element. Therefore, the browser must add (or reuse) a new <code>&lt;script&gt;</code> element with the required src value into the HTML DOM for each JSONP request - or &ldquo;inject&rdquo; the element. Because of this, JSON is said to be a way to &ldquo;allow users to bypass same-origin policies by injecting script elements&rdquo;.</p>
<p>Using the script tag of the remote site allows the remote site to inject any content into the site. If the remote site has a JavaScript injection vulnerability, the original site will be affected as well. There is an ongoing project to define a so-called JSON-P strict security subset that would allow browsers to force the processing of requests with a MIME class of &ldquo;application/json-p&rdquo;. If the response cannot be parsed as strictly JSON-P, the browser can throw an error or ignore the entire response.</p>
<p>Rough JSONP deployments are vulnerable to cross-site forgery requests (CSRF/XSRF). Because HTML <code>&lt;script&gt;</code> tags do not adhere to the same-origin policy in browsers, malicious pages can request and obtain JSON information belonging to other sites. When a user is logged into that other site, this situation allows the malicious site to manipulate the JSON data in the context of the malicious site, potentially compromising the user&rsquo;s password or other sensitive information.</p>
<p>This is only a problem if the JSON data contains confidential information that should not be leaked to third parties, and the server relies only on the browser&rsquo;s same-origin policy to block unusual requests. If the server determines the proprietary nature of the request itself and only outputs the information if the request is normal, then there is no problem. A cookie alone is not sufficient to determine that a request is legitimate, which makes it vulnerable to cross-site forgery of requests.</p>
<h3 id="jsonp-client-side-implementation">JSONP client-side implementation</h3>
<p>We know that even if the code in the cross-domain js file (which of course means in compliance with the web script security policy), the web page can be executed unconditionally.</p>
<p>The remote server <code>remoteserver.com</code> has a remote.js file in the root directory with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;我是远程文件&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>There is a jsonp.html page code under the local server <code>localserver.com</code> as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src=</span><span class="s">&#34;http://remoteserver.com/remote.js&#34;</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>The remote.js file code is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">localHandler</span><span class="p">({</span><span class="s2">&#34;result&#34;</span><span class="o">:</span><span class="s2">&#34;我是远程js带来的数据&#34;</span><span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>After running and checking the result, the page successfully pops up a window showing that the local function was called successfully by the remote js across the domain and also received the data brought by the remote js. I&rsquo;m very happy that the purpose of cross-domain remote data acquisition has basically been achieved, but another problem has arisen, how do I let the remote js know what the name of the local function it should call is? After all, the server of jsonp has to face many service objects, and each of these service objects has a different local function, right? Let&rsquo;s move on to the next step.</p>
<p>Smart developers can easily think, as long as the server provides js script is dynamically generated on the line, so the caller can pass a parameter to tell the server &ldquo;I want to call XXX function of the js code, please return to me&rdquo;, so the server can be in accordance with the needs of the client to generate js script and respond to the client&rsquo;s request.</p>
<p>Look at the code of the jsonp.html page.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text/javascript&#34;</span><span class="p">&gt;</span>
    <span class="c1">// 得到航班信息查询结果后的回调函数
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">flightHandler</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;你查询的航班结果是：票价 &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">price</span> <span class="o">+</span> <span class="s1">&#39; 元，&#39;</span> <span class="o">+</span> <span class="s1">&#39;余票 &#39;</span> <span class="o">+</span> <span class="nx">data</span><span class="p">.</span><span class="nx">tickets</span> <span class="o">+</span> <span class="s1">&#39; 张。&#39;</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="c1">// 提供jsonp服务的url地址（不管是什么类型的地址，最终生成的返回值都是一段javascript代码）
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&#34;http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998&amp;callback=flightHandler&#34;</span><span class="p">;</span>
    <span class="c1">// 创建script标签，设置其属性
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;script&#39;</span><span class="p">);</span>
    <span class="nx">script</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span>
    <span class="c1">// 把script标签加入head，此时调用开始
</span><span class="c1"></span>    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">&#39;head&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>This time the code change is relatively large, no longer directly write the remote js file to death, but the code to achieve dynamic query, and this is the core part of the jsonp client implementation, the focus in this case also lies in how to complete the whole process of jsonp calls.</p>
<p>We see that the call url passed a code parameter, telling the server that I want to check the CA1998 flight information, and the callback parameter tells the server that my local callback function is called flightHandler, so please pass the query results into this function to call.</p>
<p>OK, the server is very smart, the page called flightResult.aspx generates a piece of code like this to jsonp.html (the server-side implementation is not demonstrated here, it has nothing to do with your choice of language, in the end it is a spliced string).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">flightHandler</span><span class="p">({</span>
        <span class="s2">&#34;code&#34;</span><span class="o">:</span> <span class="s2">&#34;CA1998&#34;</span><span class="p">,</span>
        <span class="s2">&#34;price&#34;</span><span class="o">:</span> <span class="mi">1780</span><span class="p">,</span>
        <span class="s2">&#34;tickets&#34;</span><span class="o">:</span> <span class="mi">5</span>
    <span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>We see that what is passed to the flightHandler function is a json, which describes the basic information about the flight. Run the page, a pop-up window appears successfully, and the whole process of jsonp execution is completed successfully!</p>
<p>Up to this point, I believe you have been able to understand the principle of jsonp client implementation, right? All that remains is to encapsulate the code so that it can interact with the user interface and be called multiple times and repeatedly.</p>
<h3 id="jquery-implementation-of-jsonp">jQuery implementation of JSONP</h3>
<p>We still use the same example as above for the flight information query, assuming that the jsonp results are returned unchanged.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&#34;text/javascript&#34;</span> <span class="na">src=</span><span class="s">jquery.min.js&#34;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&#34;text/javascript&#34;</span><span class="nt">&gt;</span>
    jQuery(document).ready(function () {

        $.ajax({
            type: &#34;get&#34;,
            async: false,
            url: &#34;http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998&#34;,
            dataType: &#34;jsonp&#34;,
            jsonp: &#34;callback&#34;,//传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(一般默认为:callback)
            jsonpCallback: &#34;flightHandler&#34;,//自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名，也可以写&#34;?&#34;，jQuery会自动为你处理数据
            success: function (json) {
                alert(&#39;您查询到航班信息：票价： &#39; + json.price + &#39; 元，余票： &#39; + json.tickets + &#39; 张。&#39;);
            },
            error: function () {
                alert(&#39;fail&#39;);
            }
        });
    });
<span class="nt">&lt;/script&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Why didn&rsquo;t I write the function flightHandler this time? And it worked! That&rsquo;s where jQuery comes in. jquery automatically generates a callback function for you when handling ajax of type jsonp and takes the data out for the success property method to call.</p>
<h3 id="similarities-and-differences-between-ajax-and-jsonp">Similarities and differences between ajax and jsonp</h3>
<p>ajax and jsonp are two technologies that &ldquo;look&rdquo; very similar in the way they are called, and the purpose is the same, both are requesting a url and then processing the data returned by the server, so frameworks such as jquery and ext encapsulate jsonp as a form of ajax; but ajax and jsonp are essentially different things.</p>
<p>But ajax and jsonp are actually essentially different things. ajax&rsquo;s core is to get non-page content via XmlHttpRequest, while jsonp&rsquo;s core is to dynamically add <code>&lt;script&gt;</code> tags to call the js script provided by the server.</p>
<p>So, in fact, the difference between ajax and jsonp is not whether it is cross-domain or not. ajax can achieve cross-domain through the server-side proxy as well, and jsonp itself does not exclude the acquisition of data from the same domain.</p>
<p>And that is, jsonp is a way or non-compulsory protocol, as ajax, it does not have to use json format to pass data, if you want, string can, but this is not conducive to the use of jsonp to provide public services.</p>
<p>In short, jsonp is not a special case of ajax, even if jquery and other giants to jsonp encapsulated into ajax, can not change this!</p>
<h3 id="python-with-jsonp">Python with JSONP</h3>
<p>Python generates JSONP data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">def</span> <span class="nf">dumps_jsonp</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">funcname</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;callback&#39;</span><span class="p">)</span>
    <span class="c1"># print(funcname)</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">funcname</span><span class="p">,</span> <span class="n">data</span><span class="p">())</span>
    <span class="c1"># print(content)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Python reads JSONP data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="k">def</span> <span class="nf">loads_jsonp</span><span class="p">(</span><span class="n">_jsonp</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&#34;.*?({.*}).*&#34;</span><span class="p">,</span><span class="n">_jsonp</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">S</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Invalid Input&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          <a href="/tags/json/">json</a>
          <a href="/tags/jsonp/">jsonp</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10/python-aiml/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Python chatbot building based on AIML</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10/python-xml/">
            <span class="next-text nav-default">Python XML file format parsing</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
