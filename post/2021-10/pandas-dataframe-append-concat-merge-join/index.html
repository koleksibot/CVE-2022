<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Merging and Joining DataFrames in Pandas - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="When working with data in Pandas, it is sometimes necessary to merge and concatenate multiple data, the most common of which include merging multiple split files.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  import pandas as pd import glob file_list = glob.glob(&amp;#39;data/*&amp;#39;) df_list = [] for file in file_list: df_temp = pd.read_csv(file, sep=&amp;#34;&amp;lt;pre class=&amp;#34;EnlighterJSRAW&amp;#34; data-enlighter-language=&amp;#34;generic&amp;#34;&amp;gt;import pandas as pd import glob file_list = glob." /><meta name="keywords" content="python, pandas, Joining, Merging, DataFrames" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-10/pandas-dataframe-append-concat-merge-join/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Merging and Joining DataFrames in Pandas" />
<meta property="og:description" content="When working with data in Pandas, it is sometimes necessary to merge and concatenate multiple data, the most common of which include merging multiple split files.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  import pandas as pd import glob file_list = glob.glob(&#39;data/*&#39;) df_list = [] for file in file_list: df_temp = pd.read_csv(file, sep=&#34;&lt;pre class=&#34;EnlighterJSRAW&#34; data-enlighter-language=&#34;generic&#34;&gt;import pandas as pd import glob file_list = glob." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-10/pandas-dataframe-append-concat-merge-join/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-23T15:58:17+08:00" />
<meta property="article:modified_time" content="2021-10-23T15:58:17+08:00" />

<meta itemprop="name" content="Merging and Joining DataFrames in Pandas">
<meta itemprop="description" content="When working with data in Pandas, it is sometimes necessary to merge and concatenate multiple data, the most common of which include merging multiple split files.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  import pandas as pd import glob file_list = glob.glob(&#39;data/*&#39;) df_list = [] for file in file_list: df_temp = pd.read_csv(file, sep=&#34;&lt;pre class=&#34;EnlighterJSRAW&#34; data-enlighter-language=&#34;generic&#34;&gt;import pandas as pd import glob file_list = glob."><meta itemprop="datePublished" content="2021-10-23T15:58:17+08:00" />
<meta itemprop="dateModified" content="2021-10-23T15:58:17+08:00" />
<meta itemprop="wordCount" content="680">
<meta itemprop="keywords" content="python,pandas," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Merging and Joining DataFrames in Pandas"/>
<meta name="twitter:description" content="When working with data in Pandas, it is sometimes necessary to merge and concatenate multiple data, the most common of which include merging multiple split files.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  import pandas as pd import glob file_list = glob.glob(&#39;data/*&#39;) df_list = [] for file in file_list: df_temp = pd.read_csv(file, sep=&#34;&lt;pre class=&#34;EnlighterJSRAW&#34; data-enlighter-language=&#34;generic&#34;&gt;import pandas as pd import glob file_list = glob."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Merging and Joining DataFrames in Pandas</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-23 15:58:17 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 680 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#dfappend">df.append()</a></li>
        <li><a href="#pdconcat">pd.concat()</a></li>
        <li><a href="#pdmerge-or-dfmerge">pd.merge() or df.merge()</a></li>
        <li><a href="#dfjoin">df.join()</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>When working with data in Pandas, it is sometimes necessary to merge and concatenate multiple data, the most common of which include merging multiple split files.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/*&#39;</span><span class="p">)</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
    <span class="n">df_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;&lt;pre class=&#34;</span><span class="n">EnlighterJSRAW</span><span class="s2">&#34; data-enlighter-language=&#34;</span><span class="n">generic</span><span class="s2">&#34;&gt;import pandas as pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="n">file_list</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;data/*&#39;</span><span class="p">)</span>
<span class="n">df_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
<span class="n">df_temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&#34;</span><span class="se">\001</span><span class="s2">&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">N&#39;</span><span class="p">])</span>
<span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_temp</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&lt;/</span><span class="n">pre</span><span class="o">&gt;</span><span class="mi">1</span><span class="s2">&#34;, header=None, na_values=[&#39;</span><span class="se">\\</span><span class="s2">N&#39;])</span>
    <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_temp</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>There are a total of four methods for merging data in Pandas.</p>
<ul>
<li>append()</li>
<li>concat()</li>
<li>merge() or df.merge()</li>
<li>join()</li>
</ul>
<h2 id="dfappend">df.append()</h2>
<p>df.append () is better understood, is the original data in the append data, the syntax: df1.append (df2, sort=False), the effect is similar to UNION ALL in SQL.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/fbb11feed88e4a4a95621c161d71831d.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/d5697399c047408e89c9e945b08ac100.png" alt=""></p>
<h2 id="pdconcat">pd.concat()</h2>
<p>pd.concat() is equivalent to the enhanced version of df.append(). It supports merging multiple DataFrames in addition to vertical (portrait) merging, but also horizontal (landscape) merging.</p>
<p>Vertical (vertical) merge: pd.concat([df1, df2], sort = False)</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/8488a925358743c29053ee3505afbf21.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/ae5b6a869357473f982815b16e70dd44.png" alt=""></p>
<p>Horizontal (horizontal) merge: pd.concat([df1, df2], axis = 1, sort = False)</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/faa333ad91454b03afba857aa997fa1f.png" alt=""></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/f21cf1155b2543b2a2cbdc4c2f3e1010.png" alt=""></p>
<p>pandas.concat(objs, axis=0, join=&lsquo;outer&rsquo;, ignore_index=False, keys=None, levels=None, names=None, verify_ integrity=False, sort=False, copy=True)</p>
<p>Parameter description.</p>
<ul>
<li>objs: The sequence or mapping of Pandas Series or DataFrame objects to join.</li>
<li>join: join method (inner or outer)</li>
<li>axis: join along a row (axis=0) or column (axis=1)</li>
<li>ignore_index: if True, the index of the original DataFrames is ignored.</li>
<li>keys: order of adding identifiers to the result index</li>
<li>levels: the levels used to create the MultiIndex</li>
<li>names: the names of the levels in the MultiIndex</li>
<li>verify_integrity: boolean. If True, check for duplicates.</li>
<li>sort: boolean. When join is outer, sort the non-concatenation axes if they are not already aligned.</li>
<li>copy: Boolean. If False, avoid unnecessary data copying.</li>
</ul>
<h2 id="pdmerge-or-dfmerge">pd.merge() or df.merge()</h2>
<p>pandas provides a method similar to the join operation of relational databases merage, which can join rows in different DataFrames based on one or more keys</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/23/8684187baa4f4fcc95f9bdc2b4ee5868.png" alt=""></p>
<p>DataFrame.merge(right, how=’inner’, on=None, left_on=None, right_on=None, left_index=False, right_index=False, sort=False, suffixes=(‘_x’, ‘_y’), copy=True, indicator=False, validate=None)</p>
<p>Parameter Description.</p>
<ul>
<li>right: the DataFrame on the right side when connected</li>
<li>how: join method, optional values {&lsquo;left&rsquo;, &lsquo;right&rsquo;, &lsquo;outer&rsquo;, &lsquo;inner&rsquo;, &lsquo;cross&rsquo;}, default &lsquo;inner&rsquo;
<ul>
<li>left: similar to SQL&rsquo;s left join</li>
<li>right: similar to SQL&rsquo;s right join</li>
<li>outer: SQL-like full join</li>
<li>inner: SQL-like inner join</li>
<li>cross: SQL-like cross join (Cartesian product)</li>
</ul>
</li>
<li>on: similar to SQL&rsquo;s on, requires both left and right DataFrame to have the same column name.</li>
<li>left_on: the name of the column associated with the left Dataframe</li>
<li>right_on: the name of the column associated with the right Dataframe, which can be different from the name of the left one.</li>
<li>left_index: use the row index in the left DataFrame as the join key.</li>
<li>right_index: use the row index in the right DataFrame as the concatenation key.</li>
<li>sort: default is True to sort the merged data, set to False to improve performance.</li>
<li>suffixes: a tuple of string values, used to specify the suffix name to be appended to the column name when the same column name exists in the left and right DataFrame, default is ('_x', &lsquo;_y&rsquo;).</li>
<li>copy: default is True, always copy data into the data structure, set to False to improve performance.</li>
<li>indicator: shows the source of the data in the merged data</li>
<li>validate: validation option
<ul>
<li>&ldquo;one_to_one&rdquo; or &ldquo;1:1&rdquo;: determines if the left table is one-to-one with the right table</li>
<li>&ldquo;one_to_many&rdquo; or &ldquo;1:m&rdquo;: Determines if the left table is one-to-many with the right table</li>
<li>&ldquo;many_to_one&rdquo; or &ldquo;m:1&rdquo;: Determines if the left table is many-to-one with the right table</li>
<li>&ldquo;many_to_many&rdquo; or &ldquo;m:m&rdquo;: determines if the left table and the right table are many-to-many</li>
</ul>
</li>
</ul>
<h2 id="dfjoin">df.join()</h2>
<p>df.join() is the built-in join method of dataframe, with index as the aligned column by default. The function is weaker than merge(), so we won&rsquo;t introduce it in detail here.</p>
<p>DataFrame.join(other, on=None, how=&lsquo;left&rsquo;, lsuffix=&quot;, rsuffix=&quot;, sort=False)</p>
<p>Parameter description.</p>
<ul>
<li>other: the right DataFrame</li>
<li>on: same as above</li>
<li>how: same as above</li>
<li>lsuffix: the suffix of the duplicate column in the left DataFrame</li>
<li>rsuffix: the suffix of the repeating column in the right DataFrame</li>
<li>sort: same as above</li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          <a href="/tags/pandas/">pandas</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10/use-kustomize-custom-helm-charts/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Customize Helm Charts with Kustomize</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10/pandas-sqlalchemy/">
            <span class="next-text nav-default">Pandas&#43;SQLAlchemy interaction with database</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
