<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python chatbot building based on AIML - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="AIML Introduction AIML, known as Artificial Intelligence Markup Language, is an XML language for creating natural language software agents, invented and created by Dr. Richard S. Wallace and the Alicebot open source software organization between 1995-2000. AIML is an XML format for rule definition in order to match patterns and determine responses. The design goals of AIML are as follows. AIML should be easy for the general public to learn" /><meta name="keywords" content="python, aiml" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-10/python-aiml/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python chatbot building based on AIML" />
<meta property="og:description" content="AIML Introduction AIML, known as Artificial Intelligence Markup Language, is an XML language for creating natural language software agents, invented and created by Dr. Richard S. Wallace and the Alicebot open source software organization between 1995-2000. AIML is an XML format for rule definition in order to match patterns and determine responses. The design goals of AIML are as follows. AIML should be easy for the general public to learn" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-10/python-aiml/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-31T11:17:09+08:00" />
<meta property="article:modified_time" content="2021-10-31T11:17:09+08:00" />

<meta itemprop="name" content="Python chatbot building based on AIML">
<meta itemprop="description" content="AIML Introduction AIML, known as Artificial Intelligence Markup Language, is an XML language for creating natural language software agents, invented and created by Dr. Richard S. Wallace and the Alicebot open source software organization between 1995-2000. AIML is an XML format for rule definition in order to match patterns and determine responses. The design goals of AIML are as follows. AIML should be easy for the general public to learn"><meta itemprop="datePublished" content="2021-10-31T11:17:09+08:00" />
<meta itemprop="dateModified" content="2021-10-31T11:17:09+08:00" />
<meta itemprop="wordCount" content="1920">
<meta itemprop="keywords" content="python,aiml," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python chatbot building based on AIML"/>
<meta name="twitter:description" content="AIML Introduction AIML, known as Artificial Intelligence Markup Language, is an XML language for creating natural language software agents, invented and created by Dr. Richard S. Wallace and the Alicebot open source software organization between 1995-2000. AIML is an XML format for rule definition in order to match patterns and determine responses. The design goals of AIML are as follows. AIML should be easy for the general public to learn"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python chatbot building based on AIML</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-31 11:17:09 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1920 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#aiml-introduction">AIML Introduction</a></li>
        <li><a href="#building-a-chatbot-with-aiml">Building a chatbot with AIML</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="aiml-introduction">AIML Introduction</h2>
<p>AIML, known as Artificial Intelligence Markup Language, is an XML language for creating natural language software agents, invented and created by Dr. Richard S. Wallace and the Alicebot open source software organization between 1995-2000. AIML is an XML format for rule definition in order to match patterns and determine responses.</p>
<ul>
<li>The design goals of AIML are as follows.</li>
<li>AIML should be easy for the general public to learn and understand.</li>
<li>AIML should enable minimal concepts to be encoded to support a stimulus-response discipline system component based on I.C.E.</li>
<li>AIML should be compatible with XML.</li>
<li>Writing AIML processable program files should be easy and convenient.</li>
<li>AIML objects should have good readability and clarity for people.</li>
<li>The design of AIML should be formal and simple.</li>
<li>AIML should contain dependencies on other languages.</li>
</ul>
<p>For a detailed primer on AIML, you can turn to <a href="http://www.alicebot.org/documentation/aiml-primer.html">Alice Bot&rsquo;s AIML Primer</a>. You can also learn more about AIML and what it can do at the <a href="https://en.wikipedia.org/wiki/AIML">AIML Wikipedia page</a>. With Python&rsquo;s AIML package, it is easy to implement artificial intelligence chatbots.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/31/5bda2f725b264c48b9592201f0b24533.png" alt=""></p>
<h2 id="building-a-chatbot-with-aiml">Building a chatbot with AIML</h2>
<p><strong>Install the Python aiml library</strong></p>
<ul>
<li>Python 2：pip install aiml</li>
<li>Python 3：pip install python-aiml</li>
</ul>
<p><strong>Get alice resources</strong>.</p>
<p>After Python aiml is installed, there will be an alice subdirectory under Lib/site-packages/aiml in the Python installation directory, which is a simple corpus that comes with the system.</p>
<p><strong>Loading alice under Python</strong></p>
<p>Once you have obtained the alice resource, you can load the alice brain directly using the Python aiml library.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">aiml</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="k">def</span> <span class="nf">get_module_dir</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="s1">&#39;__file__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;module </span><span class="si">%s</span><span class="s1"> has not attribute __file__&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>


<span class="n">alice_path</span> <span class="o">=</span> <span class="n">get_module_dir</span><span class="p">(</span><span class="s1">&#39;aiml&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/alice&#39;</span>
<span class="c1">#切换到语料库所在工作目录</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">alice_path</span><span class="p">)</span>

<span class="n">alice</span> <span class="o">=</span> <span class="n">aiml</span><span class="o">.</span><span class="n">Kernel</span><span class="p">()</span>
<span class="n">alice</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="s2">&#34;startup.xml&#34;</span><span class="p">)</span>
<span class="n">alice</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;LOAD ALICE&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span> <span class="n">alice</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;Enter your message &gt;&gt; &#34;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>The above process is very simple, next we have to create our own bot from zero.</p>
<p><strong>Creating a standard startup file</strong></p>
<p>It is standard practice to create a startup file called std-startup.xml as the main entry point for loading AIML files. In this example, we will create a base file that matches a pattern and returns one accordingly. We want to match the pattern load aiml b and then have it load our aiml brain as a response. We will create the basic_chat.aiml file in one step.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;aiml</span> <span class="na">version=</span><span class="s">&#34;1.0.1&#34;</span> <span class="na">encoding=</span><span class="s">&#34;UTF-8&#34;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- std-startup.xml --&gt;</span>

    <span class="c">&lt;!-- Category是一个自动的AIML单元 --&gt;</span>
    <span class="nt">&lt;category&gt;</span>

        <span class="c">&lt;!-- Pattern用来匹配用户输入 --&gt;</span>
        <span class="c">&lt;!-- 如果用户输入 &#34;LOAD AIML B&#34; --&gt;</span>
        <span class="nt">&lt;pattern&gt;</span>LOAD AIML B<span class="nt">&lt;/pattern&gt;</span>

        <span class="c">&lt;!-- Template是模式的响应 --&gt;</span>
        <span class="c">&lt;!-- 这里学习一个aiml文件 --&gt;</span>
        <span class="nt">&lt;template&gt;</span>
            <span class="nt">&lt;learn&gt;</span>basic_chat.aiml<span class="nt">&lt;/learn&gt;</span>
            <span class="c">&lt;!-- 你可以在这里添加更多的aiml文件 --&gt;</span>
            <span class="c">&lt;!--&lt;learn&gt;more_aiml.aiml&lt;/learn&gt;--&gt;</span>
        <span class="nt">&lt;/template&gt;</span>

    <span class="nt">&lt;/category&gt;</span>

<span class="nt">&lt;/aiml&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Creating a standard startup file</strong></p>
<p>It is standard practice to create a startup file called std-startup.xml as the main entry point for loading AIML files. In this example, we will create a base file that matches a pattern and returns one accordingly. We want to match the pattern load aiml b and then have it load our aiml brain as a response. We will create the basic_chat.aiml file in one step.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;aiml</span> <span class="na">version=</span><span class="s">&#34;1.0.1&#34;</span> <span class="na">encoding=</span><span class="s">&#34;UTF-8&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- basic_chat.aiml --&gt;</span>
<span class="nt">&lt;aiml&gt;</span>

    <span class="nt">&lt;category&gt;</span>
        <span class="nt">&lt;pattern&gt;</span>HELLO<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;template&gt;</span>
            Well, hello!
        <span class="nt">&lt;/template&gt;</span>
    <span class="nt">&lt;/category&gt;</span>

    <span class="nt">&lt;category&gt;</span>
        <span class="nt">&lt;pattern&gt;</span>WHAT ARE YOU<span class="nt">&lt;/pattern&gt;</span>
        <span class="nt">&lt;template&gt;</span>
            I&#39;m a bot, silly!
        <span class="nt">&lt;/template&gt;</span>
    <span class="nt">&lt;/category&gt;</span>

<span class="nt">&lt;/aiml&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Random Response</strong></p>
<p>You can also add a random response like the one below. It will respond randomly when receiving a message that starts with &ldquo;One time I&rdquo;. * is a wildcard that matches anything.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;category&gt;</span>
    <span class="nt">&lt;pattern&gt;</span>ONE TIME I *<span class="nt">&lt;/pattern&gt;</span>
    <span class="nt">&lt;template&gt;</span>
        <span class="nt">&lt;random&gt;</span>
            <span class="nt">&lt;li&gt;</span>Go on.<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>How old are you?<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>Be more specific.<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>I did not know that.<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>Are you telling the truth?<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>I don&#39;t know what that means.<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>Try to tell me that another way.<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>Are you talking about an animal, vegetable or mineral?<span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;li&gt;</span>What is it?<span class="nt">&lt;/li&gt;</span>
        <span class="nt">&lt;/random&gt;</span>
    <span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;/category&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Use an existing AIML file</strong></p>
<p>Writing your own AIML file is a lot of fun, but it will take a lot of work. I think it takes about 10,000 patterns before it starts to get real. Fortunately, the ALICE Foundation offers a large number of free AIML files. Browse the AIML files on the Alice Bot website.</p>
<p><strong>Testing the newly created robot</strong></p>
<p>So far, all the AIML files in XML format are ready. They are all important as part of the robot&rsquo;s brain, but for now they are just information (information). The robot needs to come to life. You can customize the AIML with any language, but here you can use Python.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">aiml</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="n">mybot_path</span> <span class="o">=</span> <span class="s1">&#39;./mybot&#39;</span>
<span class="c1">#切换到语料库所在工作目录</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">mybot_path</span><span class="p">)</span>

<span class="n">mybot</span> <span class="o">=</span> <span class="n">aiml</span><span class="o">.</span><span class="n">Kernel</span><span class="p">()</span>
<span class="n">mybot</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="s2">&#34;std-startup.xml&#34;</span><span class="p">)</span>
<span class="n">mybot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="s1">&#39;load aiml b&#39;</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mybot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;Enter your message &gt;&gt; &#34;</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p>This is the simplest program we can start with. It creates an aiml object, learns the startup file, and then loads the rest of the aiml file. Then it is ready to chat, and we enter an infinite loop of constantly prompting the user for messages. You will need to enter a pattern that the bot recognizes. This pattern depends on which AIML files you have loaded. We create the startup file as a separate entity so that we can later add more aiml files to the bot without modifying any of the program source code. We can add more files to the startup xml file that are available for learning.</p>
<p><strong>Accelerated Brain Loading</strong></p>
<p>When you start having a lot of AIML files, it will take a long time to learn. That&rsquo;s where the BRAIN files come from. After the robot learns all the AIML files, it can save its brain directly to a file that will dynamically speed up the loading time in subsequent runs.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">aiml</span>
<span class="kn">import</span> <span class="nn">os</span>


<span class="n">mybot_path</span> <span class="o">=</span> <span class="s1">&#39;./mybot&#39;</span>
<span class="c1">#切换到语料库所在工作目录</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">mybot_path</span><span class="p">)</span>

<span class="n">mybot</span> <span class="o">=</span> <span class="n">aiml</span><span class="o">.</span><span class="n">Kernel</span><span class="p">()</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&#34;mybot_brain.brn&#34;</span><span class="p">):</span>
    <span class="n">mybot</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span><span class="n">brainFile</span><span class="o">=</span><span class="s2">&#34;mybot_brain.brn&#34;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">mybot</span><span class="o">.</span><span class="n">bootstrap</span><span class="p">(</span><span class="n">learnFiles</span><span class="o">=</span><span class="s2">&#34;std-startup.xml&#34;</span><span class="p">,</span> <span class="n">commands</span><span class="o">=</span><span class="s2">&#34;load aiml b&#34;</span><span class="p">)</span>
    <span class="n">mybot</span><span class="o">.</span><span class="n">saveBrain</span><span class="p">(</span><span class="s2">&#34;mybot_brain.brn&#34;</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">mybot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;Enter your message &gt;&gt; &#34;</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><p>Remember, if you use the brain method as written above, loading at runtime does not save the added changes to brain. You will either need to delete the brain file so that it can be rebuilt at the next start, or you will need to modify the code so that it saves the brain at some point after reloading.</p>
<p><strong>Add Python commands</strong></p>
<p>If you want to provide your bot with some special commands for running Python functions, then you should capture the input message for the bot and then process it before sending it to mybot.respond(). In the above example, we get the user&rsquo;s input from raw_input. However, we can get the input from anywhere. It could be a TCP socket, or a speech recognition source code. Process the message before it goes to AIML. You may want to skip AIML processing on some specific messages.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">message</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;Enter your message &gt;&gt; &#34;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">message</span> <span class="o">==</span> <span class="s2">&#34;quit&#34;</span><span class="p">:</span>
        <span class="n">exit</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">message</span> <span class="o">==</span> <span class="s2">&#34;save&#34;</span><span class="p">:</span>
        <span class="n">mybot</span><span class="o">.</span><span class="n">saveBrain</span><span class="p">(</span><span class="s2">&#34;bot_brain.brn&#34;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bot_response</span> <span class="o">=</span> <span class="n">mybot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="c1"># Do something with bot_response</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Sessions and Assertions</strong></p>
<p>By specifying a session, AIML can tailor different sessions for different people. For example, if a person tells the bot that his name is Alice and another person tells the bot that his name is Bob, the bot can distinguish between the different people. To specify the session you are using, pass it as the second argument to respond()</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">sessionId</span> <span class="o">=</span> <span class="mi">12345</span>
<span class="n">mybot</span><span class="o">.</span><span class="n">respond</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s2">&#34;&gt;&gt;&gt;&#34;</span><span class="p">),</span> <span class="n">sessionId</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>This is helpful for customizing personalized conversations for each client. You will have to generate your own session ID in some form and keep track of it. Note that saving the brain file will not save all the session values.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">sessionId</span> <span class="o">=</span> <span class="mi">12345</span>

<span class="c1"># 会话信息作为字典获取. 包含输入输出历史，</span>
<span class="c1"># 以及任何已知断言</span>
<span class="n">sessionData</span> <span class="o">=</span> <span class="n">mybot</span><span class="o">.</span><span class="n">getSessionData</span><span class="p">(</span><span class="n">sessionId</span><span class="p">)</span>

<span class="c1"># 每一个会话ID需要时一个唯一值。</span>
<span class="c1"># 断言名是机器人在与你的会话中了解到的某些/某个名字 </span>
<span class="c1"># 机器人可能知道，你是&#34;Billy&#34;，而你的狗的名字是&#34;Brandy&#34;</span>
<span class="n">mybot</span><span class="o">.</span><span class="n">setPredicate</span><span class="p">(</span><span class="s2">&#34;dog&#34;</span><span class="p">,</span> <span class="s2">&#34;Brandy&#34;</span><span class="p">,</span> <span class="n">sessionId</span><span class="p">)</span>
<span class="n">clients_dogs_name</span> <span class="o">=</span> <span class="n">mybot</span><span class="o">.</span><span class="n">getPredicate</span><span class="p">(</span><span class="s2">&#34;dog&#34;</span><span class="p">,</span> <span class="n">sessionId</span><span class="p">)</span>

<span class="n">mybot</span><span class="o">.</span><span class="n">setBotPredicate</span><span class="p">(</span><span class="s2">&#34;hometown&#34;</span><span class="p">,</span> <span class="s2">&#34;127.0.0.1&#34;</span><span class="p">)</span>
<span class="n">bot_hometown</span> <span class="o">=</span> <span class="n">mybot</span><span class="o">.</span><span class="n">getBotPredicate</span><span class="p">(</span><span class="s2">&#34;hometown&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>In AIML, we can use the set response in the template to set the assertion</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;aiml</span> <span class="na">version=</span><span class="s">&#34;1.0.1&#34;</span> <span class="na">encoding=</span><span class="s">&#34;UTF-8&#34;</span><span class="nt">&gt;</span>
   <span class="nt">&lt;category&gt;</span>
      <span class="nt">&lt;pattern&gt;</span>MY DOGS NAME IS *<span class="nt">&lt;/pattern&gt;</span>
      <span class="nt">&lt;template&gt;</span>
         That is interesting that you have a dog named <span class="nt">&lt;set</span> <span class="na">name=</span><span class="s">&#34;dog&#34;</span><span class="nt">&gt;&lt;star/&gt;&lt;/set&gt;</span>
      <span class="nt">&lt;/template&gt;</span>  
   <span class="nt">&lt;/category&gt;</span>  
   <span class="nt">&lt;category&gt;</span>
      <span class="nt">&lt;pattern&gt;</span>WHAT IS MY DOGS NAME<span class="nt">&lt;/pattern&gt;</span>
      <span class="nt">&lt;template&gt;</span>
         Your dog&#39;s name is <span class="nt">&lt;get</span> <span class="na">name=</span><span class="s">&#34;dog&#34;</span><span class="nt">/&gt;</span>.
      <span class="nt">&lt;/template&gt;</span>  
   <span class="nt">&lt;/category&gt;</span>  
<span class="nt">&lt;/aiml&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Using the AIML above, you can tell the robot.</p>
<p><em>My dogs name is Max</em></p>
<p>And the robot will answer you.</p>
<p><em>That is interesting that you have a dog named Max</em></p>
<p>Then, if you ask the robot.</p>
<p><em>What is my dogs name?</em></p>
<p>The robot will answer.</p>
<p><em>Your dog&rsquo;s name is Max.</em></p>
<p>AIML can be used to implement conversational bots, but for Chinese there are the following problems.</p>
<ul>
<li>Chinese rule base is small. In general, the richer the rule base, the more human-like the response of the robot. Currently, the rule base for English is very rich, covers a wide range of topics, and is publicly available. However, the publicly available Chinese rule base is basically not available.</li>
<li>The AIML interpreter does not support Chinese well. In fact, the PyAIML module (parser) under Python can already support Chinese relatively well, but there are also the following problems: English words are generally distinguished by spaces or punctuation, so they have a kind of &ldquo;natural word separation&rdquo; feature, and since Chinese input is not separated by spaces, the above will cause some inconvenience in practice. Some inconvenience in practice. For example, to achieve input matching with/without spaces, it is necessary to include both modes in the rule base.</li>
</ul>
<p>Solutions.</p>
<ul>
<li>Build your own corpus (e.g. get training from subtitle files)</li>
<li>Own Chinese word separation tool (e.g. jieba)</li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">python</a>
          <a href="/tags/aiml/">aiml</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10/go-generic-eliding-interface/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Go Generics - Simplify again, omitting interfaces</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10/python-json-jsonp/">
            <span class="next-text nav-default">Python JSON/JSONP Data Parsing</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
