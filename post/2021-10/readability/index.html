<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Readability, a web body extraction tool - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="What is Readability? If you see a good article on the Internet and want to save it for later reading, but don&amp;rsquo;t want to save a lot of green ads or irrelevant web elements at the same time, then you can try Readability!
Readability is a unique &amp;ldquo;read later&amp;rdquo; web favorites service that not only allows you to bookmark articles you like, but also has the best feature of automatically and intelligently eliminating some unimportant elements on the web page and reformatting them to present you with a clean and tidy body part, making your better reading experience!" /><meta name="keywords" content="readability" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-10/readability/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Readability, a web body extraction tool" />
<meta property="og:description" content="What is Readability? If you see a good article on the Internet and want to save it for later reading, but don&rsquo;t want to save a lot of green ads or irrelevant web elements at the same time, then you can try Readability!
Readability is a unique &ldquo;read later&rdquo; web favorites service that not only allows you to bookmark articles you like, but also has the best feature of automatically and intelligently eliminating some unimportant elements on the web page and reformatting them to present you with a clean and tidy body part, making your better reading experience!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-10/readability/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-10-28T19:58:16+08:00" />
<meta property="article:modified_time" content="2021-10-28T19:58:16+08:00" />

<meta itemprop="name" content="Readability, a web body extraction tool">
<meta itemprop="description" content="What is Readability? If you see a good article on the Internet and want to save it for later reading, but don&rsquo;t want to save a lot of green ads or irrelevant web elements at the same time, then you can try Readability!
Readability is a unique &ldquo;read later&rdquo; web favorites service that not only allows you to bookmark articles you like, but also has the best feature of automatically and intelligently eliminating some unimportant elements on the web page and reformatting them to present you with a clean and tidy body part, making your better reading experience!"><meta itemprop="datePublished" content="2021-10-28T19:58:16+08:00" />
<meta itemprop="dateModified" content="2021-10-28T19:58:16+08:00" />
<meta itemprop="wordCount" content="1177">
<meta itemprop="keywords" content="readability," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Readability, a web body extraction tool"/>
<meta name="twitter:description" content="What is Readability? If you see a good article on the Internet and want to save it for later reading, but don&rsquo;t want to save a lot of green ads or irrelevant web elements at the same time, then you can try Readability!
Readability is a unique &ldquo;read later&rdquo; web favorites service that not only allows you to bookmark articles you like, but also has the best feature of automatically and intelligently eliminating some unimportant elements on the web page and reformatting them to present you with a clean and tidy body part, making your better reading experience!"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Readability, a web body extraction tool</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-28 19:58:16 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1177 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-readability">What is Readability?</a></li>
        <li><a href="#implementation-principle-of-readability">Implementation principle of Readability</a></li>
        <li><a href="#how-to-use-readability-quickly">How to use Readability quickly?</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="what-is-readability">What is Readability?</h2>
<p>If you see a good article on the Internet and want to save it for later reading, but don&rsquo;t want to save a lot of green ads or irrelevant web elements at the same time, then you can try Readability!</p>
<p>Readability is a unique &ldquo;read later&rdquo; web favorites service that not only allows you to bookmark articles you like, but also has the best feature of automatically and intelligently eliminating some unimportant elements on the web page and reformatting them to present you with a clean and tidy body part, making your better reading experience! In addition to plug-ins for mainstream browsers, it also provides mobile versions of the app for iOS/Android/Kindle, which can be synced to your phone for efficient and comfortable reading anytime, anywhere &hellip;&hellip;</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/10/28/b551250283594a448b563ed4b0088933.png" alt=""></p>
<h2 id="implementation-principle-of-readability">Implementation principle of Readability</h2>
<p>Extracting the main content from a web page has always been a more challenging algorithm.</p>
<p>Readability was previously open source, but is no longer publicly available. Here is the original open source version for reference: <a href="https://code.google.com/archive/p/arc90labs-readability/">arc90labs-readability - Readability cleans up hard-to-read articles on the Web</a>.</p>
<p>Readability reconsolidates the content of a page by traversing the Dom object and weighting tags and common text. Next, we take a brief look at how this algorithm is implemented. First, it defines a set of orthographies.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">regexps: {
        unlikelyCandidates:    /combx|comment|community|disqus|extra|foot|header|menu|remark|rss|shoutbox|sidebar|sponsor|ad-break|agegate|pagination|pager|popup|tweet|twitter/i,
        okMaybeItsACandidate:  /and|article|body|column|main|shadow/i,
        positive:              /article|body|content|entry|hentry|main|page|pagination|post|text|blog|story/i,
        negative:              /combx|comment|com-|contact|foot|footer|footnote|masthead|media|meta|outbrain|promo|related|scroll|shoutbox|sidebar|sponsor|shopping|tags|tool|widget/i,
        extraneous:            /print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single/i,
        divToPElements:        /&lt;(a|blockquote|dl|div|img|ol|p|pre|table|ul)/i,
        replaceBrs:            /(&lt;br[^&gt;]*&gt;[ \n\r\t]*){2,}/gi,
        replaceFonts:          /&lt;(\/?)font[^&gt;]*&gt;/gi,
        trim:                  /^\s+|\s+$/g,
        normalize:             /\s{2,}/g,
        killBreaks:            /(&lt;br\s*\/?&gt;(\s|&amp;nbsp;?)*){1,}/g,
        videos:                /http:\/\/(www\.)?(youtube|vimeo)\.com/i,
        skipFootnoteLink:      /^\s*(\[?[a-z0-9]{1,2}\]?|^|edit|citation needed)\s*$/i,
        nextLink:              /(next|weiter|continue|&gt;([^\|]|$)|»([^\|]|$))/i, // Match: next, continue, &gt;, &gt;&gt;, » but not &gt;|, »| as those usually mean last.
        prevLink:              /(prev|earl|old|new|&lt;|«)/i
},
</code></pre></td></tr></table>
</div>
</div><p>As you can see, tags and text are grouped with weighted or downgraded groups. The whole content analysis is done by the grabArticle function. First start traversing the nodes.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">for</span><span class="p">(</span><span class="n">var</span> <span class="n">nodeIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">(</span><span class="n">node</span> <span class="o">=</span> <span class="n">allElements</span><span class="p">[</span><span class="n">nodeIndex</span><span class="p">]);</span> <span class="n">nodeIndex</span><span class="o">+=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The elements that do not resemble content are then removed.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="k">if</span> <span class="p">(</span><span class="nx">stripUnlikelyCandidates</span><span class="p">)</span> 
<span class="p">{</span>
    <span class="kd">var</span> <span class="nx">unlikelyMatchString</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">className</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="p">(</span>
            <span class="nx">unlikelyMatchString</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">readability</span><span class="p">.</span><span class="nx">regexps</span><span class="p">.</span><span class="nx">unlikelyCandidates</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span>
            <span class="nx">unlikelyMatchString</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="nx">readability</span><span class="p">.</span><span class="nx">regexps</span><span class="p">.</span><span class="nx">okMaybeItsACandidate</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span>
            <span class="nx">node</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">!==</span> <span class="s2">&#34;BODY&#34;</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">dbg</span><span class="p">(</span><span class="s2">&#34;Removing unlikely candidate - &#34;</span> <span class="o">+</span> <span class="nx">unlikelyMatchString</span><span class="p">);</span>
        <span class="nx">node</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
        <span class="nx">nodeIndex</span><span class="o">-=</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>               
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>After replacing the DIV with a P-tag, the target node is then traversed for scoring.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">candidates</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">pt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">pt</span> <span class="o">&lt;</span> <span class="nx">nodesToScore</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">pt</span><span class="o">+=</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">parentNode</span>      <span class="o">=</span> <span class="nx">nodesToScore</span><span class="p">[</span><span class="nx">pt</span><span class="p">].</span><span class="nx">parentNode</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">grandParentNode</span> <span class="o">=</span> <span class="nx">parentNode</span> <span class="o">?</span> <span class="nx">parentNode</span><span class="p">.</span><span class="nx">parentNode</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">innerText</span>       <span class="o">=</span> <span class="nx">readability</span><span class="p">.</span><span class="nx">getInnerText</span><span class="p">(</span><span class="nx">nodesToScore</span><span class="p">[</span><span class="nx">pt</span><span class="p">]);</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">parentNode</span> <span class="o">||</span> <span class="k">typeof</span><span class="p">(</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">tagName</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/* If this paragraph is less than 25 characters, don&#39;t even count it. */</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">innerText</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">continue</span><span class="p">;</span> <span class="p">}</span>

    <span class="cm">/* Initialize readability data for the parent. */</span>
    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">parentNode</span><span class="p">.</span><span class="nx">readability</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">readability</span><span class="p">.</span><span class="nx">initializeNode</span><span class="p">(</span><span class="nx">parentNode</span><span class="p">);</span>
        <span class="nx">candidates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">parentNode</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="cm">/* Initialize readability data for the grandparent. */</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">grandParentNode</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span><span class="p">(</span><span class="nx">grandParentNode</span><span class="p">.</span><span class="nx">readability</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span><span class="p">(</span><span class="nx">grandParentNode</span><span class="p">.</span><span class="nx">tagName</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">readability</span><span class="p">.</span><span class="nx">initializeNode</span><span class="p">(</span><span class="nx">grandParentNode</span><span class="p">);</span>
        <span class="nx">candidates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">grandParentNode</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">contentScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="cm">/* Add a point for the paragraph itself as a base. */</span>
    <span class="nx">contentScore</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span>

    <span class="cm">/* Add points for any commas within this paragraph */</span>
    <span class="nx">contentScore</span> <span class="o">+=</span> <span class="nx">innerText</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
    
    <span class="cm">/* For every 100 characters in this paragraph, add another point. Up to 3 points. */</span>
    <span class="nx">contentScore</span> <span class="o">+=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">innerText</span><span class="p">.</span><span class="nx">length</span> <span class="o">/</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">3</span><span class="p">);</span>
    
    <span class="cm">/* Add the score to the parent. The grandparent gets half. */</span>
    <span class="nx">parentNode</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span> <span class="o">+=</span> <span class="nx">contentScore</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">grandParentNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">grandParentNode</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span> <span class="o">+=</span> <span class="nx">contentScore</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>             
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Finally, according to the score, the content is reassembled.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">articleContent</span>        <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&#34;DIV&#34;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">isPaging</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">articleContent</span><span class="p">.</span><span class="nx">id</span>     <span class="o">=</span> <span class="s2">&#34;readability-content&#34;</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">siblingScoreThreshold</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nx">topCandidate</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">siblingNodes</span>          <span class="o">=</span> <span class="nx">topCandidate</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">;</span>


<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">s</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nx">sl</span><span class="o">=</span><span class="nx">siblingNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">s</span> <span class="o">&lt;</span> <span class="nx">sl</span><span class="p">;</span> <span class="nx">s</span><span class="o">+=</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">siblingNode</span> <span class="o">=</span> <span class="nx">siblingNodes</span><span class="p">[</span><span class="nx">s</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">append</span>      <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="cm">/**
</span><span class="cm">     * Fix for odd IE7 Crash where siblingNode does not exist even though this should be a live nodeList.
</span><span class="cm">     * Example of error visible here: http://www.esquire.com/features/honesty0707
</span><span class="cm">    **/</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">siblingNode</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">dbg</span><span class="p">(</span><span class="s2">&#34;Looking at sibling node: &#34;</span> <span class="o">+</span> <span class="nx">siblingNode</span> <span class="o">+</span> <span class="s2">&#34; (&#34;</span> <span class="o">+</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">id</span> <span class="o">+</span> <span class="s2">&#34;)&#34;</span> <span class="o">+</span> <span class="p">((</span><span class="k">typeof</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">readability</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="s2">&#34; with score &#34;</span> <span class="o">+</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span><span class="p">)</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>
    <span class="nx">dbg</span><span class="p">(</span><span class="s2">&#34;Sibling has score &#34;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">siblingNode</span><span class="p">.</span><span class="nx">readability</span> <span class="o">?</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span> <span class="o">:</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">));</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">siblingNode</span> <span class="o">===</span> <span class="nx">topCandidate</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">append</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">var</span> <span class="nx">contentBonus</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="cm">/* Give a bonus if sibling nodes and top candidates have the example same classname */</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">siblingNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="nx">topCandidate</span><span class="p">.</span><span class="nx">className</span> <span class="o">&amp;&amp;</span> <span class="nx">topCandidate</span><span class="p">.</span><span class="nx">className</span> <span class="o">!==</span> <span class="s2">&#34;&#34;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">contentBonus</span> <span class="o">+=</span> <span class="nx">topCandidate</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">readability</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">siblingNode</span><span class="p">.</span><span class="nx">readability</span><span class="p">.</span><span class="nx">contentScore</span><span class="o">+</span><span class="nx">contentBonus</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nx">siblingScoreThreshold</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">append</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">if</span><span class="p">(</span><span class="nx">siblingNode</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">===</span> <span class="s2">&#34;P&#34;</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">linkDensity</span> <span class="o">=</span> <span class="nx">readability</span><span class="p">.</span><span class="nx">getLinkDensity</span><span class="p">(</span><span class="nx">siblingNode</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">nodeContent</span> <span class="o">=</span> <span class="nx">readability</span><span class="p">.</span><span class="nx">getInnerText</span><span class="p">(</span><span class="nx">siblingNode</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">nodeLength</span>  <span class="o">=</span> <span class="nx">nodeContent</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        
        <span class="k">if</span><span class="p">(</span><span class="nx">nodeLength</span> <span class="o">&gt;</span> <span class="mi">80</span> <span class="o">&amp;&amp;</span> <span class="nx">linkDensity</span> <span class="o">&lt;</span> <span class="mf">0.25</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">append</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">nodeLength</span> <span class="o">&lt;</span> <span class="mi">80</span> <span class="o">&amp;&amp;</span> <span class="nx">linkDensity</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">nodeContent</span><span class="p">.</span><span class="nx">search</span><span class="p">(</span><span class="sr">/\.( |$)/</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nx">append</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">append</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">dbg</span><span class="p">(</span><span class="s2">&#34;Appending node: &#34;</span> <span class="o">+</span> <span class="nx">siblingNode</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">nodeToAppend</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">siblingNode</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">!==</span> <span class="s2">&#34;DIV&#34;</span> <span class="o">&amp;&amp;</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">!==</span> <span class="s2">&#34;P&#34;</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/* We have a node that isn&#39;t a common block level element, like a form or td tag. Turn it into a div so it doesn&#39;t get filtered out later by accident. */</span>
            
            <span class="nx">dbg</span><span class="p">(</span><span class="s2">&#34;Altering siblingNode of &#34;</span> <span class="o">+</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">nodeName</span> <span class="o">+</span> <span class="s1">&#39; to div.&#39;</span><span class="p">);</span>
            <span class="nx">nodeToAppend</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&#34;DIV&#34;</span><span class="p">);</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="nx">nodeToAppend</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
                <span class="nx">nodeToAppend</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">siblingNode</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">catch</span><span class="p">(</span><span class="nx">er</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">dbg</span><span class="p">(</span><span class="s2">&#34;Could not alter siblingNode to div, probably an IE restriction, reverting back to original.&#34;</span><span class="p">);</span>
                <span class="nx">nodeToAppend</span> <span class="o">=</span> <span class="nx">siblingNode</span><span class="p">;</span>
                <span class="nx">s</span><span class="o">-=</span><span class="mi">1</span><span class="p">;</span>
                <span class="nx">sl</span><span class="o">-=</span><span class="mi">1</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">nodeToAppend</span> <span class="o">=</span> <span class="nx">siblingNode</span><span class="p">;</span>
            <span class="nx">s</span><span class="o">-=</span><span class="mi">1</span><span class="p">;</span>
            <span class="nx">sl</span><span class="o">-=</span><span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="cm">/* To ensure a node does not interfere with readability styles, remove its classnames */</span>
        <span class="nx">nodeToAppend</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>

        <span class="cm">/* Append sibling and subtract from our list because it removes the node when you append to another node */</span>
        <span class="nx">articleContent</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">nodeToAppend</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>As you can see, there are a lot of trick tricks used, such as not scoring paragraphs under 25 words. There are already many versions in other languages, but considering that the original function was designed for English pages. In the porting process, we need to consider</p>
<p>Support GBK, GB2312 and other encoding</p>
<p>Support more video sites, such as Youku, Tudou, etc.</p>
<p>Support extracting article titles</p>
<p>Support converting image relative path to absolute path</p>
<p>&hellip;</p>
<h2 id="how-to-use-readability-quickly">How to use Readability quickly?</h2>
<p>The better ported versions collected so far are.</p>
<ul>
<li>nodejs version: <a href="https://github.com/luin/readability">https://github.com/luin/readability</a></li>
<li>php version: <a href="https://github.com/feelinglucky/php-readability">https://github.com/feelinglucky/php-readability</a></li>
<li>Python version: <a href="https://github.com/timbertson/python-readability">https://github.com/timbertson/python-readability</a></li>
<li>JS version: <a href="https://github.com/mozilla/readability">https://github.com/mozilla/readability</a></li>
<li>Swift version: <a href="https://github.com/exyte/ReadabilityKit">https://github.com/exyte/ReadabilityKit</a></li>
<li>java version: <a href="https://github.com/karussell/snacktory">https://github.com/karussell/snacktory</a></li>
<li>Ruby version: <a href="https://github.com/cantino/ruby-readability">https://github.com/cantino/ruby-readability</a></li>
</ul>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/readability/">readability</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-10/universally-unique-identifier/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Universally Unique Identifier</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-10/python-logging/">
            <span class="next-text nav-default">Using the Python Logging Module</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
