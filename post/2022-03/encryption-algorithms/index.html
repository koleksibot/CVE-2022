<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Commonly used encryption algorithms in programming - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="This article describes the commonly used encryption algorithms and digest algorithms in Java. And sample code." /><meta name="keywords" content="java, md5, sha256, aes, rsa, des, 3des" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-03/encryption-algorithms/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Commonly used encryption algorithms in programming" />
<meta property="og:description" content="This article describes the commonly used encryption algorithms and digest algorithms in Java. And sample code." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-03/encryption-algorithms/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-03-21T08:59:59+08:00" />
<meta property="article:modified_time" content="2022-03-21T08:59:59+08:00" />

<meta itemprop="name" content="Commonly used encryption algorithms in programming">
<meta itemprop="description" content="This article describes the commonly used encryption algorithms and digest algorithms in Java. And sample code."><meta itemprop="datePublished" content="2022-03-21T08:59:59+08:00" />
<meta itemprop="dateModified" content="2022-03-21T08:59:59+08:00" />
<meta itemprop="wordCount" content="2169">
<meta itemprop="keywords" content="java," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Commonly used encryption algorithms in programming"/>
<meta name="twitter:description" content="This article describes the commonly used encryption algorithms and digest algorithms in Java. And sample code."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Commonly used encryption algorithms in programming</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-03-21 08:59:59 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2169 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#preface">Preface</a></li>
        <li><a href="#key">Key</a>
          <ul>
            <li><a href="#key-classification">Key classification</a></li>
            <li><a href="#keys-and-passwords">Keys and Passwords</a></li>
            <li><a href="#key-management">Key management</a></li>
            <li><a href="#key-generation">Key generation</a></li>
          </ul>
        </li>
        <li><a href="#message-digest-algorithm">Message Digest Algorithm</a>
          <ul>
            <li><a href="#md-series">MD series</a></li>
            <li><a href="#sha-family">SHA Family</a></li>
          </ul>
        </li>
        <li><a href="#symmetric-encryption-algorithm">Symmetric encryption algorithm</a>
          <ul>
            <li><a href="#des">DES</a></li>
            <li><a href="#3des">3DES</a></li>
            <li><a href="#aes">AES</a></li>
          </ul>
        </li>
        <li><a href="#asymmetric-encryption-algorithm">Asymmetric encryption algorithm</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="preface">Preface</h2>
<p>There are several common encryption algorithms in programming, and they each have applications in different scenarios. All encryption methods except the message digest algorithm will require a key.</p>
<ul>
<li>Message digest algorithm</li>
<li>Symmetric encryption algorithm</li>
<li>Asymmetric encryption algorithm</li>
</ul>
<h2 id="key">Key</h2>
<p>A <strong>key</strong> (key, also often called <strong>golden key</strong>) is some secret information used to accomplish <strong>encryption</strong>, <strong>decryption</strong>, <strong>integrity verification</strong>, and other cryptographic applications.</p>
<h3 id="key-classification">Key classification</h3>
<ul>
<li>Keys in encryption and decryption: share the same key in symmetric encryption, split into <strong>public key</strong> and <strong>private key</strong> in asymmetric encryption, public key encryption private key decryption.</li>
<li>Keys in message authentication code and digital signature: In message authentication code, the message sender and receiver use a shared key for authentication. In digital signatures, the signature uses the private key, and the verification uses the public key.</li>
<li>Session key and master key: A key that is used only once per communication is called a session key. A key that is used repeatedly as opposed to a session key is called a master key.</li>
</ul>
<h3 id="keys-and-passwords">Keys and Passwords</h3>
<p>Passwords are generally generated by the user, are readable, can be remembered and stored, and are often used for software management, while keys are used by software that implements encryption algorithms and do not need to have readability (though they are Base64 for ease of reading in programming). We can also generate keys by passwords.</p>
<h3 id="key-management">Key management</h3>
<ul>
<li>Generate keys: you can generate keys with random numbers or with passphrases.</li>
<li>Distribute keys: you can use prior shared keys, use key distribution centers, use public key ciphers, use Diffie-Hellman key exchange.</li>
<li>Update keys</li>
<li>Save the key</li>
<li>Revoke keys</li>
</ul>
<h3 id="key-generation">Key generation</h3>
<p>jce (Java Cryptography Extension) in jdk contains all <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html">APIs</a> related to cryptography.</p>
<p><strong>Generate the key for the symmetric encryption algorithm.</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/21/02514df814024d16815d388004bb0ea2.png" alt="Generate the key for the symmetric encryption algorithm"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="n">SecretKey</span> <span class="nf">generateKey</span><span class="o">(</span><span class="kt">int</span> <span class="n">keySize</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">KeyGenerator</span> <span class="n">keyGenerator</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="n">keyGenerator</span> <span class="o">=</span> <span class="n">KeyGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;AES&#34;</span><span class="o">);</span>
        <span class="n">keyGenerator</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">keySize</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">keyGenerator</span><span class="o">.</span><span class="na">generateKey</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ignore
</span><span class="c1"></span>        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Generate keys for symmetric asymmetric encryption algorithms.</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="cm">/**
</span><span class="cm">     * 生成非对称密钥对
</span><span class="cm">     *
</span><span class="cm">     * @param keySize 密钥大小
</span><span class="cm">     * @param random  指定随机来源，默认使用 JCAUtil.getSecureRandom()
</span><span class="cm">     * @return 非对称密钥对
</span><span class="cm">     * @throws NoSuchAlgorithmException NoSuchAlgorithm
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">PPKeys</span> <span class="nf">genKeysRSA</span><span class="o">(</span><span class="kt">int</span> <span class="n">keySize</span><span class="o">,</span> <span class="n">SecureRandom</span> <span class="n">random</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">NoSuchAlgorithmException</span> <span class="o">{</span>
        <span class="n">KeyPairGenerator</span> <span class="n">generator</span> <span class="o">=</span> <span class="n">KeyPairGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;RSA&#34;</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="kc">null</span> <span class="o">!=</span> <span class="n">random</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">generator</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">keySize</span><span class="o">,</span> <span class="n">random</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">generator</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">keySize</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">KeyPair</span> <span class="n">pair</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="na">generateKeyPair</span><span class="o">();</span>
        <span class="n">PPKeys</span> <span class="n">keys</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PPKeys</span><span class="o">();</span>
        <span class="n">PublicKey</span> <span class="n">publicKey</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="na">getPublic</span><span class="o">();</span>
        <span class="n">PrivateKey</span> <span class="n">privateKey</span> <span class="o">=</span> <span class="n">pair</span><span class="o">.</span><span class="na">getPrivate</span><span class="o">();</span>
        <span class="n">keys</span><span class="o">.</span><span class="na">setPublicKey</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">publicKey</span><span class="o">.</span><span class="na">getEncoded</span><span class="o">()));</span>
      <span class="n">keys</span><span class="o">.</span><span class="na">setPrivateKey</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">privateKey</span><span class="o">.</span><span class="na">getEncoded</span><span class="o">()));</span>
        <span class="k">return</span> <span class="n">keys</span><span class="o">;</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>Key Negotiation</strong> (<strong>Diffie-Hellman</strong>)</p>
<p>Key negotiation is a protocol by which two or more parties establish the same shared key and then communicate with each other in a symmetric encrypted transmission without exchanging keys.</p>
<p>The general process: each party generates a public-private key pair and distributes the public key to the other parties, and the shared key can be computed offline when both parties get a copy of the other party&rsquo;s public key.</p>
<p>Java provides <code>KeyAgreement</code> to implement key negotiation.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/21/a916108270364d27a59e1ed9cd992017.png" alt="Java provides KeyAgreement to implement key negotiation"></p>
<ul>
<li>Alice and Bob each initialize their own key negotiation object <code>KeyAgreement</code> with their private keys, calling the <code>init()</code> method.</li>
<li>Then pass the public key of each communicating party into the execution <code>doPhase(Key key, boolean lastPhase)</code> .</li>
<li>Each party generates a shared key <code>generateSecret()</code> .</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">diffieHellman</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">AlgorithmParameterGenerator</span> <span class="n">dhParams</span> <span class="o">=</span> <span class="n">AlgorithmParameterGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DH&#34;</span><span class="o">);</span>
        <span class="n">dhParams</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">1024</span><span class="o">);</span>
        <span class="n">KeyPairGenerator</span> <span class="n">keyGen</span> <span class="o">=</span> <span class="n">KeyPairGenerator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DH&#34;</span><span class="o">);</span>
        <span class="n">keyGen</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="n">dhParams</span><span class="o">.</span><span class="na">generateParameters</span><span class="o">().</span><span class="na">getParameterSpec</span><span class="o">(</span><span class="n">DHParameterSpec</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">());</span>

        <span class="n">KeyAgreement</span> <span class="n">aliceKeyAgree</span> <span class="o">=</span> <span class="n">KeyAgreement</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DH&#34;</span><span class="o">);</span>
        <span class="n">KeyPair</span> <span class="n">alicePair</span> <span class="o">=</span> <span class="n">keyGen</span><span class="o">.</span><span class="na">generateKeyPair</span><span class="o">();</span>
        <span class="n">KeyAgreement</span> <span class="n">bobKeyAgree</span> <span class="o">=</span> <span class="n">KeyAgreement</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DH&#34;</span><span class="o">);</span>
        <span class="n">KeyPair</span> <span class="n">bobPair</span> <span class="o">=</span> <span class="n">keyGen</span><span class="o">.</span><span class="na">generateKeyPair</span><span class="o">();</span>

        <span class="n">aliceKeyAgree</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">alicePair</span><span class="o">.</span><span class="na">getPrivate</span><span class="o">());</span>
        <span class="n">bobKeyAgree</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">bobPair</span><span class="o">.</span><span class="na">getPrivate</span><span class="o">());</span>

        <span class="n">aliceKeyAgree</span><span class="o">.</span><span class="na">doPhase</span><span class="o">(</span><span class="n">bobPair</span><span class="o">.</span><span class="na">getPublic</span><span class="o">(),</span> <span class="kc">true</span><span class="o">);</span>
        <span class="n">bobKeyAgree</span><span class="o">.</span><span class="na">doPhase</span><span class="o">(</span><span class="n">alicePair</span><span class="o">.</span><span class="na">getPublic</span><span class="o">(),</span> <span class="kc">true</span><span class="o">);</span>

       <span class="kt">boolean</span> <span class="n">agree</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">aliceKeyAgree</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">()).</span><span class="na">equals</span><span class="o">(</span>
          <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">bobKeyAgree</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">())</span>
        <span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">agree</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="message-digest-algorithm">Message Digest Algorithm</h2>
<p>Message digest algorithms, also known as <strong>cryptographic hashing algorithms</strong>, do not require a key for the encryption process. Common cryptographic hashing algorithms are the <strong>MD series</strong> and the <strong>SHA series</strong>.</p>
<p>An ideal cryptographic hash function should have the following properties.</p>
<ul>
<li>The output of any incoming message is always of fixed length.</li>
<li>The message digest appears to be &ldquo;random&rdquo;, so that it is difficult to infer the value from the original message.</li>
<li>A good hash function should have a very low collision probability, i.e., the probability of getting the same value for different messages.</li>
</ul>
<h3 id="md-series">MD series</h3>
<p><strong>MD5 Message-Digest Algorithm</strong> (MD5 Message-Digest Algorithm), a widely used cryptographic hash function, outputs a 128-bit (16-byte) hash value (hash value), MD5 was originally designed as a cryptographic hash function, and it is currently found to have a large number of vulnerabilities, so it is not recommended for direct use as encryption, however However, it is still widely used in non-encrypted scenarios such as data integrity checking and file integrity checking.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">md5</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">MessageDigest</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;MD5&#34;</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">digest</span><span class="o">.</span><span class="na">digest</span><span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="k">return</span> <span class="n">Hex</span><span class="o">.</span><span class="na">encodeHexString</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="kd">final</span> <span class="n">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="sha-family">SHA Family</h3>
<p><strong>Secure Hash Algorithm</strong> (SHA for short) is a family of cryptographic hash functions that are certified by FIPS (Federal Information Processing Standards) as secure hash algorithms. It is an algorithm that calculates a string of fixed length (also called message digest) corresponding to a digital message. If the input messages are different, the chance that they correspond to different strings is high.</p>
<p>They contain <code>SHA-0, SHA-1, SHA-2, SHA-3</code>, where <code>SHA-0, SHA-1</code> output length is 160 bits, and <code>SHA-2</code> contains <code>SHA-224, SHA-256, SHA-384, SHA-512, SHA-512/224, SHA-512/256</code>, which we usually use. <code>SHA-256</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">sha256</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">MessageDigest</span> <span class="n">digest</span> <span class="o">=</span> <span class="n">MessageDigest</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;SHA-256&#34;</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">bytes</span> <span class="o">=</span> <span class="n">digest</span><span class="o">.</span><span class="na">digest</span><span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="k">return</span> <span class="n">Hex</span><span class="o">.</span><span class="na">encodeHexString</span><span class="o">(</span><span class="n">bytes</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="kd">final</span> <span class="n">NoSuchAlgorithmException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">IllegalArgumentException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="symmetric-encryption-algorithm">Symmetric encryption algorithm</h2>
<p>Symmetric encryption algorithm, both sides hold the same key for encryption and decryption, common symmetric encryption algorithm: <code>DES</code> <code>3DES</code> <code>AES128</code> <code>AES192</code> <code>AES256</code> . Understanding symmetric encryption requires first understanding the following concepts.</p>
<ul>
<li><strong>Grouped cipher mode</strong> : The plaintext is cut for encryption, and then the ciphertext is stitched together. For example, in AES, the plaintext data is cut into blocks of 16 bytes in size, and when the last block is not enough for 16 bytes, Padding mode is used to supplement it.</li>
<li><strong>Padding</strong> : It has three modes PKCS5, PKCS7 and NOPADDING, PKCS5 is padded with the number of missing bytes, for example, if 5 bytes are missing, 5 number 5 is padded, and PKCS7 is padded with 0 for the number of missing bytes. If the data happens to be an integer multiple of 16, PKCS5 and PKCS7 will be supplemented with another 16 bytes of data to distinguish between padding and valid data, NOPADDING mode does not require padding.</li>
<li><strong>Initialization vector</strong> : The purpose of initial vector IV is to make the encryption more secure and reliable, and the IV size corresponds to the data block length in group cipher mode.</li>
<li><strong>encryption mode</strong>: four encryption modes are: ECB (electronic cipher book mode), CBC (cipher group link mode), CFB, OFB. ECB mode is only using plaintext and key to encrypt data, so the mode does not require Padding, security is also weak, CBC mode data chunking and use the incoming IV in order to carry out the heterogeneous operation, security is also CBC mode is relatively high security, so CBC mode is generally chosen at present.</li>
<li><strong>encryption key</strong>: Different encryption algorithms have different key lengths, for example: DES default length 56 bits, 3DES default length 168 bits, also supports 128 bits, AES default 128 bits, also supports 192 bits, 256 bits. We generally generate the key according to the password, and the password length needs to meet the algorithm key length.</li>
</ul>
<h3 id="des">DES</h3>
<p><code>DES</code> is a typical algorithm in the field of symmetric encryption algorithms, because the default length of the key is <code>56 bit</code>, so the length of the cipher needs to be larger than <code>8 byte</code>, <code>DESKeySpec</code> takes the first <code>8 byte</code> for key making.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"> <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">encryptDES</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">content</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">SecureRandom</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
            <span class="n">DESKeySpec</span> <span class="n">desKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DESKeySpec</span><span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
            <span class="n">SecretKeyFactory</span> <span class="n">secretKeyFactory</span> <span class="o">=</span> <span class="n">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DES&#34;</span><span class="o">);</span>
            <span class="n">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">secretKeyFactory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">desKeySpec</span><span class="o">);</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DES&#34;</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">random</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">content</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">decryptDES</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">SecureRandom</span> <span class="n">random</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecureRandom</span><span class="o">();</span>
        <span class="n">DESKeySpec</span> <span class="n">desKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DESKeySpec</span><span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
        <span class="n">SecretKeyFactory</span> <span class="n">keyFactory</span> <span class="o">=</span> <span class="n">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DES&#34;</span><span class="o">);</span>
        <span class="n">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">keyFactory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">desKeySpec</span><span class="o">);</span>
        <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DES&#34;</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">,</span> <span class="n">random</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">content</span><span class="o">)));</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="3des">3DES</h3>
<p>3DES (or Triple DES). It is an enhancement of DES algorithm, which uses three 56-bit keys to encrypt data three times. It takes DES as the basic module and designs a packet encryption algorithm by combining grouping methods. Compared with the original DES, 3DES is more secure. The default length of the key is <code>168 bit</code>, the password needs to be larger than <code>24 byte</code>, and the IV is an <code>8 byte</code> array of random numbers and letters.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">encrypt3DESECB</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">,</span> <span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">iv</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">IvParameterSpec</span> <span class="n">ivSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IvParameterSpec</span><span class="o">(</span><span class="n">iv</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="n">DESedeKeySpec</span> <span class="n">dks</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DESedeKeySpec</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="n">SecretKeyFactory</span> <span class="n">keyFactory</span> <span class="o">=</span> <span class="n">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DESede&#34;</span><span class="o">);</span>
            <span class="n">SecretKey</span> <span class="n">secretkey</span> <span class="o">=</span> <span class="n">keyFactory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">dks</span><span class="o">);</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DESede/CBC/PKCS5Padding&#34;</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">secretkey</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">content</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">)));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">decrypt3DESECB</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">,</span> <span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">iv</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">IvParameterSpec</span> <span class="n">ivSpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IvParameterSpec</span><span class="o">(</span><span class="n">iv</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="n">DESedeKeySpec</span> <span class="n">dks</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DESedeKeySpec</span><span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
            <span class="n">SecretKeyFactory</span> <span class="n">keyFactory</span> <span class="o">=</span> <span class="n">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DESede&#34;</span><span class="o">);</span>
            <span class="n">SecretKey</span> <span class="n">secretkey</span> <span class="o">=</span> <span class="n">keyFactory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">dks</span><span class="o">);</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;DESede/CBC/PKCS5Padding&#34;</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">secretkey</span><span class="o">,</span> <span class="n">ivSpec</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">content</span><span class="o">)),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><h3 id="aes">AES</h3>
<p>AES Advanced Data Encryption Standard, which is effective against all known attacks against the DES algorithm, has a default key length of <code>128 bit</code> and can also be selected from <code>192 bit</code> and <code>256 bit</code>. <code>AES-128</code> <code>AES-192</code> <code>AES-256</code></p>
<p>Default <code>AES-128</code>, use <code>PBEKeySpec</code> to generate a fixed size key.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">encryptAES128</span><span class="o">(</span><span class="n">String</span> <span class="n">plainText</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">,</span> <span class="n">String</span> <span class="n">salt</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">SecretKeyFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;PBKDF2WithHmacSHA1&#34;</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">saltBytes</span> <span class="o">=</span> <span class="n">salt</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
        <span class="c1">// AES-128 密钥长度为128bit
</span><span class="c1"></span>        <span class="n">PBEKeySpec</span> <span class="n">spec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PBEKeySpec</span><span class="o">(</span>
          <span class="n">password</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">(),</span>
          <span class="n">saltBytes</span><span class="o">,</span>
          <span class="n">1000</span><span class="o">,</span>
          <span class="n">128</span>
        <span class="o">);</span>
        <span class="n">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">spec</span><span class="o">);</span>
        <span class="n">SecretKeySpec</span> <span class="n">secret</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getEncoded</span><span class="o">(),</span> <span class="s">&#34;AES&#34;</span><span class="o">);</span>
        <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;AES/CBC/PKCS5Padding&#34;</span><span class="o">);</span>
        <span class="n">AlgorithmParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">getParameters</span><span class="o">();</span>
        <span class="n">IvParameterSpec</span> <span class="n">iv</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">getParameterSpec</span><span class="o">(</span><span class="n">IvParameterSpec</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">secret</span><span class="o">,</span> <span class="n">iv</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptedTextBytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">plainText</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>

        <span class="n">String</span> <span class="n">encodedText</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">encryptedTextBytes</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">encodedIV</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">iv</span><span class="o">.</span><span class="na">getIV</span><span class="o">());</span>
        <span class="n">String</span> <span class="n">encodedSalt</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">saltBytes</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">encodedSalt</span> <span class="o">+</span> <span class="s">&#34;.&#34;</span> <span class="o">+</span> <span class="n">encodedIV</span> <span class="o">+</span> <span class="s">&#34;.&#34;</span> <span class="o">+</span> <span class="n">encodedText</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">decryptAES128</span><span class="o">(</span><span class="n">String</span> <span class="n">encryptedText</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">String</span><span class="o">[]</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">encryptedText</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&#34;\\.&#34;</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">saltBytes</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">fields</span><span class="o">[</span><span class="n">0</span><span class="o">]);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">ivBytes</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">fields</span><span class="o">[</span><span class="n">1</span><span class="o">]);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptedTextBytes</span> <span class="o">=</span> <span class="n">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">fields</span><span class="o">[</span><span class="n">2</span><span class="o">]);</span>

        <span class="n">SecretKeyFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="n">SecretKeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;PBKDF2WithHmacSHA1&#34;</span><span class="o">);</span>
        <span class="n">PBEKeySpec</span> <span class="n">spec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PBEKeySpec</span><span class="o">(</span>
          <span class="n">password</span><span class="o">.</span><span class="na">toCharArray</span><span class="o">(),</span>
          <span class="n">saltBytes</span><span class="o">,</span>
          <span class="n">1000</span><span class="o">,</span>
          <span class="n">128</span>
        <span class="o">);</span>

        <span class="n">SecretKey</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="na">generateSecret</span><span class="o">(</span><span class="n">spec</span><span class="o">);</span>
        <span class="n">SecretKeySpec</span> <span class="n">secret</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SecretKeySpec</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getEncoded</span><span class="o">(),</span> <span class="s">&#34;AES&#34;</span><span class="o">);</span>
        <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;AES/CBC/PKCS5Padding&#34;</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">secret</span><span class="o">,</span> <span class="k">new</span> <span class="n">IvParameterSpec</span><span class="o">(</span><span class="n">ivBytes</span><span class="o">));</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">decryptedTextBytes</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">decryptedTextBytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">encryptedTextBytes</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">decryptedTextBytes</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IllegalBlockSizeException</span> <span class="o">|</span> <span class="n">BadPaddingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The following exception may occur when using <code>AES-256</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"> <span class="n">java</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">InvalidKeyException</span><span class="o">:</span> <span class="n">Illegal</span> <span class="n">key</span> <span class="n">size</span>
</code></pre></td></tr></table>
</div>
</div><p>JDK 1.8.0_161 and above have unlimited strength encryption enabled by default.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">    <span class="kd">static</span> <span class="o">{</span>
        <span class="n">java</span><span class="o">.</span><span class="na">security</span><span class="o">.</span><span class="na">Security</span><span class="o">.</span><span class="na">setProperty</span><span class="o">(</span><span class="s">&#34;crypto.policy&#34;</span><span class="o">,</span> <span class="s">&#34;unlimited&#34;</span><span class="o">);</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>JDK 1.8.0_161 Previous versions require manual installation of jce <strong>strategy file</strong> (<a href="https://www.oracle.com/java/technologies/javase-jce8-downloads.html">download address</a>)</p>
<h2 id="asymmetric-encryption-algorithm">Asymmetric encryption algorithm</h2>
<p>Asymmetric encryption uses a key pair, the public key for encryption and the private key for decryption. Regarding key size, as of 2020, the largest publicly known RSA key that is cracked is the 829-bit RSA-250, and it is recommended to use at least 2048-bit keys.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/21/850ed107aacd457c98f3715d6624fa56.png" alt="Asymmetric encryption algorithm"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"> <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">encrypt</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">publicKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">plainText</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">X509EncodedKeySpec</span> <span class="n">keySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">X509EncodedKeySpec</span><span class="o">(</span><span class="n">publicKey</span><span class="o">);</span>
        <span class="n">KeyFactory</span> <span class="n">kf</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">kf</span> <span class="o">=</span> <span class="n">KeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;RSA&#34;</span><span class="o">);</span>
            <span class="n">PublicKey</span> <span class="n">publicKeySecret</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="na">generatePublic</span><span class="o">(</span><span class="n">keySpec</span><span class="o">);</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;RSA/ECB/PKCS1Padding&#34;</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">ENCRYPT_MODE</span><span class="o">,</span> <span class="n">publicKeySecret</span><span class="o">);</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">encryptedBytes</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">plainText</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encode</span><span class="o">(</span><span class="n">encryptedBytes</span><span class="o">));</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;Rsa encrypt error &#34;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">decrypt</span><span class="o">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">privateKey</span><span class="o">,</span> <span class="n">String</span> <span class="n">encryptedText</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">PKCS8EncodedKeySpec</span> <span class="n">keySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PKCS8EncodedKeySpec</span><span class="o">(</span><span class="n">privateKey</span><span class="o">);</span>
        <span class="n">KeyFactory</span> <span class="n">kf</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">kf</span> <span class="o">=</span> <span class="n">KeyFactory</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;RSA&#34;</span><span class="o">);</span>
            <span class="n">PrivateKey</span> <span class="n">privateKeySecret</span> <span class="o">=</span> <span class="n">kf</span><span class="o">.</span><span class="na">generatePrivate</span><span class="o">(</span><span class="n">keySpec</span><span class="o">);</span>
            <span class="n">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="n">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">&#34;RSA/ECB/PKCS1Padding&#34;</span><span class="o">);</span>
            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">Cipher</span><span class="o">.</span><span class="na">DECRYPT_MODE</span><span class="o">,</span> <span class="n">privateKeySecret</span><span class="o">);</span>
            <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">Base64</span><span class="o">.</span><span class="na">getDecoder</span><span class="o">().</span><span class="na">decode</span><span class="o">(</span><span class="n">encryptedText</span><span class="o">)),</span> <span class="n">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;Rsa decrypt error &#34;</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/java/">java</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-03/kuberentes-federation/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Kubernetes, cluster federation, and resource distribution</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-03/k8s-nodeport-networkpolicy/">
            <span class="next-text nav-default">How to Configure NetworkPolicy for NodePort in Kubernetes</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
