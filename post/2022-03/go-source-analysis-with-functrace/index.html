<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Go project source code analysis with the help of functrace - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="1" /><meta name="keywords" content="golang, Source Analysis, Functrace" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-03/go-source-analysis-with-functrace/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Go project source code analysis with the help of functrace" />
<meta property="og:description" content="1" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-03/go-source-analysis-with-functrace/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-03-28T10:52:44+08:00" />
<meta property="article:modified_time" content="2022-03-28T10:52:44+08:00" />

<meta itemprop="name" content="Go project source code analysis with the help of functrace">
<meta itemprop="description" content="1"><meta itemprop="datePublished" content="2022-03-28T10:52:44+08:00" />
<meta itemprop="dateModified" content="2022-03-28T10:52:44+08:00" />
<meta itemprop="wordCount" content="2065">
<meta itemprop="keywords" content="golang," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go project source code analysis with the help of functrace"/>
<meta name="twitter:description" content="1"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Go project source code analysis with the help of functrace</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-03-28 10:52:44 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2065 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents"></nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/28/b1bbd1c169ec45088ed3dd84314506ad.png" alt="Go project source code analysis with the help of functrace"></p>
<p>The daily life of a programmer cannot be separated from &ldquo;source code reading and analysis&rdquo;, and the daily reading of code can only be done in these ways (or a combination of them).</p>
<ul>
<li>Combining the powerful source code cross-indexing and jumping features provided by source code editors or IDEs to establish links between codes in a large source code base.</li>
<li>running the code up, adding some print output to the code, tracing the execution flow and drawing it out.</li>
<li>Some people also like to use a debugger to trace the execution flow in a single step starting from a point (usually main).</li>
</ul>
<p>No matter which way, eventually, as long as enough time and attitude in place, will always analyze the code out of a rough.</p>
<p>From my point of view, no matter which paradigm: imperative, object-oriented, functional, the final comb out the source code vein is built on the execution of the basic unit (function or method), the main line of code execution (concurrent programs will have several) is essentially a function / method call chain. As long as this chain is sorted out, the code will not be difficult to understand. The code reading method described above essentially refers to this same logic. However, for code with a deeper call hierarchy and callbacks, sorting out the call chain is difficult and inefficient.</p>
<p>functrace was originally used to trace function call chains (thanks to the <a href="https://tip.golang.org/pkg/go/ast/">Abstract Syntax Tree AST API</a> made public by the Go core development team), but if we use functrace to output function call chains directly when reading code, it will dramatically improve our source code reading and analysis efficiency. Let&rsquo;s use a sample project to try out how to use functrace to sort out the main lines of code execution.</p>
<p>Let&rsquo;s take gnet, Go&rsquo;s high-performance, lightweight, non-blocking event-driven networking framework, as an example to see how to read and analyze gnet&rsquo;s source code. First we need to install the functrace tool.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$go</span> install github.com/bigwhite/functrace/cmd/gen@latest
go: downloading github.com/bigwhite/functrace v0.0.0-20210603024853-ccab68a2604c
go: downloading golang.org/x/tools v0.0.0-20201204062850-545788942d5f

<span class="nv">$gen</span> -h
<span class="o">[</span>gen -h<span class="o">]</span>
gen <span class="o">[</span>-w<span class="o">]</span> xxx.go
  -w    write result to <span class="o">(</span><span class="nb">source</span><span class="o">)</span> file instead of stdout
</code></pre></td></tr></table>
</div>
</div><p>Next, we download the gnet source code for the source code analysis to be performed.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$git</span> clone git@github.com:panjf2000/gnet.git
</code></pre></td></tr></table>
</div>
</div><p>We go to the gnet directory and now we can add a &ldquo;tracking facility&rdquo; to any go source file using the gen command, e.g.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$gen</span> -w gnet.go
<span class="o">[</span>gen -w gnet.go<span class="o">]</span>
add trace <span class="k">for</span> gnet.go ok

$ git diff gnet.go
diff --git a/gnet.go b/gnet.go
index b4c04a5..a7afe2b <span class="m">100644</span>
--- a/gnet.go
+++ b/gnet.go
@@ -29,6 +29,7 @@ import <span class="o">(</span>
        <span class="s2">&#34;sync&#34;</span>
        <span class="s2">&#34;time&#34;</span>

+       <span class="s2">&#34;github.com/bigwhite/functrace&#34;</span>
        <span class="s2">&#34;github.com/panjf2000/gnet/errors&#34;</span>
        <span class="s2">&#34;github.com/panjf2000/gnet/internal&#34;</span>
        <span class="s2">&#34;github.com/panjf2000/gnet/internal/logging&#34;</span>
... ...
</code></pre></td></tr></table>
</div>
</div><p>We can add &ldquo;trace facilities&rdquo; to specific go source files as we see fit, but in most cases, we can also add &ldquo;trace facilities&rdquo; to all go source files in a project in bulk via a script. The functrace project provides a simple script <a href="https://github.com/bigwhite/functrace/blob/main/scripts/batch_add_trace.sh">batch_add_trace.sh</a>, which we will use to bulk add &ldquo;trace facilities&rdquo; to all the go source files under gnet files under gnet with the function trace facility.</p>
<p>Download the functrace source code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$git</span> clone https://github.com/bigwhite/functrace.git
</code></pre></td></tr></table>
</div>
</div><p>Copy functrace/scripts/batch_add_trace.sh to the gnet directory above and execute the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1"># bash batch_add_trace.sh</span>
... ...
<span class="o">[</span>gen -w ./server_unix.go<span class="o">]</span>
add trace <span class="k">for</span> ./server_unix.go ok
<span class="o">[</span>gen -w ./internal/socket/sockopts_posix.go<span class="o">]</span>
add trace <span class="k">for</span> ./internal/socket/sockopts_posix.go ok
... ...
<span class="o">[</span>gen -w ./ringbuffer/ring_buffer_test.go<span class="o">]</span>
add trace <span class="k">for</span> ./ringbuffer/ring_buffer_test.go ok
<span class="o">[</span>gen -w ./ringbuffer/ring_buffer.go<span class="o">]</span>
add trace <span class="k">for</span> ./ringbuffer/ring_buffer.go ok
<span class="o">[</span>gen -w ./pool/bytebuffer/bytebuffer.go<span class="o">]</span>
no trace added <span class="k">for</span> ./pool/bytebuffer/bytebuffer.go
<span class="o">[</span>gen -w ./pool/goroutine/goroutine.go<span class="o">]</span>
add trace <span class="k">for</span> ./pool/goroutine/goroutine.go ok
<span class="o">[</span>gen -w ./pool/ringbuffer/ringbuffer.go<span class="o">]</span>
add trace <span class="k">for</span> ./pool/ringbuffer/ringbuffer.go ok
<span class="o">[</span>gen -w ./loop_linux.go<span class="o">]</span>
add trace <span class="k">for</span> ./loop_linux.go ok
<span class="o">[</span>gen -w ./server_windows.go<span class="o">]</span>
add trace <span class="k">for</span> ./server_windows.go ok
</code></pre></td></tr></table>
</div>
</div><p>Next we write a gnet-based program, and we&rsquo;ll use that code from gnet&rsquo;s participation in <a href="https://github.com/TechEmpower/FrameworkBenchmarks/tree/master/frameworks/Go/gnet">TechEmpower</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">//main.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;bytes&#34;</span>
    <span class="s">&#34;flag&#34;</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;log&#34;</span>
    <span class="s">&#34;runtime&#34;</span>
    <span class="s">&#34;time&#34;</span>

    <span class="s">&#34;github.com/panjf2000/gnet&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">httpServer</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="o">*</span><span class="nx">gnet</span><span class="p">.</span><span class="nx">EventServer</span>
<span class="p">}</span>

<span class="kd">type</span> <span class="nx">httpCodec</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">delimiter</span> <span class="p">[]</span><span class="kt">byte</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">hc</span> <span class="o">*</span><span class="nx">httpCodec</span><span class="p">)</span> <span class="nf">Encode</span><span class="p">(</span><span class="nx">c</span> <span class="nx">gnet</span><span class="p">.</span><span class="nx">Conn</span><span class="p">,</span> <span class="nx">buf</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">)</span> <span class="p">(</span><span class="nx">out</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">buf</span><span class="p">,</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">hc</span> <span class="o">*</span><span class="nx">httpCodec</span><span class="p">)</span> <span class="nf">Decode</span><span class="p">(</span><span class="nx">c</span> <span class="nx">gnet</span><span class="p">.</span><span class="nx">Conn</span><span class="p">)</span> <span class="p">(</span><span class="nx">out</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">err</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">buf</span> <span class="o">:=</span> <span class="nx">c</span><span class="p">.</span><span class="nf">Read</span><span class="p">()</span>
    <span class="k">if</span> <span class="nx">buf</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="k">return</span>
    <span class="p">}</span>
    <span class="nx">c</span><span class="p">.</span><span class="nf">ResetBuffer</span><span class="p">()</span>

    <span class="c1">// process the pipeline
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">i</span> <span class="kt">int</span>
<span class="nx">pipeline</span><span class="p">:</span>
    <span class="k">if</span> <span class="nx">i</span> <span class="p">=</span> <span class="nx">bytes</span><span class="p">.</span><span class="nf">Index</span><span class="p">(</span><span class="nx">buf</span><span class="p">,</span> <span class="nx">hc</span><span class="p">.</span><span class="nx">delimiter</span><span class="p">);</span> <span class="nx">i</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="p">{</span>
        <span class="nx">out</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">out</span><span class="p">,</span> <span class="s">&#34;HTTP/1.1 200 OK\r\nServer: gnet\r\nContent-Type: text/plain\r\nDate: &#34;</span><span class="o">...</span><span class="p">)</span>
        <span class="nx">out</span> <span class="p">=</span> <span class="nx">time</span><span class="p">.</span><span class="nf">Now</span><span class="p">().</span><span class="nf">AppendFormat</span><span class="p">(</span><span class="nx">out</span><span class="p">,</span> <span class="s">&#34;Mon, 02 Jan 2006 15:04:05 GMT&#34;</span><span class="p">)</span>
        <span class="nx">out</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">out</span><span class="p">,</span> <span class="s">&#34;\r\nContent-Length: 13\r\n\r\nHello, World!&#34;</span><span class="o">...</span><span class="p">)</span>
        <span class="nx">buf</span> <span class="p">=</span> <span class="nx">buf</span><span class="p">[</span><span class="nx">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:]</span>
        <span class="k">goto</span> <span class="nx">pipeline</span>
    <span class="p">}</span>
    <span class="c1">// request not ready, yet
</span><span class="c1"></span>    <span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">hs</span> <span class="o">*</span><span class="nx">httpServer</span><span class="p">)</span> <span class="nf">OnInitComplete</span><span class="p">(</span><span class="nx">srv</span> <span class="nx">gnet</span><span class="p">.</span><span class="nx">Server</span><span class="p">)</span> <span class="p">(</span><span class="nx">action</span> <span class="nx">gnet</span><span class="p">.</span><span class="nx">Action</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">log</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;HTTP server is listening on %s (multi-cores: %t, loops: %d)\n&#34;</span><span class="p">,</span>
        <span class="nx">srv</span><span class="p">.</span><span class="nx">Addr</span><span class="p">.</span><span class="nf">String</span><span class="p">(),</span> <span class="nx">srv</span><span class="p">.</span><span class="nx">Multicore</span><span class="p">,</span> <span class="nx">srv</span><span class="p">.</span><span class="nx">NumEventLoop</span><span class="p">)</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="p">(</span><span class="nx">hs</span> <span class="o">*</span><span class="nx">httpServer</span><span class="p">)</span> <span class="nf">React</span><span class="p">(</span><span class="nx">frame</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">c</span> <span class="nx">gnet</span><span class="p">.</span><span class="nx">Conn</span><span class="p">)</span> <span class="p">(</span><span class="nx">out</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">,</span> <span class="nx">action</span> <span class="nx">gnet</span><span class="p">.</span><span class="nx">Action</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle the request
</span><span class="c1"></span>    <span class="nx">out</span> <span class="p">=</span> <span class="nx">frame</span>
    <span class="k">return</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">runtime</span><span class="p">.</span><span class="nf">GOMAXPROCS</span><span class="p">(</span><span class="nx">runtime</span><span class="p">.</span><span class="nf">NumCPU</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">port</span> <span class="kt">int</span>
    <span class="kd">var</span> <span class="nx">multicore</span> <span class="kt">bool</span>

    <span class="c1">// Example command: go run main.go --port 8080 --multicore=true
</span><span class="c1"></span>    <span class="nx">flag</span><span class="p">.</span><span class="nf">IntVar</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">port</span><span class="p">,</span> <span class="s">&#34;port&#34;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">,</span> <span class="s">&#34;server port&#34;</span><span class="p">)</span>
    <span class="nx">flag</span><span class="p">.</span><span class="nf">BoolVar</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">multicore</span><span class="p">,</span> <span class="s">&#34;multicore&#34;</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="s">&#34;multicore&#34;</span><span class="p">)</span>
    <span class="nx">flag</span><span class="p">.</span><span class="nf">Parse</span><span class="p">()</span>

    <span class="nx">http</span> <span class="o">:=</span> <span class="nb">new</span><span class="p">(</span><span class="nx">httpServer</span><span class="p">)</span>
    <span class="nx">hc</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">httpCodec</span><span class="p">{</span><span class="nx">delimiter</span><span class="p">:</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="s">&#34;\r\n\r\n&#34;</span><span class="p">)}</span>

    <span class="c1">// Start serving!
</span><span class="c1"></span>    <span class="nx">log</span><span class="p">.</span><span class="nf">Fatal</span><span class="p">(</span><span class="nx">gnet</span><span class="p">.</span><span class="nf">Serve</span><span class="p">(</span><span class="nx">http</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nf">Sprintf</span><span class="p">(</span><span class="s">&#34;tcp://:%d&#34;</span><span class="p">,</span> <span class="nx">port</span><span class="p">),</span> <span class="nx">gnet</span><span class="p">.</span><span class="nf">WithMulticore</span><span class="p">(</span><span class="nx">multicore</span><span class="p">),</span> <span class="nx">gnet</span><span class="p">.</span><span class="nf">WithCodec</span><span class="p">(</span><span class="nx">hc</span><span class="p">)))</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Build this code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="err">$</span><span class="k">go</span> <span class="nx">mod</span> <span class="nx">init</span> <span class="nx">gnet</span><span class="o">-</span><span class="nx">demo</span>
<span class="err">$</span><span class="k">go</span> <span class="nx">get</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">panjf2000</span><span class="o">/</span><span class="nx">gnet</span>
<span class="k">go</span><span class="p">:</span> <span class="nx">downloading</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">panjf2000</span><span class="o">/</span><span class="nx">gnet</span> <span class="nx">v1</span><span class="mf">.4.5</span>
<span class="k">go</span> <span class="nx">get</span><span class="p">:</span> <span class="nx">added</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">panjf2000</span><span class="o">/</span><span class="nx">gnet</span> <span class="nx">v1</span><span class="mf">.4.5</span>

<span class="c1">//修改go.mod，使用replace让gnet-demo使用本地的gnet代码
</span><span class="c1"></span><span class="err">$</span><span class="nx">cat</span> <span class="k">go</span><span class="p">.</span><span class="nx">mod</span>
<span class="nx">module</span> <span class="nx">gnet</span><span class="o">-</span><span class="nx">demo</span>

<span class="k">go</span> <span class="mf">1.16</span>

<span class="nx">replace</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">panjf2000</span><span class="o">/</span><span class="nx">gnet</span> <span class="p">=&gt;</span> <span class="o">/</span><span class="nx">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">panjf2000</span><span class="o">/</span><span class="nx">gnet</span>

<span class="nf">require</span> <span class="p">(</span>
        <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">panjf2000</span><span class="o">/</span><span class="nx">gnet</span> <span class="nx">v1</span><span class="mf">.4.5</span>
<span class="p">)</span>

<span class="err">$</span><span class="k">go</span> <span class="nx">get</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">bigwhite</span><span class="o">/</span><span class="nx">functrace</span>
<span class="k">go</span> <span class="nx">get</span><span class="p">:</span> <span class="nx">added</span> <span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">bigwhite</span><span class="o">/</span><span class="nx">functrace</span> <span class="nx">v0</span><span class="mf">.0.0</span><span class="o">-</span><span class="mi">20210603024853</span><span class="o">-</span><span class="nx">ccab68a2604c</span>

<span class="err">$</span><span class="k">go</span> <span class="nx">build</span> <span class="o">-</span><span class="nx">tags</span> <span class="nx">trace</span> <span class="c1">//-tags trace务必不能省略，这个是开启functrace的关键
</span></code></pre></td></tr></table>
</div>
</div><p>After the build, let&rsquo;s execute the built executable: gnet-demo.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ go build -tags trace
root@VM-0-12-ubuntu:~/test/go/gnet-demo# ./gnet-demo
g<span class="o">[</span>01<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet/internal/socket.maxListenerBacklog
g<span class="o">[</span>01<span class="o">]</span>:  &lt;-github.com/panjf2000/gnet/internal/socket.maxListenerBacklog
g<span class="o">[</span>01<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet/ringbuffer.New
g<span class="o">[</span>01<span class="o">]</span>:  &lt;-github.com/panjf2000/gnet/ringbuffer.New
g<span class="o">[</span>01<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet/internal/logging.init.0
g<span class="o">[</span>01<span class="o">]</span>:  &lt;-github.com/panjf2000/gnet/internal/logging.init.0
g<span class="o">[</span>01<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet.WithMulticore
g<span class="o">[</span>01<span class="o">]</span>:  &lt;-github.com/panjf2000/gnet.WithMulticore
g<span class="o">[</span>01<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet.WithCodec
g<span class="o">[</span>01<span class="o">]</span>:  &lt;-github.com/panjf2000/gnet.WithCodec
g<span class="o">[</span>01<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet.Serve
g<span class="o">[</span>01<span class="o">]</span>:      -&gt;github.com/panjf2000/gnet.loadOptions
g<span class="o">[</span>01<span class="o">]</span>:      &lt;-github.com/panjf2000/gnet.loadOptions
g<span class="o">[</span>01<span class="o">]</span>:      -&gt;github.com/panjf2000/gnet.parseProtoAddr
g<span class="o">[</span>01<span class="o">]</span>:      &lt;-github.com/panjf2000/gnet.parseProtoAddr
g<span class="o">[</span>01<span class="o">]</span>:      -&gt;github.com/panjf2000/gnet.initListener
g<span class="o">[</span>01<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*listener<span class="o">)</span>.normalize
g<span class="o">[</span>01<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/socket.TCPSocket
g<span class="o">[</span>01<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/socket.tcpSocket
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/socket.getTCPSockaddr
g<span class="o">[</span>01<span class="o">]</span>:                          -&gt;github.com/panjf2000/gnet/internal/socket.determineTCPProto
g<span class="o">[</span>01<span class="o">]</span>:                          &lt;-github.com/panjf2000/gnet/internal/socket.determineTCPProto
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/socket.getTCPSockaddr
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/socket.sysSocket
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/socket.sysSocket
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/socket.SetNoDelay
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/socket.SetNoDelay
g<span class="o">[</span>01<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/socket.tcpSocket
g<span class="o">[</span>01<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/socket.TCPSocket
g<span class="o">[</span>01<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*listener<span class="o">)</span>.normalize
g<span class="o">[</span>01<span class="o">]</span>:      &lt;-github.com/panjf2000/gnet.initListener
g<span class="o">[</span>01<span class="o">]</span>:      -&gt;github.com/panjf2000/gnet.serve
2021/06/03 14:53:30 HTTP server is listening on :8080 <span class="o">(</span>multi-cores: true, loops: 1<span class="o">)</span>
g<span class="o">[</span>01<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.start
g<span class="o">[</span>01<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.activateReactors
g<span class="o">[</span>01<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/netpoll.OpenPoller
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.NewLockFreeQueue
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.NewLockFreeQueue
g<span class="o">[</span>01<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/netpoll.OpenPoller
g<span class="o">[</span>01<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*roundRobinLoadBalancer<span class="o">)</span>.register
g<span class="o">[</span>01<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*roundRobinLoadBalancer<span class="o">)</span>.register
g<span class="o">[</span>01<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.startSubReactors
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*roundRobinLoadBalancer<span class="o">)</span>.iterate
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*roundRobinLoadBalancer<span class="o">)</span>.iterate
g<span class="o">[</span>01<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.startSubReactors
g<span class="o">[</span>01<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/netpoll.OpenPoller
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>01<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.NewLockFreeQueue
g<span class="o">[</span>01<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.NewLockFreeQueue
g<span class="o">[</span>01<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/netpoll.OpenPoller
g<span class="o">[</span>01<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>01<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>01<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.activateReactors
g<span class="o">[</span>01<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.start
g<span class="o">[</span>01<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.stop
g<span class="o">[</span>01<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.waitForShutdown
g<span class="o">[</span>07<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.activateMainReactor
g<span class="o">[</span>07<span class="o">]</span>:      -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.Polling
g<span class="o">[</span>07<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.newEventList
g<span class="o">[</span>07<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.newEventList
g<span class="o">[</span>06<span class="o">]</span>:  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.activateSubReactor
g<span class="o">[</span>06<span class="o">]</span>:      -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.Polling
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.newEventList
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.newEventList
</code></pre></td></tr></table>
</div>
</div><p>We see that the main execution line of gnet is clearly printed out, and we can easily find the corresponding source file by the package where the output functions are located. g[01], the goroutine, is obviously the main goroutine, and the initialization trail of the whole program can be seen at a glance by tracing the function chain of g[01].</p>
<p>If we want to see how gnet handles an external link, we can create a connection to gnet-demo and see the output of gnet-demo.</p>
<p>We make an http request to gnet-demo via the curl command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$curl</span> localhost:8080
Hello, World!
</code></pre></td></tr></table>
</div>
</div><p>gnet-demo output.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">g<span class="o">[</span>07<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.acceptNewConnection
g<span class="o">[</span>07<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/socket.SockaddrToTCPOrUnixAddr
g<span class="o">[</span>07<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/socket.sockaddrInet6ToIPAndZone
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/socket.ip6ZoneToString
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/socket.ip6ZoneToString
g<span class="o">[</span>07<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/socket.sockaddrInet6ToIPAndZone
g<span class="o">[</span>07<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/socket.SockaddrToTCPOrUnixAddr
g<span class="o">[</span>07<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*roundRobinLoadBalancer<span class="o">)</span>.next
g<span class="o">[</span>07<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*roundRobinLoadBalancer<span class="o">)</span>.next
g<span class="o">[</span>07<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.newTCPConn
g<span class="o">[</span>07<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/pool/ringbuffer.Get
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Get
g<span class="o">[</span>07<span class="o">]</span>:                          -&gt;github.com/panjf2000/gnet/ringbuffer.New
g<span class="o">[</span>07<span class="o">]</span>:                          &lt;-github.com/panjf2000/gnet/ringbuffer.New
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Get
g<span class="o">[</span>07<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/pool/ringbuffer.Get
g<span class="o">[</span>07<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/pool/ringbuffer.Get
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Get
g<span class="o">[</span>07<span class="o">]</span>:                          -&gt;github.com/panjf2000/gnet/ringbuffer.New
g<span class="o">[</span>07<span class="o">]</span>:                          &lt;-github.com/panjf2000/gnet/ringbuffer.New
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Get
g<span class="o">[</span>07<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/pool/ringbuffer.Get
g<span class="o">[</span>07<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.newTCPConn
g<span class="o">[</span>07<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.Trigger
g<span class="o">[</span>07<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Enqueue
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.cas
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.cas
g<span class="o">[</span>07<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.cas
g<span class="o">[</span>07<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.cas
g<span class="o">[</span>07<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Enqueue
g<span class="o">[</span>07<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.Trigger
g<span class="o">[</span>07<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*server<span class="o">)</span>.acceptNewConnection
g<span class="o">[</span>07<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>07<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Dequeue
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.cas
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.cas
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Dequeue
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.AddRead
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopOpen
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.addConn
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.addConn
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*EventServer<span class="o">)</span>.OnOpened
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*EventServer<span class="o">)</span>.OnOpened
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.handleAction
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.handleAction
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopOpen
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Dequeue
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.load
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Dequeue
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Empty
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll/queue.<span class="o">(</span>*lockFreeQueue<span class="o">)</span>.Empty
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopRead
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.read
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.Read
g<span class="o">[</span>06<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.Read
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.ResetBuffer
g<span class="o">[</span>06<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.ResetBuffer
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.read
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*EventServer<span class="o">)</span>.PreWrite
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*EventServer<span class="o">)</span>.PreWrite
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.write
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.write
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.read
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.Read
g<span class="o">[</span>06<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.Read
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.ResetBuffer
g<span class="o">[</span>06<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.ResetBuffer
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.read
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Write
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Write
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopRead
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopRead
g<span class="o">[</span>06<span class="o">]</span>:              -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopCloseConn
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.IsEmpty
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.Delete
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*Poller<span class="o">)</span>.Delete
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.addConn
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.addConn
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*EventServer<span class="o">)</span>.OnClosed
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*EventServer<span class="o">)</span>.OnClosed
g<span class="o">[</span>06<span class="o">]</span>:                  -&gt;github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.releaseTCP
g<span class="o">[</span>06<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/pool/ringbuffer.Put
g<span class="o">[</span>06<span class="o">]</span>:                          -&gt;github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Put
g<span class="o">[</span>06<span class="o">]</span>:                              -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Len
g<span class="o">[</span>06<span class="o">]</span>:                              &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Len
g<span class="o">[</span>06<span class="o">]</span>:                              -&gt;github.com/panjf2000/gnet/pool/ringbuffer.index
g<span class="o">[</span>06<span class="o">]</span>:                              &lt;-github.com/panjf2000/gnet/pool/ringbuffer.index
g<span class="o">[</span>06<span class="o">]</span>:                              -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                              &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                          &lt;-github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Put
g<span class="o">[</span>06<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/pool/ringbuffer.Put
g<span class="o">[</span>06<span class="o">]</span>:                      -&gt;github.com/panjf2000/gnet/pool/ringbuffer.Put
g<span class="o">[</span>06<span class="o">]</span>:                          -&gt;github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Put
g<span class="o">[</span>06<span class="o">]</span>:                              -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Len
g<span class="o">[</span>06<span class="o">]</span>:                              &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Len
g<span class="o">[</span>06<span class="o">]</span>:                              -&gt;github.com/panjf2000/gnet/pool/ringbuffer.index
g<span class="o">[</span>06<span class="o">]</span>:                              &lt;-github.com/panjf2000/gnet/pool/ringbuffer.index
g<span class="o">[</span>06<span class="o">]</span>:                              -&gt;github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                              &lt;-github.com/panjf2000/gnet/ringbuffer.<span class="o">(</span>*RingBuffer<span class="o">)</span>.Reset
g<span class="o">[</span>06<span class="o">]</span>:                          &lt;-github.com/panjf2000/gnet/pool/ringbuffer.<span class="o">(</span>*Pool<span class="o">)</span>.Put
g<span class="o">[</span>06<span class="o">]</span>:                      &lt;-github.com/panjf2000/gnet/pool/ringbuffer.Put
g<span class="o">[</span>06<span class="o">]</span>:                  &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*conn<span class="o">)</span>.releaseTCP
g<span class="o">[</span>06<span class="o">]</span>:              &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopCloseConn
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet.<span class="o">(</span>*eventloop<span class="o">)</span>.loopRead
g<span class="o">[</span>06<span class="o">]</span>:          -&gt;github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
g<span class="o">[</span>06<span class="o">]</span>:          &lt;-github.com/panjf2000/gnet/internal/netpoll.<span class="o">(</span>*eventList<span class="o">)</span>.shrink
</code></pre></td></tr></table>
</div>
</div><p>Through the gnet-demo output, we can clearly see the chain of function calls for gnet to receive a connection, read and write on this connection and close this connection. With this chain, it is much easier for us to read the gnet source code again, even if there are callback functions.</p>
<p>The above output of the function call chain is already a lot of content. But if you are not satisfied with that, for example, I have to trace to golang.org/x/sys which gnet depends on, then you can use the same idea to download golang.org/x/sys locally and add the trace facility via functrace and replace golang.org/ x/sys so that it points to the local sys package code. If you think there is too much information, you can do individual necessary go source file trace information addition via the gen command, instead of unnecessarily using a batch approach. Further homework on tracing the function call chain of the sys package is left to you, so we won&rsquo;t dive into it here.</p>
<p>Once the code reading is complete, we can restore gnet to its original form by simply executing the following command in the gnet directory.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$git</span> checkout .
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/golang/">golang</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-03/go-escape/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Understanding Go escape analysis by example</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-03/global-images-distribution-network/">
            <span class="next-text nav-default">A global images distribution network</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
