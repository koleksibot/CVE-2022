<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Use the reflect package to read and write variables of all types in the reflection world - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Learn how to read and write Go basic type variables, compound type variables using the reflect package." /><meta name="keywords" content="golang, reflect" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-03/golang-reflect/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Use the reflect package to read and write variables of all types in the reflection world" />
<meta property="og:description" content="Learn how to read and write Go basic type variables, compound type variables using the reflect package." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-03/golang-reflect/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-03-29T09:54:22+08:00" />
<meta property="article:modified_time" content="2022-03-29T09:54:22+08:00" />

<meta itemprop="name" content="Use the reflect package to read and write variables of all types in the reflection world">
<meta itemprop="description" content="Learn how to read and write Go basic type variables, compound type variables using the reflect package."><meta itemprop="datePublished" content="2022-03-29T09:54:22+08:00" />
<meta itemprop="dateModified" content="2022-03-29T09:54:22+08:00" />
<meta itemprop="wordCount" content="2663">
<meta itemprop="keywords" content="golang," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Use the reflect package to read and write variables of all types in the reflection world"/>
<meta name="twitter:description" content="Learn how to read and write Go basic type variables, compound type variables using the reflect package."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Use the reflect package to read and write variables of all types in the reflection world</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-03-29 09:54:22 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2663 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-basic-types">1. basic types</a></li>
        <li><a href="#2-composite-types">2. Composite types</a></li>
        <li><a href="#3-get-the-value-of-the-system-resource-descriptor">3. Get the value of the system resource descriptor</a>
          <ul>
            <li><a href="#a-file-descriptors">a) File Descriptors</a></li>
            <li><a href="#b-socket-descriptors">b) socket descriptors</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/29/07fab7600d2e486ebf942a3247e3380a.png" alt="golang reflect"></p>
<p>The reflection package provided by Go in the standard library gives Go programs the ability to reflect at runtime (reflection), but this reflection ability is also a &ldquo;double-edged sword&rdquo;, it has the advantage of solving a specific class of problems, but also brings a lack of logic, performance problems, and difficult to find problems and debug It also brings disadvantages such as unclear logic, performance problems, and difficulty in problem identification and debugging. However, the reflect package, which has been released with Go since its inception, is an important and indispensable capability for Go. Whether you use it or not, it is important to master the basic methods of interacting with the type system using reflect, such as <strong>how to read and write variables of all types in a reflect world</strong>. In this article, we&rsquo;ll take a quick look at using the reflect package to read and write Go basic type variables, composite type variables, and their applications.</p>
<h2 id="1-basic-types">1. basic types</h2>
<blockquote>
<p>There are two main gates into the reflect world: <code>reflect.ValueOf</code> and <code>reflect.TypeOf</code>. When we enter the reflect world, each variable can find a <code>reflect.Value</code> that corresponds to its own, through which we can read and write information of real-world variables. Here we mainly go through the methods to manipulate the value of each type of variable, so we mainly use <code>reflect.ValueOf</code>.</p>
</blockquote>
<p>Go native basic types (non-compound types) mainly include:</p>
<ul>
<li>Integer(int, int8, int16, int32(rune), int64, uint, uint8(byte), uint16, uint32, uint64)</li>
<li>Floating-point type(float32, float64)</li>
<li>Complex type(complex64, complex128)</li>
<li>Boolean type(bool)</li>
<li>String type (string)</li>
</ul>
<p>How do we get the values of these type variables in the world of reflection, or how do we modify the values of these variables in the world of reflection? The following example can be used as a quick checklist for reading and writing Go basic type variables using reflect on a daily basis.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// github.com/bigwhite/experiments/blob/master/vars-in-reflect/basic/main.go
</span><span class="c1"></span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;reflect&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 整型
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">i</span> <span class="kt">int</span> <span class="p">=</span> <span class="mi">11</span>
    <span class="nx">vi</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>                         <span class="c1">// reflect Value of i
</span><span class="c1"></span>    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;i = [%d], vi = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">vi</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// i = [11], vi = [11]
</span><span class="c1"></span>    <span class="c1">// vi.SetInt(11 + 100) // panic: reflect: reflect.Value.SetInt using unaddressable value
</span><span class="c1"></span>
    <span class="nx">vai</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">i</span><span class="p">)</span> <span class="c1">// reflect Value of Address of i
</span><span class="c1"></span>    <span class="nx">vi</span> <span class="p">=</span> <span class="nx">vai</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;i = [%d], vi = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">vi</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// i = [11], vi = [11]
</span><span class="c1"></span>    <span class="nx">vi</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, i = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="c1">// after set, i = [111]
</span><span class="c1"></span>
    <span class="c1">// 整型指针
</span><span class="c1"></span>    <span class="nx">i</span> <span class="p">=</span> <span class="mi">11</span>
    <span class="kd">var</span> <span class="nx">pi</span> <span class="o">*</span><span class="kt">int</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">i</span>
    <span class="nx">vpi</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">pi</span><span class="p">)</span> <span class="c1">// reflect Value of pi
</span><span class="c1"></span>    <span class="nx">vi</span> <span class="p">=</span> <span class="nx">vpi</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">vi</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">11</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, i = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="c1">// after set, i = [111]
</span><span class="c1"></span>
    <span class="c1">// 浮点型
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">f</span> <span class="kt">float64</span> <span class="p">=</span> <span class="mf">3.1415</span>

    <span class="nx">vaf</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">f</span><span class="p">)</span>
    <span class="nx">vf</span> <span class="o">:=</span> <span class="nx">vaf</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;f = [%f], vf = [%f]\n&#34;</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="nx">vf</span><span class="p">.</span><span class="nf">Float</span><span class="p">())</span> <span class="c1">// f = [3.141500], vf = [3.141500]
</span><span class="c1"></span>    <span class="nx">vf</span><span class="p">.</span><span class="nf">SetFloat</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mf">3.1415</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, f = [%f]\n&#34;</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="c1">// after set, f = [103.141500]
</span><span class="c1"></span>
    <span class="c1">// 复数型
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">c</span> <span class="p">=</span> <span class="nb">complex</span><span class="p">(</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">6.2</span><span class="p">)</span>

    <span class="nx">vac</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">c</span><span class="p">)</span>
    <span class="nx">vc</span> <span class="o">:=</span> <span class="nx">vac</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;c = [%g], vc = [%g]\n&#34;</span><span class="p">,</span> <span class="nx">f</span><span class="p">,</span> <span class="nx">vc</span><span class="p">.</span><span class="nf">Complex</span><span class="p">())</span> <span class="c1">// c = [103.1415], vc = [(5.1+6.2i)]
</span><span class="c1"></span>    <span class="nx">vc</span><span class="p">.</span><span class="nf">SetComplex</span><span class="p">(</span><span class="nb">complex</span><span class="p">(</span><span class="mf">105.1</span><span class="p">,</span> <span class="mf">106.2</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, c = [%g]\n&#34;</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="c1">// after set, c = [(105.1+106.2i)]
</span><span class="c1"></span>
    <span class="c1">// 布尔类型
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">b</span> <span class="kt">bool</span> <span class="p">=</span> <span class="kc">true</span>

    <span class="nx">vab</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">b</span><span class="p">)</span>
    <span class="nx">vb</span> <span class="o">:=</span> <span class="nx">vab</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;b = [%t], vb = [%t]\n&#34;</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">vb</span><span class="p">.</span><span class="nf">Bool</span><span class="p">())</span> <span class="c1">// b = [true], vb = [true]
</span><span class="c1"></span>    <span class="nx">vb</span><span class="p">.</span><span class="nf">SetBool</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, b = [%t]\n&#34;</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="c1">// after set, b = [false]
</span><span class="c1"></span>
    <span class="c1">// 字符串类型
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">s</span> <span class="kt">string</span> <span class="p">=</span> <span class="s">&#34;hello, reflect&#34;</span>

    <span class="nx">vas</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">s</span><span class="p">)</span>
    <span class="nx">vs</span> <span class="o">:=</span> <span class="nx">vas</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;s = [%s], vs = [%s]\n&#34;</span><span class="p">,</span> <span class="nx">s</span><span class="p">,</span> <span class="nx">vs</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span> <span class="c1">// s = [hello, reflect], vs = [hello, reflect]
</span><span class="c1"></span>    <span class="nx">vs</span><span class="p">.</span><span class="nf">SetString</span><span class="p">(</span><span class="s">&#34;bye, reflect&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, s = [%s]\n&#34;</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span> <span class="c1">// after set, s = [bye, reflect]
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We see that.</p>
<ul>
<li>The native basic type variable enters the reflection world via <code>reflect.ValueOf</code>, and if the value of the original variable is eventually modified in the reflection world, then what is passed to ValueOf should not be the variable itself, but the address of the variable, except for the pointer type.</li>
<li>After entering the reflection world, use the Elem method of <code>reflect.Value</code> to get the real instance of Value that the pointer/address points to, and read the value of the variable through various &ldquo;method sugars&rdquo; provided by the Value type, such as <code>reflect.Value.Int</code>,<code>reflect.Value.String</code>,<code>reflect.Value.Bool</code> etc.</li>
<li>Similarly, in the reflection world, we set the value of the variable in question at runtime through the SetXXX series of methods of <code>reflect.Value</code>.</li>
</ul>
<h2 id="2-composite-types">2. Composite types</h2>
<p>As we have seen before, it is relatively easy to read and write variables of native basic types in the reflection world using the reflect package, so let&rsquo;s take a look at reading and writing variables of composite type.</p>
<p>The composite types in Go include.</p>
<ul>
<li>Arrays</li>
<li>slice</li>
<li>map</li>
<li>structure</li>
<li>channel</li>
</ul>
<p>Unlike basic type variables, compound variables consist of both isomorphic and heteromorphic fields or elements, so how to read and write the value of a field or element in a compound type variable is what we need to consider. The following example can be used as a quick checklist for reading and writing field or element values in Go composite variables in the reflection world using reflect on a daily basis.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// github.com/bigwhite/experiments/blob/master/vars-in-reflect/composite/main.go
</span><span class="c1"></span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;reflect&#34;</span>
    <span class="s">&#34;unsafe&#34;</span>
<span class="p">)</span>

<span class="kd">type</span> <span class="nx">Foo</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="kt">string</span>
    <span class="nx">age</span>  <span class="kt">int</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// 数组
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">a</span> <span class="p">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="kt">int</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">}</span>
    <span class="nx">vaa</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">a</span><span class="p">)</span> <span class="c1">// reflect Value of Address of arr
</span><span class="c1"></span>    <span class="nx">va</span> <span class="o">:=</span> <span class="nx">vaa</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">va0</span> <span class="o">:=</span> <span class="nx">va</span><span class="p">.</span><span class="nf">Index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;a0 = [%d], va0 = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">va0</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// a0 = [1], va0 = [1]
</span><span class="c1"></span>    <span class="nx">va0</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, a0 = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">a</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">// after set, a0 = [101]
</span><span class="c1"></span>
    <span class="c1">// 切片
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">s</span> <span class="p">=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">}</span>
    <span class="nx">vs</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span>
    <span class="nx">vs0</span> <span class="o">:=</span> <span class="nx">vs</span><span class="p">.</span><span class="nf">Index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;s0 = [%d], vs0 = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">vs0</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// s0 = [11], vs0 = [11]
</span><span class="c1"></span>    <span class="nx">vs0</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, s0 = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1">// after set, s0 = [111]
</span><span class="c1"></span>
    <span class="c1">// map
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">m</span> <span class="p">=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
        <span class="mi">1</span><span class="p">:</span> <span class="s">&#34;tom&#34;</span><span class="p">,</span>
        <span class="mi">2</span><span class="p">:</span> <span class="s">&#34;jerry&#34;</span><span class="p">,</span>
        <span class="mi">3</span><span class="p">:</span> <span class="s">&#34;lucy&#34;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nx">vm</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">m</span><span class="p">)</span>
    <span class="nx">vm_1_v</span> <span class="o">:=</span> <span class="nx">vm</span><span class="p">.</span><span class="nf">MapIndex</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>                      <span class="c1">// the reflect Value of the value of key 1
</span><span class="c1"></span>    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;m_1 = [%s], vm_1 = [%s]\n&#34;</span><span class="p">,</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">vm_1_v</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span> <span class="c1">// m_1 = [tom], vm_1 = [tom]
</span><span class="c1"></span>    <span class="nx">vm</span><span class="p">.</span><span class="nf">SetMapIndex</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="s">&#34;tony&#34;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, m_1 = [%s]\n&#34;</span><span class="p">,</span> <span class="nx">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1">// after set, m_1 = [tony]
</span><span class="c1"></span>
    <span class="c1">// 为map m新增一组key-value
</span><span class="c1"></span>    <span class="nx">vm</span><span class="p">.</span><span class="nf">SetMapIndex</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="s">&#34;amy&#34;</span><span class="p">))</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, m = [%#v]\n&#34;</span><span class="p">,</span> <span class="nx">m</span><span class="p">)</span> <span class="c1">// after set, m = [map[int]string{1:&#34;tony&#34;, 2:&#34;jerry&#34;, 3:&#34;lucy&#34;, 4:&#34;amy&#34;}]
</span><span class="c1"></span>
    <span class="c1">// 结构体
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">f</span> <span class="p">=</span> <span class="nx">Foo</span><span class="p">{</span>
        <span class="nx">Name</span><span class="p">:</span> <span class="s">&#34;lily&#34;</span><span class="p">,</span>
        <span class="nx">age</span><span class="p">:</span>  <span class="mi">16</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nx">vaf</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">f</span><span class="p">)</span>
    <span class="nx">vf</span> <span class="o">:=</span> <span class="nx">vaf</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">field1</span> <span class="o">:=</span> <span class="nx">vf</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;Name&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;the Name of f = [%s]\n&#34;</span><span class="p">,</span> <span class="nx">field1</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span> <span class="c1">// the Name of f = [lily]
</span><span class="c1"></span>    <span class="nx">field2</span> <span class="o">:=</span> <span class="nx">vf</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;the age of f = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">field2</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// the age of f = [16]
</span><span class="c1"></span>
    <span class="nx">field1</span><span class="p">.</span><span class="nf">SetString</span><span class="p">(</span><span class="s">&#34;ally&#34;</span><span class="p">)</span>
    <span class="c1">// field2.SetInt(8) // panic: reflect: reflect.Value.SetInt using value obtained using unexported field
</span><span class="c1"></span>    <span class="nx">nAge</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">NewAt</span><span class="p">(</span><span class="nx">field2</span><span class="p">.</span><span class="nf">Type</span><span class="p">(),</span> <span class="nx">unsafe</span><span class="p">.</span><span class="nf">Pointer</span><span class="p">(</span><span class="nx">field2</span><span class="p">.</span><span class="nf">UnsafeAddr</span><span class="p">())).</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">nAge</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, f is [%#v]\n&#34;</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="c1">// after set, f is [main.Foo{Name:&#34;ally&#34;, age:8}]
</span><span class="c1"></span>
    <span class="c1">// 接口
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">g</span> <span class="p">=</span> <span class="nx">Foo</span><span class="p">{</span>
        <span class="nx">Name</span><span class="p">:</span> <span class="s">&#34;Jordan&#34;</span><span class="p">,</span>
        <span class="nx">age</span><span class="p">:</span>  <span class="mi">40</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1">// 接口底层动态类型为复合类型变量
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">i</span> <span class="kd">interface</span><span class="p">{}</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">g</span>
    <span class="nx">vi</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
    <span class="nx">vg</span> <span class="o">:=</span> <span class="nx">vi</span><span class="p">.</span><span class="nf">Elem</span><span class="p">()</span>

    <span class="nx">field1</span> <span class="p">=</span> <span class="nx">vg</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;Name&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;the Name of g = [%s]\n&#34;</span><span class="p">,</span> <span class="nx">field1</span><span class="p">.</span><span class="nf">String</span><span class="p">())</span> <span class="c1">// the Name of g = [Jordan]
</span><span class="c1"></span>    <span class="nx">field2</span> <span class="p">=</span> <span class="nx">vg</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;the age of g = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">field2</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// the age of g = [40]
</span><span class="c1"></span>
    <span class="nx">nAge</span> <span class="p">=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">NewAt</span><span class="p">(</span><span class="nx">field2</span><span class="p">.</span><span class="nf">Type</span><span class="p">(),</span> <span class="nx">unsafe</span><span class="p">.</span><span class="nf">Pointer</span><span class="p">(</span><span class="nx">field2</span><span class="p">.</span><span class="nf">UnsafeAddr</span><span class="p">())).</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">nAge</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, g is [%#v]\n&#34;</span><span class="p">,</span> <span class="nx">g</span><span class="p">)</span> <span class="c1">// after set, g is [main.Foo{Name:&#34;Jordan&#34;, age:50}]
</span><span class="c1"></span>
    <span class="c1">// 接口底层动态类型为基本类型变量
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">n</span> <span class="p">=</span> <span class="mi">5</span>
    <span class="nx">i</span> <span class="p">=</span> <span class="o">&amp;</span><span class="nx">n</span>
    <span class="nx">vi</span> <span class="p">=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;i = [%d], vi = [%d]\n&#34;</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">vi</span><span class="p">.</span><span class="nf">Int</span><span class="p">())</span> <span class="c1">// i = [5], vi = [5]
</span><span class="c1"></span>    <span class="nx">vi</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;after set, n is [%d]\n&#34;</span><span class="p">,</span> <span class="nx">n</span><span class="p">)</span> <span class="c1">// after set, n is [10]
</span><span class="c1"></span>
    <span class="c1">// channel
</span><span class="c1"></span>    <span class="kd">var</span> <span class="nx">ch</span> <span class="p">=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="nx">vch</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">ch</span><span class="p">)</span>
    <span class="nx">vch</span><span class="p">.</span><span class="nf">Send</span><span class="p">(</span><span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span>

    <span class="nx">j</span> <span class="o">:=</span> <span class="o">&lt;-</span><span class="nx">ch</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;recv [%d] from channel\n&#34;</span><span class="p">,</span> <span class="nx">j</span><span class="p">)</span> <span class="c1">// recv [22] from channel
</span><span class="c1"></span>
    <span class="nx">ch</span> <span class="o">&lt;-</span> <span class="mi">33</span>
    <span class="nx">vj</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">vch</span><span class="p">.</span><span class="nf">Recv</span><span class="p">()</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;recv [%d] ok[%t]\n&#34;</span><span class="p">,</span> <span class="nx">vj</span><span class="p">.</span><span class="nf">Int</span><span class="p">(),</span> <span class="nx">ok</span><span class="p">)</span> <span class="c1">// recv [33] ok[true]
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>From the above example, we can get some information as follows.</p>
<ul>
<li>In the world of reflection, the reflect package provides corresponding methods for reading and writing elements or fields in composite types, such as <code>Value.Index</code> for array and slice elements, Value.MapIndex for map key-value, Field, FieldByName for structure fields, and Send and Recv for channel.</li>
<li>slices, maps and channels, because their underlying implementation is a pointer type structure, we can directly modify their internal elements in the reflection world using their corresponding Value in the reflection world.</li>
<li>For the non-exported fields in the structure (unexported field), we can read their values, but we cannot modify their values directly. In the above example, we have implemented the assignment of the value by the following unsafe means.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">nAge</span> <span class="p">=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">NewAt</span><span class="p">(</span><span class="nx">field2</span><span class="p">.</span><span class="nf">Type</span><span class="p">(),</span> <span class="nx">unsafe</span><span class="p">.</span><span class="nf">Pointer</span><span class="p">(</span><span class="nx">field2</span><span class="p">.</span><span class="nf">UnsafeAddr</span><span class="p">())).</span><span class="nf">Elem</span><span class="p">()</span>
<span class="nx">nAge</span><span class="p">.</span><span class="nf">SetInt</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>We create a new Value instance through reflect.NewAt, which represents a pointer to the field2 address. Then through the Elem method, we get the Value of the object pointed by that pointer Value: nAge, which is actually the field2 variable. The new value set by nAge will then also be reflected in the value of field2. This is similar to the function of vpi and vi in the basic type example above.</p>
<h2 id="3-get-the-value-of-the-system-resource-descriptor">3. Get the value of the system resource descriptor</h2>
<p>One of the functions of the reflect package is to get the value of some system resource descriptors that are encapsulated in the underlying system, such as socket descriptors and file descriptors.</p>
<h3 id="a-file-descriptors">a) File Descriptors</h3>
<p>File provides the Fd method to get the value of the underlying os file descriptor. We can also use reflection to achieve the same functionality.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// github.com/bigwhite/experiments/blob/master/vars-in-reflect/system-resource/file_fd.go
</span><span class="c1"></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;os&#34;</span>
    <span class="s">&#34;reflect&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">fileFD</span><span class="p">(</span><span class="nx">f</span> <span class="o">*</span><span class="nx">os</span><span class="p">.</span><span class="nx">File</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="nx">file</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">f</span><span class="p">).</span><span class="nf">Elem</span><span class="p">().</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;file&#34;</span><span class="p">).</span><span class="nf">Elem</span><span class="p">()</span>
    <span class="nx">pfdVal</span> <span class="o">:=</span> <span class="nx">file</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;pfd&#34;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nx">pfdVal</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;Sysfd&#34;</span><span class="p">).</span><span class="nf">Int</span><span class="p">())</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">fileName</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nx">f</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">os</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">fileName</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">defer</span> <span class="nx">f</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;file descriptor is %d\n&#34;</span><span class="p">,</span> <span class="nx">f</span><span class="p">.</span><span class="nf">Fd</span><span class="p">())</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;file descriptor in reflect is %d\n&#34;</span><span class="p">,</span> <span class="nf">fileFD</span><span class="p">(</span><span class="nx">f</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>To execute the above example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">$go</span> build file_fd.go
$./file_fd file_fd.go
file descriptor is <span class="m">3</span>
file descriptor in reflect is <span class="m">3</span>
</code></pre></td></tr></table>
</div>
</div><p>We see that the fd value obtained by reflect is the same as the value obtained by the Fd method.</p>
<p>Here we can briefly analyze the implementation of the fileFD function based on the above understanding of reading and writing basic and compound type variables.</p>
<p>The definition of os.File is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// $GOROOT/src/os/types.go
</span><span class="c1"></span>
<span class="kd">type</span> <span class="nx">File</span> <span class="kd">struct</span> <span class="p">{</span>
        <span class="o">*</span><span class="nx">file</span> <span class="c1">// os specific
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>To get the unexported pointer variable file by reflection, we use the following reflection statement.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">file</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">f</span><span class="p">).</span><span class="nf">Elem</span><span class="p">().</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;file&#34;</span><span class="p">).</span><span class="nf">Elem</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>With the above Value instance file, we can proceed to reflect the os.file structure. os.file structure varies from os to os, taking the linux/mac unix as an example, the os.file structure is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// $GOROOT/src/os/file_unix.go
</span><span class="c1"></span>
<span class="kd">type</span> <span class="nx">file</span> <span class="kd">struct</span> <span class="p">{</span>
        <span class="nx">pfd</span>         <span class="nx">poll</span><span class="p">.</span><span class="nx">FD</span>
        <span class="nx">name</span>        <span class="kt">string</span>
        <span class="nx">dirinfo</span>     <span class="o">*</span><span class="nx">dirInfo</span> <span class="c1">// nil unless directory being read
</span><span class="c1"></span>        <span class="nx">nonblock</span>    <span class="kt">bool</span>     <span class="c1">// whether we set nonblocking mode
</span><span class="c1"></span>        <span class="nx">stdoutOrErr</span> <span class="kt">bool</span>     <span class="c1">// whether this is stdout or stderr
</span><span class="c1"></span>        <span class="nx">appendMode</span>  <span class="kt">bool</span>     <span class="c1">// whether file is opened for appending
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>So we continue with the reflection.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="nx">pfdVal</span> <span class="o">:=</span> <span class="nx">file</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;pfd&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>And the structure of <code>poll.FD</code> is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// $GOROOT/src/internal/poll/fd_unix.go
</span><span class="c1"></span>
<span class="c1">// field of a larger type representing a network connection or OS file.
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">FD</span> <span class="kd">struct</span> <span class="p">{</span>
        <span class="c1">// Lock sysfd and serialize access to Read and Write methods.
</span><span class="c1"></span>        <span class="nx">fdmu</span> <span class="nx">fdMutex</span>

        <span class="c1">// System file descriptor. Immutable until Close.
</span><span class="c1"></span>        <span class="nx">Sysfd</span> <span class="kt">int</span>

        <span class="c1">// I/O poller.
</span><span class="c1"></span>        <span class="nx">pd</span> <span class="nx">pollDesc</span>

        <span class="c1">// Writev cache.
</span><span class="c1"></span>        <span class="nx">iovecs</span> <span class="o">*</span><span class="p">[]</span><span class="nx">syscall</span><span class="p">.</span><span class="nx">Iovec</span> 

        <span class="c1">// Semaphore signaled when file is closed.
</span><span class="c1"></span>        <span class="nx">csema</span> <span class="kt">uint32</span>

        <span class="c1">// Non-zero if this file has been set to blocking mode.
</span><span class="c1"></span>        <span class="nx">isBlocking</span> <span class="kt">uint32</span>

        <span class="c1">// Whether this is a streaming descriptor, as opposed to a
</span><span class="c1"></span>        <span class="c1">// packet-based descriptor like a UDP socket. Immutable.
</span><span class="c1"></span>        <span class="nx">IsStream</span> <span class="kt">bool</span>

        <span class="c1">// Whether a zero byte read indicates EOF. This is false for a
</span><span class="c1"></span>        <span class="c1">// message based socket connection.
</span><span class="c1"></span>        <span class="nx">ZeroReadIsEOF</span> <span class="kt">bool</span>

        <span class="c1">// Whether this is a file rather than a network socket.
</span><span class="c1"></span>        <span class="nx">isFile</span> <span class="kt">bool</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The Sysfd record is the value of the system file descriptor, so you can get the value of the file descriptor by using the following statement.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nx">pfdVal</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;Sysfd&#34;</span><span class="p">).</span><span class="nf">Int</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="b-socket-descriptors">b) socket descriptors</h3>
<p>The socket descriptor is also a file descriptor, and Go does not provide an API to get the socket file descriptor directly in the standard library; we can only get it through reflection. See the following example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// github.com/bigwhite/experiments/blob/master/vars-in-reflect/system-resource/socket_fd.go
</span><span class="c1"></span>
<span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;log&#34;</span>
    <span class="s">&#34;net&#34;</span>
    <span class="s">&#34;reflect&#34;</span>
<span class="p">)</span>

<span class="kd">func</span> <span class="nf">socketFD</span><span class="p">(</span><span class="nx">conn</span> <span class="nx">net</span><span class="p">.</span><span class="nx">Conn</span><span class="p">)</span> <span class="kt">int</span> <span class="p">{</span>
    <span class="nx">tcpConn</span> <span class="o">:=</span> <span class="nx">reflect</span><span class="p">.</span><span class="nf">ValueOf</span><span class="p">(</span><span class="nx">conn</span><span class="p">).</span><span class="nf">Elem</span><span class="p">().</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;conn&#34;</span><span class="p">)</span>
    <span class="nx">fdVal</span> <span class="o">:=</span> <span class="nx">tcpConn</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;fd&#34;</span><span class="p">)</span>
    <span class="nx">pfdVal</span> <span class="o">:=</span> <span class="nx">fdVal</span><span class="p">.</span><span class="nf">Elem</span><span class="p">().</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;pfd&#34;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nx">pfdVal</span><span class="p">.</span><span class="nf">FieldByName</span><span class="p">(</span><span class="s">&#34;Sysfd&#34;</span><span class="p">).</span><span class="nf">Int</span><span class="p">())</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="nx">ln</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">net</span><span class="p">.</span><span class="nf">Listen</span><span class="p">(</span><span class="s">&#34;tcp&#34;</span><span class="p">,</span> <span class="s">&#34;:8080&#34;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
        <span class="nb">panic</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">for</span> <span class="p">{</span>
        <span class="nx">conn</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">ln</span><span class="p">.</span><span class="nf">Accept</span><span class="p">()</span>
        <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">if</span> <span class="nx">ne</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">err</span><span class="p">.(</span><span class="nx">net</span><span class="p">.</span><span class="nx">Error</span><span class="p">);</span> <span class="nx">ok</span> <span class="o">&amp;&amp;</span> <span class="nx">ne</span><span class="p">.</span><span class="nf">Temporary</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">log</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;accept temp err: %v&#34;</span><span class="p">,</span> <span class="nx">ne</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="p">}</span>

            <span class="nx">log</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;accept err: %v&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="p">}</span>

        <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;conn fd is [%d]\n&#34;</span><span class="p">,</span> <span class="nf">socketFD</span><span class="p">(</span><span class="nx">conn</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><p>We see that the implementation of socketFD is somewhat similar to the implementation of fileFD, where we get the underlying Sysfd by reflecting from <code>net.Conn</code> step by step.</p>
<p>The real parameter passed to socketFD is essentially an instance of TCPConn, and we can get the value of this instance in the reflection world by <code>reflect.ValueOf(conn).Elem()</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// $GOROOT/src/net/tcpsock.go
</span><span class="c1"></span>
<span class="kd">type</span> <span class="nx">TCPConn</span> <span class="kd">struct</span> <span class="p">{</span>
        <span class="nx">conn</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Then get the Value of the field conn in the TCPConn structure in the reflection world by FieldByName(&ldquo;conn&rdquo;). <code>net.conn</code> structure is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// $GOROOT/src/net/net.go
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">conn</span> <span class="kd">struct</span> <span class="p">{</span>
        <span class="nx">fd</span> <span class="o">*</span><span class="nx">netFD</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>One of the netFDs is an os-related structure, taking linux/mac as an example, which has the following structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-go" data-lang="go"><span class="c1">// $GOROOT/src/net/fd_posix.go
</span><span class="c1"></span>
<span class="c1">// Network file descriptor.
</span><span class="c1"></span><span class="kd">type</span> <span class="nx">netFD</span> <span class="kd">struct</span> <span class="p">{</span>
        <span class="nx">pfd</span> <span class="nx">poll</span><span class="p">.</span><span class="nx">FD</span>

        <span class="c1">// immutable until Close
</span><span class="c1"></span>        <span class="nx">family</span>      <span class="kt">int</span>
        <span class="nx">sotype</span>      <span class="kt">int</span>
        <span class="nx">isConnected</span> <span class="kt">bool</span> <span class="c1">// handshake completed or use of association with peer
</span><span class="c1"></span>        <span class="nx">net</span>         <span class="kt">string</span>
        <span class="nx">laddr</span>       <span class="nx">Addr</span>
        <span class="nx">raddr</span>       <span class="nx">Addr</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>We again see the poll.FD type field pfd, and further down the reflection is consistent with fileFD.</p>
<p>The source code covered in this article can be downloaded at <a href="https://github.com/bigwhite/experiments/blob/master/vars-in-reflect">here</a>.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/golang/">golang</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-03/pitfall-in-std-flag-pkg/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">The &#34;little trap&#34; of the Go standard library flag package</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-03/golang-grpc/">
            <span class="next-text nav-default">Things to know about the gRPC client</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
