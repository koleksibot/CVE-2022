<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>C# read and write xml documents - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="C# read and write xml documents mainly through XmlDocument, XmlReader and XmlWriter three classes to achieve. XmlReader only has read functionality. XmlWriter has only write functionality. XmlDocument has both Read and Write functionality. Read This article, read the xml document for the online xml document (non-local files, replaced by local documents can also be), you can use your browser to open this document address: http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml to view the contents of" /><meta name="keywords" content="c#, Xml, Read Write" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-03/csharp-xml-read-write/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="C# read and write xml documents" />
<meta property="og:description" content="C# read and write xml documents mainly through XmlDocument, XmlReader and XmlWriter three classes to achieve. XmlReader only has read functionality. XmlWriter has only write functionality. XmlDocument has both Read and Write functionality. Read This article, read the xml document for the online xml document (non-local files, replaced by local documents can also be), you can use your browser to open this document address: http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml to view the contents of" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-03/csharp-xml-read-write/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-03-04T15:55:59+08:00" />
<meta property="article:modified_time" content="2022-03-04T15:55:59+08:00" />

<meta itemprop="name" content="C# read and write xml documents">
<meta itemprop="description" content="C# read and write xml documents mainly through XmlDocument, XmlReader and XmlWriter three classes to achieve. XmlReader only has read functionality. XmlWriter has only write functionality. XmlDocument has both Read and Write functionality. Read This article, read the xml document for the online xml document (non-local files, replaced by local documents can also be), you can use your browser to open this document address: http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml to view the contents of"><meta itemprop="datePublished" content="2022-03-04T15:55:59+08:00" />
<meta itemprop="dateModified" content="2022-03-04T15:55:59+08:00" />
<meta itemprop="wordCount" content="1012">
<meta itemprop="keywords" content="c#," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="C# read and write xml documents"/>
<meta name="twitter:description" content="C# read and write xml documents mainly through XmlDocument, XmlReader and XmlWriter three classes to achieve. XmlReader only has read functionality. XmlWriter has only write functionality. XmlDocument has both Read and Write functionality. Read This article, read the xml document for the online xml document (non-local files, replaced by local documents can also be), you can use your browser to open this document address: http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml to view the contents of"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">C# read and write xml documents</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-03-04 15:55:59 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1012 words </span>
          <span class="more-meta"> 3 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#read">Read</a>
          <ul>
            <li><a href="#use-xmlreader-to-read-the-file">Use XmlReader to read the file</a></li>
            <li><a href="#reading-documents-using-xmldocument">Reading documents using XmlDocument</a></li>
          </ul>
        </li>
        <li><a href="#write">Write</a>
          <ul>
            <li><a href="#use-xmlwriter-to-write-content-to-a-document">Use <code>XmlWriter</code> to write content to a document</a></li>
            <li><a href="#use-xmldocument-to-write-content-to-xml-documents">Use <code>XmlDocument</code> to write content to xml documents</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>C# read and write xml documents mainly through <code>XmlDocument</code>, <code>XmlReader</code> and <code>XmlWriter</code> three classes to achieve.</p>
<p><code>XmlReader</code> only has <strong>read</strong> functionality.</p>
<p><code>XmlWriter</code> has only <strong>write</strong> functionality.</p>
<p><code>XmlDocument</code> has both <strong>Read</strong> and <strong>Write</strong> functionality.</p>
<h2 id="read">Read</h2>
<p>This article, read the xml document for the online xml document (non-local files, replaced by local documents can also be), you can use your browser to open this document address: <a href="http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml">http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml</a> to view the contents of the document.</p>
<p>Here, we read the contents of this document.</p>
<p>There are the following two ways.</p>
<h3 id="use-xmlreader-to-read-the-file">Use XmlReader to read the file</h3>
<p>According to the following code example, you can read any xml document (local file or a file on a remote server).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml</span><span class="p">;</span><span class="c1">//为了支持XmlReader，必须包含Xml命名空间。
</span><span class="c1"></span>
<span class="k">namespace</span> <span class="nn">ParsingXml</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//使用静态Create()方法，创建一个XmlReader对象。该方法有多个重载，我们使用最简单的，用指向文档的URL。
</span><span class="c1"></span>            <span class="n">XmlReader</span> <span class="n">xmlReader</span> <span class="p">=</span> <span class="n">XmlReader</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="s">&#34;http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml&#34;</span><span class="p">);</span>
            <span class="c1">//只要有内容读取，loop中循环条件就一直为真。
</span><span class="c1"></span>            <span class="k">while</span> <span class="p">(</span><span class="n">xmlReader</span><span class="p">.</span><span class="n">Read</span><span class="p">())</span><span class="c1">//Read()方法，读取下一个节点，如果成功读取了下一个节点就返回true。
</span><span class="c1"></span>            <span class="p">{</span>
                <span class="c1">//NodeType获取当前节点类型， Name获取当前节点限定名。
</span><span class="c1"></span>                <span class="k">if</span> <span class="p">((</span><span class="n">xmlReader</span><span class="p">.</span><span class="n">NodeType</span> <span class="p">==</span> <span class="n">XmlNodeType</span><span class="p">.</span><span class="n">Element</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="n">xmlReader</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">&#34;Cube&#34;</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="c1">//HasArrtibutes返回结果：如果当前节点具有属性，则为 true；否则为 false。
</span><span class="c1"></span>                    <span class="c1">//GetAttribute(string name)返回指定属性的值，如果未找到，返回null。
</span><span class="c1"></span>                    <span class="k">if</span> <span class="p">(</span><span class="n">xmlReader</span><span class="p">.</span><span class="n">HasAttributes</span><span class="p">)</span>
                        <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">xmlReader</span><span class="p">.</span><span class="n">GetAttribute</span><span class="p">(</span><span class="s">&#34;currency&#34;</span><span class="p">)</span> <span class="p">+</span> <span class="s">&#34;: &#34;</span> <span class="p">+</span> <span class="n">xmlReader</span><span class="p">.</span><span class="n">GetAttribute</span><span class="p">(</span><span class="s">&#34;rate&#34;</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">ReadKey</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="reading-documents-using-xmldocument">Reading documents using XmlDocument</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml</span><span class="p">;</span>
<span class="k">namespace</span> <span class="nn">ParsingXml</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">XmlDocument</span> <span class="n">xmlDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
            <span class="n">xmlDoc</span><span class="p">.</span><span class="n">Load</span><span class="p">(</span><span class="s">&#34;http://www.ecb.int/stats/eurofxref/eurofxref-daily.xml&#34;</span><span class="p">;);</span>
            <span class="c1">//DocumentElement表示文档的根节点，如果没有则返回null。ChildNodes获取当前节点所有子节点
</span><span class="c1"></span>            <span class="k">foreach</span> <span class="p">(</span><span class="n">XmlNode</span> <span class="n">xmlNode</span> <span class="k">in</span> <span class="n">xmlDoc</span><span class="p">.</span><span class="n">DocumentElement</span><span class="p">.</span><span class="n">ChildNodes</span><span class="p">[</span><span class="m">2</span><span class="p">].</span><span class="n">ChildNodes</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">ChildNodes</span><span class="p">)</span>
                <span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="n">xmlNode</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="s">&#34;currency&#34;</span><span class="p">].</span><span class="n">Value</span> <span class="p">+</span> <span class="s">&#34;: &#34;</span> <span class="p">+</span> <span class="n">xmlNode</span><span class="p">.</span><span class="n">Attributes</span><span class="p">[</span><span class="s">&#34;rate&#34;</span><span class="p">].</span><span class="n">Value</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="n">ReadKey</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="write">Write</h2>
<h3 id="use-xmlwriter-to-write-content-to-a-document">Use <code>XmlWriter</code> to write content to a document</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml</span><span class="p">;</span>
<span class="k">namespace</span> <span class="nn">WritingXml</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// 向磁盘【C:\Users\a\Desktop\test.xml】文件写入。
</span><span class="c1"></span>            <span class="n">XmlWriter</span> <span class="n">xmlWriter</span> <span class="p">=</span> <span class="n">XmlWriter</span><span class="p">.</span><span class="n">Create</span><span class="p">(</span><span class="s">@&#34;C:\Users\a\Desktop\test.xml&#34;</span><span class="p">);</span>

            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteStartDocument</span><span class="p">();</span>
            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteStartElement</span><span class="p">(</span><span class="s">&#34;users&#34;</span><span class="p">);</span>
            <span class="c1">//添加一个element
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteStartElement</span><span class="p">(</span><span class="s">&#34;user&#34;</span><span class="p">);</span>
            <span class="c1">//添加attribute
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteAttributeString</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">,</span> <span class="s">&#34;42&#34;</span><span class="p">);</span>
            <span class="c1">//添加innerText
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteString</span><span class="p">(</span><span class="s">&#34;John Doe&#34;</span><span class="p">);</span>
            <span class="c1">//结束编写第一个element
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteEndElement</span><span class="p">();</span>
            <span class="c1">//开始另一个element
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteStartElement</span><span class="p">(</span><span class="s">&#34;user&#34;</span><span class="p">);</span>
            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteAttributeString</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">,</span> <span class="s">&#34;39&#34;</span><span class="p">);</span>
            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteString</span><span class="p">(</span><span class="s">&#34;Jane Doe&#34;</span><span class="p">);</span>

            <span class="c1">//结束编写文档
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">WriteEndDocument</span><span class="p">();</span>
            <span class="c1">//关闭流
</span><span class="c1"></span>            <span class="n">xmlWriter</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="use-xmldocument-to-write-content-to-xml-documents">Use <code>XmlDocument</code> to write content to xml documents</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Xml.Serialization</span><span class="p">;</span>
<span class="k">namespace</span> <span class="nn">WritingXml</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">XmlDocument</span> <span class="n">xmlDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="n">XmlDocument</span><span class="p">();</span>
            <span class="n">XmlNode</span> <span class="n">rootNode</span> <span class="p">=</span> <span class="n">xmlDoc</span><span class="p">.</span><span class="n">CreateElement</span><span class="p">(</span><span class="s">&#34;users&#34;</span><span class="p">);</span>
             <span class="c1">//将指定的节点添加到该节点的子节点列表的末尾。
</span><span class="c1"></span>            <span class="n">xmlDoc</span><span class="p">.</span><span class="n">AppendChild</span><span class="p">(</span><span class="n">rootNode</span><span class="p">);</span>
            <span class="n">XmlNode</span> <span class="n">userNode</span> <span class="p">=</span> <span class="n">xmlDoc</span><span class="p">.</span><span class="n">CreateElement</span><span class="p">(</span><span class="s">&#34;user&#34;</span><span class="p">);</span>
            <span class="n">XmlAttribute</span> <span class="n">attribute</span> <span class="p">=</span> <span class="n">xmlDoc</span><span class="p">.</span><span class="n">CreateAttribute</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">);</span>
            <span class="n">attribute</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="s">&#34;42&#34;</span><span class="p">;</span>
            <span class="c1">//为userNode添加属性
</span><span class="c1"></span>            <span class="n">userNode</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">attribute</span><span class="p">);</span>
            <span class="n">userNode</span><span class="p">.</span><span class="n">InnerText</span> <span class="p">=</span> <span class="s">&#34;John Doe&#34;</span><span class="p">;</span>
            <span class="c1">//为rootNode添加子节点。    
</span><span class="c1"></span>            <span class="n">rootNode</span><span class="p">.</span><span class="n">AppendChild</span><span class="p">(</span><span class="n">userNode</span><span class="p">);</span>
            <span class="n">userNode</span> <span class="p">=</span> <span class="n">xmlDoc</span><span class="p">.</span><span class="n">CreateElement</span><span class="p">(</span><span class="s">&#34;user&#34;</span><span class="p">);</span>
            <span class="n">attribute</span> <span class="p">=</span> <span class="n">xmlDoc</span><span class="p">.</span><span class="n">CreateAttribute</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">);</span>
            <span class="n">attribute</span><span class="p">.</span><span class="n">Value</span> <span class="p">=</span> <span class="s">&#34;39&#34;</span><span class="p">;</span>
            <span class="n">userNode</span><span class="p">.</span><span class="n">Attributes</span><span class="p">.</span><span class="n">Append</span><span class="p">(</span><span class="n">attribute</span><span class="p">);</span>
            <span class="n">userNode</span><span class="p">.</span><span class="n">InnerText</span> <span class="p">=</span> <span class="s">&#34;Jane Doe&#34;</span><span class="p">;</span>
            <span class="n">rootNode</span><span class="p">.</span><span class="n">AppendChild</span><span class="p">(</span><span class="n">userNode</span><span class="p">);</span>

            <span class="c1">// 将内容保存至【C:\Users\a\Desktop\test-doc.xml】                      
</span><span class="c1"></span>            <span class="n">xmlDoc</span><span class="p">.</span><span class="n">Save</span><span class="p">(</span><span class="s">@&#34;C:\Users\a\Desktop\test-doc.xml&#34;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/c/">c#</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-03/web-workers-simple-introduction/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">A brief introduction to Web Workers</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-03/ieee754/">
            <span class="next-text nav-default">How computers store floating point numbers - IEEE754</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
