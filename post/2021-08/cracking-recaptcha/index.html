<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Cracking ReCaptcha with YesCaptcha - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Maybe you haven&amp;rsquo;t heard of what ReCAPTCHA is, probably for some reason this CAPTCHA doesn&amp;rsquo;t appear much in China, but I think you should have seen or used it more or less. It looks like this. At this point, as soon as we click the checkbox at the top, the CAPTCHA algorithm will first use its &amp;ldquo;risk analysis engine&amp;rdquo; to do a security check, and if it passes the test" /><meta name="keywords" content="ReCaptcha,Cracking,YesCaptcha" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-08/cracking-recaptcha/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Cracking ReCaptcha with YesCaptcha" />
<meta property="og:description" content="Maybe you haven&rsquo;t heard of what ReCAPTCHA is, probably for some reason this CAPTCHA doesn&rsquo;t appear much in China, but I think you should have seen or used it more or less. It looks like this. At this point, as soon as we click the checkbox at the top, the CAPTCHA algorithm will first use its &ldquo;risk analysis engine&rdquo; to do a security check, and if it passes the test" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-08/cracking-recaptcha/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-07T18:49:04+08:00" />
<meta property="article:modified_time" content="2021-08-07T18:49:04+08:00" />

<meta itemprop="name" content="Cracking ReCaptcha with YesCaptcha">
<meta itemprop="description" content="Maybe you haven&rsquo;t heard of what ReCAPTCHA is, probably for some reason this CAPTCHA doesn&rsquo;t appear much in China, but I think you should have seen or used it more or less. It looks like this. At this point, as soon as we click the checkbox at the top, the CAPTCHA algorithm will first use its &ldquo;risk analysis engine&rdquo; to do a security check, and if it passes the test"><meta itemprop="datePublished" content="2021-08-07T18:49:04+08:00" />
<meta itemprop="dateModified" content="2021-08-07T18:49:04+08:00" />
<meta itemprop="wordCount" content="1850">
<meta itemprop="keywords" content="ReCaptcha,YesCaptcha," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cracking ReCaptcha with YesCaptcha"/>
<meta name="twitter:description" content="Maybe you haven&rsquo;t heard of what ReCAPTCHA is, probably for some reason this CAPTCHA doesn&rsquo;t appear much in China, but I think you should have seen or used it more or less. It looks like this. At this point, as soon as we click the checkbox at the top, the CAPTCHA algorithm will first use its &ldquo;risk analysis engine&rdquo; to do a security check, and if it passes the test"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Cracking ReCaptcha with YesCaptcha</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-08-07 18:49:04 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/tools/"> tools </a>
            <a href="/categories/security/"> security </a>
            </div>
          <span class="more-meta"> 1850 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#experience">Experience</a></li>
        <li><a href="#solutions">Solutions</a></li>
        <li><a href="#code">Code</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Maybe you haven&rsquo;t heard of what ReCAPTCHA is, probably for some reason this CAPTCHA doesn&rsquo;t appear much in China, but I think you should have seen or used it more or less. It looks like this.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/d95f6618e9c24a4f95b9fb4afa94ca91.png" alt=" "></p>
<p>At this point, as soon as we click the checkbox at the top, the CAPTCHA algorithm will first use its &ldquo;risk analysis engine&rdquo; to do a security check, and if it passes the test directly, we will directly get the following result.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/ed4538029d104ff1af419b5a423f7d4e.png" alt=" "></p>
<p>If the algorithm detects a risk in the current system, such as a possible unfamiliar network environment, possibly a simulated program, it will need to do a secondary checksum. It will further pop up something like the following.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/99b8d850d00147bc991c2987d4b155cc.png" alt=" "></p>
<p>For example, in the picture above, nine pictures will appear on the verification code page, and the text &ldquo;tree&rdquo; will appear at the top. We need to tap the picture with &ldquo;tree&rdquo; in the nine pictures below, and after we finish tapping, several new pictures may appear, so we need to finish tapping again, and finally click the &ldquo;verify&rdquo; button to complete the verification. Or we can click on the &ldquo;headset&rdquo; icon below, and then it will switch to dictation mode, and the verification code will look like this.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/cb441188fdc44a1f8faef6104ae5525f.png" alt=" "></p>
<p>At this time, if we can fill in the audio content read to the CAPTCHA, we can also pass the validation. Both ways can pass the verification, and after the verification is completed, we can complete the submission of the form, such as completing the login, registration and other operations. What is the name of this CAPTCHA? This CAPTCHA is Google&rsquo;s ReCAPTCHA V2 CAPTCHA, which is a kind of behavioral CAPTCHA. These behaviors include clicking checkboxes, selecting corresponding images, voice dictation, etc. Only when these behaviors are verified, this CAPTCHA can pass the verification. Compared with the general graphical CAPTCHA, this kind of CAPTCHA has better interactive experience, higher security and more difficult to crack.</p>
<p>In fact, the CAPTCHA introduced above is only one form of ReCAPTCHA, which is the explicit version of V2, and there is also an implicit version of V2, which does not appear explicitly on the verification page when verifying, but binds the CAPTCHA and the submit button through JavaScript, and will automatically complete the verification when submitting the form. In addition to the V2 version, Google has launched the latest V3 version. reCAPTCHA V3 captcha will calculate a score based on the user&rsquo;s behavior, which represents the probability that the user may be a robot, and the final probability will determine whether the verification can pass. Its security is higher and the experience is better.</p>
<h2 id="experience">Experience</h2>
<p>So where can we experience ReCAPTCHA? We can open this website: <a href="https://www.google.com/recaptcha/api2/demo">https://www.google.com/recaptcha/api2/demo</a>, (if you are in China, you need to use a VPN) while opening it with an anonymous window, so that the test will not be interrupted by historical cookies, as shown in the picture.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/1ba1835f0e3b45cf99e273b4e6a363f3.png" alt=" "></p>
<p>At this point, we can see a ReCAPTCHA window at the bottom, and then after clicking on it, a verification block appears.</p>
<p>Of course it is possible to solve it manually, but it is certainly not possible for crawlers, so how to automate the solution?</p>
<p>Next we will introduce a simple and useful platform.</p>
<h2 id="solutions">Solutions</h2>
<p>This time we introduce a ReCAPTCHA cracking service called YesCaptcha, the homepage is <a href="http://yescaptcha.365world.com.cn/">http://yescaptcha.365world.com.cn/</a>, which can now support both V2 and V3 versions of cracking.</p>
<p>Let&rsquo;s use it to try to solve the V2 type verification code on ReCAPTCHA just now: <a href="https://www.google.com/recaptcha/api2/demo">https://www.google.com/recaptcha/api2/demo</a>.</p>
<p>After a simple registration, you can find a Token on the home page, which we can copy for later use, as shown here.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/aa8e7c4ab8584851bf87432ff985afa9.png" alt=" "></p>
<p>It has two key APIs, one is to create CAPTCHA service tasks and the other is to query the status of the tasks, the APIs are as follows.</p>
<ul>
<li>Create task: <a href="http://api.yescaptcha.365world.com.cn/v3/recaptcha/create">http://api.yescaptcha.365world.com.cn/v3/recaptcha/create</a></li>
<li>Query status: <a href="http://api.yescaptcha.365world.com.cn/v3/recaptcha/status">http://api.yescaptcha.365world.com.cn/v3/recaptcha/status</a></li>
</ul>
<p>API documentation can be found here: <a href="http://docs.yescaptcha.365world.com.cn/">http://docs.yescaptcha.365world.com.cn/</a></p>
<p>After the API documentation, you can see that the following parameters can be configured when using it.</p>
<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>token</td>
<td>yes</td>
<td>Please get it in your personal center (Token)</td>
</tr>
<tr>
<td>siteKey</td>
<td>是</td>
<td>ReCaptcha SiteKey （Fixed parameters）</td>
</tr>
<tr>
<td>siteReferer</td>
<td>yes</td>
<td>ReCaptcha Referer （Generally also fixed parameters）</td>
</tr>
<tr>
<td>captchaType</td>
<td>no</td>
<td>ReCaptchaV2 (Default) / ReCaptchaV3</td>
</tr>
<tr>
<td>siteAction</td>
<td>no</td>
<td>ReCaptchaV3 Optional Action Action Default verify</td>
</tr>
<tr>
<td>minScore</td>
<td>no</td>
<td>ReCaptchaV3 Optional Minimum fraction (0.1 - 0.9)</td>
</tr>
</tbody>
</table>
<p>Here are the three key pieces of information.</p>
<ul>
<li>token: This is the parameter we just copied off of YesCaptcha</li>
<li>siteKey: This is the flag string of ReCAPACHA, we will show how to find it later.</li>
<li>siteReferer, which is generally the referer of the source site of ReCAPTCHA, for example, for the current case, the value is <a href="https://www.google.com/recaptcha/api2/demo">https://www.google.com/recaptcha/api2/demo</a></li>
</ul>
<p>How to find the siteKey? It&rsquo;s actually very simple, let&rsquo;s look at the HTML source code of the current ReCAPTCHA and just look for it from the source code.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/48ba66f2ae1447a7a36c41b753e423bb.png" alt=" "></p>
<p>Here you can see that each ReCAPTCHA corresponds to a div, div has an attribute called date-sitekey, see the value here is.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">6Le-wvkSAAAAAPBMRTvw0Q4Muexq9bi0DJwx_mJ-
</code></pre></td></tr></table>
</div>
</div><p>Well, everything is ready, all that&rsquo;s missing is the code!</p>
<h2 id="code">Code</h2>
<p>Let&rsquo;s use the simplest requests to implement it, first defining the constants.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="n">TOKEN</span> <span class="o">=</span> <span class="s1">&#39;50a07xxxxxxxxxxxxxxxxxxxxxxxxxf78&#39;</span>  <span class="c1"># Please replace with your own TOKEN</span>
<span class="n">REFERER</span> <span class="o">=</span> <span class="s1">&#39;https://www.google.com/recaptcha/api2/demo&#39;</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s1">&#39;http://api.yescaptcha.365world.com.cn&#39;</span>
<span class="n">SITE_KEY</span> <span class="o">=</span> <span class="s1">&#39;6Le-wvkSAAAAAPBMRTvw0Q4Muexq9bi0DJwx_mJ-&#39;</span> <span class="c1"># Please replace it with your own SITE_KEY</span>
</code></pre></td></tr></table>
</div>
</div><p>Here we define these constants.</p>
<ul>
<li>TOKEN: is the token copied from the website</li>
<li>REFERER: is the link to the demo site</li>
<li>API_BASE_URL: is the API URL of YesCaptcha</li>
<li>SITE_KEY: is the data-sitekey we just found</li>
</ul>
<p>Then we define a method to create the task.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">def</span> <span class="nf">create_task</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">/v3/recaptcha/create?token=</span><span class="si">{</span><span class="n">TOKEN</span><span class="si">}</span><span class="s2">&amp;siteKey=</span><span class="si">{</span><span class="n">SITE_KEY</span><span class="si">}</span><span class="s2">&amp;siteReferer=</span><span class="si">{</span><span class="n">REFERER</span><span class="si">}</span><span class="s2">&#34;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;response data:&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;taskId&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;create task failed&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Here is the API call to create a task, nothing to say.</p>
<p>If the creation is successful, we will get a task_id, and then we need to use this task_id to poll the status of the task, and define a method as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">def</span> <span class="nf">polling_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">/v3/recaptcha/status?token=</span><span class="si">{</span><span class="n">TOKEN</span><span class="si">}</span><span class="s2">&amp;taskId=</span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&#34;</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">120</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;polling result&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;status of task&#39;</span><span class="p">,</span> <span class="n">status</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;Success&#39;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;polling task failed&#39;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>If the result is Success, it proves that the task is successful, and the response result is the token obtained after parsing the CAPTCHA crack.</p>
<p>Two methods are called.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">task_id</span> <span class="o">=</span> <span class="n">create_task</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;create task successfully&#39;</span><span class="p">,</span> <span class="n">task_id</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">polling_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;get response:&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>

</code></pre></td></tr></table>
</div>
</div><p>The results of the run are similar to the following.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">response data: {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;taskId&#39;: &#39;1479436991&#39;}}
create task successfully 1479436991
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Working&#39;}}
status of task Working
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Working&#39;}}
status of task Working
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Working&#39;}}
status of task Working
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Success&#39;, &#39;response&#39;: &#39;03AGdBq27-ABqvNmgq96iuprN8Mvzfq6_8noknIed5foLb15oWvWVksq9KesDkDd7dgMMr-UmqULZduXTWr87scJXl3djhl2btPO721eFAYsVzSk7ftr4uHBdJWonnEemr9dNaFB9qx5pnxr3P24AC7cCfKlOH_XARaN4pvbPNxx_UY5G5fzKUPFDOV14nNkCWl61jwwC0fuwetH1q99r4hBQxyI6XICD3PiHyHJMZ_-wolcO1R9C90iGQyjzrSMiNqErezO24ODCiKRyX2cVaMwM9plbxDSuyKUVaDHqccz8UrTNNdJ4m2WxKrD9wZDWaSK10Ti1LgsqOWKjKwqBbuyRS_BkSjG6OJdHqJN4bpk_jAcPMO13wXrnHBaXdK4FNDR9-dUvupHEnr7QZEuNoRxwl8FnO2Fgwzp2sJbGeQkMbSVYWdAalE6fzJ8NwsFJxCdDyeyO817buBtvTJ4C06C1uZ92fpPTeYGJwbbicOuqbGfHNTyiSJeRNmt-5RKz0OUiPJOPnmVKGlWBOqwbwCW1WZt-E-hH4FEg4En5TITmmPb_feS9dWKUxudn1U0hHk2vV9PerjZLtI7F67KtgmcqRrARPbwnc6KyAi3Hy1hthP92lv4MRIcO2jx0Llvsja-G2nhjZB0ZoJwkb9106pmqldiwlXxky4Dcg7VPStiCYJvhQpRYol7Iq1_ltU2tyhMqsu_Xa8Z6Mr5ykRCLnmlLb8DV8isndrdwp84wo_vPARGRj7Up9ov-ycb5lDKTf1XRaHiMCa8d2WLy0Pjco9UnsRAPw0FW3MsBJah6ryHUUDho7ffhUUgV1k86ryJym6xbWch1sVC4D5owzrCFn6L-rSLc5SS1pza2zU5LK4kAZCmbXNRffiFrhUY8nP4T1xaR2KMhIaN8HhJQpR8sQh1Azc-QkDy4rwbYmxUrysYGMrAOnmDx9z7tWQXbJE4IgCVMx5wihSiE-T8nbF5y1aJ0Ru9zqg1nZ3GSqsucSnvJA8HV5t9v0QSG5cBC1x5HIceA-2uEGSjwcmYOMw8D_65Dl-d6yVk1YN2FZCgMWY5ewzB1RAFN1BMqKoITQJ64jq3lKATpkc5i7aTA2bRGQyXrbDyMRIrVXKnYMHegfMbDn0l4O81a8vxmevLspKkacVPiqLsAe-73jAxMvsOqaG7cKxMQO9CY3qbtD55YgN0W4p2jyNSVz3aEpffHRqYyWMsRI5LddLgaZQDoHHgGUhV580PSIdZJ5eKd0gOjxIYxKlr0IgbMWRmsG_TgDNImy1c5oey8ojl-zWpOQW7bnfq5Z4tZ10_sCTfoOZVLqRuOsqB1OOO9pLRQojLBP0HUiGhRAr_As9EIDu6F9NIQfdAmCaVvavJbi1CZITFjcywP-tBrHsxpwkCXlwl996MK_XyEDuyWnJVGiVSthUMY306tIh1Xxj93W3KQJCzsfJQcjN-3lGLLeDFddypHyG4yrpRqRHHBNyiNJHgxSk5SaShEhXvByjkepvhrKX3kJssCU04biqqmkrQ49GqBV9OsWIy0nN3OJTx8v05MP8aU8YYkYBF01UbSff4mTfLAhin6iWk84Y074mRbe2MbgFAdU58KnCrwYVxcAR8voZsFxbxNwZXdVeexNx5HlIlSgaAHLWm2kFWmGPPW-ZA7R8Wst-mc7oIKft5iJl8Ea0YFz8oXyVgQk1rd9nDR3xGe5mWL1co0MiW1yvHg&#39;}}
</code></pre></td></tr></table>
</div>
</div><p>If it returns the data in the above format, it means that the ReCAPTCHA authentication code has been recognized successfully, and the content of the response field is the recognized token, we directly take this token and put it into the form to submit it successfully.</p>
<p>Then how to use this token? In fact, if we use the browser to verify that the validation is successful, when we click on the form to submit, a textarea with the name g-recaptcha-response will be assigned a value in the form, and if the validation is successful, its value is the token obtained after the validation, which will be sent to the server as part of the form submission for validation This is sent to the server for validation as part of the form submission. If the field checks out, it&rsquo;s fine.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/870378916be5404fa1be6489969e18ac.png" alt=" "></p>
<p>So, the above process is equivalent to simulating the process of tapping a CAPTCHA for us, and the token we end up with is actually what we should assign to the name g-recaptcha-response. So how do we assign it? It&rsquo;s as simple as using JavaScript. We can use JavaScript to select the textarea and assign a value directly to it, with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;g-recaptcha-response&#34;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="o">=</span><span class="s2">&#34;TOKEN_FROM_YESCAPTCHA&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>Note that the TOKEN_FROM_YESCAPTCHA here needs to be replaced with the token value we just got. When we do the crawler login simulation, if we use Selenium, Puppeteer, etc., we only need to simulate the execution of this JavaScript code in the simulation program, and then we can successfully assign the value. After executing and submitting the form directly, let&rsquo;s look at the Network request.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/da69ad4cf0894bac9dc83b134572ff1d.png" alt=" "></p>
<p>You can see that it&rsquo;s just submitting a form, and one of the fields is g-recaptcha-response, and it will send it to the server for verification, and if the verification passes, it&rsquo;s successful. So if we get this token with YesCaptcha and assign it to the textarea of the form, the form will be submitted and if the token is valid, we can successfully bypass the login without having to click on the captcha again. Finally we get the following successful page.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/07/3ab28c024e8a418996f3a6bd2586cc17.png" alt=" "></p>
<p>Of course, we can also use requests to simulate the completion of a form submission: the</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">def</span> <span class="nf">verify</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;https://www.google.com/recaptcha/api2/demo&#34;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;g-recaptcha-response&#34;</span><span class="p">:</span> <span class="n">response</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</code></pre></td></tr></table>
</div>
</div><p>Final refinement of the call.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">task_id</span> <span class="o">=</span> <span class="n">create_task</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;create task successfully&#39;</span><span class="p">,</span> <span class="n">task_id</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">polling_task</span><span class="p">(</span><span class="n">task_id</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;get response:&#39;</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;...&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">verify</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>The results of the run are as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">response data: {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;taskId&#39;: &#39;1479436991&#39;}}
create task successfully 1479436991
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Working&#39;}}
status of task Working
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Working&#39;}}
status of task Working
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Working&#39;}}
status of task Working
polling result {&#39;status&#39;: 0, &#39;msg&#39;: &#39;ok&#39;, &#39;data&#39;: {&#39;status&#39;: &#39;Success&#39;, &#39;response&#39;: &#39;03AGdBq27-ABqvNmgq96iuprN8Mvzfq6_8noknIed5foLb15oWvWVksq9KesDkDd7dgMMr-UmqULZduXTWr87scJXl3djhl2btPO721eFAYsVzSk7ftr4uHBdJWonnEemr9dNaFB9qx5pnxr3P24AC7cCfKlOH_XARaN4pvbPNxx_UY5G5fzKUPFDOV14nNkCWl61jwwC0fuwetH1q99r4hBQxyI6XICD3PiHyHJMZ_-wolcO1R9C90iGQyjzrSMiNqErezO24ODCiKRyX2cVaMwM9plbxDSuyKUVaDHqccz8UrTNNdJ4m2WxKrD9wZDWaSK10Ti1LgsqOWKjKwqBbuyRS_BkSjG6OJdHqJN4bpk_jAcPMO13wXrnHBaXdK4FNDR9-dUvupHEnr7QZEuNoRxwl8FnO2Fgwzp2sJbGeQkMbSVYWdAalE6fzJ8NwsFJxCdDyeyO817buBtvTJ4C06C1uZ92fpPTeYGJwbbicOuqbGfHNTyiSJeRNmt-5RKz0OUiPJOPnmVKGlWBOqwbwCW1WZt-E-hH4FEg4En5TITmmPb_feS9dWKUxudn1U0hHk2vV9PerjZLtI7F67KtgmcqRrARPbwnc6KyAi3Hy1hthP92lv4MRIcO2jx0Llvsja-G2nhjZB0ZoJwkb9106pmqldiwlXxky4Dcg7VPStiCYJvhQpRYol7Iq1_ltU2tyhMqsu_Xa8Z6Mr5ykRCLnmlLb8DV8isndrdwp84wo_vPARGRj7Up9ov-ycb5lDKTf1XRaHiMCa8d2WLy0Pjco9UnsRAPw0FW3MsBJah6ryHUUDho7ffhUUgV1k86ryJym6xbWch1sVC4D5owzrCFn6L-rSLc5SS1pza2zU5LK4kAZCmbXNRffiFrhUY8nP4T1xaR2KMhIaN8HhJQpR8sQh1Azc-QkDy4rwbYmxUrysYGMrAOnmDx9z7tWQXbJE4IgCVMx5wihSiE-T8nbF5y1aJ0Ru9zqg1nZ3GSqsucSnvJA8HV5t9v0QSG5cBC1x5HIceA-2uEGSjwcmYOMw8D_65Dl-d6yVk1YN2FZCgMWY5ewzB1RAFN1BMqKoITQJ64jq3lKATpkc5i7aTA2bRGQyXrbDyMRIrVXKnYMHegfMbDn0l4O81a8vxmevLspKkacVPiqLsAe-73jAxMvsOqaG7cKxMQO9CY3qbtD55YgN0W4p2jyNSVz3aEpffHRqYyWMsRI5LddLgaZQDoHHgGUhV580PSIdZJ5eKd0gOjxIYxKlr0IgbMWRmsG_TgDNImy1c5oey8ojl-zWpOQW7bnfq5Z4tZ10_sCTfoOZVLqRuOsqB1OOO9pLRQojLBP0HUiGhRAr_As9EIDu6F9NIQfdAmCaVvavJbi1CZITFjcywP-tBrHsxpwkCXlwl996MK_XyEDuyWnJVGiVSthUMY306tIh1Xxj93W3KQJCzsfJQcjN-3lGLLeDFddypHyG4yrpRqRHHBNyiNJHgxSk5SaShEhXvByjkepvhrKX3kJssCU04biqqmkrQ49GqBV9OsWIy0nN3OJTx8v05MP8aU8YYkYBF01UbSff4mTfLAhin6iWk84Y074mRbe2MbgFAdU58KnCrwYVxcAR8voZsFxbxNwZXdVeexNx5HlIlSgaAHLWm2kFWmGPPW-ZA7R8Wst-mc7oIKft5iJl8Ea0YFz8oXyVgQk1rd9nDR3xGe5mWL1co0MiW1yvHg&#39;}}
status of task Success
get response: 03AGdBq27-ABqvNmgq96iuprN8Mvzfq6_8noknIe...
&lt;!DOCTYPE HTML&gt;&lt;html dir=&#34;ltr&#34;&gt;&lt;head&gt;&lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html; charset=UTF-8&#34;&gt;&lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, user-scalable=yes&#34;&gt;&lt;title&gt;ReCAPTCHA demo&lt;/title&gt;&lt;link rel=&#34;stylesheet&#34; href=&#34;https://www.gstatic.com/recaptcha/releases/TbD3vPFlUWKZD-9L4ZxB0HJI/demo__ltr.css&#34; type=&#34;text/css&#34;&gt;&lt;/head&gt;&lt;body&gt;&lt;div class=&#34;recaptcha-success&#34;&gt;Verification Success... Hooray!&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre></td></tr></table>
</div>
</div><p>Finally, you can see that after the mock submission, the result will have a Verification Success&hellip; Hooray! text, which means that the verification was successful!</p>
<p>At this point, we have successfully completed the ReCAPTCHA crack.</p>
<p>Above we introduced the implementation of requests, of course, the use of tools such as Selenium can also be achieved, the specific Demo in the document is also written, please refer to the instructions to use the document can</p>
<hr>
<p>Reference <code>https://cuiqingcai.com/30026.html</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/recaptcha/">ReCaptcha</a>
          <a href="/tags/yescaptcha/">YesCaptcha</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-08/html-picture/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Why is the HTML &lt;picture&gt; element so rarely used?</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-08/go-replay-manual/">
            <span class="next-text nav-default">GoReplay Manual</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
