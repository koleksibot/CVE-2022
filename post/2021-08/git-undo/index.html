<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Git Undo - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="When managing Git versions, you often need to undo certain actions. This article describes a few of the most important cases and gives detailed explanations. Withdrawal of submission A common scenario is that after committing the code, you suddenly realize that there is something wrong with the commit and you should undo it, so you can execute the following command. 1 $ git revert HEAD The above command works by" /><meta name="keywords" content="git, undo" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-08/git-undo/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Git Undo" />
<meta property="og:description" content="When managing Git versions, you often need to undo certain actions. This article describes a few of the most important cases and gives detailed explanations. Withdrawal of submission A common scenario is that after committing the code, you suddenly realize that there is something wrong with the commit and you should undo it, so you can execute the following command. 1 $ git revert HEAD The above command works by" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-08/git-undo/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-20T11:43:29+08:00" />
<meta property="article:modified_time" content="2021-08-20T11:43:29+08:00" />

<meta itemprop="name" content="Git Undo">
<meta itemprop="description" content="When managing Git versions, you often need to undo certain actions. This article describes a few of the most important cases and gives detailed explanations. Withdrawal of submission A common scenario is that after committing the code, you suddenly realize that there is something wrong with the commit and you should undo it, so you can execute the following command. 1 $ git revert HEAD The above command works by"><meta itemprop="datePublished" content="2021-08-20T11:43:29+08:00" />
<meta itemprop="dateModified" content="2021-08-20T11:43:29+08:00" />
<meta itemprop="wordCount" content="655">
<meta itemprop="keywords" content="git," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Git Undo"/>
<meta name="twitter:description" content="When managing Git versions, you often need to undo certain actions. This article describes a few of the most important cases and gives detailed explanations. Withdrawal of submission A common scenario is that after committing the code, you suddenly realize that there is something wrong with the commit and you should undo it, so you can execute the following command. 1 $ git revert HEAD The above command works by"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Git Undo</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-08-20 11:43:29 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/tools/"> tools </a>
            </div>
          <span class="more-meta"> 655 words </span>
          <span class="more-meta"> 2 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#withdrawal-of-submission">Withdrawal of submission</a></li>
        <li><a href="#discard-submission">Discard Submission</a></li>
        <li><a href="#replaces-the-previous-submission">Replaces the previous submission</a></li>
        <li><a href="#undoing-file-changes-in-the-workspace">Undoing file changes in the workspace</a></li>
        <li><a href="#withdrawal-of-documents-from-staging-area">Withdrawal of documents from staging area</a></li>
        <li><a href="#undo-changes-in-the-current-branch">Undo changes in the current branch</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>When managing Git versions, you often need to undo certain actions.</p>
<p>This article describes a few of the most important cases and gives detailed explanations.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/20/7c9a173ccd1c4df0a6c0ada4822531ec.png" alt=" "></p>
<h2 id="withdrawal-of-submission">Withdrawal of submission</h2>
<p>A common scenario is that after committing the code, you suddenly realize that there is something wrong with the commit and you should undo it, so you can execute the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git revert HEAD
</code></pre></td></tr></table>
</div>
</div><p>The above command works by adding a new commit after the current commit, offsetting all the changes caused by the previous commit. It doesn&rsquo;t change the past history, so it&rsquo;s the preferred way to do it without any risk of losing code.</p>
<p>The <code>git revert</code> command only offsets the last commit; if you want to offset multiple commits, you must specify them in order on the command line. For example, to offset the first two commits, write something like this.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git revert <span class="o">[</span>First submission from the bottom<span class="o">]</span> <span class="o">[</span>Penultimate submission<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>git revert</code> command has two more arguments.</p>
<ul>
<li><code>--no-edit</code>: Runs without opening the default editor and uses Git&rsquo;s automatically generated commits.</li>
<li><code>--no-commit</code>: Only offsets file changes in the staging area and workspace, no new commits are generated.</li>
</ul>
<h2 id="discard-submission">Discard Submission</h2>
<p>If you want previous commits to disappear completely in the history instead of being offset, you can use the <code>git reset</code> command to discard all commits after a certain commit.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git reset <span class="o">[</span>last good SHA<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p><code>git reset</code> works by returning the latest commit pointer to a previous point in time, and all commits after that point disappear from the history.</p>
<p>By default, <code>git reset</code> does not change the files in the workspace (but it does change the staging area), and the <code>-hard</code> argument returns the files in the workspace to their previous state as well.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git reset --hard <span class="o">[</span>last good SHA<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>After running the <code>git reset</code> command, if you want to retrieve those dropped commits, you can use the <code>git reflog</code> command, as described <a href="https://github.blog/2015-06-08-how-to-undo-almost-anything-with-git/#redo-after-undo-local">here</a>. However, this practice is time-sensitive and may not be retrieved after a long period of time.</p>
<h2 id="replaces-the-previous-submission">Replaces the previous submission</h2>
<p>After committing, you can use the <code>-git commit</code> command with the <code>-amend</code> argument to change the last commit.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git commit --amend -m <span class="s2">&#34;Fixes bug #42&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>It works by generating a new commit object that replaces the commit object generated by the previous commit.</p>
<p>If there are any files in the staging area that have changed, they will be committed to the repository together. So, <code>--amend</code> not only modifies the commit information, but also replaces the entire previous commit.</p>
<h2 id="undoing-file-changes-in-the-workspace">Undoing file changes in the workspace</h2>
<p>If a file in the workspace has been messed up but not yet committed, you can use the <code>git checkout</code> command to retrieve the file before this change.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git checkout -- <span class="o">[</span>filename<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>It works by first looking for the staging area and restoring the version of the file if it has a staged version, otherwise restoring the last committed version.</p>
<p>Note that file changes in the workspace cannot be recovered once they have been undone.</p>
<h2 id="withdrawal-of-documents-from-staging-area">Withdrawal of documents from staging area</h2>
<p>If you accidentally add a file to the staging area, you can undo it with the following command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ git rm --cached <span class="o">[</span>filename<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><p>The above command does not affect the content already submitted.</p>
<h2 id="undo-changes-in-the-current-branch">Undo changes in the current branch</h2>
<p>You&rsquo;ve made several commits on the current branch and suddenly realize that you&rsquo;ve put the wrong branch, and that these commits should have gone to another branch.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1"># Create a new feature branch that points to the current latest commit</span>
<span class="c1"># Note that it is still stuck in the current branch</span>
$ git branch feature

<span class="c1"># Switching to the state before these commits</span>
$ git reset --hard <span class="o">[</span>当前分支此前的最后一次提交<span class="o">]</span>

<span class="c1"># Switching to feature branch</span>
$ git checkout feature
</code></pre></td></tr></table>
</div>
</div><hr>
<p>Reference <code>https://www.ruanyifeng.com/blog/2019/12/git-undo.html</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/git/">git</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-08/tesla-dojo/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Tesla AI Day: Self-developed supercomputing Dojo chip released, 7nm manufacturing, can perform 1024 billion calculations per second</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-08/microsoft-windows-11-default-browser-changes/">
            <span class="next-text nav-default">Windows 11 makes it harder to switch default browsers, causing discontent with Google and Mozilla</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
