<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>An Introduction to babel - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="What is babel? babel is a Javascript compiler, one of the most commonly used tools for front-end development today, primarily for converting ECMAScript 2015&#43; versions of code to backward-compatible JavaScript syntax so that it can run in current and older versions of browsers or other environments.
1 2 3 4 5 6 7 8 9 10  a ?? 1; a?.b; //After babel conversion &amp;#34;use strict&amp;#34;; var _a; (_a = a) !" /><meta name="keywords" content="babel,javascript" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-08/babel-theory/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="An Introduction to babel" />
<meta property="og:description" content="What is babel? babel is a Javascript compiler, one of the most commonly used tools for front-end development today, primarily for converting ECMAScript 2015&#43; versions of code to backward-compatible JavaScript syntax so that it can run in current and older versions of browsers or other environments.
1 2 3 4 5 6 7 8 9 10  a ?? 1; a?.b; //After babel conversion &#34;use strict&#34;; var _a; (_a = a) !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-08/babel-theory/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-13T10:36:38+08:00" />
<meta property="article:modified_time" content="2021-08-13T10:36:38+08:00" />

<meta itemprop="name" content="An Introduction to babel">
<meta itemprop="description" content="What is babel? babel is a Javascript compiler, one of the most commonly used tools for front-end development today, primarily for converting ECMAScript 2015&#43; versions of code to backward-compatible JavaScript syntax so that it can run in current and older versions of browsers or other environments.
1 2 3 4 5 6 7 8 9 10  a ?? 1; a?.b; //After babel conversion &#34;use strict&#34;; var _a; (_a = a) !"><meta itemprop="datePublished" content="2021-08-13T10:36:38+08:00" />
<meta itemprop="dateModified" content="2021-08-13T10:36:38+08:00" />
<meta itemprop="wordCount" content="2049">
<meta itemprop="keywords" content="javascript,babel," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="An Introduction to babel"/>
<meta name="twitter:description" content="What is babel? babel is a Javascript compiler, one of the most commonly used tools for front-end development today, primarily for converting ECMAScript 2015&#43; versions of code to backward-compatible JavaScript syntax so that it can run in current and older versions of browsers or other environments.
1 2 3 4 5 6 7 8 9 10  a ?? 1; a?.b; //After babel conversion &#34;use strict&#34;; var _a; (_a = a) !"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">An Introduction to babel</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-08-13 10:36:38 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/tools/"> tools </a>
            </div>
          <span class="more-meta"> 2049 words </span>
          <span class="more-meta"> 10 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#what-is-babel">What is babel?</a></li>
        <li><a href="#uses-of-babel">Uses of babel</a></li>
        <li><a href="#the-babel-compilation-process">The babel compilation process</a>
          <ul>
            <li><a href="#parse">parse</a></li>
            <li><a href="#transform">transform</a></li>
            <li><a href="#generate">generate</a></li>
            <li><a href="#ast-node">AST Node</a></li>
          </ul>
        </li>
        <li><a href="#babel-api">babel api</a>
          <ul>
            <li><a href="#babelparser">@babel/parser</a></li>
            <li><a href="#babeltraverse">@babel/traverse</a></li>
            <li><a href="#babeltypes">@babel/types</a></li>
            <li><a href="#babeltemplate">@babel/template</a></li>
            <li><a href="#babelgenerate">@babel/generate</a></li>
            <li><a href="#babelcore">@babel/core</a></li>
          </ul>
        </li>
        <li><a href="#usage">Usage</a>
          <ul>
            <li><a href="#download">Download</a></li>
            <li><a href="#configuration">Configuration</a></li>
            <li><a href="#use">Use</a></li>
            <li><a href="#presets">Presets</a></li>
          </ul>
        </li>
        <li><a href="#a-simple-case">A simple case</a>
          <ul>
            <li><a href="#function-staking">Function Staking</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="what-is-babel">What is babel?</h2>
<p>babel is a Javascript compiler, one of the most commonly used tools for front-end development today, primarily for converting ECMAScript 2015+ versions of code to backward-compatible JavaScript syntax so that it can run in current and older versions of browsers or other environments.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">a</span> <span class="o">??</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">a</span><span class="o">?</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>

<span class="c1">//After babel conversion
</span><span class="c1"></span><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">_a</span><span class="p">;</span>

<span class="p">(</span><span class="nx">_a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">_a</span> <span class="o">!==</span> <span class="k">void</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">_a</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">(</span><span class="nx">_a2</span> <span class="o">=</span> <span class="nx">a</span><span class="p">)</span> <span class="o">===</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">_a2</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span> <span class="o">?</span> <span class="k">void</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">_a2</span><span class="p">.</span><span class="nx">b</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>You can test it yourself on the babel <a href="https://www.babeljs.cn/repl#?browsers=defaults%2C%20not%20ie%2011%2C%20not%20ie_mob%2011&amp;build=&amp;builtIns=false&amp;corejs=3.6&amp;spec=false&amp;loose=false&amp;code_lz=Q&amp;debug=false&amp;forceAllTransforms=false&amp;shippedProposals=false&amp;circleciRepo=&amp;evaluate=false&amp;fileSize=false&amp;timeTravel=false&amp;sourceType=module&amp;lineWrap=true&amp;presets=env%2Creact%2Cstage-0%2Cstage-1%2Cstage-2%2Cstage-3%2Ctypescript%2Cflow&amp;prettier=false&amp;targets=&amp;version=7.15.3&amp;externalPlugins=">website</a>.</p>
<h2 id="uses-of-babel">Uses of babel</h2>
<ol>
<li>Translate esnext, typescript, flow, etc. to js supported by the target environment.</li>
<li>Some use-specific code conversions. babel exposes a number of api&rsquo;s that can be used to parse code to AST, convert AST, and generate target code. Developers can use it for specific-purpose conversions such as function stubbing (automatic insertion of code into functions, e.g. buried code), automatic internationalization, default import to named import, etc.</li>
<li>Static analysis of code. After parse, the code can be transformed because the structure of the AST allows the code to be understood. After understanding the code, it can also be used to analyze the information of the code and perform some checks, in addition to converting and generating the target code.</li>
<li>The linter tool is to analyze the structure of the AST and to check the code specification.</li>
<li>api Documentation automatic generation tool that extracts comments from the source code and then generates documentation.</li>
<li>The type checker checks the AST for type consistency based on the type information extracted or derived from the AST, thus reducing type-related errors at runtime.</li>
<li>Compression and obfuscation tool, this also analyzes the code structure and performs various compilation optimizations such as removing dead code, variable name obfuscation, constant folding, etc. to generate smaller and better performing code.</li>
</ol>
<h2 id="the-babel-compilation-process">The babel compilation process</h2>
<p>The overall babel compilation process is divided into three steps.</p>
<ol>
<li>parse: convert the source code into an abstract syntax tree (AST) by parser</li>
<li>transform: traverse the AST and call various transform plugins to add, delete and change the AST</li>
<li>generate: print the transformed AST to the target code and generate sourcemap in three steps.</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/13/2ed1e2cce1764413942080fa23f84be3.png" alt=" "></p>
<p>The purpose of the parse phase is to convert the source code string into a machine-understandable AST, which is divided into lexical analysis and syntax analysis.</p>
<h3 id="parse">parse</h3>
<p>For example, <code>let name = 'guang';</code> such a piece of source code, we have to first divide it into words (token) that cannot be subdivided, that is <code>let, name, =, 'guang'</code>, this process is lexical analysis, splitting the string into words according to the rules of word formation.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/13/f8e50ef48e9e490ca7ec193e051f3386.png" alt=" "></p>
<h3 id="transform">transform</h3>
<p>The transform phase is the processing of the AST generated by parse, and it will traverse the AST, and the corresponding visitor function will be called when different AST nodes are processed in the traversal process.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/13/d639826c321f490a802db8deebf975e3.png" alt=" "></p>
<h3 id="generate">generate</h3>
<p>The generate phase prints the AST to the target code string and generates the sourcemap.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/13/3711031cc3f443d5a38646df8574309e.png" alt=" "></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="k">while</span> <span class="p">(</span><span class="nx">node</span> <span class="nx">condition</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// node contet
</span><span class="c1"></span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="ast-node">AST Node</h3>
<p>Literals, identifiers, expressions, statements, module syntax, and class syntax all have their own ASTs.</p>
<p>For example, literalLiteral.</p>
<p>&lsquo;a&rsquo; is StringLiteral, 123 is NumberLiteral, variable names, attribute names, and other identifiers are Identifier.</p>
<p>We can go to the AST visualization tool to understand each node.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/13/2ac8f786541e4143af7a7caaa231d566.png" alt=" "></p>
<p>You can also go to <a href="https://github.com/babel/babel/blob/main/packages/babel-parser/ast/spec.md">@babel/types</a> to see all AST types.</p>
<h4 id="public-properties-of-ast">Public Properties of AST</h4>
<ul>
<li>type: the type of the AST node.</li>
<li>start, end, loc: start and end represent the start and end subscripts of the source string corresponding to the node, and do not distinguish between rows and columns. The loc attribute is an object with line and column attributes that record the start and end row numbers, respectively.</li>
<li>leadingComments, innerComments, trailingComments: indicates the starting comments, middle comments, and ending comments, because there may be comments in each AST node, and they may be in the starting, middle, and ending positions.</li>
<li>extra: Record some extra information for handling some special cases.</li>
</ul>
<h2 id="babel-api">babel api</h2>
<h3 id="babelparser">@babel/parser</h3>
<p>It provides two api&rsquo;s: parse and parseExpression, both of which convert the source code to AST, but parse returns an AST with File as the root node and parseExpression returns an AST with Expression as the root node. You can specify what to parse and how to parse it. The two most common options are plugins and sourceType.</p>
<p>plugins: Specifies plugins such as jsx, typescript, flow, etc. to parse the corresponding syntax.</p>
<p>sourceType: specifies whether to support parsing module syntax, and has three values: module parses the es module syntax, script does not parse the es module syntax and is executed as a script, and unambiguous is based on whether the content has import and unambiguous is based on whether the content has import and export to determine whether to parse the es module syntax.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@babel/parser&#34;</span><span class="p">).</span><span class="nx">parse</span><span class="p">(</span><span class="s2">&#34;code&#34;</span><span class="p">,</span> <span class="p">{</span>
  <span class="nx">sourceType</span><span class="o">:</span> <span class="s2">&#34;module&#34;</span><span class="p">,</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&#34;jsx&#34;</span><span class="p">,</span>
    <span class="s2">&#34;typescript&#34;</span>
  <span class="p">]</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="babeltraverse">@babel/traverse</h3>
<p>The parse AST is traversed and modified by @babel/traverse. The babel traverse package provides the traverse method: function traverse(parent, opts)</p>
<p>parent specifies the AST node to be traversed and opts specifies the visitor function. babel calls the corresponding visitor function when traversing the AST corresponding to parent. enter is called before traversing the children of the current node and exit is called after traversing the children of the current node.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">visitor</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">Identifier</span> <span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">state</span><span class="p">)</span> <span class="p">{},</span>
    <span class="nx">StringLiteral</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">enter</span> <span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">state</span><span class="p">)</span> <span class="p">{},</span>
        <span class="nx">exit</span> <span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">state</span><span class="p">)</span> <span class="p">{}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The path parameter is the path during traversal, which preserves contextual information. The path provides access to node information.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">path.scope gets the scope information of the current node
path.isXxx determines if the current node is of type xx.
path.assertXxx determines whether the current node is of type xx or not, and throws an exception if it is not.
isXxx, assertXxx series methods can be used to determine the AST type
path.insertBefore, path.insertAfter insert node
path.replaceWith, path.replaceWithMultiple, replaceWithSourceString replace nodes
path.remove Remove a node
These methods can add, delete and change ASTs
</code></pre></td></tr></table>
</div>
</div><p>The parameter state allows passing data between different nodes.</p>
<h3 id="babeltypes">@babel/types</h3>
<p>Creates an AST and determines the type of the AST. To create an IfStatement you call t.ifStatement(test, consequent, alternate);</p>
<p>To determine if a node is an IfStatement, call isIfStatement or assertIfStatement t.isIfStatement(node, opts); t.assertIfStatement(node, opts);</p>
<h3 id="babeltemplate">@babel/template</h3>
<p>Batch node creation</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">template</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="p">[</span><span class="nx">opts</span><span class="p">])(</span><span class="nx">args</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">ast</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="p">[</span><span class="nx">opts</span><span class="p">]);</span>
<span class="kr">const</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">program</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="p">[</span><span class="nx">opts</span><span class="p">]);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="babelgenerate">@babel/generate</h3>
<p>Print to target code string</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="p">{</span> <span class="nx">code</span><span class="p">,</span> <span class="nx">map</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">generate</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span> <span class="nx">sourceMaps</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span>
<span class="kd">function</span> <span class="p">(</span><span class="nx">ast</span><span class="o">:</span> <span class="nb">Object</span><span class="p">,</span> <span class="nx">opts</span><span class="o">:</span> <span class="nb">Object</span><span class="p">,</span> <span class="nx">code</span><span class="o">:</span> <span class="nx">string</span><span class="p">)</span><span class="o">:</span> <span class="p">{</span><span class="nx">code</span><span class="p">,</span> <span class="nx">map</span><span class="p">}</span> 
</code></pre></td></tr></table>
</div>
</div><h3 id="babelcore">@babel/core</h3>
<p>To complete the babel compilation process based on the packages above, you can start with the source strings, source files, and ASTs.</p>
<h2 id="usage">Usage</h2>
<h3 id="download">Download</h3>
<ul>
<li>Installation</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">npm i @babel/core @babel-cli
</code></pre></td></tr></table>
</div>
</div><ul>
<li>package.json config</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;scripts&#34;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&#34;build&#34;</span><span class="p">:</span> <span class="s2">&#34;babel src -d dist&#34;</span>
  <span class="p">},</span> 
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>The babel-loader needs to be configured in webpack</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// webpack.config.js
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">entry</span><span class="o">:</span> <span class="s1">&#39;./src/app.js&#39;</span><span class="p">,</span>
    <span class="nx">output</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">path</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;dist&#39;</span><span class="p">),</span>
        <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;bundle.js&#39;</span>
    <span class="p">},</span>
    <span class="nx">module</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">rules</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="nx">test</span><span class="o">:</span> <span class="sr">/\.js$/</span><span class="p">,</span> <span class="nx">exclude</span><span class="o">:</span> <span class="sr">/node_modules/</span><span class="p">,</span> <span class="nx">loader</span><span class="o">:</span> <span class="s1">&#39;babel-loader&#39;</span> <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="configuration">Configuration</h3>
<p>We need to tell babel how to compile and what to compile. There are several ways to configure a file.</p>
<ul>
<li>Set the babel field in package.json.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="c1">//package.json
</span><span class="c1"></span><span class="p">{</span>
   <span class="nt">&#34;name&#34;</span><span class="p">:</span><span class="s2">&#34;babel-test&#34;</span><span class="p">,</span>
   <span class="nt">&#34;version&#34;</span><span class="p">:</span><span class="s2">&#34;1.0.0&#34;</span><span class="p">,</span>
   <span class="nt">&#34;devDependencies&#34;</span><span class="p">:</span> <span class="p">{</span>
       <span class="nt">&#34;@babel/core&#34;</span><span class="p">:</span><span class="s2">&#34;^7.4.5&#34;</span><span class="p">,</span>
       <span class="nt">&#34;@babel/cli&#34;</span><span class="p">:</span><span class="s2">&#34;^7.4.4&#34;</span><span class="p">,</span>
       <span class="nt">&#34;@babel/preset-env&#34;</span><span class="p">:</span><span class="s2">&#34;^7.4.5&#34;</span>
   <span class="p">}</span>
   <span class="s2">&#34;babel&#34;</span><span class="p">:</span> <span class="p">{</span>
       <span class="nt">&#34;presets&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;@babel/preset-env&#34;</span><span class="p">]</span>
   <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>.babelrc file or .babelrc.js</p>
<ul>
<li>
<p>.babelrc</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;presets&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;@babel/preset-env&#34;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>.babelrc.js</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">//The webpack configuration file is written in the same way
</span><span class="c1"></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
<span class="nx">presets</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;@babel/preset-env&#39;</span><span class="p">]</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>babel.config.js file</p>
</li>
</ul>
<p>Same as .babelrc.js, but babel.config.js is for the whole project.</p>
<h3 id="use">Use</h3>
<p>The configuration file tells babel what to compile and then introduces the corresponding plugins, for example, the @babel/plugin-transform-arrow-functions plugin for the arrow function transformation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">plugin</span><span class="o">-</span><span class="nx">transform</span><span class="o">-</span><span class="nx">arrow</span><span class="o">-</span><span class="nx">functions</span> 
<span class="c1">// babel.config.js
</span><span class="c1"></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;@babel/plugin-transform-arrow-functions&#39;</span><span class="p">]</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>Now the arrow function in our code will be compiled as a normal function.</p>
<h3 id="presets">Presets</h3>
<p>When there are a lot of plugins or a lot of options for a plugin, it becomes more expensive to use. A preset is a layer of wrapping around babel configuration.</p>
<p>Just install the preset and it will automatically convert the new features in the code into code supported by the target browser, depending on the target browser you set.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">preset</span><span class="o">-</span><span class="nx">env</span>
<span class="c1">// babel.config.js
</span><span class="c1"></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="s1">&#39;@babel/preset-env&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="nx">targets</span><span class="o">:</span> <span class="p">{</span>
                    <span class="nx">chrome</span><span class="o">:</span> <span class="s1">&#39;58&#39;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="plugin-transform-runtime-and-runtime-plugin">plugin-transform-runtime and runtime plugin</h4>
<p>When compiling a class with babel, you need some tool functions to help with the implementation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">People</span><span class="p">{</span>
<span class="p">}</span>

<span class="c1">// After babel is compiled
</span><span class="c1"></span><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">_classCallCheck</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">Constructor</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">instance</span> <span class="k">instanceof</span> <span class="nx">Constructor</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="s1">&#39;Cannot call a class as a function&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">People</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">People</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">People</span><span class="p">);</span>
<span class="p">};</span>

</code></pre></td></tr></table>
</div>
</div><p>Each class generates _classCallCheck, which ends up generating a lot of duplicate code. plugin-transform-runtime is designed to solve this problem.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">npm</span> <span class="nx">i</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">plugin</span><span class="o">-</span><span class="nx">transform</span><span class="o">-</span><span class="nx">runtime</span>
<span class="c1">//Production Dependence
</span><span class="c1"></span><span class="nx">npm</span> <span class="nx">i</span> <span class="err">@</span><span class="nx">babel</span><span class="o">/</span><span class="nx">runtime</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;@babel/preset-env&#39;</span><span class="p">],</span>
    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;@babel/plugin-transform-runtime&#39;</span><span class="p">]</span>
<span class="p">};</span>
<span class="s2">&#34;use strict&#34;</span><span class="p">;</span>

<span class="c1">// After babel is compiled
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">_interopRequireDefault</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@babel/runtime/helpers/interopRequireDefault&#34;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">_classCallCheck2</span> <span class="o">=</span> <span class="nx">_interopRequireDefault</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@babel/runtime/helpers/classCallCheck&#34;</span><span class="p">));</span>

<span class="kd">var</span> <span class="nx">People</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">People</span><span class="p">()</span> <span class="p">{</span>
  <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">_classCallCheck2</span><span class="p">[</span><span class="s2">&#34;default&#34;</span><span class="p">])(</span><span class="k">this</span><span class="p">,</span> <span class="nx">People</span><span class="p">);</span>
<span class="p">};</span>

</code></pre></td></tr></table>
</div>
</div><h4 id="babel-polyfill">babel-polyfill</h4>
<p>babel can translate some new features, but for new built-in functions (Promise, Set, Map), static methods (Array.from, Object.assign), instance methods (Array.prototype.includes) that need babel-polyfill to be addressed. babel-polyfill will fully simulate an ES2015+ environment.</p>
<p>Because @babel/polyfill is relatively large, introducing it as a whole both increases the size of the project and pollutes it with too many variables, so it is more recommended to use preset-env to introduce polyfill on demand.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// corejs is a library that provides an interface to lower versions of browsers
</span><span class="c1"></span><span class="nx">npm</span> <span class="nx">i</span> <span class="nx">core</span><span class="o">-</span><span class="nx">js</span><span class="err">@</span><span class="mi">2</span>
<span class="c1">// babel.config.js
</span><span class="c1"></span><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">presets</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">[</span>
            <span class="s1">&#39;@babel/preset-env&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="nx">useBuiltIns</span><span class="o">:</span> <span class="s1">&#39;usage&#39;</span><span class="p">,</span> <span class="c1">// use-introduce on-demand entry-introduce the entry (overall introduction) false-do not introduce polyfill
</span><span class="c1"></span>                <span class="nx">corejs</span><span class="o">:</span> <span class="mi">2</span>  <span class="c1">// 2-corejs@2  3-corejs@3
</span><span class="c1"></span>            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">};</span>

</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">//babel after compilation
</span><span class="c1"></span><span class="s2">&#34;use strict&#34;</span><span class="p">;</span>

<span class="nx">require</span><span class="p">(</span><span class="s2">&#34;core-js/modules/es6.string.iterator&#34;</span><span class="p">);</span>

<span class="nx">require</span><span class="p">(</span><span class="s2">&#34;core-js/modules/es6.array.from&#34;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">from</span><span class="p">([</span><span class="mi">1</span><span class="p">]);</span> 
</code></pre></td></tr></table>
</div>
</div><h2 id="a-simple-case">A simple case</h2>
<h3 id="function-staking">Function Staking</h3>
<p>You want to use babel to automatically insert arguments for filename and row number in api such as console.log, so that you can easily locate the code, which does not affect other logic.</p>
<p>Idea: When traversing the AST to console.log and other api automatically insert some arguments, that is, to do some processing of the function call expression CallExpression specified by the visitor. callExrpession node has two properties, callee and arguments, respectively, corresponding to the name of the function called and So we need to determine when callee is console.xx and insert an AST node in the array of arguments, creating an AST node requires the @babel/types package.</p>
<p>Main Code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">sourceCode</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">sourceType</span><span class="o">:</span> <span class="s1">&#39;unambiguous&#39;</span><span class="p">,</span>
    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;jsx&#39;</span><span class="p">]</span>
<span class="p">});</span>

<span class="kr">const</span> <span class="nx">targetCalleeName</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;debug&#39;</span><span class="p">].</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span> <span class="p">=&gt;</span> <span class="sb">`console.</span><span class="si">${</span><span class="nx">item</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="nx">traverse</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">CallExpression</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">state</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">calleeName</span> <span class="o">=</span> <span class="nx">generate</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">callee</span><span class="p">).</span><span class="nx">code</span><span class="p">;</span>
         <span class="k">if</span> <span class="p">(</span><span class="nx">targetCalleeName</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">calleeName</span><span class="p">))</span> <span class="p">{</span>
            <span class="kr">const</span> <span class="p">{</span> <span class="nx">line</span><span class="p">,</span> <span class="nx">column</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">loc</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
            <span class="nx">path</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">arguments</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="nx">types</span><span class="p">.</span><span class="nx">stringLiteral</span><span class="p">(</span><span class="sb">`filename: (</span><span class="si">${</span><span class="nx">line</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">column</span><span class="si">}</span><span class="sb">)`</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// babel before compilation
</span><span class="c1"></span><span class="kr">const</span> <span class="nx">sourceCode</span> <span class="o">=</span> <span class="sb">`
</span><span class="sb">    console.log(1);
</span><span class="sb">
</span><span class="sb">    function func() {
</span><span class="sb">        console.info(2);
</span><span class="sb">    }
</span><span class="sb">
</span><span class="sb">    export default class Clazz {
</span><span class="sb">        say() {
</span><span class="sb">            console.debug(3);
</span><span class="sb">        }
</span><span class="sb">    }
</span><span class="sb">`</span><span class="p">;</span>

<span class="c1">// After babel is compiled
</span><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&#34;filename: (2, 4)&#34;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">func</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&#34;filename: (5, 8)&#34;</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Clazz</span> <span class="p">{</span>
  <span class="nx">say</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">debug</span><span class="p">(</span><span class="s2">&#34;filename: (10, 12)&#34;</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<p>Reference <code>https://blog.dteam.top/posts/2021-06/babel-theory.html</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/javascript/">javascript</a>
          <a href="/tags/babel/">babel</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-08/avoid-go-command-orphan-processes/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">How can I avoid Go command line execution creating &#34;orphan&#34; processes?</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-08/google-open-source-allstar/">
            <span class="next-text nav-default">Google Opens Allstar to Implement Ongoing Security Best Practices for GitHub Projects</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
