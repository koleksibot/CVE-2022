<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Web Performance Optimization - preload,prefetch,preconnect - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="When it comes to front-end performance optimization, we usually think of enabling compression to compress the resource file size. Or enabling browser caching can have the effect of optimizing resource loading speed with fewer HTTP requests, but these means mainly improve the loading speed when repeatedly accessing the same resources. By default, the browser will only load resources declared in HTML first. If it is not declared, the browser will not load the resource earlier." /><meta name="keywords" content="preload,prefetch,preconnect,web" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-08/web-performance-preload-prefetch-preconnect/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Web Performance Optimization - preload,prefetch,preconnect" />
<meta property="og:description" content="When it comes to front-end performance optimization, we usually think of enabling compression to compress the resource file size. Or enabling browser caching can have the effect of optimizing resource loading speed with fewer HTTP requests, but these means mainly improve the loading speed when repeatedly accessing the same resources. By default, the browser will only load resources declared in HTML first. If it is not declared, the browser will not load the resource earlier." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-08/web-performance-preload-prefetch-preconnect/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-08-11T10:40:08+08:00" />
<meta property="article:modified_time" content="2021-08-11T10:40:08+08:00" />

<meta itemprop="name" content="Web Performance Optimization - preload,prefetch,preconnect">
<meta itemprop="description" content="When it comes to front-end performance optimization, we usually think of enabling compression to compress the resource file size. Or enabling browser caching can have the effect of optimizing resource loading speed with fewer HTTP requests, but these means mainly improve the loading speed when repeatedly accessing the same resources. By default, the browser will only load resources declared in HTML first. If it is not declared, the browser will not load the resource earlier."><meta itemprop="datePublished" content="2021-08-11T10:40:08+08:00" />
<meta itemprop="dateModified" content="2021-08-11T10:40:08+08:00" />
<meta itemprop="wordCount" content="1553">
<meta itemprop="keywords" content="solution," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Web Performance Optimization - preload,prefetch,preconnect"/>
<meta name="twitter:description" content="When it comes to front-end performance optimization, we usually think of enabling compression to compress the resource file size. Or enabling browser caching can have the effect of optimizing resource loading speed with fewer HTTP requests, but these means mainly improve the loading speed when repeatedly accessing the same resources. By default, the browser will only load resources declared in HTML first. If it is not declared, the browser will not load the resource earlier."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Web Performance Optimization - preload,prefetch,preconnect</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-08-11 10:40:08 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1553 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#preload">preload</a>
          <ul>
            <li><a href="#features">Features</a></li>
            <li><a href="#usage-scenarios">Usage Scenarios</a></li>
            <li><a href="#compatibility">Compatibility</a></li>
            <li><a href="#preload-gives-priority-to-loading-resources">preload gives priority to loading resources</a></li>
            <li><a href="#attention">Attention</a></li>
          </ul>
        </li>
        <li><a href="#prefetch">prefetch</a>
          <ul>
            <li><a href="#compatibility-1">Compatibility</a></li>
            <li><a href="#preload-and-prefetch-vs">preload and prefetch vs</a></li>
            <li><a href="#avoid-mixing-preload-and-prefetch">Avoid mixing preload and prefetch</a></li>
          </ul>
        </li>
        <li><a href="#preconnect">preconnect</a>
          <ul>
            <li><a href="#compatibility-2">Compatibility</a></li>
          </ul>
        </li>
        <li><a href="#cases">Cases</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>When it comes to front-end performance optimization, we usually think of enabling compression to compress the resource file size. Or enabling browser caching can have the effect of optimizing resource loading speed with fewer HTTP requests, but these means mainly improve the loading speed when repeatedly accessing the same resources. By default, the browser will only load resources declared in HTML first. If it is not declared, the browser will not load the resource earlier. So is there any way to load the resources needed for a page ahead of time to optimize the first load speed?</p>
<p>Fortunately, with the advancement of web technology, modern browsers can now load the resources needed for a page in advance. Using the resource hint pseudo-directives prefetch and preload, you can tell the browser to load the resources in advance, thus shortening the (first) load speed of the site and optimizing page performance.</p>
<h2 id="preload">preload</h2>
<p>A type of preloading, which declares a resource to be submitted for loading to the browser via a declaration that is executed immediately when the resource is actually used, so there is no need to wait for the network to be consumed.</p>
<p>There are three ways to use it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!-- Use link tags to statically mark resources that need to be preloaded --&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/path/to/style.css&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;style&#34;</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Create a link tag dynamically with a script and insert it into the head header --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kr">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">);</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s1">&#39;preload&#39;</span><span class="p">;</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">as</span> <span class="o">=</span> <span class="s1">&#39;style&#39;</span><span class="p">;</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">&#39;/path/to/style.css&#39;</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">link</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Add the preload field to the HTTP response header --&gt;</span>
Link: <span class="p">&lt;</span><span class="nt">https:</span><span class="err">//</span><span class="na">example</span><span class="err">.</span><span class="na">com</span><span class="err">/</span><span class="na">other</span><span class="err">/</span><span class="na">styles</span><span class="err">.</span><span class="na">css</span><span class="p">&gt;</span>; rel=preload; as=style
</code></pre></td></tr></table>
</div>
</div><p>rel attribute value is preload; as attribute is used to specify the type of the resource and set the Accep request header according to the resource type so that the corresponding resource can be requested using the normal policy; href is the address of the resource request; onload and onerror are the callback functions when the resource loads successfully and fails, respectively.</p>
<p>as values include: style, script, image, font, fetch, document, audio, video, etc. If you request a cross-domain resource, you need to add the crossorigin attribute.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;font.woff2&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;font/woff2&#34;</span> <span class="na">crossorigin</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="features">Features</h3>
<ul>
<li>preload does not block the windows onload event, unless the preload resource is requested from a resource that blocks the window load.</li>
<li>It is recommended to add the crossorigin attribute when requesting cross-domain resources, otherwise it may lead to secondary loading of resources (especially font resources).</li>
</ul>
<h3 id="usage-scenarios">Usage Scenarios</h3>
<h4 id="loading-fonts-in-advance">Loading fonts in advance</h4>
<p>Fonts in the web are a type of resource that loads late, but their rendering is critical to the user experience. Slow loading can cause font jitter to the user, i.e. the font will be displayed as the environment default font first.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;font.woff2&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;font/woff2&#34;</span> <span class="na">crossorigin</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="loading-third-party-js">Loading third-party js</h4>
<p>For example, if you want to load a piece of code that counts page visits, but you don&rsquo;t want the loading of this code to delay the rendering of the page and thus affect the user experience, you don&rsquo;t want to delay the onload event of the window.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;script&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;async_script.js&#34;</span>
    <span class="na">onload</span><span class="o">=</span><span class="s">&#34;var script = document.createElement(&#39;script&#39;); 
</span><span class="s">    script.src = this.href; document.body.appendChild(script);&#34;</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="responsive-loading">Responsive loading</h4>
<p>If the web side supports mobile browser access, the media property of the link can be used to determine when different resources are loaded on the web side and the mobile side. A common practice is to load resources dynamically by determining the current browser type through JS, but then the browser&rsquo;s preloader will not be able to find them in time, which may delay the loading time and affect the user experience.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;image&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;map.png&#34;</span> <span class="na">media</span><span class="o">=</span><span class="s">&#34;(max-width: 600px)&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;script&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;map.js&#34;</span> <span class="na">media</span><span class="o">=</span><span class="s">&#34;(min-width: 601px)&#34;</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="predicting-user-behavior-to-load-resources-in-advance">Predicting user behavior to load resources in advance</h4>
<p>For example, if the user hovers over an item, such as a product. Analyze the resources needed for the product details page and enable preload loading in advance.</p>
<h3 id="compatibility">Compatibility</h3>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/9f91848299774742b3f7f4ccf4e9e56e.png" alt=" "></p>
<p>You can determine if preload is supported by the following method.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">isPreloadSupported</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span> 
  <span class="kr">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">);</span> 
  <span class="kr">const</span> <span class="nx">relList</span> <span class="o">=</span> <span class="nx">link</span><span class="p">.</span><span class="nx">relList</span><span class="p">;</span> 
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">relList</span> <span class="o">||</span> <span class="o">!</span><span class="nx">relList</span><span class="p">.</span><span class="nx">supports</span><span class="p">)</span> <span class="p">{</span> 
    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>  
  <span class="p">}</span> 
  <span class="k">return</span> <span class="nx">relList</span><span class="p">.</span><span class="nx">supports</span><span class="p">(</span><span class="s1">&#39;preload&#39;</span><span class="p">);</span> 
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="preload-gives-priority-to-loading-resources">preload gives priority to loading resources</h3>
<p>The browser priority for loading resources is as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/037e203ed0944f9eb4ea65c3fafc2494.png" alt=" "></p>
<p>preloads use &ldquo;as&rdquo; or use the &ldquo;type&rdquo; attribute to indicate the priority of the resource they are requesting (for example, a preload using the as=&ldquo;style &quot; attribute will get the highest priority). Requests without the &ldquo;as&rdquo; attribute are treated as asynchronous, with &ldquo;Early&rdquo; meaning that they are requested before all image requests that are not preloaded (&ldquo;late&rdquo; meaning after ).</p>
<p>The resource priority can be viewed in chrome at</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/7a4965f372da4b4893499f57de315316.png" alt=" "></p>
<h3 id="attention">Attention</h3>
<h4 id="avoid-abusing-preload">Avoid abusing preload</h4>
<p>If you are not sure that a resource is bound to be loaded, do not use preload incorrectly, as this will put the cart before the horse and burden the page with more work. When a preload loads a resource that is not used, the browser will warn that</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/2c7b544dc5c948cdac4c53047ec6f7dd.png" alt=" "></p>
<h4 id="preload-adds-the-crossorigin-attribute-when-loading-cross-domain-resources">preload adds the crossorigin attribute when loading cross-domain resources</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://at.alicdn.com/t/font_zck90zmlh7hf47vi.woff&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span> <span class="na">crossorigin</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://at.alicdn.com/t/font_zck90zmlh7hf47vi.woff&#34;</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>If a cross-domain file is preloaded without adding the crossorigin attribute, it will be requested twice.</p>
<h2 id="prefetch">prefetch</h2>
<p>prefetch tells the browser about a resource that may be used in the future, such as the next page. The browser will then load the corresponding resource at leisure, or preload it if it can predict the user&rsquo;s behavior, such as lazy loading, clicking on another page, etc. It is used in the same way as preload.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!-- Use link tags to statically mark resources that need to be preloaded --&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;prefetch&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/path/to/style.css&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;style&#34;</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Create a link tag dynamically with a script and insert it into the head header --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kr">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">);</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s1">&#39;prefetch&#39;</span><span class="p">;</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">as</span> <span class="o">=</span> <span class="s1">&#39;style&#39;</span><span class="p">;</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">&#39;/path/to/style.css&#39;</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">link</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Add the prefetch field to the HTTP response header --&gt;</span>
Link: <span class="p">&lt;</span><span class="nt">https:</span><span class="err">//</span><span class="na">example</span><span class="err">.</span><span class="na">com</span><span class="err">/</span><span class="na">other</span><span class="err">/</span><span class="na">styles</span><span class="err">.</span><span class="na">css</span><span class="p">&gt;</span>; rel=prefetch; as=style
</code></pre></td></tr></table>
</div>
</div><h3 id="compatibility-1">Compatibility</h3>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/c2faa23730cf4a1ea3940e345928a45c.png" alt=" "></p>
<h3 id="preload-and-prefetch-vs">preload and prefetch vs</h3>
<ol>
<li>Chrome has four types of caches: http cache, memory cache, Service Worker cache, and Push cache. both are stored in the http cache when a preload or prefetch resource is loaded. when the resource is loaded, if the resource is cacheable, it is stored If the resources are not cacheable, they are stored in the memory cache until they are used.</li>
<li>Neither preload nor prefetch have same-domain restrictions.</li>
<li>preload is mainly used to preload the resources needed for the current page; and prefetch is mainly used to load the resources that will be needed for future pages.</li>
<li>prefetch will be cached on the network stack for at least 5 minutes, regardless of whether the resource is cacheable or not.</li>
<li>preload requires the as attribute to specify a specific resource type so that the browser can assign a certain priority to it and load the resource correctly.</li>
</ol>
<h3 id="avoid-mixing-preload-and-prefetch">Avoid mixing preload and prefetch</h3>
<p>Mixing preload and prefetch does not reuse resources, but reloads them.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preload&#34;</span>   <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://at.alicdn.com/t/font_zck90zmlh7hf47vi.woff&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;prefetch&#34;</span>  <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://at.alicdn.com/t/font_zck90zmlh7hf47vi.woff&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;font&#34;</span><span class="p">&gt;</span> 
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/89bc1180d89a410790e37cb1e2f86978.png" alt=" "></p>
<h2 id="preconnect">preconnect</h2>
<p>This includes DNS resolution, TLS negotiation, and TCP handshaking, which eliminates round-trip delays and saves the user time.</p>
<blockquote>
<p>&ldquo;Preconnect is an important tool for optimization that can reduce the round-trip path in many requests &ndash; in some cases by hundreds or thousands of milliseconds of latency.&rdquo; &ndash; lya Grigorik (author of The Definitive Guide to Web Performance)</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/e123243b48f94a968314803bca45212b.png" alt=" "></p>
<p>It is used in the same way as preload.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="c">&lt;!-- Use link tags to statically mark resources that need to be preloaded --&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;preconnect&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://cdn.domain.com&#34;</span> <span class="na">as</span><span class="o">=</span><span class="s">&#34;style&#34;</span> <span class="na">crossorigin</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Create a link tag dynamically with a script and insert it into the head header --&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="kr">const</span> <span class="nx">link</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;link&#39;</span><span class="p">);</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">rel</span> <span class="o">=</span> <span class="s1">&#39;preconnect&#39;</span><span class="p">;</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">as</span> <span class="o">=</span> <span class="s1">&#39;style&#39;</span><span class="p">;</span>
<span class="nx">link</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="s1">&#39;https://cdn.domain.com&#39;</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">link</span><span class="p">);</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

<span class="c">&lt;!-- Add the preconnect field to the HTTP response header --&gt;</span>
Link: <span class="p">&lt;</span><span class="nt">https:</span><span class="err">//</span><span class="na">cdn</span><span class="err">.</span><span class="na">domain</span><span class="err">.</span><span class="na">com</span><span class="p">&gt;</span>; rel=preconnect; as=style
</code></pre></td></tr></table>
</div>
</div><p>Here is an example of using preconnect for Google Fonts. By adding a preconnect hint to fonts.gstatic.com, the browser will immediately initiate the request and execute it in parallel with the CSS request. In this scenario, preconnect eliminates three RTTs (Round-Trip Time) from the critical path and reduces latency by more than half a second, as analyzed in more detail in lya Grigorik&rsquo;s eliminating RTTS with preconnect.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&#39;https://fonts.gstatic.com&#39;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#39;preconnect&#39;</span> <span class="na">crossorigin</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&#39;https://fonts.googleapis.com/css?family=Roboto+Slab:700|Open+Sans&#39;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#39;stylesheet&#39;</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>You can see a time saving of about 400ms on the second request.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/4cea908c7efb4bb1ac5cb13b60ad2916.png" alt=" "></p>
<h3 id="compatibility-2">Compatibility</h3>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/828cdf4b8e034e8395705ac3b7e09fde.png" alt=" "></p>
<h2 id="cases">Cases</h2>
<ol>
<li>
<p>Housing.com saw an approximate 10% reduction in interactivity time when switching to proload for their progressive web application scripts
<img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/e5b08b69378846dea3487c24c5c45744.png" alt=" "></p>
</li>
<li>
<p>Shopify got a 50% (1.2s) text rendering optimization on Chrome Desktop after switching to preload loading fonts, which completely solved their text flicker problem.
<img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/679e7220972247a2b3f2c8cf55267325.png" alt=" "></p>
</li>
<li>
<p>When the Financial Times used the preload HTTP header on their site, they saved about 1s of time in displaying the header image.
<img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/08/11/bb9c5f88e9de40839c4fda987950a1bf.png" alt=" "></p>
</li>
</ol>
<h2 id="summary">Summary</h2>
<p>preload, prefetch and preconnect allow the browser to load the required resources in advance, separating the download and execution of the resources, which can bring a significant improvement to the first screen rendering if used properly and can bring the ultimate experience to the page interaction.</p>
<hr>
<p>Reference <code>https://blog.dteam.top/posts/2021-08/web-performance-preload-prefetch-preconnect.html</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/solution/">solution</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-08/elastic-forces-developers-to-choose-one-or-the-other/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Change the protocol, change the code, Elastic is forcing developers to choose one or the other?</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-08/wireguardnt-for-windows/">
            <span class="next-text nav-default">WireGuardNT: A high-performance WireGuard implementation for the Windows kernel</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
