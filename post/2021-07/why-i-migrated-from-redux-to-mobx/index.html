<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Why I Migrated From Redux to Mobx - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Redux is a data management layer that is widely used to manage data for complex applications. But in practice, Redux is poorly used, and arguably not well used. And at the same time, a number of data management solutions have emerged in the community, Mobx being one of them.
Problems with Redux  Predictable state container for JavaScript apps
 This is the position Redux has given itself, but there are many problems with it." /><meta name="keywords" content="Redux,mobx" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-07/why-i-migrated-from-redux-to-mobx/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Why I Migrated From Redux to Mobx" />
<meta property="og:description" content="Redux is a data management layer that is widely used to manage data for complex applications. But in practice, Redux is poorly used, and arguably not well used. And at the same time, a number of data management solutions have emerged in the community, Mobx being one of them.
Problems with Redux  Predictable state container for JavaScript apps
 This is the position Redux has given itself, but there are many problems with it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-07/why-i-migrated-from-redux-to-mobx/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-07-21T20:21:21+08:00" />
<meta property="article:modified_time" content="2021-07-21T20:21:21+08:00" />

<meta itemprop="name" content="Why I Migrated From Redux to Mobx">
<meta itemprop="description" content="Redux is a data management layer that is widely used to manage data for complex applications. But in practice, Redux is poorly used, and arguably not well used. And at the same time, a number of data management solutions have emerged in the community, Mobx being one of them.
Problems with Redux  Predictable state container for JavaScript apps
 This is the position Redux has given itself, but there are many problems with it."><meta itemprop="datePublished" content="2021-07-21T20:21:21+08:00" />
<meta itemprop="dateModified" content="2021-07-21T20:21:21+08:00" />
<meta itemprop="wordCount" content="1892">
<meta itemprop="keywords" content="redux,mobx," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Why I Migrated From Redux to Mobx"/>
<meta name="twitter:description" content="Redux is a data management layer that is widely used to manage data for complex applications. But in practice, Redux is poorly used, and arguably not well used. And at the same time, a number of data management solutions have emerged in the community, Mobx being one of them.
Problems with Redux  Predictable state container for JavaScript apps
 This is the position Redux has given itself, but there are many problems with it."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Why I Migrated From Redux to Mobx</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-07-21 20:21:21 </span>
        <div class="post-category">
            <a href="/categories/frontend/"> frontend </a>
            </div>
          <span class="more-meta"> 1892 words </span>
          <span class="more-meta"> 9 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#problems-with-redux">Problems with Redux</a></li>
        <li><a href="#mobx">Mobx</a></li>
        <li><a href="#performance">Performance</a></li>
        <li><a href="#mobx-state-tree">Mobx State Tree</a></li>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#some-practices">Some practices</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Redux is a data management layer that is widely used to manage data for complex applications. But in practice, Redux is poorly used, and arguably not well used. And at the same time, a number of data management solutions have emerged in the community, Mobx being one of them.</p>
<h2 id="problems-with-redux">Problems with Redux</h2>
<blockquote>
<p>Predictable state container for JavaScript apps</p>
</blockquote>
<p>This is the position Redux has given itself, but there are many problems with it. First, what does Redux do? Looking at Redux&rsquo;s source code, <code>createStore</code> has only one function that returns 4 closures. The <code>dispatch</code> only does one thing, it calls the <code>reducer</code> and then the <code>listener</code> of the <code>subscribe</code>, where the <code>state</code> is immutable or mutable, all controlled by the user, and Redux doesn&rsquo;t know if the state has changed, let alone where it has changed. So, if the view layer needs to know which part needs to be updated, it can only do so by dirty checking.</p>
<p>Look at what <code>react-redux</code> does, it hangs a callback on store.subscribe, calls <code>connect</code> to pass in <code>mapStateToProps</code> and <code>mapDispatchToProps</code> every time a subscribe occurs, and then dirty checks every item in <code>props</code>. Of course, we could use the immutable data feature to reduce the number of props and thus reduce the number of dirty detections, but where is the nice thing to have props all coming from the same subtree?</p>
<p>So, if there are n components connected, every time an action is dispatched, no matter what granularity of update is done, O(n) time complexity of dirty detection will occur.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Redux 3.7.2 createStore.js
</span><span class="c1"></span>
<span class="c1">// ...
</span><span class="c1"></span>    <span class="k">try</span> <span class="p">{</span>
      <span class="nx">isDispatching</span> <span class="o">=</span> <span class="kc">true</span>
      <span class="nx">currentState</span> <span class="o">=</span> <span class="nx">currentReducer</span><span class="p">(</span><span class="nx">currentState</span><span class="p">,</span> <span class="nx">action</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">finally</span> <span class="p">{</span>
      <span class="nx">isDispatching</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">}</span>

    <span class="kr">const</span> <span class="nx">listeners</span> <span class="o">=</span> <span class="nx">currentListeners</span> <span class="o">=</span> <span class="nx">nextListeners</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">listeners</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">listener</span> <span class="o">=</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
      <span class="nx">listener</span><span class="p">()</span>
    <span class="p">}</span>
<span class="c1">// ...
</span></code></pre></td></tr></table>
</div>
</div><p>Worse still, each time the reducer is executed Redux calls the listener directly, and if multiple changes (e.g. user input) occur in a short period of time, the immutable overhead, combined with the overhead of redux matching actions with strings, the overhead of dirty detection, and the overhead of the view layer, the overall performance can be very bad, even when the user input The performance can be very bad, even when the user input is often updated with only one &ldquo;input&rdquo;. The larger the application, the worse the performance. (Here the application refers to a single page. The single page here does not mean a single page of SPA, because with Router, all components of the page that is cut away are unmounted)</p>
<p>As the size of the application increases, and the number of asynchronous requests increases, the <code>Predictable</code> advertised by Redux is simply a bubble, and more often than not, it is reduced to a data visualization tool with various tools.</p>
<h2 id="mobx">Mobx</h2>
<p>Mobx is arguably the most complete of many data solutions. mobx itself independent, not interdependent with any view layer framework, so you can choose the appropriate view layer framework at will (except for some, such as Vue, because they are the same principle).</p>
<p>Mobx (3.x) and Vue (2.x) currently use the same responsive principle, to borrow a diagram from the Vue documentation.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/21/0ffa5204d20e4b988e5e124ad79c34ff.png" alt=" "></p>
<p>Create a Watcher for each component, add hooks to the getter and setter of the data, trigger the getter when the component is rendered (e.g., call the render method), and then add the Watcher corresponding to this component to the dependency of the data associated with the getter (e.g., a Set). When the setter is triggered, it knows that the data has changed, and then the corresponding Watcher goes to redraw the component at the same time.</p>
<p>In this way, the data needed by each component is precisely known, so when the data changes, it is possible to know exactly which components need to be redrawn, and the process of redrawing when the data changes is O(1) time complex.</p>
<p>Note that in Mobx, the data needs to be declared as observable.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">observable</span><span class="p">,</span> <span class="nx">action</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;mobx&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Provider</span><span class="p">,</span> <span class="nx">observer</span><span class="p">,</span> <span class="nx">inject</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;mobx-react&#39;</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">CounterModel</span> <span class="p">{</span>  
    <span class="err">@</span><span class="nx">observable</span>
    <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="err">@</span><span class="nx">action</span>
    <span class="nx">increase</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CounterModel</span><span class="p">();</span>

<span class="err">@</span><span class="nx">inject</span><span class="p">(</span><span class="s1">&#39;counter&#39;</span><span class="p">)</span> <span class="err">@</span><span class="nx">observer</span>
<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">count</span><span class="p">,</span> <span class="nx">increase</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">counter</span><span class="p">;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">increase</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">increase</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>  
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">counter</span><span class="o">=</span><span class="p">{</span><span class="nx">counter</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/Provider&gt;</span>
<span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="performance">Performance</h2>
<p>In this <a href="https://hackernoon.com/an-artificial-example-where-mobx-really-shines-and-redux-is-not-really-suited-for-it-1a58313c0c70">article</a> , the authors use a 128*128 drawing board to illustrate the problem. Since Mobx uses <code>getter</code> and <code>setter</code> (a parallel <code>Proxy</code>-based version may appear in the future) to collect the data dependencies of component instances, every time a point is updated, <code>Mobx</code> knows which components need to be updated and the time complexity of the process of deciding which component to update is O(1), while <code>Redux</code> gets which components need to be updated by dirty checking each <code>connect</code> component, and with n components <code>connect</code> the time complexity of this process is O(n), which is ultimately reflected in the execution time of JavaScript in the Perf tool.</p>
<p>Although, after a series of optimizations, the Redux version can get a performance that does not lose the Mobx version, when Mobx can get a good performance without any optimization. The most perfect optimization of Redux is to create a separate store for each point, which is the same idea as a bunch of solutions like Mobx that pinpoint data dependencies.</p>
<h2 id="mobx-state-tree">Mobx State Tree</h2>
<p>Mobx is not perfect; Mobx does not require the data to be in a tree, so it is not easy to make Mobx data cubic or record every data change. Based on Mobx, the Mobx State Tree was born. Like Redux, the Mobx State Tree requires data to be in a tree, making it easy to visualize and track data, which is a boon for developers. The Mobx State Tree also makes it very easy to get accurate TypeScript type definitions, which is not easy to do with Redux. Runtime type safety checks are also provided.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="nx">ReactDOM</span> <span class="nx">from</span> <span class="s1">&#39;react-dom&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">types</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;mobx-state-tree&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">Provider</span><span class="p">,</span> <span class="nx">observer</span><span class="p">,</span> <span class="nx">inject</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;mobx-react&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">CountModel</span> <span class="o">=</span> <span class="nx">types</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s1">&#39;CountModel&#39;</span><span class="p">,</span> <span class="p">{</span>  
    <span class="nx">count</span><span class="o">:</span> <span class="nx">types</span><span class="p">.</span><span class="nx">number</span>
<span class="p">}).</span><span class="nx">actions</span><span class="p">(</span><span class="nx">self</span> <span class="p">=&gt;</span> <span class="p">({</span>
    <span class="nx">increase</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">self</span><span class="p">.</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}));</span>

<span class="kr">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">CountModel</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>  
    <span class="nx">count</span><span class="o">:</span> <span class="mi">0</span>
<span class="p">});</span>

<span class="err">@</span><span class="nx">inject</span><span class="p">(({</span> <span class="nx">store</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">({</span> <span class="nx">count</span><span class="o">:</span> <span class="nx">store</span><span class="p">.</span><span class="nx">count</span><span class="p">,</span> <span class="nx">increase</span><span class="o">:</span> <span class="nx">store</span><span class="p">.</span><span class="nx">increase</span> <span class="p">}))</span>
<span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">count</span><span class="p">,</span> <span class="nx">increase</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">count</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">increase</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">increase</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>  
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="err">/Provider&gt;</span>
<span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>Mobx State Tree also provides the <code>snapshot</code> function, so that although the MST data itself is variable, it can still hit the effect of immutable data. Officially, you can use <code>snaptshot</code> directly in conjunction with Redux development tools to facilitate development, and you can also use the MST data as a Redux store; of course, you can also use snapshot to embed the MST in a Redux store as data (similar to what is popular in Redux Immutable.js).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Development tools for connecting to Redux
</span><span class="c1">// ...
</span><span class="c1"></span><span class="nx">connectReduxDevtools</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s2">&#34;remotedev&#34;</span><span class="p">),</span> <span class="nx">store</span><span class="p">);</span>  
<span class="c1">// ...
</span><span class="c1"></span>
<span class="c1">// Used directly as a Redux store
</span><span class="c1">// ...
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">Provider</span><span class="p">,</span> <span class="nx">connect</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-redux&#39;</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">asReduxStore</span><span class="p">(</span><span class="nx">store</span><span class="p">);</span>

<span class="err">@</span><span class="nx">connect</span><span class="p">(</span><span class="c1">// ...)
</span><span class="c1"></span><span class="kd">function</span> <span class="nx">SomeComponent</span><span class="p">()</span> <span class="p">{</span>  
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">span</span><span class="o">&gt;</span><span class="nx">Some</span> <span class="nx">Component</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
<span class="p">}</span>

<span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span>  
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="nx">store</span><span class="o">=</span><span class="p">{</span><span class="nx">store</span><span class="p">}</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">App</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="nx">Provider</span> <span class="o">/&gt;</span><span class="p">,</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">// ...
</span></code></pre></td></tr></table>
</div>
</div><p>And, in MST, variable data and immutable data (snapshot) can be transformed into each other, and you can apply snapshot to data at any time.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">applySnapshot</span><span class="p">(</span><span class="nx">counter</span><span class="p">,</span> <span class="p">{</span>  
    <span class="nx">count</span><span class="o">:</span> <span class="mi">12345</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>In addition, official support for asynchronous actions is also provided. Due to the limitations of JavaScript, asynchronous actions are difficult to track, and even if an async function is used, it cannot be tracked during execution. Previously, asynchronous actions could only be accomplished by combining multiple actions, but Vue does so by separating the action and the mutation. The Mobx State Tree makes use of the Generator so that asynchronous actions can be done within a single action function and can be tracked.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// ...
</span><span class="c1"></span>
<span class="nx">SomeModel</span><span class="p">.</span><span class="nx">actions</span><span class="p">(</span><span class="nx">self</span> <span class="p">=&gt;</span> <span class="p">({</span>  
    <span class="nx">someAsyncAction</span><span class="o">:</span> <span class="nx">process</span><span class="p">(</span><span class="kd">function</span><span class="o">*</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">b</span> <span class="o">=</span> <span class="k">yield</span> <span class="nx">foo</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// foo must return a Promise
</span><span class="c1"></span>        <span class="nx">self</span><span class="p">.</span><span class="nx">bar</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
    <span class="p">})</span>
<span class="p">}));</span>

<span class="c1">// ...
</span></code></pre></td></tr></table>
</div>
</div><h2 id="summary">Summary</h2>
<p>Mobx uses <code>getter</code> and <code>setter</code> to collect data dependencies of components so that it knows exactly which components need to be redrawn when the data changes. When the interface gets large, there are often many fine-grained updates, and while responsive design has additional overhead, at large interface sizes this overhead is far smaller than doing dirty checks on each component. So in this case Mobx will easily get better performance than Redux. Dirty check-based implementations have better performance than Mobx responsive ones when all the data changes, but this is rare. Also, some benchmarks are not best practices, and their results do not reflect the real situation.</p>
<p>However, because <code>React</code> itself provides mechanisms to reduce useless rendering using immutable data structures (e.g. PureComponent, functional components), and because some of React&rsquo;s ecology is bound to Immutable (e.g. Draft.js), it is not so comfortable when working with variable observer pattern data structures. So, it is recommended to use Redux and Immutable.js with React until you encounter performance issues.</p>
<blockquote>
<p>The real problem is that programmers have spent far too much time worrying about efficiency in the wrong places and at the wrong times; premature optimization is the root of all evil (or at least most of it) in programming.</p>
</blockquote>
<h2 id="some-practices">Some practices</h2>
<p>Due to the limitations of JavaScript, some objects are not native objects and other type checking libraries may lead to unexpected results. For example, in Mobx, an array is not an Array, but an Array-like object, which is designed to listen for the assignment of data subscripts. In contrast, in Vue the array is an Array, but the array subscript assignment is done using <code>splice</code>, otherwise it is not detected.</p>
<p>Due to the principle of Mobx, to do accurate on-demand updates, you have to trigger the getter in the right place, and the easiest way to do that is to render the data to be used and only deconstruct it in render. <code>mobx-react</code> From 4.0 onwards, the structure in the map function accepted by <code>inject</code> is also tracked, so it can be written directly in a way similar to <code>react-redux</code>. Note that prior to 4.0 inject&rsquo;s map functions were not tracked.</p>
<p>Responsive has additional overhead that can have a performance impact when rendering large amounts of data (e.g., long lists), so use <code>observable.ref</code>, <code>observable.allow</code> (Mobx), and <code>types.frozen</code> (Mobx State Tree) in a sensible way.</p>
<hr>
<p>Reference <code>https://tech.youzan.com/mobx_vs_redux/</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/redux/">redux</a>
          <a href="/tags/mobx/">mobx</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-07/interaction-between-pages-window-postmessage-and-broadcastchannel-api/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Interaction Between Pages - window.postMessage and BroadcastChannel Api</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-07/common-ways-to-implement-animations-in-react/">
            <span class="next-text nav-default">Common Ways to Implement Animations in React</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
