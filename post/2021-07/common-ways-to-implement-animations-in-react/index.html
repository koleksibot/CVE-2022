<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Common Ways to Implement Animations in React - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Nowadays, users&#39; requirements for front-end pages are no longer satisfied with achieving functionality, but also with value and fun. In addition to the overall UI aesthetics, adding the right animation effect in the right place is often more expressive and natural than static pages. For example, a simple loading animation or page switching effect can not only relieve the user&amp;rsquo;s waiting emotion, but even silently achieve the effect of brand" /><meta name="keywords" content="React,Animations" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-07/common-ways-to-implement-animations-in-react/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Common Ways to Implement Animations in React" />
<meta property="og:description" content="Nowadays, users&#39; requirements for front-end pages are no longer satisfied with achieving functionality, but also with value and fun. In addition to the overall UI aesthetics, adding the right animation effect in the right place is often more expressive and natural than static pages. For example, a simple loading animation or page switching effect can not only relieve the user&rsquo;s waiting emotion, but even silently achieve the effect of brand" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-07/common-ways-to-implement-animations-in-react/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-07-20T10:02:20+08:00" />
<meta property="article:modified_time" content="2021-07-20T10:02:20+08:00" />

<meta itemprop="name" content="Common Ways to Implement Animations in React">
<meta itemprop="description" content="Nowadays, users&#39; requirements for front-end pages are no longer satisfied with achieving functionality, but also with value and fun. In addition to the overall UI aesthetics, adding the right animation effect in the right place is often more expressive and natural than static pages. For example, a simple loading animation or page switching effect can not only relieve the user&rsquo;s waiting emotion, but even silently achieve the effect of brand"><meta itemprop="datePublished" content="2021-07-20T10:02:20+08:00" />
<meta itemprop="dateModified" content="2021-07-20T10:02:20+08:00" />
<meta itemprop="wordCount" content="3705">
<meta itemprop="keywords" content="react," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Common Ways to Implement Animations in React"/>
<meta name="twitter:description" content="Nowadays, users&#39; requirements for front-end pages are no longer satisfied with achieving functionality, but also with value and fun. In addition to the overall UI aesthetics, adding the right animation effect in the right place is often more expressive and natural than static pages. For example, a simple loading animation or page switching effect can not only relieve the user&rsquo;s waiting emotion, but even silently achieve the effect of brand"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Common Ways to Implement Animations in React</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-07-20 10:02:20 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/frontend/"> frontend </a>
            </div>
          <span class="more-meta"> 3705 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-timer-or-raf-based-interval-animation">1. Timer or RAF based interval animation</a>
          <ul>
            <li><a href="#demo">Demo</a></li>
          </ul>
        </li>
        <li><a href="#2-simple-animation-based-on-css3">2. Simple animation based on css3</a>
          <ul>
            <li><a href="#demo-1">Demo</a></li>
          </ul>
        </li>
        <li><a href="#react-animation-plugin-csstransitiongroup">React animation plugin <code>CssTransitionGroup</code></a>
          <ul>
            <li><a href="#demo-2">Demo</a></li>
          </ul>
        </li>
        <li><a href="#4-implementing-complex-animations-in-combination-with-hooks">4. Implementing complex animations in combination with hooks</a>
          <ul>
            <li><a href="#demo-3">Demo</a></li>
          </ul>
        </li>
        <li><a href="#5-other-third-party-animation-libraries">5. Other third-party animation libraries</a>
          <ul>
            <li><a href="#51-animated">5.1 Animated</a></li>
          </ul>
        </li>
        <li><a href="#6-summary">6. Summary</a></li>
        <li><a href="#7-reference">7. Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Nowadays, users' requirements for front-end pages are no longer satisfied with achieving functionality, but also with value and fun. In addition to the overall UI aesthetics, adding the right animation effect in the right place is often more expressive and natural than static pages. For example, a simple loading animation or page switching effect can not only relieve the user&rsquo;s waiting emotion, but even silently achieve the effect of brand promotion by using the brand logo and other forms.</p>
<p>React, a popular front-end development framework in recent years, proposes the concept of virtual DOM, in which all DOM changes occur on the virtual DOM first, and then analyze the actual changes of the web page through DOM diff and reflect them on the real DOM, thus greatly improving the web page performance. However, in terms of animation implementation, React as a framework does not directly provide animation effects to the components, and developers need to implement them themselves, while most traditional web animations are implemented by directly manipulating the actual DOM elements, which is obviously not advocated in React. So, how are animations implemented in React?</p>
<p>The essence of all animations is to continuously modify one or more properties of a DOM element to produce a coherent change, thus creating an animation. Animations in React are essentially the same as traditional web animations, but in two ways: through css3 animations and through js modifications to element properties. However, the implementation is more in line with the framework of React, and can be summarized in several categories</p>
<ol>
<li>interval animation based on timer or requestAnimationFrame(RAF).</li>
<li>simple animations based on css3.</li>
<li>the React animation plugin <code>CssTransitionGroup</code>.</li>
<li>complex animations combined with hooks.</li>
<li>other third-party animation libraries.</li>
</ol>
<h2 id="1-timer-or-raf-based-interval-animation">1. Timer or RAF based interval animation</h2>
<p>In the beginning, animations were implemented by relying on timers <code>setInterval</code>, <code>setTimeout</code> or <code>requestAnimationFrame</code> (RAF) to directly modify the properties of DOM elements. Developers unfamiliar with React features may habitually get the real DOM node via <code>ref</code> or <code>findDOMNode()</code> and modify its style directly. However, fetching and manipulating the real DOM directly via <code>ref</code> is not recommended and should be avoided at all costs.</p>
<p>Therefore, we need to link methods such as timers or RAFs to DOM node properties via <code>state</code>. First, we need to extract the properties related to the changing style, replace them with <code>state</code>, and then add a timer or <code>requestAnimationFrame</code> to the appropriate lifecycle function to keep modifying <code>state</code> and trigger the component update to achieve the animation effect.</p>
<h3 id="demo">Demo</h3>
<p>Take a progress bar as an example, the code is shown below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Change `state` using `requestAnimationFrame`
</span><span class="c1"></span><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Progress</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">percent</span><span class="o">:</span> <span class="mi">10</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">increase</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">percent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">percent</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">targetPercent</span> <span class="o">=</span> <span class="nx">percent</span> <span class="o">&gt;=</span> <span class="mi">90</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="nx">percent</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">speed</span> <span class="o">=</span> <span class="p">(</span><span class="nx">targetPercent</span> <span class="o">-</span> <span class="nx">percent</span><span class="p">)</span> <span class="o">/</span> <span class="mi">400</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">start</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">animate</span> <span class="o">=</span> <span class="nx">timestamp</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">start</span><span class="p">)</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>
            <span class="kr">const</span> <span class="nx">progress</span> <span class="o">=</span> <span class="nx">timestamp</span> <span class="o">-</span> <span class="nx">start</span><span class="p">;</span>
            <span class="kr">const</span> <span class="nx">currentProgress</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">speed</span> <span class="o">*</span> <span class="nx">progress</span> <span class="o">+</span> <span class="nx">percent</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nx">targetPercent</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
                <span class="nx">percent</span><span class="o">:</span> <span class="nx">currentProgress</span>
            <span class="p">});</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">currentProgress</span> <span class="o">&lt;</span> <span class="nx">targetPercent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">decrease</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">percent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">percent</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">targetPercent</span> <span class="o">=</span> <span class="nx">percent</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">percent</span> <span class="o">-</span> <span class="mi">10</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">speed</span> <span class="o">=</span> <span class="p">(</span><span class="nx">percent</span> <span class="o">-</span> <span class="nx">targetPercent</span><span class="p">)</span> <span class="o">/</span> <span class="mi">400</span><span class="p">;</span>
        <span class="kd">let</span> <span class="nx">start</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="kr">const</span> <span class="nx">animate</span> <span class="o">=</span> <span class="nx">timestamp</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">start</span><span class="p">)</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">timestamp</span><span class="p">;</span>
            <span class="kr">const</span> <span class="nx">progress</span> <span class="o">=</span> <span class="nx">timestamp</span> <span class="o">-</span> <span class="nx">start</span><span class="p">;</span>
            <span class="kr">const</span> <span class="nx">currentProgress</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">percent</span> <span class="o">-</span> <span class="nx">speed</span> <span class="o">*</span> <span class="nx">progress</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nx">targetPercent</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
                    <span class="nx">percent</span><span class="o">:</span> <span class="nx">currentProgress</span>
                <span class="p">});</span>
            <span class="k">if</span> <span class="p">(</span><span class="nx">currentProgress</span> <span class="o">&gt;</span> <span class="nx">targetPercent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nb">window</span><span class="p">.</span><span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">};</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">requestAnimationFrame</span><span class="p">(</span><span class="nx">animate</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">percent</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;progress&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;progress-wrapper&#34;</span> <span class="o">&gt;</span>
                        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;progress-inner&#34;</span> <span class="nx">style</span> <span class="o">=</span> <span class="p">{{</span><span class="nx">width</span><span class="o">:</span> <span class="sb">`</span><span class="si">${</span><span class="nx">percent</span><span class="si">}</span><span class="sb">%`</span><span class="p">}}</span> <span class="o">&gt;&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;progress-info&#34;</span> <span class="o">&gt;</span><span class="p">{</span><span class="nx">percent</span><span class="p">}</span><span class="o">%&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;btns&#34;</span><span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">decrease</span><span class="p">}</span><span class="o">&gt;-&lt;</span><span class="err">/button&gt;</span>
                    <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">increase</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In the example, we build the linear transition function <code>animation</code> in the <code>increase</code> and <code>decrease</code> functions, and <code>requestAnimationFrame</code> executes the transition function before each browser redraw, calculating the current progress bar <code>width</code> property and updating that <code>state</code> to make the progress bar re rendered again. The effect of this example is shown below.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/7f3fc66bd1b54df180f38ce3db2fc4ee.gif" alt=" "></p>
<p>This implementation has good performance when using <code>requestAnimationFrame</code>, is fully implemented in pure js, does not depend on css, and may cause frame drops and lag when using the timer. In addition, it requires the developer to calculate the state based on the speed function itself, which is more complicated.</p>
<h2 id="2-simple-animation-based-on-css3">2. Simple animation based on css3</h2>
<p>When <code>animation</code> and <code>transition</code> in css3 became available and widespread, we could easily use css to implement changes in element styles without having to calculate real-time styles artificially.</p>
<h3 id="demo-1">Demo</h3>
<p>We still take the above progress bar as an example and use css3 to implement the dynamic effect of the progress bar, the code is shown below.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Progress</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">percent</span><span class="o">:</span> <span class="mi">10</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">increase</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">percent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">percent</span> <span class="o">+</span> <span class="mi">10</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="nx">percent</span><span class="o">:</span> <span class="nx">percent</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="o">?</span> <span class="mi">100</span> <span class="o">:</span> <span class="nx">percent</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">decrease</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">percent</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">percent</span> <span class="o">-</span> <span class="mi">10</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="nx">percent</span><span class="o">:</span> <span class="nx">percent</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="nx">percent</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Same as above, omitted
</span><span class="c1"></span>        <span class="p">....</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="p">.</span><span class="nx">progress</span><span class="o">-</span><span class="nx">inner</span> <span class="p">{</span>
  <span class="nx">transition</span><span class="o">:</span> <span class="nx">width</span> <span class="mi">400</span><span class="nx">ms</span> <span class="nx">cubic</span><span class="o">-</span><span class="nx">bezier</span><span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.82</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="c1">// Other styles as above, omitted
</span><span class="c1"></span>  <span class="p">...</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In the example, the <code>increase</code> and <code>decrease</code> functions no longer calculate <code>width</code>, but directly set the width after the increase or decrease. Note that the <code>transition</code> property is set in the css style to automatically achieve a dynamic change in the style when the width property changes, and to set the speed curve for different speed effects. The effect of the example is shown below. It can be found that, unlike the previous example, the progress data on the right side is directly changed to the target number without a specific change process, while the dynamic effect of the progress bar is more vivid because it is no longer a linear change.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/893a104259e7453ba93ce5622e2f9e6d.gif" alt=" "></p>
<p>The css3-based implementation has higher performance and less code, but it only relies on css effects and is difficult to implement for complex animations. In addition, animating effects by modifying <code>state</code> can only work on nodes that already exist in the DOM tree. If you want to add entry and exit animations to a component in this way, you need to maintain at least two <code>states</code> to implement entry and exit animations, one <code>state</code> to control whether the element is displayed or not, and another <code>state</code> to control the properties of the element as it changes during the animation. In this case, the developer needs to spend a lot of effort to maintain the animation logic of the component, which is very complicated and tedious.</p>
<h2 id="react-animation-plugin-csstransitiongroup">React animation plugin <code>CssTransitionGroup</code></h2>
<p>React has provided developers with an animation plugin <a href="https://reactjs.org/docs/animation.html">react-addons-css-transition-group</a>, which was later maintained by the community and became the current <a href="https://github.com/reactjs/react-transition-group/tree/v1-stable">react-transition-group</a>, which can easily implement the entrance and exit animations of components, but requires additional installation. <code>react-transition-group</code> contains <code>CSSTransitionGroup</code> and <code>TransitionGroup</code>, the latter is the underlying api, the former is a further encapsulation of the latter, which can be used to implement css animations more easily.</p>
<h3 id="demo-2">Demo</h3>
<p>As an example of a dynamically increasing tab, the code is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">CSSTransitionGroup</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-transition-group&#39;</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">uid</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>  
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Tabs</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">activeId</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">tabData</span><span class="o">:</span> <span class="p">[{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nx">panel</span><span class="o">:</span> <span class="s1">&#39;Option 1&#39;</span>
            <span class="p">},</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="nx">panel</span><span class="o">:</span> <span class="s1">&#39;Option 2&#39;</span>
            <span class="p">}]</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">addTab</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// Add tab code
</span><span class="c1"></span>        <span class="p">...</span>
    <span class="p">}</span>

    <span class="nx">deleteTab</span> <span class="o">=</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// Delete tab code
</span><span class="c1"></span>        <span class="p">...</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">tabData</span><span class="p">,</span> <span class="nx">activeId</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

        <span class="kr">const</span> <span class="nx">renderTabs</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">tabData</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="o">&lt;</span><span class="nx">div</span>
                        <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="sb">`tab-item</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">activeId</span> <span class="o">?</span> <span class="s1">&#39; tab-item-active&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
                        <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="sb">`tab</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span>
                    <span class="o">&gt;</span>
                        <span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">panel</span><span class="p">}</span>
                        <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;btns btn-delete&#34;</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">deleteTab</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">)}</span><span class="o">&gt;</span><span class="err">✕</span><span class="o">&lt;</span><span class="err">/span&gt;</span>
                    <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="p">);</span>
            <span class="p">})</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;tabs&#34;</span> <span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">CSSTransitionGroup</span>
                      <span class="nx">transitionName</span><span class="o">=</span><span class="s2">&#34;tabs-wrap&#34;</span>
                      <span class="nx">transitionEnterTimeout</span><span class="o">=</span><span class="p">{</span><span class="mi">500</span><span class="p">}</span>
                      <span class="nx">transitionLeaveTimeout</span><span class="o">=</span><span class="p">{</span><span class="mi">500</span><span class="p">}</span>
                    <span class="o">&gt;</span>
                      <span class="p">{</span><span class="nx">renderTabs</span><span class="p">()}</span>
                    <span class="o">&lt;</span><span class="err">/CSSTransitionGroup&gt;</span>
                    <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;btns btn-add&#34;</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">addTab</span><span class="p">}</span><span class="o">&gt;+&lt;</span><span class="err">/span&gt;</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
                <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;tab-cont&#34;</span><span class="o">&gt;</span>
                    <span class="nx">cont</span>
                <span class="o">&lt;</span><span class="err">/div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="c">/* tab dynamic increase animation */</span>
<span class="p">.</span><span class="nc">tabs-wrap-enter</span> <span class="p">{</span>
  <span class="k">opacity</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">tabs-wrap-enter</span><span class="p">.</span><span class="nc">tabs-wrap-enter-active</span> <span class="p">{</span>
  <span class="k">opacity</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">transition</span><span class="p">:</span> <span class="kc">all</span> <span class="mi">500</span><span class="kt">ms</span> <span class="kc">ease-in</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">tabs-wrap-leave</span> <span class="p">{</span>
  <span class="k">opacity</span><span class="p">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">tabs-wrap-leave</span><span class="p">.</span><span class="nc">tabs-wrap-leave-active</span> <span class="p">{</span>
  <span class="k">opacity</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">;</span>
  <span class="k">transition</span><span class="p">:</span> <span class="kc">all</span> <span class="mi">500</span><span class="kt">ms</span> <span class="kc">ease-in</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The <code>CSSTransitionGroup</code> can add additional css classes to its child nodes, and then animate them with css animations for entry and exit. To animate each tab node, you need to wrap them in the <code>CSSTransitionGroup</code> component first. After setting the <code>transitionName</code> property to <code>'tabs-wrapper'</code> and the <code>transitionEnterTimeout</code> to 400 milliseconds, once a new node is added to the <code>CSSTransitionGroup</code>, the new node will be added with the css class <code>'tabs- wrapper-enter'</code> and then the css class <code>'tabs-wrapper-enter-active'</code> is added on the next frame. After 400 milliseconds the css classes <code>'tabs-wrapper-enter'</code> and <code>'tabs-wrapper-enter-active'</code> will be removed simultaneously and the node completes the entire entry animation process. The implementation of the leave animation is similar to the enter animation, except that the added css classes are named <code>'tabs-wrapper-leave'</code> and <code>'tabs-wrapper-leave-active'</code>. The sample effect is shown in the following image.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/99a5a2787fb34f44a72031534d79b947.gif" alt=" "></p>
<p>The <code>CSSTransitionGroup</code> supports the following 7 properties.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/2755c0c4f24345299307b12b2661be8d.png" alt=" "></p>
<p>The entry and exit animations are enabled by default, and <code>transitionEnterTimeout</code> and <code>transitionLeaveTimeout</code> need to be set. It is worth noting that <code>CSSTransitionGroup</code> also provides an appearance animation (appear), which needs to be set to <code>transitionAppearTimeout</code>. So, what is the difference between the appear animation and the enter animation? When <code>transitionAppear</code> is set to <code>true</code>, the <code>CSSTransitionGroup</code> adds an appearance phase to the <strong>first rendering</strong>. During this phase, all existing children of <code>CSSTransitionGroup</code> are added to the css classes <code>'tabs-wrapper-appear'</code> and <code>'tabs-wrapper-appear-active'</code> one after the other to achieve the appearance animation effect. Therefore, <strong>appear animations only apply to the children of a <code>CSSTransitionGroup</code> that exist at initial rendering</strong>, and once the <code>CSSTransitionGroup</code> finishes rendering, its children can only have an enter animation, not an appear animation.</p>
<p>In addition, the following points need to be noted when using <code>CSSTransitionGroup</code>.</p>
<ul>
<li><code>CSSTransitionGroup</code> generates a <code>span</code> tag to wrap its children in the DOM tree by default; if you want to use other html tags, you can set the <code>component</code> attribute of <code>CSSTransitionGroup</code>.</li>
<li>The child elements of <code>CSSTransitionGroup</code> must have a <code>key</code> value added to them in order to accurately calculate which nodes need to add entry animations and which nodes need to add exit animations when the nodes change.</li>
<li>the animation effect of <code>CSSTransitionGroup</code> only works on the direct child nodes, not on their grandchildren.</li>
<li>The end time of the animation is not based on the transition-duration in css, but on <code>transitionEnterTimeout</code>, <code>transitionLeaveTimeout</code>, <code>TransitionAppearTimeout</code>, because in some cases transitionend events are not triggered, see <a href="https://developer.mozilla.org/en-US/docs/Web/Events/transitionend">MDN transitionend</a> for details.</li>
</ul>
<p>The advantages of implementing animations with <code>CSSTransitionGroup</code> are.</p>
<ul>
<li>simplicity and ease of use, allowing for easy and fast element entry and exit animations.</li>
<li>Better performance in combination with React.</li>
</ul>
<p>The disadvantages of <code>CSSTransitionGroup</code> are also obvious.</p>
<ul>
<li>Limited to appearance animations, entry animations and exit animations.</li>
<li>Not flexible enough due to the need for a <code>transitionName</code>.</li>
<li>Can only rely on css for simple animations.</li>
</ul>
<h2 id="4-implementing-complex-animations-in-combination-with-hooks">4. Implementing complex animations in combination with hooks</h2>
<p>In real projects, you may need some cooler animation effects, which are often difficult to achieve by relying on css3 alone. In this case, we may want to use some mature third-party libraries, such as jQuery or GASP, combined with the hook function of the lifecycle hook method in the React component, to achieve complex animations. In addition to the normal lifecycle of a React component, the underlying api <code>TransitonGroup</code> also provides a series of special lifecycle hook functions for its child elements, which can be combined with third-party animation libraries to achieve rich entrance and exit animations.</p>
<p><code>TransitonGroup</code> provides the following six lifecycle hook functions respectively.</p>
<ul>
<li>componentWillAppear(callback)</li>
<li>componentDidAppear()</li>
<li>componentWillEnter(callback)</li>
<li>componentDidEnter()</li>
<li>componentWillLeave(callback)</li>
<li>componentDidLeave()</li>
</ul>
<p>They are triggered with the timing shown in the figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/9b5b4025559c474886f802f199b35e9d.png" alt=" "></p>
<h3 id="demo-3">Demo</h3>
<p><a href="https://greensock.com/gsap">GASP</a> is a flash-era animation library that has evolved since then, drawing on the concept of video frames, and is particularly well suited for long sequence animation effects. In this article, we use <code>TransitonGroup</code> and <a href="https://github.com/azazdeaz/react-gsap-enhancer"> <code>react-gsap-enhancer</code></a> (an enhancement library that can apply GSAP to React) to complete an image gallery with the following code as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span><span class="lnt">94
</span><span class="lnt">95
</span><span class="lnt">96
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">TransitionGroup</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-transition-group&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="nx">GSAP</span> <span class="nx">from</span> <span class="s1">&#39;react-gsap-enhancer&#39;</span>  
<span class="kr">import</span> <span class="p">{</span> <span class="nx">TimelineMax</span><span class="p">,</span> <span class="nx">Back</span><span class="p">,</span> <span class="nx">Sine</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;gsap&#39;</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">Photo</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">componentWillEnter</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addAnimation</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">enterAnim</span><span class="p">,</span> <span class="p">{</span><span class="nx">callback</span><span class="o">:</span> <span class="nx">callback</span><span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">componentWillLeave</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">addAnimation</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">leaveAnim</span><span class="p">,</span> <span class="p">{</span><span class="nx">callback</span><span class="o">:</span> <span class="nx">callback</span><span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">enterAnim</span> <span class="o">=</span> <span class="p">(</span><span class="nx">utils</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">TimelineMax</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">from</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">x</span><span class="o">:</span> <span class="sb">`+=</span><span class="si">${</span><span class="p">(</span> <span class="mi">4</span> <span class="o">-</span> <span class="nx">id</span> <span class="p">)</span> <span class="o">*</span> <span class="mi">60</span><span class="si">}</span><span class="sb">px`</span><span class="p">,</span>
                <span class="nx">autoAlpha</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nx">onComplete</span><span class="o">:</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">callback</span><span class="p">,</span>
            <span class="p">},</span> <span class="nx">id</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">leaveAnim</span> <span class="o">=</span> <span class="p">(</span><span class="nx">utils</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">TimelineMax</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">to</span><span class="p">(</span><span class="nx">utils</span><span class="p">.</span><span class="nx">target</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">scale</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nx">ease</span><span class="o">:</span> <span class="nx">Sine</span><span class="p">.</span><span class="nx">easeOut</span><span class="p">,</span>
                <span class="nx">onComplete</span><span class="o">:</span> <span class="nx">utils</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">callback</span><span class="p">,</span>
            <span class="p">},</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="nx">id</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.7</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">url</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;photo&#34;</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="nx">url</span><span class="p">}</span> <span class="o">/&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">WrappedPhoto</span> <span class="o">=</span> <span class="nx">GSAP</span><span class="p">()(</span><span class="nx">Photo</span><span class="p">);</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">Gallery</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">show</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">photos</span><span class="o">:</span> <span class="p">[{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://img4.imgtn.bdimg.com/it/u=1032683424,3204785822&amp;fm=214&amp;gp=0.jpg&#39;</span>
            <span class="p">},</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://imgtu.5011.net/uploads/content/20170323/7488001490262119.jpg&#39;</span>
            <span class="p">},</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://tupian.enterdesk.com/2014/lxy/2014/12/03/18/10.jpg&#39;</span>
            <span class="p">},</span> <span class="p">{</span>
                <span class="nx">id</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://img4.imgtn.bdimg.com/it/u=360498760,1598118672&amp;fm=27&amp;gp=0.jpg&#39;</span>
            <span class="p">}]</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">toggle</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
            <span class="nx">show</span><span class="o">:</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">show</span>
        <span class="p">})</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">show</span><span class="p">,</span> <span class="nx">photos</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

        <span class="kr">const</span> <span class="nx">renderPhotos</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">photos</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">item</span><span class="p">,</span> <span class="nx">index</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
                <span class="k">return</span> <span class="o">&lt;</span><span class="nx">WrappedPhoto</span> <span class="nx">id</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span> <span class="nx">url</span><span class="o">=</span><span class="p">{</span><span class="nx">item</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="sb">`photo</span><span class="si">${</span><span class="nx">item</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">;</span>
            <span class="p">})</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggle</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">toggle</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">TransitionGroup</span> <span class="nx">component</span><span class="o">=</span><span class="s2">&#34;div&#34;</span><span class="o">&gt;</span>
                    <span class="p">{</span><span class="nx">show</span> <span class="o">&amp;&amp;</span> <span class="nx">renderPhotos</span><span class="p">()}</span>
                <span class="o">&lt;</span><span class="err">/TransitionGroup&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In this example, we have added an entry animation <code>enterAnim</code> and an exit animation <code>LeaveAnim</code> to each subcomponent in the <code>componentWillEnter</code> and <code>componentWillLeave</code> hook functions of the subcomponent <code>Photo</code>. In the enter animation, we use <code>TimeLineMax.from(target, duration, vars, delay)</code> to create the timeline animation, specifying that the animation distance of each subcomponent decreases as <code>id</code> increases, the delay time increases as <code>id</code> increases, and the delay time of each subcomponent in the leave animation decreases as <code>id</code> increases. so that the animation effect is different according to the component <code>id</code>. In practice, you can add different effects to any subcomponent according to your needs. The effect of this example is shown in the following figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/73a939ba428e4976bad7f8011cee9fa2.gif" alt=" "></p>
<p>When using <code>TransitionGroup</code>, always <strong>call <code>callback</code> in the <code>componentnWillAppear(callback)</code> , <code>componentnWillEntercallback)</code> , <code>componentnWillLeave(callback)</code> functions after the <code>callback</code> at the end of the logic to ensure that the <code>TransitionGroup</code> correctly maintains the state sequence of the child nodes</strong>. For more details on the use of GASP, please refer to the <a href="https://greensock.com/gsap">official GASP documentation</a> and the blog post <a href="http://acgtofe.com/posts/2016/05/gsap-for-animation-pro">GSAP, the professional Web animation library</a> This article will not go into detail.</p>
<p>Combined with hook to implement animation can support a variety of complex animation, such as time series animation, etc., because of the reliance on third-party libraries, the animation effect is often more smooth, user experience is better. However, the introduction of third-party libraries requires developers to learn the corresponding api, which also improves the code complexity.</p>
<h2 id="5-other-third-party-animation-libraries">5. Other third-party animation libraries</h2>
<p>In addition, there are many excellent third-party animation libraries, such as react-motion, Animated, velocity-react, etc., and each of these animation libraries is unique in its use.</p>
<h3 id="51-animated">5.1 Animated</h3>
<p><a href="https://github.com/animatedjs/animated">Animated</a> is a cross-platform animation library, compatible with React and React Native. Since during animation we only care about the initial state, end state and change function of the animation, and not the specific values of the element properties at each moment, Animated uses declarative animation, which computes the css object and passes in <code>Animated.div</code> to achieve the animation effect. So Animated uses declarative animation, which computes css objects by the specific methods it provides and passes in <code>Animated.div</code> to achieve the animation effect.</p>
<h4 id="demo-4">Demo</h4>
<p>We use Animated to implement an image flip effect with the following code.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="nx">React</span><span class="p">,</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>  
<span class="kr">import</span> <span class="nx">Animated</span> <span class="nx">from</span> <span class="s1">&#39;animated/lib/targets/react-dom&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">PhotoPreview</span> <span class="kr">extends</span> <span class="nx">Component</span> <span class="p">{</span>  
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nx">anim</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Animated</span><span class="p">.</span><span class="nx">Value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="nx">handleClick</span> <span class="o">=</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">anim</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
        <span class="nx">anim</span><span class="p">.</span><span class="nx">stopAnimation</span><span class="p">(</span><span class="nx">value</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="nx">Animated</span><span class="p">.</span><span class="nx">spring</span><span class="p">(</span><span class="nx">anim</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">toValue</span><span class="o">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="p">}).</span><span class="nx">start</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="p">{</span> <span class="nx">anim</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>

        <span class="kr">const</span> <span class="nx">rotateDegree</span> <span class="o">=</span> <span class="nx">anim</span><span class="p">.</span><span class="nx">interpolate</span><span class="p">({</span>
            <span class="nx">inputRange</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="nx">outputRange</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;0deg&#39;</span><span class="p">,</span> <span class="s1">&#39;360deg&#39;</span><span class="p">]</span>
        <span class="p">});</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">向右翻转</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
                <span class="o">&lt;</span><span class="nx">Animated</span><span class="p">.</span><span class="nx">div</span>
                    <span class="nx">style</span><span class="o">=</span><span class="p">{{</span>
                        <span class="nx">transform</span><span class="o">:</span> <span class="p">[{</span>
                            <span class="nx">rotate</span><span class="o">:</span> <span class="nx">rotateDegree</span>
                        <span class="p">}]</span>
                    <span class="p">}}</span>
                    <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;preivew-wrapper&#34;</span>
                <span class="o">&gt;</span>
                    <span class="o">&lt;</span><span class="nx">img</span>
                        <span class="nx">alt</span><span class="o">=</span><span class="s2">&#34;img&#34;</span>
                        <span class="nx">src</span><span class="o">=</span><span class="s2">&#34;http://img4.imgtn.bdimg.com/it/u=1032683424,3204785822&amp;fm=214&amp;gp=0.jpg&#34;</span>
                    <span class="o">/&gt;</span>
                <span class="o">&lt;</span><span class="err">/Animated.div&gt;</span>
            <span class="o">&lt;</span><span class="err">/div&gt;</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><p>In this example, we want to achieve a 90° rotation of the image to the right with each click of the button. When the component is initialized, a new <code>Animated</code> object is created with an initial value of 0, <code>this.state.anim</code>. The <code>Animated</code> object has an interpolate function <code>interpolate</code>. When the input range <code>inputRange</code> and the output range <code>outputRange</code> are set, the interpolate function can perform linear interpolation based on the current value of the <code>Animated</code> object and calculate the corresponding mapped value.</p>
<p>In this example, we assume that the value of <code>this.state.anim</code> is increased by 1 for each click on the button, and the image needs to be rotated by 90°. In the render function, we set the interpolation function <code>this.state.anim.interpolate</code> to have an input interval of [0, 4] and an output interval of [&lsquo;0deg&rsquo;, &lsquo;360deg&rsquo;]. When the animation is executed, the value of <code>this.state.anim</code> changes and the interpolation function calculates the rotation angle <code>rotateDegree</code> based on the current value of <code>this.state.anim</code>, which triggers the re-rendering of the component. Therefore, if the current value of <code>Animated</code> is 2, the corresponding rotation angle is 180deg. In the component rendering structure, you need to use <code>Animated.div</code> to wrap the animation node, and encapsulate <code>rotateDegree</code> as a css object and pass it into <code>Animated.div</code> as stlye to realize the change of the node&rsquo;s css attribute of the node.</p>
<p>In the click event, considering that the button may be clicked several times in a row, we first use <code>stopAnimation</code> to stop the current animation, which returns a {value : number} object in the callback function, with the value corresponding to the last moment of the animation property value. Based on the obtained <code>value</code> value, the <code>Animated.spring</code> function is then used to start a new spring animation process, resulting in a smooth animation effect. Since we want the flip angle to be an integer multiple of 90° each time the rotation stops, we need to round the termination value of <code>Animated.spring</code>. We end up with the following effect:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/20/30cc5366b1ae4bb2877f13e30046a17a.gif" alt=" "></p>
<p>The following points need to be noted when using it.</p>
<ul>
<li>The value of the <code>Animated</code> object and its interpolation result can only be applied to the <code>Animated.div</code> node.</li>
<li><code>interpolate</code> will linearly interpolate based on the input interval and output interval by default, if the input value is outside the input interval it will not be affected, the interpolation result will be interpolated outward based on the output interval by default, you can limit the interpolation result interval by setting the <code>extrapolate</code> property.</li>
</ul>
<p>Animated does not directly modify the component <code>state</code> during animation, but directly modifies the element&rsquo;s properties through its new object&rsquo;s components and methods, without repeatedly triggering the render function.</p>
<h2 id="6-summary">6. Summary</h2>
<p>When implementing animations in React, the first thing to consider is the ease of the animation and the usage scenario. For simple animations, css3 is preferred, followed by js-based interval animations. For element entry and exit animations, we recommend combining <code>CSSTransitionGroup</code> or <code>TransitionGroup</code>. When the animation effect to be achieved is more complex, try some good third-party libraries to open the door to wonderful dynamic effects.</p>
<p>Ps. All sample code in this article can be viewed at <a href="https://github.com/fairyaierl/react-animation-demos">github</a></p>
<h2 id="7-reference">7. Reference</h2>
<ul>
<li><a href="https://github.com/reactjs/react-transition-group/tree/v1-stable">react-transition-group</a></li>
<li><a href="http://azazdeaz.github.io/react-gsap-enhancer/#/demo/using-transition-group?_k=n0lcbb">react-gsap-enhancer</a></li>
<li><a href="https://css-tricks.com/comparison-animation-technologies/">A Comparison of Animation Technologies</a></li>
<li><a href="https://medium.com/react-native-training/react-animations-in-depth-433e2b3f0e8e">React Animations in Depth</a></li>
</ul>
<hr>
<p>Reference <code>https://tech.youzan.com/react-animations/</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/react/">react</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-07/why-i-migrated-from-redux-to-mobx/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Why I Migrated From Redux to Mobx</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-07/simple-usage-of-colly/">
            <span class="next-text nav-default">Simple Usage of Colly</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
