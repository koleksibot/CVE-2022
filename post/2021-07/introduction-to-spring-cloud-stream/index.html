<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Introduction to Spring Cloud Stream - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Spring Cloud Stream is used within the Spring Cloud architecture to build highly scalable, event-driven microservices.
There is a lot of content in Spring Cloud Stream itself and it has many external dependencies. To get familiar with Spring Cloud Stream, you need to know the following.
 Spring Framework(Spring Messaging, Spring Environment) Spring Boot Actuator Spring Boot Externalized Configuration Spring Retry Spring Integration Spring Cloud Stream  The purpose of this article is to introduce Spring Cloud Stream, and with so much knowledge, we will try to take you through Spring Cloud Steam in the simplest way possible (we will replace Spring Cloud Stream with SCS later)." /><meta name="keywords" content="spring-cloud-stream,spring-cloud" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-07/introduction-to-spring-cloud-stream/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Introduction to Spring Cloud Stream" />
<meta property="og:description" content="Spring Cloud Stream is used within the Spring Cloud architecture to build highly scalable, event-driven microservices.
There is a lot of content in Spring Cloud Stream itself and it has many external dependencies. To get familiar with Spring Cloud Stream, you need to know the following.
 Spring Framework(Spring Messaging, Spring Environment) Spring Boot Actuator Spring Boot Externalized Configuration Spring Retry Spring Integration Spring Cloud Stream  The purpose of this article is to introduce Spring Cloud Stream, and with so much knowledge, we will try to take you through Spring Cloud Steam in the simplest way possible (we will replace Spring Cloud Stream with SCS later)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-07/introduction-to-spring-cloud-stream/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-07-01T11:27:20+08:00" />
<meta property="article:modified_time" content="2021-07-01T11:27:20+08:00" />

<meta itemprop="name" content="Introduction to Spring Cloud Stream">
<meta itemprop="description" content="Spring Cloud Stream is used within the Spring Cloud architecture to build highly scalable, event-driven microservices.
There is a lot of content in Spring Cloud Stream itself and it has many external dependencies. To get familiar with Spring Cloud Stream, you need to know the following.
 Spring Framework(Spring Messaging, Spring Environment) Spring Boot Actuator Spring Boot Externalized Configuration Spring Retry Spring Integration Spring Cloud Stream  The purpose of this article is to introduce Spring Cloud Stream, and with so much knowledge, we will try to take you through Spring Cloud Steam in the simplest way possible (we will replace Spring Cloud Stream with SCS later)."><meta itemprop="datePublished" content="2021-07-01T11:27:20+08:00" />
<meta itemprop="dateModified" content="2021-07-01T11:27:20+08:00" />
<meta itemprop="wordCount" content="1823">
<meta itemprop="keywords" content="spring-cloud,spring-cloud-stream," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to Spring Cloud Stream"/>
<meta name="twitter:description" content="Spring Cloud Stream is used within the Spring Cloud architecture to build highly scalable, event-driven microservices.
There is a lot of content in Spring Cloud Stream itself and it has many external dependencies. To get familiar with Spring Cloud Stream, you need to know the following.
 Spring Framework(Spring Messaging, Spring Environment) Spring Boot Actuator Spring Boot Externalized Configuration Spring Retry Spring Integration Spring Cloud Stream  The purpose of this article is to introduce Spring Cloud Stream, and with so much knowledge, we will try to take you through Spring Cloud Steam in the simplest way possible (we will replace Spring Cloud Stream with SCS later)."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Introduction to Spring Cloud Stream</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-07-01 11:27:20 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            <a href="/categories/implementation-details/"> implementation-details </a>
            <a href="/categories/microservices/"> microservices </a>
            </div>
          <span class="more-meta"> 1823 words </span>
          <span class="more-meta"> 9 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#spring-messaging">Spring Messaging</a></li>
        <li><a href="#spring-integration">Spring Integration</a>
          <ul>
            <li><a href="#several-ways-of-message-processing">Several ways of message processing</a></li>
          </ul>
        </li>
        <li><a href="#spring-cloud-stream">Spring Cloud Stream</a></li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><a href="https://spring.io/projects/spring-cloud-stream">Spring Cloud Stream</a> is used within the Spring Cloud architecture to build highly scalable, event-driven microservices.</p>
<p>There is a lot of content in Spring Cloud Stream itself and it has many external dependencies. To get familiar with Spring Cloud Stream, you need to know the following.</p>
<ul>
<li>Spring Framework(Spring Messaging, Spring Environment)</li>
<li>Spring Boot Actuator</li>
<li>Spring Boot Externalized Configuration</li>
<li>Spring Retry</li>
<li>Spring Integration</li>
<li>Spring Cloud Stream</li>
</ul>
<p>The purpose of this article is to introduce Spring Cloud Stream, and with so much knowledge, we will try to take you through Spring Cloud Steam in the simplest way possible (we will replace Spring Cloud Stream with SCS later).</p>
<p>Before we understand SCS, we must understand the Spring Messaging and Spring Integration projects, first let&rsquo;s look at these two projects.</p>
<h2 id="spring-messaging">Spring Messaging</h2>
<p>The Spring Messaging module is a module in the Spring Framework whose role is to unify the programming model for messages.</p>
<p>For example, the message Messaging corresponds to a model that includes a message body Payload and a message header:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/efe45c8fdfdb4fad8546c08d4407b6a4.png" alt=" "></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">org.springframework.messaging</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Message</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>
	<span class="n">T</span> <span class="nf">getPayload</span><span class="o">();</span>
	<span class="n">MessageHeaders</span> <span class="nf">getHeaders</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The message channel MessageChannel is used to receive messages and the send method can be called to send messages to this message channel :</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/3cb9049afad24149a64999803f223b00.png" alt=" "></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@FunctionalInterface</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MessageChannel</span> <span class="o">{</span>
	<span class="kt">long</span> <span class="n">INDEFINITE_TIMEOUT</span> <span class="o">=</span> <span class="o">-</span><span class="n">1</span><span class="o">;</span>
	<span class="k">default</span> <span class="kt">boolean</span> <span class="nf">send</span><span class="o">(</span><span class="n">Message</span><span class="o">&lt;?&gt;</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
		<span class="k">return</span> <span class="n">send</span><span class="o">(</span><span class="n">message</span><span class="o">,</span> <span class="n">INDEFINITE_TIMEOUT</span><span class="o">);</span>
	<span class="o">}</span>
	<span class="kt">boolean</span> <span class="nf">send</span><span class="o">(</span><span class="n">Message</span><span class="o">&lt;?&gt;</span> <span class="n">message</span><span class="o">,</span> <span class="kt">long</span> <span class="n">timeout</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>How are the messages in the message channel consumed? It is implemented by the subscribable channel SubscribableChannel, a sub-interface of the message channel, which is subscribed to by the MessageHandler message processor:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SubscribableChannel</span> <span class="kd">extends</span> <span class="n">MessageChannel</span> <span class="o">{</span>
	<span class="kt">boolean</span> <span class="nf">subscribe</span><span class="o">(</span><span class="n">MessageHandler</span> <span class="n">handler</span><span class="o">);</span>
	<span class="kt">boolean</span> <span class="nf">unsubscribe</span><span class="o">(</span><span class="n">MessageHandler</span> <span class="n">handler</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>MessageHandler really consumes/processes messages:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@FunctionalInterface</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MessageHandler</span> <span class="o">{</span>
	<span class="kt">void</span> <span class="nf">handleMessage</span><span class="o">(</span><span class="n">Message</span><span class="o">&lt;?&gt;</span> <span class="n">message</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">MessagingException</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Spring Messaging internally derives other features based on the messaging model, such as</p>
<ul>
<li>Message reception parameter and return value handling: Message reception parameter handler <code>HandlerMethodArgumentResolver</code> with <code>@Header</code>, <code>@Payload</code> and other annotations; Message return value handler after reception <code>HandlerMethodReturnValueHandler</code> with <code>@SendTo</code> annotations</li>
<li>Message body content converter <code>MessageConverter</code></li>
<li>Unified abstract message sending template <code>AbstractMessageSendingTemplate</code></li>
<li>Message channel interceptor <code>ChannelInterceptor</code></li>
<li>â€¦</li>
</ul>
<h2 id="spring-integration">Spring Integration</h2>
<p><a href="https://docs.spring.io/spring-integration/reference/html/index.html">Spring Integration</a> provides an extension to the Spring programming model to support <a href="https://www.enterpriseintegrationpatterns.com/">Enterprise Integration Patterns</a>.</p>
<p><code>Spring Integration</code> is an extension to <code>Spring Messaging</code>. It introduces a number of new concepts, including message routing <code>MessageRoute</code>, message distribution <code>MessageDispatcher</code>, message filtering <code>Filter</code>, message transformation <code>Transformer</code>, message aggregation <code>Aggregator</code>, message splitting <code>Splitter</code> and so on. Also provided are <code>MessageChannel</code> implementations <code>DirectChannel</code>, <code>ExecutorChannel</code>, <code>PublishSubscribeChannel</code>, etc.; <code>MessageHandler</code> implementations <code>MessageFilter</code>, <code>ServiceActivatingHandler</code>, <code>ServiceFilter</code>, <code>ServiceFilter</code>, <code>ServiceFilter</code>, etc. <code>ServiceActivatingHandler</code>, <code>MethodInvokingSplitter</code>, etc.</p>
<h3 id="several-ways-of-message-processing">Several ways of message processing</h3>
<p>Segmentation of the message.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/428b4bfd7699493790599ac9d93b7f55.png" alt=" "></p>
<p>Aggregation of messages.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/310813813756460291e5c55b7eb49fb0.png" alt=" "></p>
<p>Filtering of messages.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/772a3c14827b4ae0a523b508a3d7d58a.png" alt=" "></p>
<p>Distribution of messages.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/c4e202e7596247c8b2c34c7d4ba96255.png" alt=" "></p>
<p>Let&rsquo;s try Spring Integration with the simplest example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">SubscribableChannel</span> <span class="n">messageChannel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DirectChannel</span><span class="o">();</span> <span class="c1">// 1
</span><span class="c1"></span>
<span class="n">messageChannel</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">msg</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="c1">// 2
</span><span class="c1"></span>  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">.</span><span class="na">getPayload</span><span class="o">());</span>
<span class="o">});</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">MessageBuilder</span><span class="o">.</span><span class="na">withPayload</span><span class="o">(</span><span class="s">&#34;msg from alibaba&#34;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span> <span class="c1">// 3
</span><span class="c1"></span>
</code></pre></td></tr></table>
</div>
</div><p>This code explains.</p>
<ol>
<li>Construct a subscribable message channel messageChannel</li>
<li>Use MessageHandler to consume the messages in this message channel</li>
<li>send a message to this message channel, the message is finally consumed by the MessageHandler in the message channel</li>
</ol>
<p>Finally the console prints: receive: msg from alibaba</p>
<p><code>DirectChannel</code> has an internal message dispatcher of type <code>UnicastingDispatcher</code>, which distributes to the corresponding message channel <code>MessageChannel</code>, as can be seen from the name, <code>UnicastingDispatcher</code> is a unicast dispatcher, which can only select only one message channel. So how to choose it? The internal <code>LoadBalancingStrategy</code> load balancing strategy is provided, and by default only the polling implementation can be extended.</p>
<p>Let&rsquo;s modify the above code a bit and use multiple <code>MessageHandlers</code> to handle messages.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">SubscribableChannel</span> <span class="n">messageChannel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DirectChannel</span><span class="o">();</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">msg</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive1: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">.</span><span class="na">getPayload</span><span class="o">());</span>
<span class="o">});</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">msg</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive2: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">.</span><span class="na">getPayload</span><span class="o">());</span>
<span class="o">});</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">MessageBuilder</span><span class="o">.</span><span class="na">withPayload</span><span class="o">(</span><span class="s">&#34;msg from alibaba&#34;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>
<span class="n">messageChannel</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">MessageBuilder</span><span class="o">.</span><span class="na">withPayload</span><span class="o">(</span><span class="s">&#34;msg from alibaba&#34;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>

</code></pre></td></tr></table>
</div>
</div><p>Since the message dispatcher inside <code>DirectChannel</code> is <code>UnicastingDispatcher</code> unicast and uses a polling load balancing strategy, the two consumptions here correspond to the two <code>MessageHandlers</code> respectively. The console prints out.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">receive1: msg from alibaba
receive2: msg from alibaba
</code></pre></td></tr></table>
</div>
</div><p>Since there is a unicast message dispatcher <code>UnicastingDispatcher</code>, there must also be a broadcast message dispatcher, that is <code>BroadcastingDispatcher</code>, which is used by the message channel <code>PublishSubscribeChannel</code>. The broadcasting message dispatcher distributes messages to all <code>MessageHandler</code>s.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="n">SubscribableChannel</span> <span class="n">messageChannel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PublishSubscribeChannel</span><span class="o">();</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">msg</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive1: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">.</span><span class="na">getPayload</span><span class="o">());</span>
<span class="o">});</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span><span class="n">msg</span> <span class="o">-&gt;</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive2: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">.</span><span class="na">getPayload</span><span class="o">());</span>
<span class="o">});</span>

<span class="n">messageChannel</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">MessageBuilder</span><span class="o">.</span><span class="na">withPayload</span><span class="o">(</span><span class="s">&#34;msg from alibaba&#34;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>
<span class="n">messageChannel</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">MessageBuilder</span><span class="o">.</span><span class="na">withPayload</span><span class="o">(</span><span class="s">&#34;msg from alibaba&#34;</span><span class="o">).</span><span class="na">build</span><span class="o">());</span>
</code></pre></td></tr></table>
</div>
</div><p>Sends two messages, both of which are consumed by all MessageHandlers. Console printing.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">receive1: msg from alibaba
receive2: msg from alibaba
receive1: msg from alibaba
receive2: msg from alibaba
</code></pre></td></tr></table>
</div>
</div><h2 id="spring-cloud-stream">Spring Cloud Stream</h2>
<p>SCS encapsulates Spring Integration, introducing concepts such as Binder, Binding, <code>@EnableBinding</code>, <code>@StreamListener</code>, etc.; integrates with Spring Boot Actuator, providing / bindings, /channels endpoint; integration with Spring Boot Externalized Configuration, providing externalized configuration classes such as BindingProperties, BinderProperties, etc.; enhancements to the message sending The SCS is an enhancement to Spring Integration and provides externalized configuration classes such as BindingProperties, BinderProperties, etc.</p>
<p>SCS is an enhancement to Spring Integration and is integrated with the Spring Boot system and is the foundation of Spring Cloud Bus. It shields the implementation details of the underlying messaging middleware, hoping to unify the set of APIs for sending/consuming messages, and the implementation details of the underlying messaging middleware are done by the Binder of each messaging middleware.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/6c6afdc60eef404da912ca8157b8ec25.png" alt=" "></p>
<p>The <code>Binder</code> is a component that provides integration with external messaging middleware and constructs a <code>Binding</code>, providing two methods <code>bindConsumer</code> and bindProducer for constructing producers and consumers respectively. The current official implementations are <code>Rabbit Binder</code> and <code>Kafka Binder</code>, and <code>Spring Cloud Alibaba</code> has an internal implementation of <code>RocketMQ Binder</code>.</p>
<p>As you can see from the diagram, the Binding is the bridge between the application and the messaging middleware, and is used to consume and produce messages.</p>
<p>Let&rsquo;s take a look at the simplest example using RocketMQ Binder and then analyze the underlying processing principles.</p>
<p>Startup class and sending of messages:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@SpringBootApplication</span>
<span class="nd">@EnableBinding</span><span class="o">({</span> <span class="n">Source</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">Sink</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span> <span class="c1">// 1
</span><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SendAndReceiveApplication</span> <span class="o">{</span>
  
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">SendAndReceiveApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
	<span class="o">}</span>
  
    <span class="nd">@Bean</span> <span class="c1">// 2
</span><span class="c1"></span>	<span class="kd">public</span> <span class="n">CustomRunner</span> <span class="nf">customRunner</span><span class="o">()</span> <span class="o">{</span>
		<span class="k">return</span> <span class="k">new</span> <span class="n">CustomRunner</span><span class="o">();</span>
	<span class="o">}</span>

	<span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CustomRunner</span> <span class="kd">implements</span> <span class="n">CommandLineRunner</span> <span class="o">{</span>

		<span class="nd">@Autowired</span>
		<span class="kd">private</span> <span class="n">Source</span> <span class="n">source</span><span class="o">;</span>

		<span class="nd">@Override</span>
		<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
			<span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="n">5</span><span class="o">;</span>
			<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">1</span><span class="o">;</span> <span class="n">index</span> <span class="o">&lt;=</span> <span class="n">count</span><span class="o">;</span> <span class="n">index</span><span class="o">++)</span> <span class="o">{</span>
				<span class="n">source</span><span class="o">.</span><span class="na">output</span><span class="o">().</span><span class="na">send</span><span class="o">(</span><span class="n">MessageBuilder</span><span class="o">.</span><span class="na">withPayload</span><span class="o">(</span><span class="s">&#34;msg-&#34;</span> <span class="o">+</span> <span class="n">index</span><span class="o">).</span><span class="na">build</span><span class="o">());</span> <span class="c1">// 3
</span><span class="c1"></span>			<span class="o">}</span>
		<span class="o">}</span>
	<span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Receipt of messages.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">StreamListenerReceiveService</span> <span class="o">{</span>

	<span class="nd">@StreamListener</span><span class="o">(</span><span class="n">Sink</span><span class="o">.</span><span class="na">INPUT</span><span class="o">)</span> <span class="c1">// 4
</span><span class="c1"></span>	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receiveByStreamListener1</span><span class="o">(</span><span class="n">String</span> <span class="n">receiveMsg</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receiveByStreamListener: &#34;</span> <span class="o">+</span> <span class="n">receiveMsg</span><span class="o">);</span>
	<span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The code is very simple and does not involve RocketMQ related code, the messages are sent and received based on the SCS system. If you want to switch to rabbitmq or kafka, just change the configuration file, no code changes are needed.</p>
<p>We analyze the principle of this code:</p>
<ol>
<li>
<p>The two interface properties of @EnableBinding, Source and Sink, are provided internally by SCS, which constructs the BindableProxyFactory based on Source and Sink, and the corresponding output and input methods return a MessageChannel that is a DirectChannel. The value corresponding to the annotation modified by the output and input methods is the name of the binding in the configuration file.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Source</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">OUTPUT</span> <span class="o">=</span> <span class="s">&#34;output&#34;</span><span class="o">;</span>
    <span class="nd">@Output</span><span class="o">(</span><span class="n">Source</span><span class="o">.</span><span class="na">OUTPUT</span><span class="o">)</span>
    <span class="n">MessageChannel</span> <span class="nf">output</span><span class="o">();</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">Sink</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">INPUT</span> <span class="o">=</span> <span class="s">&#34;input&#34;</span><span class="o">;</span>
    <span class="nd">@Input</span><span class="o">(</span><span class="n">Sink</span><span class="o">.</span><span class="na">INPUT</span><span class="o">)</span>
    <span class="n">SubscribableChannel</span> <span class="nf">input</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The names of the bindings in the configuration file are output and input, corresponding to the values in the annotations on the methods of the Source and Sink interfaces.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">spring.cloud.stream.bindings.output.destination=test-topic
spring.cloud.stream.bindings.output.content-type=text/plain
spring.cloud.stream.rocketmq.bindings.output.producer.group=demo-group

spring.cloud.stream.bindings.input.destination=test-topic
spring.cloud.stream.bindings.input.content-type=text/plain
spring.cloud.stream.bindings.input.group=test-group1
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Construct the CommandLineRunner and execute the run method of the CustomRunner when the application starts.</p>
</li>
<li>
<p>Call the output method of the Source interface to get the DirectChannel and send the message to this channel. This is the same code as in the previous Spring Integration chapter</p>
<ul>
<li>After the output in Source sends a message to the DirectChannel message channel, it is processed by the MessageHandler, AbstractMessageChannelBinder#SendingHandler, and then it is delegated to the MessageHandler created by It will then be delegated to the MessageHandler created by AbstractMessageChannelBinder#createProducerMessageHandler (this method is implemented by a different messaging middleware)</li>
<li>The MessageHandler returned by the AbstractMessageChannelBinder#createProducerMessageHandler method of the different messaging middleware will internally convert the Spring Message into the Message model of the corresponding middleware and send it to the broker of the corresponding middleware.</li>
</ul>
</li>
<li>
<p>Use @StreamListener for message subscription. Note that the value corresponding to Sink.input in the annotation is &ldquo;input&rdquo;, which will be configured according to the value corresponding to the binding&rsquo;s name of input in the configuration file</p>
<ul>
<li>The AbstractMessageChannelBinder#createConsumerEndpoint method corresponding to different message middleware will use the Consumer to subscribe to the message, and will internally convert the Message model corresponding to the middleware into a Spring Message after the message is subscribed.</li>
<li>After message conversion, the Spring Message will be sent to the message channel with the name input</li>
<li>The StreamListenerMessageHandler corresponding to @StreamListener subscribes to the message channel with the name input and consumes the message</li>
</ul>
</li>
</ol>
<p>This process is a bit verbose, so I&rsquo;ll summarize it in a diagram (the yellow part involves the Binder implementation of each message middleware and the basic subscription publishing function of MQ).</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/b73b073585d8491bbcf2201282f39a75.png" alt=" "></p>
<p>At the end of the SCS chapter, let&rsquo;s look at a piece of code from SCS about the way messages are handled.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@StreamListener</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Sink</span><span class="o">.</span><span class="na">INPUT</span><span class="o">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="s">&#34;headers[&#39;index&#39;]==&#39;1&#39;&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receiveByHeader</span><span class="o">(</span><span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive by headers[&#39;index&#39;]==&#39;1&#39;: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@StreamListener</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Sink</span><span class="o">.</span><span class="na">INPUT</span><span class="o">,</span> <span class="n">condition</span> <span class="o">=</span> <span class="s">&#34;headers[&#39;index&#39;]==&#39;9999&#39;&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receivePerson</span><span class="o">(</span><span class="nd">@Payload</span> <span class="n">Person</span> <span class="n">person</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive Person: &#34;</span> <span class="o">+</span> <span class="n">person</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@StreamListener</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Sink</span><span class="o">.</span><span class="na">INPUT</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receiveAllMsg</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive allMsg by StreamListener. content: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">);</span>
<span class="o">}</span>

<span class="nd">@StreamListener</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="n">Sink</span><span class="o">.</span><span class="na">INPUT</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">receiveHeaderAndMsg</span><span class="o">(</span><span class="nd">@Header</span><span class="o">(</span><span class="s">&#34;index&#34;</span><span class="o">)</span> <span class="n">String</span> <span class="n">index</span><span class="o">,</span> <span class="n">Message</span> <span class="n">msg</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;receive by HeaderAndMsg by StreamListener. content: &#34;</span> <span class="o">+</span> <span class="n">msg</span><span class="o">);</span>
<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><p>Did you notice that this code is similar to the code that receives requests in the Spring MVC Controller? In fact, their architecture is similar, and the Spring MVC classes for handling parameters and return values in the Controller are</p>
<ul>
<li><code>org.springframework.web.method.support.HandlerMethodArgumentResolver</code></li>
<li><code>org.springframework.web.method.support.HandlerMethodReturnValueHandler</code></li>
</ul>
<p>The classes for handling parameters and return values in Spring Messaging have been mentioned before, and are</p>
<ul>
<li><code>org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolver</code></li>
<li><code>org.springframework.messaging.handler.invocation.HandlerMethodReturnValueHandler</code></li>
</ul>
<p>Their class names are exactly the same, and even the internal method names are the same.</p>
<h2 id="summary">Summary</h2>
<p>This is a summary of the SCS system related class descriptions.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/07/01/f8529e70f2cc4919801e4ba266fb31da.png" alt=" "></p>
<hr>
<p>Reference <code>https://fangjian0423.github.io/2019/04/03/spring-cloud-stream-intro/</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/spring-cloud/">spring-cloud</a>
          <a href="/tags/spring-cloud-stream/">spring-cloud-stream</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-07/spring-cloud-gateway-downgrading-with-hystrix-using-custom-filters/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Spring Cloud Gateway - Downgrading with Hystrix using Custom Filters</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-06/a-pitfall-of-comparing-empty-structs-in-golang/">
            <span class="next-text nav-default">A pitfall of comparing empty structs in Golang</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
