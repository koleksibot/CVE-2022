<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>C&#43;&#43; implementation for friendly handling of Json data - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Background C/C&#43;&#43; client needs to receive and send JSON format data to the backend to achieve communication and data interaction, but there is no ready-made interface for handling JSON format data in C&#43;&#43;, so we can&amp;rsquo;t avoid splitting and splicing by directly referring to third-party libraries. Considering that there will be a lot of JSON data to be processed in this project, we can&amp;rsquo;t avoid the repetitive splitting and splicing." /><meta name="keywords" content="c&#43;&#43;, json" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-02/cpp-json/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="C&#43;&#43; implementation for friendly handling of Json data" />
<meta property="og:description" content="Background C/C&#43;&#43; client needs to receive and send JSON format data to the backend to achieve communication and data interaction, but there is no ready-made interface for handling JSON format data in C&#43;&#43;, so we can&rsquo;t avoid splitting and splicing by directly referring to third-party libraries. Considering that there will be a lot of JSON data to be processed in this project, we can&rsquo;t avoid the repetitive splitting and splicing." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-02/cpp-json/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-12T11:20:29+08:00" />
<meta property="article:modified_time" content="2022-02-12T11:20:29+08:00" />

<meta itemprop="name" content="C&#43;&#43; implementation for friendly handling of Json data">
<meta itemprop="description" content="Background C/C&#43;&#43; client needs to receive and send JSON format data to the backend to achieve communication and data interaction, but there is no ready-made interface for handling JSON format data in C&#43;&#43;, so we can&rsquo;t avoid splitting and splicing by directly referring to third-party libraries. Considering that there will be a lot of JSON data to be processed in this project, we can&rsquo;t avoid the repetitive splitting and splicing."><meta itemprop="datePublished" content="2022-02-12T11:20:29+08:00" />
<meta itemprop="dateModified" content="2022-02-12T11:20:29+08:00" />
<meta itemprop="wordCount" content="3327">
<meta itemprop="keywords" content="c&#43;&#43;,json," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="C&#43;&#43; implementation for friendly handling of Json data"/>
<meta name="twitter:description" content="Background C/C&#43;&#43; client needs to receive and send JSON format data to the backend to achieve communication and data interaction, but there is no ready-made interface for handling JSON format data in C&#43;&#43;, so we can&rsquo;t avoid splitting and splicing by directly referring to third-party libraries. Considering that there will be a lot of JSON data to be processed in this project, we can&rsquo;t avoid the repetitive splitting and splicing."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">C&#43;&#43; implementation for friendly handling of Json data</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-02-12 11:20:29 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 3327 words </span>
          <span class="more-meta"> 7 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#background">Background</a></li>
        <li><a href="#design">Design</a>
          <ul>
            <li><a href="#objectives">Objectives</a></li>
            <li><a href="#effect">Effect</a></li>
          </ul>
        </li>
        <li><a href="#implementation">Implementation</a>
          <ul>
            <li><a href="#basic-data-type-conversion">Basic data type conversion</a></li>
            <li><a href="#custom-data-structure-type">Custom data structure type</a></li>
            <li><a href="#template-matching-to-prevent-compilation-errors">Template matching to prevent compilation errors</a></li>
            <li><a href="#member-variable-matching-key-renaming">Member variable matching Key renaming</a></li>
            <li><a href="#object2json-implementation">Object2Json implementation</a></li>
          </ul>
        </li>
        <li><a href="#highlights">Highlights</a></li>
        <li><a href="#source-code">Source code</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="background">Background</h2>
<p>C/C++ client needs to receive and send JSON format data to the backend to achieve communication and data interaction, but there is no ready-made interface for handling JSON format data in C++, so we can&rsquo;t avoid splitting and splicing by directly referring to third-party libraries. Considering that there will be a lot of JSON data to be processed in this project, we can&rsquo;t avoid the repetitive splitting and splicing. So I intend to encapsulate a set of C++ structure object to JSON data, JSON data directly mounted on the interface of C++ structure object, similar to the common serialization and deserialization in data transfer, in order to facilitate the subsequent processing of data and improve development efficiency.</p>
<h2 id="design">Design</h2>
<h3 id="objectives">Objectives</h3>
<ol>
<li>To be able to convert a C++ structure object instance to JSON string data, or to load and assign a string of JSON string data to a C++ structure object instance through a simple interface. Ideal interface: <code>Json2Object(inJsonString, outStructObject)</code> , or <code>Object2Json(inStructObject, outJsonString)</code>. 2.</li>
<li>Support Json conversion of built-in basic types such as bool, int, double, Json conversion of custom structures, Json conversion of the above types as arrays of elements, and Json conversion of nested structures.</li>
</ol>
<h3 id="effect">Effect</h3>
<p>first post the unit test code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="n">TEST_CASE</span><span class="p">(</span><span class="s">&#34;解析结构体数组到JSON串&#34;</span><span class="p">,</span> <span class="s">&#34;[json]&#34;</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">struct</span> <span class="nc">DemoChildrenObject</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">boolValue</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">intValue</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strValue</span><span class="p">;</span>
        <span class="cm">/*JSON相互转换成员变量声明（必需）*/</span>
        <span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER</span><span class="p">(</span><span class="n">boolValue</span><span class="p">,</span> <span class="n">intValue</span><span class="p">,</span> <span class="n">strValue</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="k">struct</span> <span class="nc">DemoObjct</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">boolValue</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">intValue</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strValue</span><span class="p">;</span>
        <span class="cm">/*嵌套的支持JSON转换的结构体成员变量，数组形式*/</span>
        <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span> <span class="n">DemoChildrenObject</span><span class="o">&gt;</span> <span class="n">children</span><span class="p">;</span>
        
        <span class="cm">/*JSON相互转换成员变量声明（必需）*/</span>
        <span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER</span><span class="p">(</span><span class="n">boolValue</span><span class="p">,</span> <span class="n">intValue</span><span class="p">,</span> <span class="n">strValue</span><span class="p">,</span> <span class="n">children</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="n">DemoObjct</span> <span class="n">demoObj</span><span class="p">;</span>
    <span class="cm">/*开始对demoObj对象的成员变量进行赋值*/</span>
    <span class="n">demoObj</span><span class="p">.</span><span class="n">boolValue</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">demoObj</span><span class="p">.</span><span class="n">intValue</span> <span class="o">=</span> <span class="mi">321</span><span class="p">;</span>
    <span class="n">demoObj</span><span class="p">.</span><span class="n">strValue</span> <span class="o">=</span> <span class="s">&#34;hello worLd&#34;</span><span class="p">;</span>

    <span class="n">DemoChildrenObject</span> <span class="n">child1</span><span class="p">;</span>
    <span class="n">child1</span><span class="p">.</span><span class="n">boolValue</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">child1</span><span class="p">.</span><span class="n">intValue</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="n">child1</span><span class="p">.</span><span class="n">strValue</span> <span class="o">=</span> <span class="s">&#34;hello worLd child1&#34;</span><span class="p">;</span>

    <span class="n">DemoChildrenObject</span> <span class="n">child2</span><span class="p">;</span>
    <span class="n">child2</span><span class="p">.</span><span class="n">boolValue</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">child2</span><span class="p">.</span><span class="n">intValue</span> <span class="o">=</span> <span class="mi">30005</span><span class="p">;</span>
    <span class="n">child2</span><span class="p">.</span><span class="n">strValue</span> <span class="o">=</span> <span class="s">&#34;hello worLd child2&#34;</span><span class="p">;</span>

    <span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">child1</span><span class="p">);</span>
    <span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">child2</span><span class="p">);</span>
    <span class="cm">/*结束对demoObj对象的成员变量的赋值*/</span>

    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">jsonStr</span><span class="p">;</span>
    <span class="cm">/*关键转换函数*/</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">Object2Json</span><span class="p">(</span><span class="n">jsonStr</span><span class="p">,</span> <span class="n">demoObj</span><span class="p">));</span> 
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;returned json format: &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">jsonStr</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

    <span class="cm">/*打印的内容如下：
</span><span class="cm">    returned json format: {
</span><span class="cm">       &#34;boolValue&#34; : true,
</span><span class="cm">       &#34;children&#34; : [
</span><span class="cm">          {
</span><span class="cm">             &#34;boolValue&#34; : true,
</span><span class="cm">             &#34;intValue&#34; : 1000,
</span><span class="cm">             &#34;strValue&#34; : &#34;hello worLd child1&#34;
</span><span class="cm">          },
</span><span class="cm">          {
</span><span class="cm">             &#34;boolValue&#34; : true,
</span><span class="cm">             &#34;intValue&#34; : 30005,
</span><span class="cm">             &#34;strValue&#34; : &#34;hello worLd child2&#34;
</span><span class="cm">          }
</span><span class="cm">       ],
</span><span class="cm">       &#34;intValue&#34; : 321,
</span><span class="cm">       &#34;strValue&#34; : &#34;hello worLd&#34;
</span><span class="cm">    }
</span><span class="cm">    */</span>
    
    <span class="n">DemoObjct</span> <span class="n">demoObj2</span><span class="p">;</span>
    <span class="cm">/*关键转换函数*/</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">Json2Object</span><span class="p">(</span><span class="n">demoObj2</span><span class="p">,</span> <span class="n">jsonStr</span><span class="p">));</span>

    <span class="cm">/*校验转换后的结构体变量中各成员变量的内容是否如预期*/</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj2</span><span class="p">.</span><span class="n">boolValue</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj2</span><span class="p">.</span><span class="n">intValue</span> <span class="o">==</span> <span class="mi">321</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj2</span><span class="p">.</span><span class="n">strValue</span> <span class="o">==</span> <span class="s">&#34;hello worLd&#34;</span><span class="p">);</span>

    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj2</span><span class="p">.</span><span class="n">children</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="p">);</span>

    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">boolValue</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">intValue</span> <span class="o">==</span> <span class="mi">1000</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">strValue</span> <span class="o">==</span> <span class="s">&#34;hello worLd child1&#34;</span><span class="p">);</span>

    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">boolValue</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">intValue</span> <span class="o">==</span> <span class="mi">30005</span><span class="p">);</span>
    <span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">strValue</span> <span class="o">==</span> <span class="s">&#34;hello worLd child2&#34;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="implementation">Implementation</h2>
<p>This time we will only focus on how to convert between structures and Json strings in a friendly way, without focusing in depth on how exactly JSon strings are converted with basic data types. There are already quite a few third-party libraries to help us with this, such as <a href="https://github.com/DaveGamble/cJSON">cJSON</a>, <a href="https://github.com/open-source-parsers/jsoncpp">Jsoncpp</a>, <a href="https://github.com/Tencent/rapidjson">rapidjson</a>, without having to create tools repeatedly.</p>
<p>This time we chose JsonCPP as the underlying JSON parsing support, if you want to replace it with other three-party libraries is also relatively simple, modify the corresponding embedded content can be.</p>
<p>Our goal is to implement two interfaces.</p>
<ul>
<li><code>Json2Object(inJsonString, outStructObject)</code></li>
<li><code>Object2Json(inStructObject, outJsonString)</code></li>
</ul>
<p>Combined with the types defined by JsonCPP itself, we further need to implement</p>
<ul>
<li><code>Json2Object(const Json::Value&amp; jsonTypeValue, outStructObject)</code></li>
<li><code>Object2Json(inStructObject, const std::string&amp; key, Json::Value&amp; jsonTypeValue)</code></li>
</ul>
<h3 id="basic-data-type-conversion">Basic data type conversion</h3>
<p>For basic data types such as bool, int, double, string, etc., the implementation is relatively simple.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="cm">/*int 类型支持*/</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="kt">int</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isInt</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asInt</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*std::string 字符串类型支持*/</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isString</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asString</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="custom-data-structure-type">Custom data structure type</h3>
<p>For the custom structure type, all we have to do is to make sure that its member variables can correspond to the JSON nodes one by one and can match for data filling.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++">   <span class="cm">/*Json字符串：
</span><span class="cm">   {
</span><span class="cm">   &#34;boolValue&#34; : true,
</span><span class="cm">   &#34;intValue&#34; : 1234,
</span><span class="cm">   &#34;strValue&#34; : &#34;demo object!&#34;
</span><span class="cm">   }*/</span>

   <span class="k">struct</span> <span class="nc">DemoObjct</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">boolValue</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">intValue</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strValue</span><span class="p">;</span>
    <span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>As the above example, in the process of mutual conversion, &ldquo;boolValue&rdquo; can correspond to the member variable named boolValue in the DemoObjct object, and &ldquo;strValue&rdquo; corresponds to the member variable named strValue in the DemoObjct object.</p>
<p>Under normal circumstances, for this scenario, we can only implement the processing function for data conversion for DemoObjct structure <strong>extra</strong>, because the member variables defined by different structure declarations are different, so for each structure need to be implemented separately, the work is tedious and not universal.</p>
<p>From here, what we need to do is <strong>&ldquo;hide &ldquo;</strong> the conversion functions implemented for class structures and use the language&rsquo;s own features (function templates, etc.) to let them do this for us.</p>
<ol>
<li>declare the conversion member functions, and in this member function implementation, enable each member variable to read or write values from the JSON native data.</li>
<li>register member variables so that the conversion member function knows which member variables it needs to handle and which node field in the JSON native data each member variable corresponds to in order to match reads and writes.</li>
<li>trigger calls to this conversion member function when the <code>Json2Object</code> and <code>Object2Json</code> functions are called externally in order to populate or output the contents of the member variables.</li>
</ol>
<p>Fitting the elephant into the fridge takes only three steps, let&rsquo;s see how these three steps work.</p>
<h4 id="member-variable-handling">Member Variable Handling</h4>
<ul>
<li>
<p>Considering the uncontrollable type and number of member variables per structure and the need to treat each member variable as a left value (when <code>Json2Object</code>), you can&rsquo;t simply use array enumeration to handle them, you can use C++11&rsquo;s feature, variable parameter template, to iterate through each member variable from inside to outside</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">JsonParse</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">names</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">key</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isMember</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">||</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">Args</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">JsonParse</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">names</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">,</span> <span class="n">Args</span><span class="o">&amp;</span><span class="p">...</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">JsonParse</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">arg</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">JsonParse</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">args</span><span class="p">...);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Member variables have correspondence with the JSON native node key field. Initially, we will first simply consider the member variable name as the key name of the corresponding node in JSON first. This can be achieved by the macro definition feature, which splits the list of key names by declaring the content of the registered member variable as a string.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="cp">#define JSONCONVERT2OBJECT_MEMEBER_REGISTER(...)  \
</span><span class="cp">bool ParseHelpImpl(const Json::Value&amp; jsonTypeValue)
</span><span class="cp"></span><span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="n">Member2KeyParseWithStr</span><span class="p">(</span><span class="err">#</span><span class="n">__VA_ARGS__</span><span class="p">);</span>
    <span class="k">return</span> <span class="nf">JsonParse</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">__VA_ARGS__</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="member-variable-registration">Member Variable Registration</h4>
<p>For example, for the class structure <code>DemoObjct</code>, add <code>JSONCONVERT2OBJECT_MEMEBER_REGISTER</code> with a registration statement for the member variable.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++">   <span class="k">struct</span> <span class="nc">DemoObjct</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">boolValue</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">intValue</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strValue</span><span class="p">;</span>
       
       <span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER</span><span class="p">(</span><span class="n">boolValue</span><span class="p">,</span> <span class="n">intValue</span><span class="p">,</span> <span class="n">strValue</span><span class="p">)</span>
           
    <span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>Equivalent to.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++">   <span class="k">struct</span> <span class="nc">DemoObjct</span>
    <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">boolValue</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">intValue</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strValue</span><span class="p">;</span>
       
       <span class="kt">bool</span> <span class="nf">ParseHelpImpl</span><span class="p">(</span><span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> 
                          <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">names</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">Member2KeyParseWithStr</span><span class="p">(</span><span class="s">&#34;boolValue, intValue, strValue&#34;</span><span class="p">);</span>
            <span class="c1">//names 得到 [&#34;boolValue&#34;,&#34;intValue&#34;, &#34;strValue&#34;]
</span><span class="c1"></span>            <span class="c1">//然后带着这些key逐一从Json中取值赋值到成员变量中
</span><span class="c1"></span>            <span class="k">return</span> <span class="n">JsonParse</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">boolValue</span><span class="p">,</span> <span class="n">intValue</span><span class="p">,</span> <span class="n">strValue</span><span class="p">);</span>
        <span class="p">}</span>      
    <span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="template-matching-to-prevent-compilation-errors">Template matching to prevent compilation errors</h3>
<p>So far, the core functionality has been implemented. If the target struct class does not add the JSON conversion declaration registration, external use of the <code>Json2Object</code> interface will result in a compilation error indicating that the declaration definition of the member function <code>ParseHelpImpl</code> cannot be found. &hellip;&hellip; We can use <code>enable_if</code> to provide a default function for to provide default functions for structs that do not declare registered macros.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">enable_if</span><span class="o">&lt;</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="n">PreGetCustomMemberNameIfExists</span><span class="p">(</span><span class="n">aimObj</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">aimObj</span><span class="p">.</span><span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER_RESERVERD_IMPLE</span><span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">names</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span>  <span class="n">enable_if</span><span class="o">&lt;!</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="member-variable-matching-key-renaming">Member variable matching Key renaming</h3>
<p>The current implementations all use the name of the member variable as the name of the Key in the JSON string. For flexible handling, another macro is added for redeclaring the key corresponding to the JSON string in the member variable of the structure, for example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="k">struct</span> <span class="nc">DemoObjct</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="n">boolValue</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">intValue</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">strValue</span><span class="p">;</span>

    <span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER</span><span class="p">(</span><span class="n">boolValue</span><span class="p">,</span> <span class="n">intValue</span><span class="p">,</span> <span class="n">strValue</span><span class="p">)</span>
    <span class="cm">/*重新声明成员变量对应到JSON串的key，注意顺序一致*/</span>
    <span class="n">JSONCONVERT2OBJECT_MEMEBER_RENAME_REGISTER</span><span class="p">(</span><span class="s">&#34;bValue&#34;</span><span class="p">,</span> <span class="s">&#34;iValue&#34;</span><span class="p">,</span> <span class="s">&#34;sValue&#34;</span><span class="p">)</span>
<span class="p">};</span>

<span class="n">DemoObjct</span> <span class="n">demoObj</span><span class="p">;</span>
<span class="cm">/*boolValue &lt;--&gt; bValue; intValue &lt;--&gt; iValue; ...*/</span>
<span class="n">REQUIRE</span><span class="p">(</span><span class="n">Json2Object</span><span class="p">(</span><span class="n">demoObj</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="s">&#34;{</span><span class="se">\&#34;</span><span class="s">bValue</span><span class="se">\&#34;</span><span class="s">:true, </span><span class="se">\&#34;</span><span class="s">iValue</span><span class="se">\&#34;</span><span class="s">:1234, </span><span class="se">\&#34;</span><span class="s">sValue</span><span class="se">\&#34;</span><span class="s">:</span><span class="se">\&#34;</span><span class="s">demo object!</span><span class="se">\&#34;</span><span class="s">}&#34;</span><span class="p">)));</span>
<span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">boolValue</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
<span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">intValue</span> <span class="o">==</span> <span class="mi">1234</span><span class="p">);</span>
<span class="n">REQUIRE</span><span class="p">(</span><span class="n">demoObj</span><span class="p">.</span><span class="n">strValue</span> <span class="o">==</span> <span class="s">&#34;demo object!&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="object2json-implementation">Object2Json implementation</h3>
<p>The above mentioned is mostly for the implementation of the <code>Json2Object</code> interface provided by the operation, from the structure object to Json is also a similar operation, here will not elaborate, detailed can refer to the source code.</p>
<h2 id="highlights">Highlights</h2>
<ul>
<li>Simplify the processing of JSON data in C++, shield attention to the operation of splitting and processing JSON data.</li>
<li>Provide easy interface to switch from structure to JSON string and JSON string to structure freely.</li>
</ul>
<h2 id="source-code">Source code</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c++" data-lang="c++"><span class="cp">#include</span> <span class="cpf">&#34;json/json.h&#34;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;vector&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;initializer_list&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#define JSONCONVERT2OBJECT_MEMEBER_REGISTER(...)  \
</span><span class="cp">bool JSONCONVERT2OBJECT_MEMEBER_REGISTER_RESERVERD_IMPLE(const Json::Value&amp; jsonTypeValue, std::vector&lt;std::string&gt; &amp;names) \
</span><span class="cp">{     \
</span><span class="cp">    if(names.size() &lt;= 0)  { \
</span><span class="cp">        names = Member2KeyParseWithStr(#__VA_ARGS__); \
</span><span class="cp">    }   \
</span><span class="cp">    return JsonParse(names, 0, jsonTypeValue, __VA_ARGS__); \
</span><span class="cp">}   \
</span><span class="cp">bool OBJECTCONVERT2JSON_MEMEBER_REGISTER_RESERVERD_IMPLE(Json::Value&amp; jsonTypeValue, std::vector&lt;std::string&gt; &amp;names) const \
</span><span class="cp">{     \
</span><span class="cp">    if(names.size() &lt;= 0)  { \
</span><span class="cp">        names = Member2KeyParseWithStr(#__VA_ARGS__); \
</span><span class="cp">    }   \
</span><span class="cp">    return ParseJson(names, 0, jsonTypeValue, __VA_ARGS__); \
</span><span class="cp">}   \
</span><span class="cp">
</span><span class="cp"></span>
<span class="cp">#define JSONCONVERT2OBJECT_MEMEBER_RENAME_REGISTER(...)  \
</span><span class="cp">std::vector&lt;std::string&gt; JSONCONVERT2OBJECT_MEMEBER_RENAME_REGISTER_RESERVERD_IMPLE() const \
</span><span class="cp">{     \
</span><span class="cp">    return Member2KeyParseWithMultiParam({ __VA_ARGS__ }); \
</span><span class="cp">}
</span><span class="cp"></span>
<span class="k">namespace</span> <span class="n">JSON</span>
<span class="p">{</span>
<span class="k">template</span> <span class="o">&lt;</span><span class="kt">bool</span><span class="p">,</span> <span class="k">class</span> <span class="nc">TYPE</span> <span class="o">=</span> <span class="kt">void</span><span class="o">&gt;</span>
<span class="k">struct</span> <span class="nc">enable_if</span>
<span class="p">{</span>
<span class="p">};</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">class</span> <span class="nc">TYPE</span><span class="o">&gt;</span>
<span class="k">struct</span> <span class="nc">enable_if</span><span class="o">&lt;</span><span class="nb">true</span><span class="p">,</span> <span class="n">TYPE</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="k">typedef</span> <span class="n">TYPE</span> <span class="n">type</span><span class="p">;</span>
<span class="p">};</span>
<span class="p">}</span> <span class="c1">//JSON
</span><span class="c1"></span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">struct</span> <span class="nc">HasConverFunction</span>
<span class="p">{</span>
    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TT</span><span class="o">&gt;</span>
    <span class="k">static</span> <span class="kt">char</span> <span class="n">func</span><span class="p">(</span><span class="k">decltype</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TT</span><span class="o">::</span><span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER_RESERVERD_IMPLE</span><span class="p">));</span> <span class="c1">//@1
</span><span class="c1"></span>    
    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TT</span><span class="o">&gt;</span>
    <span class="k">static</span> <span class="kt">int</span> <span class="n">func</span><span class="p">(...);</span> <span class="c1">//@2
</span><span class="c1"></span>
    <span class="k">const</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">has</span> <span class="o">=</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">func</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">NULL</span><span class="p">))</span> <span class="o">==</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>

    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TT</span><span class="o">&gt;</span>
    <span class="k">static</span> <span class="kt">char</span> <span class="n">func2</span><span class="p">(</span><span class="k">decltype</span><span class="p">(</span><span class="o">&amp;</span><span class="n">TT</span><span class="o">::</span><span class="n">JSONCONVERT2OBJECT_MEMEBER_RENAME_REGISTER_RESERVERD_IMPLE</span><span class="p">));</span> <span class="c1">//@1
</span><span class="c1"></span>    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TT</span><span class="o">&gt;</span>
    <span class="k">static</span> <span class="kt">int</span> <span class="n">func2</span><span class="p">(...);</span> <span class="c1">//@2
</span><span class="c1"></span>    <span class="k">const</span> <span class="k">static</span> <span class="kt">bool</span> <span class="n">has2</span> <span class="o">=</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">func2</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nb">NULL</span><span class="p">))</span> <span class="o">==</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">char</span><span class="p">));</span>
<span class="p">};</span>

<span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">Member2KeyParseWithMultiParam</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">initializer_list</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">il</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">result</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="n">it</span> <span class="o">=</span> <span class="n">il</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">il</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="n">it</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">*</span><span class="n">it</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">NormalStringTrim</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">str</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="kt">char</span> <span class="k">const</span><span class="o">*</span> <span class="n">whitespaceChars</span> <span class="o">=</span> <span class="s">&#34;</span><span class="se">\n\r\t</span><span class="s"> &#34;</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">size_type</span> <span class="n">start</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">find_first_not_of</span><span class="p">(</span><span class="n">whitespaceChars</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">size_type</span> <span class="n">end</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">find_last_not_of</span><span class="p">(</span><span class="n">whitespaceChars</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">start</span> <span class="o">!=</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span> <span class="o">?</span> <span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">:</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">();</span>
<span class="p">}</span>

<span class="kr">inline</span> <span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">NormalStringSplit</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">str</span><span class="p">,</span> <span class="kt">char</span> <span class="n">splitElem</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">strs</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">size_type</span> <span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">;</span>
    <span class="n">pos2</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">splitElem</span><span class="p">);</span>
    <span class="n">pos1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">::</span><span class="n">npos</span> <span class="o">!=</span> <span class="n">pos2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">strs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span> <span class="o">-</span> <span class="n">pos1</span><span class="p">));</span>
        <span class="n">pos1</span> <span class="o">=</span> <span class="n">pos2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">pos2</span> <span class="o">=</span> <span class="n">str</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="n">splitElem</span><span class="p">,</span> <span class="n">pos1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">strs</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">substr</span><span class="p">(</span><span class="n">pos1</span><span class="p">));</span>
    <span class="k">return</span> <span class="n">strs</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">Member2KeyParseWithStr</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">values</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">result</span><span class="p">;</span>
    <span class="k">auto</span> <span class="n">enumValues</span> <span class="o">=</span> <span class="n">NormalStringSplit</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="sc">&#39;,&#39;</span><span class="p">);</span>
    <span class="n">result</span><span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="n">enumValues</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
    <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="k">const</span><span class="o">&amp;</span> <span class="nl">enumValue</span> <span class="p">:</span> <span class="n">enumValues</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">result</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">NormalStringTrim</span><span class="p">(</span><span class="n">enumValue</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//////////////////////////////////////////////////////////////////////////////
</span><span class="c1"></span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="kt">bool</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isBool</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asBool</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="kt">int</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isInt</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asInt</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isUInt</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asUInt</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="kt">double</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isDouble</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asDouble</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="kt">double</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isString</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span> <span class="o">=</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">asString</span><span class="p">();</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">JSON</span><span class="o">::</span><span class="n">enable_if</span><span class="o">&lt;</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has2</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">PreGetCustomMemberNameIfExists</span><span class="p">(</span><span class="k">const</span> <span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">aimObj</span><span class="p">.</span><span class="n">JSONCONVERT2OBJECT_MEMEBER_RENAME_REGISTER_RESERVERD_IMPLE</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">JSON</span><span class="o">::</span><span class="n">enable_if</span><span class="o">&lt;!</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has2</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">PreGetCustomMemberNameIfExists</span><span class="p">(</span><span class="k">const</span> <span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">JSON</span><span class="o">::</span><span class="n">enable_if</span><span class="o">&lt;</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="n">PreGetCustomMemberNameIfExists</span><span class="p">(</span><span class="n">aimObj</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">aimObj</span><span class="p">.</span><span class="n">JSONCONVERT2OBJECT_MEMEBER_REGISTER_RESERVERD_IMPLE</span><span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">names</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">JSON</span><span class="o">::</span><span class="n">enable_if</span><span class="o">&lt;!</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isNull</span><span class="p">()</span> <span class="o">||</span> <span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isArray</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">aimObj</span><span class="p">.</span><span class="n">clear</span><span class="p">();</span>
        <span class="kt">bool</span> <span class="nf">result</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">T</span> <span class="n">item</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Json2Object</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="p">{</span>
                <span class="n">result</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">aimObj</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">JsonParse</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">names</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="k">auto</span> <span class="n">key</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">jsonTypeValue</span><span class="p">.</span><span class="n">isMember</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">||</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">Args</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">JsonParse</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">names</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="k">const</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">,</span> <span class="n">Args</span><span class="o">&amp;</span><span class="p">...</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">JsonParse</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">arg</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nf">JsonParse</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">args</span><span class="p">...);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/** Provider interface*/</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="o">&gt;</span>
<span class="kt">bool</span> <span class="n">Json2Object</span><span class="p">(</span><span class="n">TClass</span><span class="o">&amp;</span> <span class="n">aimObj</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">jsonTypeStr</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Json</span><span class="o">::</span><span class="n">Reader</span> <span class="n">reader</span><span class="p">;</span>
    <span class="n">Json</span><span class="o">::</span><span class="n">Value</span> <span class="n">root</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">jsonTypeStr</span><span class="p">,</span> <span class="n">root</span><span class="p">)</span> <span class="o">||</span> <span class="n">root</span><span class="p">.</span><span class="n">isNull</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nf">Json2Object</span><span class="p">(</span><span class="n">aimObj</span><span class="p">,</span> <span class="n">root</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">bool</span> <span class="nf">GetJsonRootObject</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">root</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">jsonTypeStr</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Json</span><span class="o">::</span><span class="n">Reader</span> <span class="n">reader</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">reader</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">jsonTypeStr</span><span class="p">,</span> <span class="n">root</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">////////////////////////////////////////////////////////////////////////
</span><span class="c1"></span>
<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">JSON</span><span class="o">::</span><span class="n">enable_if</span><span class="o">&lt;</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeOutValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="n">TClass</span><span class="o">&amp;</span> <span class="n">objValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="n">PreGetCustomMemberNameIfExists</span><span class="p">(</span><span class="n">objValue</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">objValue</span><span class="p">.</span><span class="n">OBJECTCONVERT2JSON_MEMEBER_REGISTER_RESERVERD_IMPLE</span><span class="p">(</span><span class="n">jsonTypeOutValue</span><span class="p">,</span> <span class="n">names</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Json</span><span class="o">::</span><span class="n">Value</span> <span class="n">jsonTypeNewValue</span><span class="p">;</span>
        <span class="k">const</span> <span class="kt">bool</span> <span class="n">result</span> <span class="o">=</span> <span class="n">objValue</span><span class="p">.</span><span class="n">OBJECTCONVERT2JSON_MEMEBER_REGISTER_RESERVERD_IMPLE</span><span class="p">(</span><span class="n">jsonTypeNewValue</span><span class="p">,</span> <span class="n">names</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">jsonTypeOutValue</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">jsonTypeNewValue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">TClass</span><span class="p">,</span> <span class="k">typename</span> <span class="n">JSON</span><span class="o">::</span><span class="n">enable_if</span><span class="o">&lt;!</span><span class="n">HasConverFunction</span><span class="o">&lt;</span><span class="n">TClass</span><span class="o">&gt;::</span><span class="n">has</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;::</span><span class="n">type</span> <span class="o">=</span> <span class="mi">0</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">bool</span> <span class="n">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeOutValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="n">TClass</span><span class="o">&amp;</span> <span class="n">objValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">Object2Json</span><span class="p">(</span><span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeOutValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">key</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&amp;</span> <span class="n">objValue</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">bool</span> <span class="nf">result</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">objValue</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Json</span><span class="o">::</span><span class="n">Value</span> <span class="n">item</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Object2Json</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">objValue</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="p">{</span>
            <span class="n">result</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span> <span class="n">jsonTypeOutValue</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
            <span class="k">else</span> <span class="n">jsonTypeOutValue</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>
        <span class="p">}</span>
     <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">ParseJson</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">names</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">names</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">index</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">key</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
        <span class="k">return</span> <span class="nf">Object2Json</span><span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="p">,</span> <span class="k">typename</span><span class="p">...</span> <span class="n">Args</span><span class="o">&gt;</span>
<span class="k">static</span> <span class="kt">bool</span> <span class="n">ParseJson</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&gt;&amp;</span> <span class="n">names</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">,</span> <span class="n">Json</span><span class="o">::</span><span class="n">Value</span><span class="o">&amp;</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">arg</span><span class="p">,</span> <span class="n">Args</span><span class="o">&amp;</span><span class="p">...</span> <span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">names</span><span class="p">.</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">...(</span><span class="n">Args</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">key</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>
    <span class="n">Object2Json</span><span class="p">(</span><span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>

    <span class="k">return</span> <span class="nf">ParseJson</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jsonTypeValue</span><span class="p">,</span> <span class="n">args</span><span class="p">...);</span>
<span class="p">}</span>

<span class="cm">/** Provider interface*/</span>
<span class="k">template</span><span class="o">&lt;</span><span class="k">typename</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="kt">bool</span> <span class="n">Object2Json</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">jsonTypeStr</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span><span class="o">&amp;</span> <span class="n">obj</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//std::function&lt;Json::Value()&gt;placehoder = [&amp;]()-&gt;Json::Value { return Json::Value(); };
</span><span class="c1"></span>    <span class="c1">//auto func = [&amp;](std::function&lt;Json::Value()&gt;f) { return f(); };
</span><span class="c1"></span>    <span class="c1">//Json::Value val = func(placehoder);
</span><span class="c1"></span>
    <span class="n">Json</span><span class="o">::</span><span class="n">StyledWriter</span> <span class="n">writer</span><span class="p">;</span>
    <span class="n">Json</span><span class="o">::</span><span class="n">Value</span> <span class="n">root</span><span class="p">;</span>
    <span class="k">const</span> <span class="kt">bool</span> <span class="n">result</span> <span class="o">=</span> <span class="n">Object2Json</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="n">obj</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">jsonTypeStr</span> <span class="o">=</span> <span class="n">writer</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">root</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/c&#43;&#43;/">c&#43;&#43;</a>
          <a href="/tags/json/">json</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-02/tcp-connection/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Does the original TCP connection still exist after disconnecting the network cable?</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-02/webgpu-buffer-mapping/">
            <span class="next-text nav-default">Buffer mapping mechanism in WebGPU</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
