<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Nine years on, what has TLS 1.3 brought? - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Nine years after the release of TLS 1.2, and four long years of agreement on it, TLS 1.3 is now available, designed with the simple goal of making data transfers faster and more secure.
More secure TLS uses a hybrid encryption process, which means that symmetric encryption is used during communication and the key for that encryption is negotiated through asymmetric encryption. The MAC algorithm is used for integrity checking and the certificate system is used for authentication." /><meta name="keywords" content="Tls 13" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2022-02/tls-13/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Nine years on, what has TLS 1.3 brought?" />
<meta property="og:description" content="Nine years after the release of TLS 1.2, and four long years of agreement on it, TLS 1.3 is now available, designed with the simple goal of making data transfers faster and more secure.
More secure TLS uses a hybrid encryption process, which means that symmetric encryption is used during communication and the key for that encryption is negotiated through asymmetric encryption. The MAC algorithm is used for integrity checking and the certificate system is used for authentication." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2022-02/tls-13/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-02-19T11:33:40+08:00" />
<meta property="article:modified_time" content="2022-02-19T11:33:40+08:00" />

<meta itemprop="name" content="Nine years on, what has TLS 1.3 brought?">
<meta itemprop="description" content="Nine years after the release of TLS 1.2, and four long years of agreement on it, TLS 1.3 is now available, designed with the simple goal of making data transfers faster and more secure.
More secure TLS uses a hybrid encryption process, which means that symmetric encryption is used during communication and the key for that encryption is negotiated through asymmetric encryption. The MAC algorithm is used for integrity checking and the certificate system is used for authentication."><meta itemprop="datePublished" content="2022-02-19T11:33:40+08:00" />
<meta itemprop="dateModified" content="2022-02-19T11:33:40+08:00" />
<meta itemprop="wordCount" content="1195">
<meta itemprop="keywords" content="tls," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Nine years on, what has TLS 1.3 brought?"/>
<meta name="twitter:description" content="Nine years after the release of TLS 1.2, and four long years of agreement on it, TLS 1.3 is now available, designed with the simple goal of making data transfers faster and more secure.
More secure TLS uses a hybrid encryption process, which means that symmetric encryption is used during communication and the key for that encryption is negotiated through asymmetric encryption. The MAC algorithm is used for integrity checking and the certificate system is used for authentication."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Nine years on, what has TLS 1.3 brought?</h1>

      <div class="post-meta">
        <span class="post-time"> 2022-02-19 11:33:40 </span>
        <div class="post-category">
            <a href="/categories/tutorials/"> tutorials </a>
            </div>
          <span class="more-meta"> 1195 words </span>
          <span class="more-meta"> 6 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#more-secure">More secure</a>
          <ul>
            <li><a href="#forward-security">Forward Security</a></li>
            <li><a href="#rsa-and-dh">RSA and DH</a></li>
            <li><a href="#more-potential-pitfalls">More potential pitfalls</a></li>
            <li><a href="#too-much-choice-is-not-a-good-thing">Too much choice is not a good thing</a></li>
          </ul>
        </li>
        <li><a href="#faster">Faster</a>
          <ul>
            <li><a href="#1-rtt">1-RTT</a></li>
            <li><a href="#0-rtt">0-RTT</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Nine years after the release of TLS 1.2, and four long years of agreement on it, TLS 1.3 is now available, designed with the simple goal of making data transfers faster and more secure.</p>
<h2 id="more-secure">More secure</h2>
<p>TLS uses a hybrid encryption process, which means that symmetric encryption is used during communication and the key for that encryption is negotiated through asymmetric encryption. The MAC algorithm is used for integrity checking and the certificate system is used for authentication. This process may sound perfect, but the reality is not always so rosy.</p>
<h3 id="forward-security">Forward Security</h3>
<p>Forward Secrecy (FS), also known as Perfect Forward Secrecy (PFS), is a concept in cryptography that refers to the fact that a compromise of a long-used master key does not result in the compromise of keys from past sessions; in other words, if an attacker saves traffic from past encrypted sessions and also obtains the private key, it still cannot decrypt all sessions.</p>
<p>Forward security is one of the most critical features in TLS 1.3.</p>
<h3 id="rsa-and-dh">RSA and DH</h3>
<p>The key part of the TLS handshake is to negotiate the key for subsequent communication, which is divided into two key exchange algorithms, RSA and Diffie-Hellman.</p>
<p>RSA is a common and simple algorithm for exchanging keys, i.e., the client decides the key and transmits it to the other party encrypted with the server&rsquo;s public key, so that both communicating parties have the key for subsequent communication.</p>
<p>Diffie-Hellman (DH) is another algorithm for exchanging keys, where both the client and the server generate a pair of public and private keys, and then send the public key to the other party. After both parties get the other party&rsquo;s public key, they use digital signatures to ensure that the public key has not been tampered with, and then combine it with their own private keys to compute the same key.</p>
<p>Both methods were once used to exchange keys, but RSA has the disadvantage that it is not forward-secure, because when the server private key is compromised, all communications can be decrypted and the security depends entirely on the security of the server private key. For DH algorithm, as long as a new key pair is generated for each communication, the decrypted key will be different for each communication.</p>
<p>To ensure forward security, the RSA algorithm is <strong>removed</strong> from TLS 1.3, and Diffie-Hellman is the <strong>only</strong> key exchange algorithm.</p>
<h3 id="more-potential-pitfalls">More potential pitfalls</h3>
<p>Besides the above mentioned key exchange algorithms are problematic, some symmetric encryption algorithms and digital signature algorithms also have vulnerabilities, such as CBC, RC4, SHA1.</p>
<p>The method of computing MAC before encryption also has security risks, so the mechanism of using MAC for block encryption and stream encryption is also deprecated, and AEAD becomes the only choice.</p>
<p>At the same time, compression of encrypted TLS messages is vulnerable and is no longer allowed; DH itself has forward security and renegotiation is no longer allowed. The mechanism by which the <code>Change Cipher Spec</code> used to determine when to start transmitting encrypted data is also deprecated, as it can be started naturally with the completion of the handshake.</p>
<p>In addition, in the past, the handshake server signed only part of the content, and the part of the negotiation using the algorithm suite was not signed, and an attack would have tampered with this part, forcing both communicating parties to use weak ciphers and weak algorithm suites. But these too are now history, as TLS 1.3 signs the entire handshake, and the plaintext part of the handshake phase is greatly reduced.</p>
<blockquote>
<p>Unfortunately, SNI is still a clear-text transmission</p>
</blockquote>
<h3 id="too-much-choice-is-not-a-good-thing">Too much choice is not a good thing</h3>
<p>The algorithm suite for TLS negotiation covers almost all the details of a connection, and a suite of algorithms includes the following.</p>
<ul>
<li>Supported certificate types</li>
<li>Hashing algorithms for deriving keys (SHA1, SHA256, &hellip;)</li>
<li>Message Authentication (MAC) functions (HMAC with SHA1, SHA256, &hellip;)</li>
<li>Key exchange algorithms (RSA, ECDHE, &hellip;)</li>
<li>Algorithms for symmetric encryption (AES, RC4, &hellip;)</li>
<li>Algorithms working in encryption mode (CBC, &hellip;)</li>
</ul>
<p>Each part of the past TLS offered a large number of options, which, together with various combinations, resulted in a large number of smelly and long names like DHE-RSA-AES256-GCM-SHA384.</p>
<p>TLS 1.3 simplifies the negotiation of the algorithm suite by removing all known insecure algorithms, while changing the algorithm suite into three orthogonal parts.</p>
<ul>
<li>the encryption algorithm and the HKDF hash algorithm</li>
<li>Key exchange algorithm</li>
<li>Signature algorithm</li>
</ul>
<blockquote>
<p>HKDF (HMAC based Key Derivation Function) is to solve the lack of randomness in generating keys, so that the hash value of the handshake phase and the negotiated key can be passed through this function to obtain a more secure key.</p>
</blockquote>
<p>Compared to 1.2, which has more than thirty algorithm suites, 1.3 currently has only these five suites.</p>
<ul>
<li>TLS_AES_256_GCM_SHA384</li>
<li>TLS_CHACHA20_POLY1305_SHA256</li>
<li>TLS_AES_128_GCM_SHA256</li>
<li>TLS_AES_128_CCM_8_SHA256</li>
<li>TLS_AES_128_CCM_SHA256</li>
</ul>
<h2 id="faster">Faster</h2>
<p>Let&rsquo;s recall the time taken for the TLS 1.2 handshake.</p>
<ol>
<li>client →→ server: Client Hello (supported encryption suites, key negotiation material, etc.)</li>
<li>client ←← server: Server Hello (certificate, selected cipher suite, etc.)</li>
<li>Client →→ Server: Pre Master Key (RSA) or Client Public Key (DH)</li>
</ol>
<p>At this point both parties have obtained all the materials needed to calculate the session key and can subsequently start using the negotiated key to continue communication, a process that takes 1.5 RTT.</p>
<h3 id="1-rtt">1-RTT</h3>
<p>Yes, TLS 1.3 reduces the RTT by half, thanks to the simplification of key negotiation. Now we can only choose DH, and the server can support so few parameters that it is so easy to guess, so the client can send the first message with the public key and all the key negotiation material directly, rather than waiting until the server chooses the suite to adopt.</p>
<p>Thus, the handshake process can now be simplified as follows</p>
<ol>
<li>client →→ server: client&rsquo;s public key</li>
<li>client ←← server: certificate, server&rsquo;s public key</li>
</ol>
<p>In the rare case that a server is not supported, then a HelloRetryRequest is sent to retry the connection, but this is extremely rare.</p>
<h3 id="0-rtt">0-RTT</h3>
<p>Yes, you read that right, it is possible to send encrypted content directly without RTT, just like HTTP.</p>
<p>Of course, this assumes that the client has already established a connection with the server, after which both parties can export something called a <strong>Pre-Shared Key</strong> (PSK), the server sends the client a session id or session credentials for subsequent resumption of the connection, and then uses the parameters of the previous communication to continue the communication.</p>
<p>While 0-RTT is great in terms of performance, it comes at the cost of forward security, and there is also the problem of replay attacks. Because neither side communicates before sending, the data is not interactive, so an attacker can capture the packet and resend it, and the server is likely to consider it valid and accept it, which can be risky if the operation is one that has side effects, such as modifying the server state.</p>
<p>Therefore, for clients, only secure data should be placed in 0-RTT data, such as HTTP GET requests.</p>
<h2 id="summary">Summary</h2>
<p>In short, TLS 1.3 is another human struggle against security and RTT. Forward security is implemented, leaving only the currently secure algorithms, and the time required to connect is further reduced to 1-RTT, with 0-RTT possible in special cases.</p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/tls/">tls</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2022-02/type-deduction/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Type derivation in modern C&#43;&#43;</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2022-02/esni-ech/">
            <span class="next-text nav-default">The Past Life of ESNI and ECH</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
