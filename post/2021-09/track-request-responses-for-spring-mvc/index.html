<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>How to track http request responses for Spring MVC - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Certain business requirements require tracking access to our http service, that is, logging the requests and responses. The basic logging dimension contains request parameters (path query parameters, request body), request path (uri), request method (method), request headers (headers), and response status, response headers, and even contains sensitive response bodies, etc. Today summarizes several methods, you can choose as needed.
How request tracking is implemented Gateway Many gateway facilities have httptrace capabilities that help us centrally log request traffic." /><meta name="keywords" content="QSpring MVC, track http request responses" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-09/track-request-responses-for-spring-mvc/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="How to track http request responses for Spring MVC" />
<meta property="og:description" content="Certain business requirements require tracking access to our http service, that is, logging the requests and responses. The basic logging dimension contains request parameters (path query parameters, request body), request path (uri), request method (method), request headers (headers), and response status, response headers, and even contains sensitive response bodies, etc. Today summarizes several methods, you can choose as needed.
How request tracking is implemented Gateway Many gateway facilities have httptrace capabilities that help us centrally log request traffic." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-09/track-request-responses-for-spring-mvc/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-09-03T17:19:43+08:00" />
<meta property="article:modified_time" content="2021-09-03T17:19:43+08:00" />

<meta itemprop="name" content="How to track http request responses for Spring MVC">
<meta itemprop="description" content="Certain business requirements require tracking access to our http service, that is, logging the requests and responses. The basic logging dimension contains request parameters (path query parameters, request body), request path (uri), request method (method), request headers (headers), and response status, response headers, and even contains sensitive response bodies, etc. Today summarizes several methods, you can choose as needed.
How request tracking is implemented Gateway Many gateway facilities have httptrace capabilities that help us centrally log request traffic."><meta itemprop="datePublished" content="2021-09-03T17:19:43+08:00" />
<meta itemprop="dateModified" content="2021-09-03T17:19:43+08:00" />
<meta itemprop="wordCount" content="1279">
<meta itemprop="keywords" content="spring-mvc," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to track http request responses for Spring MVC"/>
<meta name="twitter:description" content="Certain business requirements require tracking access to our http service, that is, logging the requests and responses. The basic logging dimension contains request parameters (path query parameters, request body), request path (uri), request method (method), request headers (headers), and response status, response headers, and even contains sensitive response bodies, etc. Today summarizes several methods, you can choose as needed.
How request tracking is implemented Gateway Many gateway facilities have httptrace capabilities that help us centrally log request traffic."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">How to track http request responses for Spring MVC</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-09-03 17:19:43 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 1279 words </span>
          <span class="more-meta"> 7 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#how-request-tracking-is-implemented">How request tracking is implemented</a>
          <ul>
            <li><a href="#gateway">Gateway</a></li>
            <li><a href="#spring-boot-actuator">Spring Boot Actuator</a></li>
            <li><a href="#commonsrequestloggingfilter">CommonsRequestLoggingFilter</a></li>
            <li><a href="#responsebodyadvice">ResponseBodyAdvice</a></li>
            <li><a href="#logstash-logback-encoder">logstash-logback-encoder</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Certain business requirements require tracking access to our http service, that is, logging the requests and responses. The basic logging dimension contains request parameters (path query parameters, request body), request path (uri), request method (method), request headers (headers), and response status, response headers, and even contains sensitive response bodies, etc. Today summarizes several methods, you can choose as needed.</p>
<h2 id="how-request-tracking-is-implemented">How request tracking is implemented</h2>
<h3 id="gateway">Gateway</h3>
<p>Many gateway facilities have httptrace capabilities that help us centrally log request traffic. orange, Kong, Apache Apisix, and other Nginx-based gateways have this capability, and even Nginx itself provides the ability to log httptrace logs.</p>
<blockquote>
<p>The advantage is that httptrace logs can be managed centrally, free of development; the disadvantage is the high technical requirements and the need for supporting distribution, storage and query facilities.</p>
</blockquote>
<h3 id="spring-boot-actuator">Spring Boot Actuator</h3>
<p>In Spring Boot, simple tracking is actually provided. You just need to integrate.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-actuator<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>enable <code>/actuator/httptrace</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">management</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">endpoints</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">web</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">exposure</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">include</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;httptrace&#39;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>You can get the most recent Http request information through <code>http://server:port/actuator/httptrace</code></p>
<blockquote>
<p>However, in the latest versions it may be necessary to explicitly declare how this trace information is stored, i.e. by implementing the <code>HttpTraceRepository</code> interface and injecting <strong>Spring IoC</strong>.</p>
</blockquote>
<p>For example in memory and limited to the last 100 entries (<strong>not recommended for production use</strong>).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="n">HttpTraceRepository</span> <span class="nf">httpTraceRepository</span><span class="o">(){</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">InMemoryHttpTraceRepository</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>The trace log is presented in <code>json</code> format.</p>
<p><img src="https://oscimg.oschina.net/oscnet/up-cfe5a6ce000079aa257a9813d1a05624197.png" alt=" "></p>
<p>There are not many dimensions recorded, but of course you can try if it is enough.</p>
<blockquote>
<p>The advantage is that it is simple to integrate and virtually eliminates development; the disadvantage is that there are few dimensions to record and a facility needs to be built to buffer the consumption of this log information.</p>
</blockquote>
<h3 id="commonsrequestloggingfilter">CommonsRequestLoggingFilter</h3>
<p>The <strong>Spring Web</strong> module also provides a filter <code>CommonsRequestLoggingFilter</code> that logs the details of the request. It is also relatively simple to configure.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Bean</span>
<span class="n">CommonsRequestLoggingFilter</span>  <span class="nf">loggingFilter</span><span class="o">(){</span>
    <span class="n">CommonsRequestLoggingFilter</span> <span class="n">loggingFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommonsRequestLoggingFilter</span><span class="o">();</span>
    <span class="c1">// Logging Client IP Information
</span><span class="c1"></span>    <span class="n">loggingFilter</span><span class="o">.</span><span class="na">setIncludeClientInfo</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="c1">// Record request header
</span><span class="c1"></span>    <span class="n">loggingFilter</span><span class="o">.</span><span class="na">setIncludeHeaders</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="c1">// If the request header is logged, you can specify which records are logged and which are not
</span><span class="c1"></span>    <span class="c1">// loggingFilter.setHeaderPredicate();
</span><span class="c1"></span>    <span class="c1">// Log the request body, especially the body parameter of the POST request
</span><span class="c1"></span>    <span class="n">loggingFilter</span><span class="o">.</span><span class="na">setIncludePayload</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="c1">// Size limit of request body Default 50
</span><span class="c1"></span>    <span class="n">loggingFilter</span><span class="o">.</span><span class="na">setMaxPayloadLength</span><span class="o">(</span><span class="n">10000</span><span class="o">);</span>
    <span class="c1">//Record query parameters in the request path 
</span><span class="c1"></span>    <span class="n">loggingFilter</span><span class="o">.</span><span class="na">setIncludeQueryString</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">loggingFilter</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>And the <strong>debug</strong> logging for <code>CommonsRequestLoggingFilter</code> must be turned on.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="nt">logging</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="nt">level</span><span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="nt">org</span><span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="nt">springframework</span><span class="p">:</span><span class="w">
</span><span class="w">        </span><span class="nt">web</span><span class="p">:</span><span class="w">
</span><span class="w">          </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span><span class="w">            </span><span class="nt">CommonsRequestLoggingFilter</span><span class="p">:</span><span class="w"> </span><span class="l">debug</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>A request outputs the log twice, once before the first pass through the filter; and once after completing the filter chain.</p>
<p><img src="https://oscimg.oschina.net/oscnet/up-4af721b30ec79e091c9b56847ab41838126.png" alt=" "></p>
<p>Here is one more sentence can actually be converted to output json format.</p>
<blockquote>
<p>The advantages are flexible configuration and comprehensive dimensionality of request tracking, while the disadvantage is that only requests but not responses are logged.</p>
</blockquote>
<h3 id="responsebodyadvice">ResponseBodyAdvice</h3>
<p>The Spring Boot unified return body can actually be logged, so you need to implement it yourself. This is based on the <code>CommonsRequestLoggingFilter</code> method of parsing requests. The response body can also be obtained, but the response header and state are not clear because the life cycle is not clear, so it is not clear whether it is appropriate to obtain here, but it is an idea.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="cm">/**
</span><span class="cm"> * @author felord.cn
</span><span class="cm"> * @since 1.0.8.RELEASE
</span><span class="cm"> */</span>
<span class="nd">@Slf4j</span>
<span class="nd">@RestControllerAdvice</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;cn.felord.logging&#34;</span><span class="o">})</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RestBodyAdvice</span> <span class="kd">implements</span> <span class="n">ResponseBodyAdvice</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">DEFAULT_MAX_PAYLOAD_LENGTH</span> <span class="o">=</span> <span class="n">10000</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">REQUEST_MESSAGE_PREFIX</span> <span class="o">=</span> <span class="s">&#34;Request [&#34;</span><span class="o">;</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">REQUEST_MESSAGE_SUFFIX</span> <span class="o">=</span> <span class="s">&#34;]&#34;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supports</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">returnType</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">HttpMessageConverter</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">converterType</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@SneakyThrows</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">beforeBodyWrite</span><span class="o">(</span><span class="n">Object</span> <span class="n">body</span><span class="o">,</span>
                                  <span class="n">MethodParameter</span> <span class="n">returnType</span><span class="o">,</span>
                                  <span class="n">MediaType</span> <span class="n">selectedContentType</span><span class="o">,</span>
                                  <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">HttpMessageConverter</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">selectedConverterType</span><span class="o">,</span>
                                  <span class="n">ServerHttpRequest</span> <span class="n">request</span><span class="o">,</span>
                                  <span class="n">ServerHttpResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>

        <span class="n">ServletServerHttpRequest</span> <span class="n">servletServerHttpRequest</span> <span class="o">=</span> <span class="o">(</span><span class="n">ServletServerHttpRequest</span><span class="o">)</span> <span class="n">request</span><span class="o">;</span>

        <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="n">createRequestMessage</span><span class="o">(</span><span class="n">servletServerHttpRequest</span><span class="o">.</span><span class="na">getServletRequest</span><span class="o">(),</span> <span class="n">REQUEST_MESSAGE_PREFIX</span><span class="o">,</span> <span class="n">REQUEST_MESSAGE_SUFFIX</span><span class="o">));</span>
        <span class="n">Rest</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">objectRest</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">body</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">objectRest</span> <span class="o">=</span> <span class="n">RestBody</span><span class="o">.</span><span class="na">okData</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">emptyMap</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">Rest</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">body</span><span class="o">.</span><span class="na">getClass</span><span class="o">()))</span> <span class="o">{</span>
            <span class="n">objectRest</span> <span class="o">=</span> <span class="o">(</span><span class="n">Rest</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;)</span> <span class="n">body</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">checkPrimitive</span><span class="o">(</span><span class="n">body</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">RestBody</span><span class="o">.</span><span class="na">okData</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">singletonMap</span><span class="o">(</span><span class="s">&#34;result&#34;</span><span class="o">,</span> <span class="n">body</span><span class="o">));</span>
        <span class="o">}</span><span class="k">else</span> <span class="o">{</span>
            <span class="n">objectRest</span> <span class="o">=</span> <span class="n">RestBody</span><span class="o">.</span><span class="na">okData</span><span class="o">(</span><span class="n">body</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&#34;Response Body [&#34;</span><span class="o">+</span> <span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">objectRest</span><span class="o">)</span> <span class="o">+</span><span class="s">&#34;]&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">objectRest</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">private</span> <span class="kt">boolean</span> <span class="nf">checkPrimitive</span><span class="o">(</span><span class="n">Object</span> <span class="n">body</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">clazz</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">clazz</span><span class="o">.</span><span class="na">isPrimitive</span><span class="o">()</span>
                <span class="o">||</span> <span class="n">clazz</span><span class="o">.</span><span class="na">isArray</span><span class="o">()</span>
                <span class="o">||</span> <span class="n">Collection</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">clazz</span><span class="o">)</span>
                <span class="o">||</span> <span class="n">body</span> <span class="k">instanceof</span> <span class="n">Number</span>
                <span class="o">||</span> <span class="n">body</span> <span class="k">instanceof</span> <span class="n">Boolean</span>
                <span class="o">||</span> <span class="n">body</span> <span class="k">instanceof</span> <span class="n">Character</span>
                <span class="o">||</span> <span class="n">body</span> <span class="k">instanceof</span> <span class="n">String</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">createRequestMessage</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">String</span> <span class="n">prefix</span><span class="o">,</span> <span class="n">String</span> <span class="n">suffix</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">StringBuilder</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
        <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">prefix</span><span class="o">);</span>
        <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getMethod</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&#34; &#34;</span><span class="o">);</span>
        <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">());</span>


        <span class="n">String</span> <span class="n">queryString</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">queryString</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="sc">&#39;?&#39;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">queryString</span><span class="o">);</span>
        <span class="o">}</span>


        <span class="n">String</span> <span class="n">client</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">hasLength</span><span class="o">(</span><span class="n">client</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;, client=&#34;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">client</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">HttpSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getSession</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">session</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;, session=&#34;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">session</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="o">}</span>
        <span class="n">String</span> <span class="n">user</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRemoteUser</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">user</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;, user=&#34;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">HttpHeaders</span> <span class="n">headers</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServletServerHttpRequest</span><span class="o">(</span><span class="n">request</span><span class="o">).</span><span class="na">getHeaders</span><span class="o">();</span>
        <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;, headers=&#34;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">headers</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">payload</span> <span class="o">=</span> <span class="n">getMessagePayload</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">payload</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&#34;, payload=&#34;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">payload</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">msg</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">suffix</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">msg</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">protected</span> <span class="n">String</span> <span class="nf">getMessagePayload</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">ContentCachingRequestWrapper</span> <span class="n">wrapper</span> <span class="o">=</span>
                <span class="n">WebUtils</span><span class="o">.</span><span class="na">getNativeRequest</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">ContentCachingRequestWrapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">wrapper</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="n">wrapper</span><span class="o">.</span><span class="na">getContentAsByteArray</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">buf</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">Math</span><span class="o">.</span><span class="na">min</span><span class="o">(</span><span class="n">buf</span><span class="o">.</span><span class="na">length</span><span class="o">,</span> <span class="n">DEFAULT_MAX_PAYLOAD_LENGTH</span><span class="o">);</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="k">new</span> <span class="n">String</span><span class="o">(</span><span class="n">buf</span><span class="o">,</span> <span class="n">0</span><span class="o">,</span> <span class="n">length</span><span class="o">,</span> <span class="n">wrapper</span><span class="o">.</span><span class="na">getCharacterEncoding</span><span class="o">());</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">UnsupportedEncodingException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="s">&#34;[unknown]&#34;</span><span class="o">;</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Don&rsquo;t forget to configure the logging level of <code>ResponseBodyAdvice</code> to be <code>DEBUG</code>.</p>
<h3 id="logstash-logback-encoder">logstash-logback-encoder</h3>
<p>This is logstash&rsquo;s logback encoder that structures the output of httptrace as json.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>net.logstash.logback<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>logstash-logback-encoder<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>6.6<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Add a <code>ConsoleAppender</code> as <code>LogstashEncoder</code> in the logback configuration</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;appender</span> <span class="na">name=</span><span class="s">&#34;jsonConsoleAppender&#34;</span> <span class="na">class=</span><span class="s">&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;encoder</span> <span class="na">class=</span><span class="s">&#34;net.logstash.logback.encoder.LogstashEncoder&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/appender&gt;</span>
    <span class="nt">&lt;root</span> <span class="na">level=</span><span class="s">&#34; INFO&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&#34;jsonConsoleAppender&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/root&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>Then implement a Filter for parsing as well:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="kn">import</span> <span class="nn">org.slf4j.Logger</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.LoggerFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.slf4j.MDC</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.core.annotation.Order</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletRequest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.HttpServletResponse</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.UUID</span><span class="o">;</span>

<span class="cm">/**
</span><span class="cm"> * @author felord.cn
</span><span class="cm"> * @since 1.0.8.RELEASE
</span><span class="cm"> */</span>
<span class="nd">@Order</span><span class="o">(</span><span class="n">1</span><span class="o">)</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MDCFilter</span> <span class="kd">implements</span> <span class="n">Filter</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">LOGGER</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">MDCFilter</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">X_REQUEST_ID</span> <span class="o">=</span> <span class="s">&#34;X-Request-ID&#34;</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doFilter</span><span class="o">(</span><span class="n">ServletRequest</span> <span class="n">request</span><span class="o">,</span>
                         <span class="n">ServletResponse</span> <span class="n">response</span><span class="o">,</span>
                         <span class="n">FilterChain</span> <span class="n">chain</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span> <span class="o">{</span>
        <span class="n">HttpServletRequest</span> <span class="n">req</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpServletRequest</span><span class="o">)</span> <span class="n">request</span><span class="o">;</span>
        <span class="n">HttpServletResponse</span> <span class="n">res</span> <span class="o">=</span> <span class="o">(</span><span class="n">HttpServletResponse</span><span class="o">)</span> <span class="n">response</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">addXRequestId</span><span class="o">(</span><span class="n">req</span><span class="o">);</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;path: {}, method: {}, query {}&#34;</span><span class="o">,</span>
                    <span class="n">req</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">(),</span> <span class="n">req</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(),</span> <span class="n">req</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">());</span>
            <span class="n">res</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="n">X_REQUEST_ID</span><span class="o">,</span> <span class="n">MDC</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">X_REQUEST_ID</span><span class="o">));</span>
            <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;statusCode {}, path: {}, method: {}, query {}&#34;</span><span class="o">,</span>
                    <span class="n">res</span><span class="o">.</span><span class="na">getStatus</span><span class="o">(),</span> <span class="n">req</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">(),</span> <span class="n">req</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(),</span> <span class="n">req</span><span class="o">.</span><span class="na">getQueryString</span><span class="o">());</span>
            <span class="n">MDC</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">addXRequestId</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">xRequestId</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="n">X_REQUEST_ID</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">xRequestId</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">X_REQUEST_ID</span><span class="o">,</span> <span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">X_REQUEST_ID</span><span class="o">,</span> <span class="n">xRequestId</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>The parsing approach here could actually be a bit more refined.</p>
</blockquote>
<p>Not only can the interface request log be recorded, but it can also be structured as json.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span><span class="nt">&#34;@timestamp&#34;</span><span class="p">:</span><span class="s2">&#34;2021-08-10T23:48:51.322+08:00&#34;</span><span class="p">,</span><span class="nt">&#34;@version&#34;</span><span class="p">:</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="nt">&#34;message&#34;</span><span class="p">:</span><span class="s2">&#34;statusCode 200, path: /log/get, method: GET, query foo=xxx&amp;bar=ooo&#34;</span><span class="p">,</span><span class="nt">&#34;logger_name&#34;</span><span class="p">:</span><span class="s2">&#34;cn.felord.logging.MDCFilter&#34;</span><span class="p">,</span><span class="nt">&#34;thread_name&#34;</span><span class="p">:</span><span class="s2">&#34;http-nio-8080-exec-1&#34;</span><span class="p">,</span><span class="nt">&#34;level&#34;</span><span class="p">:</span><span class="s2">&#34;INFO&#34;</span><span class="p">,</span><span class="nt">&#34;level_value&#34;</span><span class="p">:</span><span class="mi">20000</span><span class="p">,</span><span class="nt">&#34;X-Request-ID&#34;</span><span class="p">:</span><span class="s2">&#34;7c0db56c-b1f2-4d85-ad9a-7ead67660f96&#34;</span><span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="summary">Summary</h2>
<p>Today introduced a number of records tracking interface request response method, relatively simple, if your project to do a large may need to use the link tracking.</p>
<hr>
<p>Reference <code>https://my.oschina.net/10000000000/blog/5182314</code></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/spring-mvc/">spring-mvc</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-09/improving-git-protocol-security-github/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">GitHub: The Unencrypted Git Protocol Is About to Become History</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-09/qt-6-2-lts-cover-5-15/">
            <span class="next-text nav-default">Qt 6.2 LTS features may completely override Qt 5.15</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
