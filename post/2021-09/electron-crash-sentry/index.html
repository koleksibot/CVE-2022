<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Electron self-compiled application crash debugging analysis method - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Application crashes in Electron If the exception is only caused by Javascript, you can listen for the relevant Error type event in the application logic and handle it. By listening for crashed related events, you can listen for and respond to application crashes within the application. 1 2 3 4 app.on(&amp;#39;gpu-process-crashed&amp;#39;, (_event, killed) =&amp;gt; {}); app.on(&amp;#39;renderer-process-crashed&amp;#39;, (_e, _w, killed) =&amp;gt; {}); mainWindow.webContents.on(&amp;#39;plugin-crashed&amp;#39;, (_ev, name, version) =&amp;gt; {}); mainWindow.webContents.on(&amp;#39;crashed&amp;#39;, (ev, killed)" /><meta name="keywords" content="electron, Crash, Sentry" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-09/electron-crash-sentry/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Electron self-compiled application crash debugging analysis method" />
<meta property="og:description" content="Application crashes in Electron If the exception is only caused by Javascript, you can listen for the relevant Error type event in the application logic and handle it. By listening for crashed related events, you can listen for and respond to application crashes within the application. 1 2 3 4 app.on(&#39;gpu-process-crashed&#39;, (_event, killed) =&gt; {}); app.on(&#39;renderer-process-crashed&#39;, (_e, _w, killed) =&gt; {}); mainWindow.webContents.on(&#39;plugin-crashed&#39;, (_ev, name, version) =&gt; {}); mainWindow.webContents.on(&#39;crashed&#39;, (ev, killed)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-09/electron-crash-sentry/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-09-22T16:09:40+08:00" />
<meta property="article:modified_time" content="2021-09-22T16:09:40+08:00" />

<meta itemprop="name" content="Electron self-compiled application crash debugging analysis method">
<meta itemprop="description" content="Application crashes in Electron If the exception is only caused by Javascript, you can listen for the relevant Error type event in the application logic and handle it. By listening for crashed related events, you can listen for and respond to application crashes within the application. 1 2 3 4 app.on(&#39;gpu-process-crashed&#39;, (_event, killed) =&gt; {}); app.on(&#39;renderer-process-crashed&#39;, (_e, _w, killed) =&gt; {}); mainWindow.webContents.on(&#39;plugin-crashed&#39;, (_ev, name, version) =&gt; {}); mainWindow.webContents.on(&#39;crashed&#39;, (ev, killed)"><meta itemprop="datePublished" content="2021-09-22T16:09:40+08:00" />
<meta itemprop="dateModified" content="2021-09-22T16:09:40+08:00" />
<meta itemprop="wordCount" content="2155">
<meta itemprop="keywords" content="electron," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Electron self-compiled application crash debugging analysis method"/>
<meta name="twitter:description" content="Application crashes in Electron If the exception is only caused by Javascript, you can listen for the relevant Error type event in the application logic and handle it. By listening for crashed related events, you can listen for and respond to application crashes within the application. 1 2 3 4 app.on(&#39;gpu-process-crashed&#39;, (_event, killed) =&gt; {}); app.on(&#39;renderer-process-crashed&#39;, (_e, _w, killed) =&gt; {}); mainWindow.webContents.on(&#39;plugin-crashed&#39;, (_ev, name, version) =&gt; {}); mainWindow.webContents.on(&#39;crashed&#39;, (ev, killed)"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Electron self-compiled application crash debugging analysis method</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-09-22 16:09:40 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 2155 words </span>
          <span class="more-meta"> 5 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#application-crashes-in-electron">Application crashes in Electron</a></li>
        <li><a href="#application-crash-files-in-electron">Application crash files in Electron</a></li>
        <li><a href="#electron-crash-file-analysis">Electron crash file analysis</a>
          <ul>
            <li><a href="#what-is-the-application-symbols-file-symbols">What is the application symbols file (Symbols)</a></li>
            <li><a href="#debugging-electron-with-windbg">Debugging Electron with Windbg</a></li>
            <li><a href="#analysis-using-the-sentry-platform">Analysis using the Sentry platform</a></li>
            <li><a href="#compile-your-own-symbols-file-for-electron">Compile your own symbols file for Electron</a></li>
            <li><a href="#sentry-upload-of-self-coded-electron-symbol-files">Sentry upload of self-coded Electron symbol files</a></li>
          </ul>
        </li>
        <li><a href="#related-issues-and-solutions">Related issues and solutions</a>
          <ul>
            <li><a href="#the-default-release-version-pdb-file-output-by-electron-compilation-is-too-large">The default release version pdb file output by Electron compilation is too large</a></li>
            <li><a href="#failed-to-generate-sym-file-using-dump_symsexe">Failed to generate sym file using dump_syms.exe</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h2 id="application-crashes-in-electron">Application crashes in Electron</h2>
<p>If the exception is only caused by Javascript, you can listen for the relevant Error type event in the application logic and handle it. By listening for <code>crashed</code> related events, you can listen for and respond to application crashes within the application.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;gpu-process-crashed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">_event</span><span class="p">,</span> <span class="nx">killed</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{});</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;renderer-process-crashed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">_e</span><span class="p">,</span> <span class="nx">_w</span><span class="p">,</span> <span class="nx">killed</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{});</span>
<span class="nx">mainWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;plugin-crashed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">_ev</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">version</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{});</span>
<span class="nx">mainWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;crashed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">ev</span><span class="p">,</span> <span class="nx">killed</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{});</span>
</code></pre></td></tr></table>
</div>
</div><p>The above code can only listen to and handle <code>crashed</code> events, but it can&rsquo;t tell what caused the crash; to analyze the details, you need to get the <code>minidump</code> file where the crash occurred and debug it.</p>
<h2 id="application-crash-files-in-electron">Application crash files in Electron</h2>
<p>Only when <code>crashReporter.start</code> is executed in the Electron application will the crash-related directory and file information be generated. The following sample code is referenced from the official documentation.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="p">{</span> <span class="nx">crashReporter</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">);</span>
 
<span class="nx">crashReporter</span><span class="p">.</span><span class="nx">start</span><span class="p">({</span>
  <span class="nx">productName</span><span class="o">:</span> <span class="s1">&#39;YourName&#39;</span><span class="p">,</span>
  <span class="nx">companyName</span><span class="o">:</span> <span class="s1">&#39;YourCompany&#39;</span><span class="p">,</span>
  <span class="nx">submitURL</span><span class="o">:</span> <span class="s1">&#39;https://your-domain.com/url-to-submit&#39;</span><span class="p">,</span>
  <span class="nx">uploadToServer</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><p>Create a crash:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="nx">process</span><span class="p">.</span><span class="nx">crash</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><p>Find crash files.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">).</span><span class="nx">remote</span><span class="p">.</span><span class="nx">app</span><span class="p">;</span>
 
<span class="c1">// 对于支持 crashDumps 的版本，获取崩溃文件路径
</span><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="s1">&#39;crashDumps&#39;</span><span class="p">);</span>
 
<span class="c1">// 不支持 getPath(&#39;crashDumps&#39;) 的 Electron 版本
</span><span class="c1">// 从 temp 目录下查找 &lt;productName&gt;-Crashes 目录
</span><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="s1">&#39;temp&#39;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><p>By actually testing the above code, the crashed file was found in the temporary directory under the <code>electron@5.x</code> version with the <code>.dmp</code> suffix. As shown in the figure.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/09/22/5640e648960542fc851d3708d259ab4e.png" alt=""></p>
<h2 id="electron-crash-file-analysis">Electron crash file analysis</h2>
<h3 id="what-is-the-application-symbols-file-symbols">What is the application symbols file (Symbols)</h3>
<p>The <code>.dmp</code> file obtained above is a <code>minidump</code> file, which is a file in the crash-to-storage technology format developed by Microsoft. The <code>minidump</code> file contains only the most necessary information to recover the call stack of all threads of the failed process and to see the values of local variables at the moment of failure.</p>
<p>To analyze the <code>minidump</code> file specifically, you need to use the symbols file of the Electron application.</p>
<p>The application symbols file is similar to the sourceMap file in the front-end, which allows debugging tools to map the crash information in the dump file to the original code and parse it. The format of symbols file varies from platform to platform, Windows platform applications are generally in <code>.pdb</code> format.</p>
<p><code>Google breakpad</code> is a cross-platform crash dump and analysis framework and tools collection, it provides tools to support the conversion of crash files under all platforms to <code>Symobol</code> format as defined by <code>Breakpad</code>. The <code>Symobol</code> format is very simple, it is actually a plain text file, one record per line, with a space separating the fields in each record and the first field of each record indicating what type of record the line is.</p>
<p>If you are using the official Electron package, you can download the corresponding symbols file from github at</p>
<ul>
<li><a href="https://github.com/electron/electron/releases">https://github.com/electron/electron/releases</a></li>
</ul>
<p>If it is a self-programmed application, it will output a symbolic file with the same name in the output directory of the executable. For example <code>electron.exe -&gt; electron.exe.pdb</code> .</p>
<h3 id="debugging-electron-with-windbg">Debugging Electron with Windbg</h3>
<p>For the <code>minidump</code> file, you can use <code>Windbg</code> to analyze it under windows. It is included in the windows SDK and you can install the <a href="https://developer.microsoft.com/zh-cn/windows/downloads/windows-10-sdk/">windows 10 SDK</a> directly.</p>
<p>A brief step-by-step procedure is roughly as follows (please consult the official documentation for a more detailed approach).</p>
<ul>
<li>Install the <code>windows 10 SDK</code></li>
<li>Search for <code>Windbg</code> and open it</li>
<li>Press the <code>ctrl+E</code> shortcut and select the <code>electron.exe</code> application file</li>
<li>At the bottom run <code>.reload /f /i electron.exe</code> to load it. This will look for its corresponding symbol file, and will report an error if it is not found. You can place the corresponding symbol file in any directory in the error message, and then re-execute</li>
<li>Press <code>ctrl+s</code> shortcut key to select <code>minidump</code> file to load.</li>
<li>Just analyze it according to the loading situation</li>
</ul>
<p><strong>Related references:</strong></p>
<ul>
<li><a href="https://docs.microsoft.com/zh-cn/windows-hardware/drivers/debugger/debugger-download-tools">https://docs.microsoft.com/zh-cn/windows-hardware/drivers/debugger/debugger-download-tools</a></li>
<li><a href="https://developer.microsoft.com/zh-cn/windows/downloads/windows-10-sdk/">https://developer.microsoft.com/zh-cn/windows/downloads/windows-10-sdk/</a></li>
<li><a href="https://docs.microsoft.com/zh-cn/windows-hardware/drivers/debugger/getting-started-with-windows-debugging">https://docs.microsoft.com/zh-cn/windows-hardware/drivers/debugger/getting-started-with-windows-debugging</a></li>
</ul>
<h3 id="analysis-using-the-sentry-platform">Analysis using the Sentry platform</h3>
<p>Electron provides the official <code>@sentry-cli</code> and <code>@sentry/electron</code> toolkits available through Sentry. By installing and configuring them, you can integrate Sentry in your Electron application, which can help collect and analyze crash files.</p>
<h4 id="installation-and-integration-sentry">Installation and Integration Sentry</h4>
<p>Installing <code>@sentry/electron</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">yarn add -D @sentry/cli
yarn add @sentry/electron
</code></pre></td></tr></table>
</div>
</div><p>Integrating Sentry in Electron Applications.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 用于main 主进程应用中
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">init</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@sentry/electron/dist/main&#39;</span><span class="p">;</span>
<span class="c1">// 用于浏览器渲染进程中
</span><span class="c1"></span><span class="kr">import</span> <span class="p">{</span> <span class="nx">init</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;@sentry/electron/dist/renderer&#39;</span><span class="p">;</span>
 
<span class="nx">init</span><span class="p">({</span>
  <span class="nx">dsn</span><span class="o">:</span> <span class="s1">&#39;https://examplePublicKey@o0.ingest.sentry.io/0&#39;</span><span class="p">,</span>
  <span class="nx">debug</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">APP_ENV</span> <span class="o">!==</span> <span class="s1">&#39;prod&#39;</span><span class="p">,</span>
  <span class="nx">environment</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">APP_ENV</span><span class="p">,</span>
  <span class="nx">release</span><span class="o">:</span> <span class="s1">&#39;release@&#39;</span> <span class="o">+</span> <span class="nx">pkg</span><span class="p">.</span><span class="nx">version</span><span class="p">,</span>
  <span class="nx">beforeSend</span><span class="o">:</span> <span class="nx">data</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">exception</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">exception</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">exception</span> <span class="o">&amp;&amp;</span> <span class="nx">exception</span><span class="p">.</span><span class="nx">values</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// TODO，可以做一些修正累的处理等
</span><span class="c1"></span>    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
  <span class="p">},</span>
<span class="p">});</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="configurator-file-download-and-sentry-upload">Configurator file download and Sentry upload</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">npm install -g @sentry/wizard
<span class="c1"># 登陆 Sentry 并获取相关项目配置信息</span>
sentry-wizard --integration electron --url <span class="s2">&#34;https://mysentry.lzw.me&#34;</span>
<span class="c1"># or 手动填写相关项目配置信息</span>
sentry-wizard --integration electron --skip-connect
</code></pre></td></tr></table>
</div>
</div><p>Follow the prompts and when you are done, a <code>sentry-symbols.js</code> file will be generated. Run it after each Electron update to download the corresponding symbols from the Electron Github Release address and upload them to your configured Sentry server.</p>
<p>For more specific information, please refer to the official documentation at</p>
<ul>
<li><a href="https://docs.sentry.io/platforms/javascript/guides/electron/">https://docs.sentry.io/platforms/javascript/guides/electron/</a></li>
<li><a href="https://www.npmjs.com/package/@sentry/wizard">https://www.npmjs.com/package/@sentry/wizard</a></li>
</ul>
<h4 id="sourcemap-of-javascript-files-uploaded-to-sentry">SourceMap of JavaScript files uploaded to Sentry</h4>
<p>Integrating in <code>webpack</code>, uploading <code>SourceMap</code> to the Sentry server.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="l">yarn add -D @sentry/webpack-plugin</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>To configure the plugin in webpack.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">SentryWebpackPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&#34;@sentry/webpack-plugin&#34;</span><span class="p">);</span>
 
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// other configuration
</span><span class="c1"></span>  <span class="nx">configureWebpack</span><span class="o">:</span> <span class="p">{</span>
    <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
      <span class="k">new</span> <span class="nx">SentryWebpackPlugin</span><span class="p">({</span>
        <span class="c1">// sentry-cli configuration
</span><span class="c1"></span>        <span class="nx">authToken</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SENTRY_AUTH_TOKEN</span><span class="p">,</span>
        <span class="nx">org</span><span class="o">:</span> <span class="s2">&#34;example-org&#34;</span><span class="p">,</span>
        <span class="nx">project</span><span class="o">:</span> <span class="s2">&#34;example-project&#34;</span><span class="p">,</span>
        <span class="nx">release</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">SENTRY_RELEASE</span><span class="p">,</span>
 
        <span class="c1">// webpack specific configuration
</span><span class="c1"></span>        <span class="nx">include</span><span class="o">:</span> <span class="s2">&#34;.&#34;</span><span class="p">,</span>
        <span class="nx">ignore</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;node_modules&#34;</span><span class="p">,</span> <span class="s2">&#34;webpack.config.js&#34;</span><span class="p">],</span>
      <span class="p">}),</span>
    <span class="p">],</span>
  <span class="p">},</span>
<span class="p">};</span>
</code></pre></td></tr></table>
</div>
</div><p>Alternatively, you can use <code>@sentry/cli</code> to upload a <code>SourceMap</code>, for which the official documentation can be found at</p>
<ul>
<li><a href="https://docs.sentry.io/product/cli/releases/#sentry-cli-sourcemaps">https://docs.sentry.io/product/cli/releases/#sentry-cli-sourcemaps</a></li>
</ul>
<h3 id="compile-your-own-symbols-file-for-electron">Compile your own symbols file for Electron</h3>
<p>If it is a self-coded application after modifying the Electron source code, the <code>.pdb</code> type file in the build output directory is the symbols symbol file, such as <code>electron.exe.pdb</code>, etc.</p>
<p>The Sentry platform supports symbol files in <code>Breakpad</code> format. In addition, the Sentry platform also supports Native-style pdb files, but does not support pdb files generated under the <code>.NET</code> platform.</p>
<p>We can use the <code>dump_syms.exe</code> utility to convert <code>pdb</code> format symbol files to <code>Breakpad</code> format. The <code>dump_syms.exe</code> file is in the Electron compilation directory at the following path <code>third_party\breakpad\breakpad\src\tools\windows\binaries\dump_syms.exe</code>. It can also be downloaded at the following address.</p>
<ul>
<li><a href="https://github.com/electron/chromium-breakpad/blob/master/dump_syms.exe">https://github.com/electron/chromium-breakpad/blob/master/dump_syms.exe</a></li>
<li><a href="https://gitee.com/lzw/breakpad-minindump-tools/blob/master/tools/dump_syms.exe">https://gitee.com/lzw/breakpad-minindump-tools/blob/master/tools/dump_syms.exe</a></li>
</ul>
<p>Example of <code>electron.exe.sym</code> file generated using <code>dump_syms.exe</code> tool.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">..<span class="se">\.</span>.<span class="se">\t</span>hird_party<span class="se">\b</span>reakpad<span class="se">\b</span>reakpad<span class="se">\s</span>rc<span class="se">\t</span>ools<span class="se">\w</span>indows<span class="se">\b</span>inaries<span class="se">\d</span>ump_syms.exe out<span class="se">\R</span>elease<span class="se">\e</span>lectron.exe &gt; electron.exe.sym
</code></pre></td></tr></table>
</div>
</div><p>Open the <code>electron.exe.sym</code> file and take a look. It is actually a SourceMap-like text file containing the original filenames and the mapping of variables, functions, methods and so on. The first line contains the system platform, <code>Breakpadid</code> and the corresponding pdb file name.</p>
<h3 id="sentry-upload-of-self-coded-electron-symbol-files">Sentry upload of self-coded Electron symbol files</h3>
<p>The official symbol file downloaded from Electron contains the following information, which we can use to generate a package of the same format and provide to Sentry for upload. The paragraph after the <code>electron.exe.pbd</code> path is <code>Breakpadid</code>, which can be obtained from the first line of the symbol file.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/09/22/46f881e7c7d5440c9ba44c0b9aa3a676.png" alt=""></p>
<p>In fact, the main logic in the <code>sentry-symbols.js</code> file is to download the corresponding symbols according to the currently installed version of Electron and upload them using <code>@sentry/cli</code>. We can also write a similar upload script. Example.</p>
<p>We refer to the <code>electron-&lt;version&gt;-win32-x64-symbols.zip</code> file downloaded from the official website as an example, and generate and compress a zip file of the same structure locally into the <code>.electron-symbols/custom</code> directory.</p>
<p>Generate Symbols symbols files from the Electron compile output directory, main example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="p">{</span> <span class="nx">execSync</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;child_process&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">getArgv</span> <span class="o">=</span> <span class="p">()</span>  <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">d</span> <span class="p">=&gt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^--/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)).</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">res</span><span class="p">,</span> <span class="nx">d</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="kr">const</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">]</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
            <span class="nx">res</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="nx">res</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">;</span>
    <span class="p">},</span> <span class="p">{});</span>
<span class="p">};</span>
<span class="kr">const</span> <span class="nx">argv</span> <span class="o">=</span> <span class="nx">getArgv</span><span class="p">();</span>
 
<span class="kd">function</span> <span class="nx">genSym</span><span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">version</span> <span class="o">=</span> <span class="nx">argv</span><span class="p">.</span><span class="nx">version</span> <span class="o">||</span> <span class="s1">&#39;5.0.13&#39;</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">outDirBase</span> <span class="o">=</span> <span class="s1">&#39;electron-v${version}-win32-&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nx">argv</span><span class="p">.</span><span class="nx">ia32</span> <span class="o">?</span> <span class="s1">&#39;ia32&#39;</span> <span class="o">:</span> <span class="s1">&#39;x64&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-symbols&#39;</span><span class="p">;</span>
    <span class="kr">const</span> <span class="nx">dumpSyms</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="s1">&#39;../../third_party/breakpad/breakpad/src/tools/windows/binaries/dump_syms.exe&#39;</span><span class="p">);</span>
 
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">dumpSyms</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;未找到 dump_syms.exe 文件，请将当前文件放置到构建输出目录中，如 out/Release 下。&#39;</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;NotFound dumpSymsPath:&#39;</span><span class="p">,</span> <span class="nx">dumpSyms</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">outDirBase</span><span class="p">))</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdirSync</span><span class="p">(</span><span class="nx">outDirBase</span><span class="p">,</span> <span class="p">{</span><span class="nx">recursive</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
        <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">outDirBase</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">),</span> <span class="nx">version</span><span class="p">);</span>
 
        <span class="p">[</span><span class="s1">&#39;electron.exe&#39;</span><span class="p">,</span> <span class="s1">&#39;libEGL.dll&#39;</span><span class="p">,</span> <span class="s1">&#39;libGLESv2.dll&#39;</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">filename</span> <span class="p">=&gt;</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">filename</span><span class="p">))</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;未发现文件：&#39;</span><span class="p">,</span> <span class="nx">filename</span><span class="p">);</span>
 
            <span class="kr">const</span> <span class="nx">outFilename</span> <span class="o">=</span> <span class="nx">filename</span> <span class="o">+</span> <span class="s1">&#39;.sym&#39;</span><span class="p">;</span>
            <span class="nx">execSync</span><span class="p">(</span><span class="nx">dumpSyms</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">filename</span> <span class="o">+</span> <span class="s1">&#39; &gt; &#39;</span> <span class="o">+</span> <span class="nx">outFilename</span><span class="p">);</span>
 
            <span class="k">if</span> <span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">outFilename</span><span class="p">))</span> <span class="p">{</span>
                <span class="kr">const</span> <span class="nx">outFileContent</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">outFilename</span><span class="p">,</span> <span class="s1">&#39;utf8&#39;</span><span class="p">);</span>
                <span class="kr">const</span> <span class="nx">firstLine</span> <span class="o">=</span> <span class="nx">outFileContent</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;/n&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">);</span>
                <span class="kr">const</span> <span class="nx">breakpadid</span> <span class="o">=</span> <span class="nx">firstLine</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
 
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">breakpadid</span><span class="p">)</span> <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;sym 文件读取错误:&#39;</span><span class="p">,</span> <span class="nx">firstLine</span><span class="p">);</span>
 
                <span class="kr">const</span> <span class="nx">outFilePath</span> <span class="o">=</span> <span class="nx">outDirBase</span> <span class="o">+</span> <span class="s1">&#39;/breakpad_symbols/&#39;</span> <span class="o">+</span> <span class="nx">breakpadid</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">outFilename</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">dirname</span><span class="p">(</span><span class="nx">outFilePath</span><span class="p">)))</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">mkdirSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">dirname</span><span class="p">(</span><span class="nx">outFilePath</span><span class="p">),</span> <span class="p">{</span><span class="nx">recursive</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
                <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="nx">outFilePath</span><span class="p">,</span> <span class="nx">outFileContent</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;生成文件:&#39;</span><span class="p">,</span> <span class="nx">outFilePath</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;可能生成失败了，未发现生成的文件：&#39;</span><span class="p">,</span> <span class="nx">filename</span><span class="p">,</span> <span class="s1">&#39;=&gt;&#39;</span><span class="p">,</span> <span class="nx">outFilename</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
 
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;执行完成&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
 
<span class="nx">genSym</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><p>Compress the contents of the generated symbols directory into a zip file and place it in a custom directory, such as <code>.electron-symbols/custom</code>, then upload the symbols file to Sentry with the following main code example.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">SentryCli</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@sentry/cli&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">argv</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;yargs&#39;</span><span class="p">).</span><span class="nx">argv</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">zipDir</span> <span class="o">=</span> <span class="nx">argv</span><span class="p">.</span><span class="nx">dir</span> <span class="o">||</span> <span class="s1">&#39;.electron-symbols/custom&#39;</span><span class="p">;</span>
 
<span class="kr">async</span> <span class="kd">function</span> <span class="nx">doUpload</span><span class="p">()</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">sentryCli</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SentryCli</span><span class="p">(</span><span class="nx">argv</span><span class="p">.</span><span class="nx">test</span> <span class="o">?</span> <span class="s1">&#39;./sentry.properties&#39;</span> <span class="o">:</span> <span class="s1">&#39;./sentry.prod.properties&#39;</span><span class="p">);</span>
  <span class="kr">const</span> <span class="nx">zipFiles</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdirSync</span><span class="p">(</span><span class="nx">zipDir</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">name</span> <span class="p">=&gt;</span> <span class="nx">name</span><span class="p">.</span><span class="nx">endsWith</span><span class="p">(</span><span class="s1">&#39;symbols.zip&#39;</span><span class="p">));</span>
 
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">zipFiles</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;未发现可上传的 Symbols 文件！&#39;</span><span class="p">,</span> <span class="nx">zipDir</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
 
  <span class="k">for</span> <span class="p">(</span><span class="kr">const</span> <span class="nx">filename</span> <span class="k">of</span> <span class="nx">zipFiles</span><span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">zipPath</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">zipDir</span><span class="p">,</span> <span class="nx">filename</span><span class="p">);</span>
      <span class="kr">await</span> <span class="nx">sentryCli</span><span class="p">.</span><span class="nx">execute</span><span class="p">([</span><span class="s1">&#39;upload-dif&#39;</span><span class="p">,</span> <span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="s1">&#39;breakpad&#39;</span><span class="p">,</span> <span class="s1">&#39;--no-zips&#39;</span><span class="p">,</span> <span class="nx">zipPath</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
 
<span class="nx">doUpload</span><span class="p">();</span>
</code></pre></td></tr></table>
</div>
</div><p>Execute the test, and if all goes well, the result will be approximately as follows.</p>
<p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/09/22/973e9f335fa54cb5a98a54fbeee9dfdd.png" alt=""></p>
<p>Related references.</p>
<ul>
<li><a href="https://docs.sentry.io/platforms/native/data-management/debug-files/upload/">https://docs.sentry.io/platforms/native/data-management/debug-files/upload/</a></li>
</ul>
<h2 id="related-issues-and-solutions">Related issues and solutions</h2>
<h3 id="the-default-release-version-pdb-file-output-by-electron-compilation-is-too-large">The default release version pdb file output by Electron compilation is too large</h3>
<p>The <code>electron.exe.pdb</code> file size is close to 1.5G to 2G in the directory of the Release version of the compiled output using the default parameters. This is because the default compiled output symbol file contains more information such as source code, you can adjust the output of the symbol file by setting the compile parameter <code>symbol_level=1</code>. This parameter can be added to the configuration file at</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">electron/build/args/release.gn
</code></pre></td></tr></table>
</div>
</div><p>It can also be added to the command line of the generated GN project at</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">gn gen out/Release --args<span class="o">=</span><span class="s2">&#34;import(\&#34;//electron/build/args/release.gn\&#34;) symbol_level=1&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>After setting <code>symbol_level=1</code>, the output <code>electron.exe.pdb</code> is only a little over 100 M in size.</p>
<h3 id="failed-to-generate-sym-file-using-dump_symsexe">Failed to generate sym file using dump_syms.exe</h3>
<p>The error message is as follows.</p>
<blockquote>
<p>CoCreateInstance CLSID_DiaSource {E6756135-1E65-4D17-8576-610761398C3C} failed (msdia*.dll unregistered?)
Open failed</p>
</blockquote>
<p>This is because the system has not registered the <code>msdia*.dll</code> file. From the <code>Visual Studio</code> installation directory, you can search for the <code>msdia120.dll</code> and <code>msdia140 .dll</code> files. Let&rsquo;s register <code>msdia140.dll</code> and that&rsquo;s it.</p>
<p>Start the cmd command prompt as system administrator (shortcut win+x, click &ldquo;Command Prompt (Administrator)&quot;), and then execute the following command to register <code>msdia140.dll</code>: <code>msdia140.dll</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">regsvr32 <span class="s2">&#34;C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\msdia140.dll&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://cdn.jsdelivr.net/gh/b0xt/sobyte-images/2021/09/22/7b86c95d4d364b4f81191704b21b9b8d.png" alt=""></p>
<p>If executed with a non-system administrator cmd, you will get a registration failure message with the error code <code>0x80070005</code>.</p>
<blockquote>
<p>msdia140.dll is loaded, but the call to DllRegisterServer failed with error code 0x80070005</p>
</blockquote>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/electron/">electron</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-09/nodejs-stmp-exchange-email-send/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Ways to send STMP-based emails with MS Exchange using node.js</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-09/webpack-strip-use-strict/">
            <span class="next-text nav-default">webpack build results remove use strict mode</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
