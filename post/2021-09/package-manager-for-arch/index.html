<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>How to make a package for Arch  - SoByte</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6356451834813761" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-E8GRRGBTEZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-E8GRRGBTEZ');
</script>


<meta name="author" content="" /><meta name="description" content="Arch uses the pacman package manager and the package format is tar.zst. Arch provides a number of tools for creating tar.zst packages, first you need to install the base-devel package and the devtools package.
1  pacman -S base-devel devtools   Arch&amp;rsquo;s packaging process works like this, starting with writing a PKGBUILD file that describes all the information needed to build a package, such as where to download the source code from, what the dependencies are, what the build version is, how to build, etc." /><meta name="keywords" content="arch, Package" />






<meta name="generator" content="Hugo 0.92.2 with theme even" />


<link rel="canonical" href="https://www.sobyte.net/post/2021-09/package-manager-for-arch/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="How to make a package for Arch " />
<meta property="og:description" content="Arch uses the pacman package manager and the package format is tar.zst. Arch provides a number of tools for creating tar.zst packages, first you need to install the base-devel package and the devtools package.
1  pacman -S base-devel devtools   Arch&rsquo;s packaging process works like this, starting with writing a PKGBUILD file that describes all the information needed to build a package, such as where to download the source code from, what the dependencies are, what the build version is, how to build, etc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.sobyte.net/post/2021-09/package-manager-for-arch/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-09-14T15:57:07+08:00" />
<meta property="article:modified_time" content="2021-09-14T15:57:07+08:00" />

<meta itemprop="name" content="How to make a package for Arch ">
<meta itemprop="description" content="Arch uses the pacman package manager and the package format is tar.zst. Arch provides a number of tools for creating tar.zst packages, first you need to install the base-devel package and the devtools package.
1  pacman -S base-devel devtools   Arch&rsquo;s packaging process works like this, starting with writing a PKGBUILD file that describes all the information needed to build a package, such as where to download the source code from, what the dependencies are, what the build version is, how to build, etc."><meta itemprop="datePublished" content="2021-09-14T15:57:07+08:00" />
<meta itemprop="dateModified" content="2021-09-14T15:57:07+08:00" />
<meta itemprop="wordCount" content="579">
<meta itemprop="keywords" content="arch," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to make a package for Arch "/>
<meta name="twitter:description" content="Arch uses the pacman package manager and the package format is tar.zst. Arch provides a number of tools for creating tar.zst packages, first you need to install the base-devel package and the devtools package.
1  pacman -S base-devel devtools   Arch&rsquo;s packaging process works like this, starting with writing a PKGBUILD file that describes all the information needed to build a package, such as where to download the source code from, what the dependencies are, what the build version is, how to build, etc."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">SoByte</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a><a href="/ukraine/">
        <li class="mobile-menu-item">UKRAINE</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">SoByte</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/ukraine/">UKRAINE</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">How to make a package for Arch </h1>

      <div class="post-meta">
        <span class="post-time"> 2021-09-14 15:57:07 </span>
        <div class="post-category">
            <a href="/categories/skills/"> skills </a>
            </div>
          <span class="more-meta"> 579 words </span>
          <span class="more-meta"> 3 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#pkgbuild">PKGBUILD</a></li>
        <li><a href="#how-to-submit-a-package-to-aur">How to submit a package to aur</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>Arch uses the pacman package manager and the package format is tar.zst. Arch provides a number of tools for creating tar.zst packages, first you need to install the base-devel package and the devtools package.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">pacman -S base-devel devtools
</code></pre></td></tr></table>
</div>
</div><p>Arch&rsquo;s packaging process works like this, starting with writing a PKGBUILD file that describes all the information needed to build a package, such as where to download the source code from, what the dependencies are, what the build version is, how to build, etc.</p>
<h2 id="pkgbuild">PKGBUILD</h2>
<p>A basic PKGBUILD format is as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="c1"># Maintainer: justforlxz &lt;justforlxz@gmail.com&gt;</span>

<span class="nv">pkgname</span><span class="o">=</span>dtkcore-git
<span class="nv">pkgver</span><span class="o">=</span>5.4.0.r1.ge7e7a99
<span class="nv">pkgrel</span><span class="o">=</span><span class="m">1</span>
<span class="nv">pkgdesc</span><span class="o">=</span><span class="s1">&#39;DTK core modules&#39;</span>
<span class="nv">arch</span><span class="o">=(</span><span class="s1">&#39;x86_64&#39;</span><span class="o">)</span>
<span class="nv">url</span><span class="o">=</span><span class="s2">&#34;https://github.com/linuxdeepin/dtkcore&#34;</span>
<span class="nv">license</span><span class="o">=(</span><span class="s1">&#39;LGPL3&#39;</span><span class="o">)</span>
<span class="nv">depends</span><span class="o">=(</span><span class="s1">&#39;dconf&#39;</span> <span class="s1">&#39;deepin-desktop-base-git&#39;</span> <span class="s1">&#39;python&#39;</span> <span class="s1">&#39;gsettings-qt&#39;</span> <span class="s1">&#39;lshw&#39;</span><span class="o">)</span>
<span class="nv">makedepends</span><span class="o">=(</span><span class="s1">&#39;git&#39;</span> <span class="s1">&#39;qt5-tools&#39;</span> <span class="s1">&#39;gtest&#39;</span><span class="o">)</span>
<span class="nv">conflicts</span><span class="o">=(</span><span class="s1">&#39;dtkcore&#39;</span><span class="o">)</span>
<span class="nv">provides</span><span class="o">=(</span><span class="s1">&#39;dtkcore&#39;</span><span class="o">)</span>
<span class="nv">groups</span><span class="o">=(</span><span class="s1">&#39;deepin-git&#39;</span><span class="o">)</span>
<span class="nv">source</span><span class="o">=(</span><span class="s2">&#34;</span><span class="nv">$pkgname</span><span class="s2">::git://github.com/linuxdeepin/dtkcore.git&#34;</span><span class="o">)</span>
<span class="nv">sha512sums</span><span class="o">=(</span><span class="s1">&#39;SKIP&#39;</span><span class="o">)</span>

pkgver<span class="o">()</span> <span class="o">{</span>
    <span class="nb">cd</span> <span class="nv">$pkgname</span>
    git describe --long --tags <span class="p">|</span> sed <span class="s1">&#39;s/\([^-]*-g\)/r\1/;s/-/./g&#39;</span>
<span class="o">}</span>

build<span class="o">()</span> <span class="o">{</span>
  <span class="nb">cd</span> <span class="nv">$pkgname</span>
  qmake-qt5 <span class="nv">PREFIX</span><span class="o">=</span>/usr <span class="nv">DTK_VERSION</span><span class="o">=</span><span class="nv">$pkgver</span> <span class="nv">LIB_INSTALL_DIR</span><span class="o">=</span>/usr/lib
  make
<span class="o">}</span>

package<span class="o">()</span> <span class="o">{</span>
  <span class="nb">cd</span> <span class="nv">$pkgname</span>
  make <span class="nv">INSTALL_ROOT</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$pkgdir</span><span class="s2">&#34;</span> install
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>Take dtkcore as an example, the whole configuration file is very clear and straightforward, at a glance you can see how the build tool makes a package step by step.</p>
<p>Save the configuration file to a directory named after PKGBUILD and then execute makepkg.</p>
<p>makepkg is the tool used to execute the PKGBUILD file and it builds the package according to the description in the file.</p>
<h2 id="how-to-submit-a-package-to-aur">How to submit a package to aur</h2>
<p>When you want your package to be used by others, you usually request to upload it to the official repository, but the process of entering the official repository is exceptionally tedious and can be demanding for contributors. arch provides a user repository for users to freely share configuration files, and all you need to do is download the configuration file and package it locally.</p>
<p>According to aur&rsquo;s <a href="https://wiki.archlinux.org/index.php/AUR_submission_guidelines">contribution guidelines</a>, we can easily upload our own configuration files and borrow aur tools like yay to download and build packages automatically.</p>
<blockquote>
<p>Users can share PKGBUILD through the Arch User Repository. AUR does not contain any binary packages, only PKGBUILD uploaded by users for other users to download and use. All packages are unofficial and are used at your own risk.</p>
</blockquote>
<p>Before submitting aur, it is necessary to understand some requirements of aur. <a href="https://wiki.archlinux.org/index.php/AUR_submission_guidelines#Rules_of_submission">Rules of submission</a> provides some rules to upload and maintain our own packages as long as we follow them.</p>
<p>First you need to go to the <a href="https://aur.archlinux.org/">aur website</a> and register an account and upload your ssh key We do this by cloning a new repository as a way to upload.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git clone ssh://aur@aur.archlinux.org/&lt;pkgname&gt;.git
</code></pre></td></tr></table>
</div>
</div><p>Take dtkcore for example, change the pkgname to dtkcore when cloning.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">git clone ssh://aur@aur.archlinux.org/dtkcore.git
</code></pre></td></tr></table>
</div>
</div><p>If it is the first time you create it, you will be prompted for an empty repository that you cloned.</p>
<p>Copy the PKGBUILD file to the cloned directory, then run <code>makepkg --printsrcinfo &gt; .SRCINFO</code> to create a package message, add both the <code>.SRCINFO</code> and <code>PKGBUILD</code> files to git, then commit the commit message and push it to the server.</p>
<p>Note: If you forget to include .SRCINFO in your initial commit, you can use rebasing with -root or filtering the tree to make the AUR accept your first push</p>
<p>Tip: To keep your working directory and commits as clean as possible, you can create a gitignore file to exclude all files, and then add files as needed.</p>
<p>Reference.</p>
<p><a href="https://wiki.archlinux.org/index.php/PKGBUILD">https://wiki.archlinux.org/index.php/PKGBUILD</a></p>

    </div>

    
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/arch/">arch</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/2021-09/qt-multi-thread/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Qt Multithreading</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/2021-09/deploy-k8s-by-kubespray/">
            <span class="next-text nav-default">Deploying a kubernetes cluster with Kubespray native development tests</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
  <a href="https://www.sobyte.net/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        tags: 'ams',
        }
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-mml-chtml.js" integrity="sha256-HGLuEfFcsUJGhvB8cQ8nr0gai9EucOOaIxFw7qxmd+w=" crossorigin="anonymous"></script>








</body>
</html>
